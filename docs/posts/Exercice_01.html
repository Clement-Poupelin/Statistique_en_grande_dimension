<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Clément Poupelin">
<meta name="dcterms.date" content="2025-02-17">
<meta name="description" content="Il s’agit d’une première utilisation des méthodes de régression avec sélection automatique de variables sur des données de baseball">

<title>Exercice 01 – Statistique en grande dimension</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../img/logo_univ_nantes_simple.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://www.univ-nantes.fr/" class="navbar-brand navbar-brand-logo">
    <img src="../img/logo_univ_nantes_complet.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://www.univ-nantes.fr/">
    <span class="navbar-title">Front page</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../TP_StatGdeDim.pdf"> <i class="bi bi-file-earmark-font-fill" role="img">
</i> 
<span class="menu-text">Feuille de TP</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://clement-poupelin.github.io/Statistique_en_grande_dimension/"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/Clement-Poupelin">
 <span class="dropdown-text">Clément Poupelin</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/nonomtrt">
 <span class="dropdown-text">Noémie Matrat</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-linkedin" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-linkedin">    
        <li>
    <a class="dropdown-item" href="http://www.linkedin.com/in/cl%C3%A9ment-poupelin-7675311a7/">
 <span class="dropdown-text">Clément Poupelin</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.linkedin.com/in/no%C3%A9mie-matrat-86a34a200/">
 <span class="dropdown-text">Noémie Matrat</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:clementjc.poupelin@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://clement-poupelin.github.io/"> <i class="bi bi-person-circle" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/clement__poupelin"> <i class="bi bi-instagram" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Exercice 01</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          Il s’agit d’une première utilisation des méthodes de régression avec <strong>sélection automatique de variables</strong> sur des données de baseball
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Régression linéaire</div>
                <div class="quarto-category">Sélection automatique</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Clément Poupelin </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 17, 2025</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">March 13, 2025</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#intervenant.e.s" id="toc-intervenant.e.s" class="nav-link active" data-scroll-target="#intervenant.e.s">Intervenant.e.s</a>
  <ul class="collapse">
  <li><a href="#rédaction" id="toc-rédaction" class="nav-link" data-scroll-target="#rédaction">Rédaction</a></li>
  <li><a href="#relecture" id="toc-relecture" class="nav-link" data-scroll-target="#relecture">Relecture</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#données" id="toc-données" class="nav-link" data-scroll-target="#données">Données</a></li>
  <li><a href="#analyse-descriptive" id="toc-analyse-descriptive" class="nav-link" data-scroll-target="#analyse-descriptive">Analyse descriptive</a></li>
  <li><a href="#analyse-inférentielle" id="toc-analyse-inférentielle" class="nav-link" data-scroll-target="#analyse-inférentielle">Analyse inférentielle</a>
  <ul class="collapse">
  <li><a href="#modèle-brut" id="toc-modèle-brut" class="nav-link" data-scroll-target="#modèle-brut">Modèle brut</a></li>
  <li><a href="#modèles-parcimonieux" id="toc-modèles-parcimonieux" class="nav-link" data-scroll-target="#modèles-parcimonieux">Modèles parcimonieux</a></li>
  </ul></li>
  <li><a href="#comparaison-des-critères" id="toc-comparaison-des-critères" class="nav-link" data-scroll-target="#comparaison-des-critères">Comparaison des critères</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session info</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="intervenant.e.s" class="level1">
<h1>Intervenant.e.s</h1>
<section id="rédaction" class="level3">
<h3 class="anchored" data-anchor-id="rédaction">Rédaction</h3>
<ul>
<li><strong>Clément Poupelin</strong>, <a href="mailto:clementjc.poupelin@gmail.com" class="email">clementjc.poupelin@gmail.com</a><br>
</li>
</ul>
</section>
<section id="relecture" class="level3">
<h3 class="anchored" data-anchor-id="relecture">Relecture</h3>
<ul>
<li></li>
</ul>
</section>
</section>
<section id="setup" class="level1">
<h1>Setup</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Fonctions</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Données</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)         <span class="co"># Hitters data </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)        <span class="co"># manipulation des données</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inférence</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)        <span class="co"># regsubsets </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)          <span class="co"># pour VIF</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ggplot</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Heatmap</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">pairs.panels</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">VIF plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Critères</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">plot pour nos critères</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false">Meilleur modèle après <em><code>regsubset</code></em></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transformer les données en format long pour ggplot</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  data_long <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(data)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span>  <span class="co"># Palette de couleurs harmonieuse</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Variables (Boxplot)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Valeurs"</span>) <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Thème épuré</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotation des étiquettes</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my_barplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, variable1, variable2) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> {{ variable1 }}, <span class="at">fill =</span> {{ variable2 }})) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#C41E3A"</span>, <span class="st">"#0033A0"</span>)) <span class="sc">+</span>  </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Répartition des joueurs par ligue et division"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(variable1)), </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Nombre de joueurs"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>my_League_heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  table_league <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>League,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>NewLeague</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(table_league) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"League"</span>, <span class="st">"NewLeague"</span>, <span class="st">"Count"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(table_league, <span class="fu">aes</span>(<span class="at">x =</span> League, <span class="at">y =</span> NewLeague, <span class="at">fill =</span> Count)) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"deeppink"</span>, <span class="at">high =</span> <span class="st">"deeppink4"</span>) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Count), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Transition des Joueurs entre les Ligues"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Ligue d'origine"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Nouvelle Ligue"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Nombre de joueurs"</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>my_pairs.panels <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  psych<span class="sc">::</span><span class="fu">pairs.panels</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pearson"</span>,  <span class="co"># Méthode de corrélation</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">hist.col =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Set3"</span>),  <span class="co"># Couleurs des histogrammes</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout des courbes de densité</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ellipses =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout d'ellipses</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">smooth =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout de régressions lissées</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">lm =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout des droites de régression</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"#69b3a2"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,  <span class="co"># Transparence</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.labels =</span> <span class="fl">3.5</span>,  <span class="co"># Taille du texte des variables</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">font.labels =</span> <span class="dv">2</span>  <span class="co"># Mettre en gras</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>my_VIFplot <span class="ot">&lt;-</span> <span class="cf">function</span>(vif) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  vif_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">names</span>(vif), <span class="at">VIF =</span> vif)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(vif_df, <span class="fu">aes</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">reorder</span>(Variable, VIF),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">pmin</span>(VIF, <span class="dv">15</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> VIF <span class="sc">&gt;</span> <span class="dv">10</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(VIF <span class="sc">&gt;</span> <span class="dv">10</span>, <span class="fu">round</span>(VIF, <span class="dv">1</span>), <span class="st">""</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>)) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variance Inflation Factor (VIF)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"VIF (limité à 15)"</span>) <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">34</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">54</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">26</span>),</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">30</span>),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">38</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<p>On rappel que <span class="math inline">\(SCR = \sum_i (y_i - f(x_i))^2\)</span> et <span class="math inline">\(SCT = \sum_i (y_i - \bar{y})^2\)</span>.<br>
</p>
<p>Ainsi, on peut trouver les différents critères :</p>
<p><span class="math display">\[ R^2 = 1 - \frac{SCR}{SCT}\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>r2_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># r2 = SSE/SST = (SST - SSR)/SST = 1 - ssr/sst</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SCR<span class="sc">/</span>SCT</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[ R^2_{adjusted} = 1 - \frac{SCR (n-1)}{SCT(n-(p+1))}\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>r2a_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  r2a <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SCR<span class="sc">/</span>(n<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">/</span>(SCT<span class="sc">/</span>(n<span class="dv">-1</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2a)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[ C_p = \frac{SCR}{\sigma^2} + 2(p+1) - n\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, SCR){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  sig <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  cp <span class="ot">&lt;-</span> SCR<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>) <span class="sc">-</span> n</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cp)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[ AIC = n\text{log}\left(\frac{SCR}{n}\right) + 2(p+1)\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>aic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(aic)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[ BIC = n\text{log}\left(\frac{SCR}{n}\right) + \text{log}(n)(p+1)\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>bic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="fu">log</span>(n)<span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(bic)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Criteria_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(Criteria, <span class="at">crit_name =</span> <span class="st">"Critère"</span>) {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création d'un data frame pour ggplot</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  df_criteria <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb_var =</span> <span class="fu">seq_along</span>(Criteria),  <span class="co"># Nombre de variables du modèle</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Criteria =</span> Criteria            <span class="co"># Critère</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création du plot avec ggplot2</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_criteria, <span class="fu">aes</span>(<span class="at">x =</span> nb_var, <span class="at">y =</span> Criteria)) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Évolution de"</span>, crit_name, <span class="st">"en fonction du nombre de variables"</span>),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Nombre de variables sélectionnées"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> crit_name</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">26</span>),  <span class="co"># Titre centré et agrandi</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(g)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Best_model <span class="ot">&lt;-</span> <span class="cf">function</span>(model, criteria_df){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## On a d'abord les critères à maximiser</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    criteria_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(criteria_df)[i]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    criteria <span class="ot">&lt;-</span> criteria_df[,i]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    best_model_criteria <span class="ot">&lt;-</span> <span class="fu">which.max</span>(criteria)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>which[best_model_criteria,]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Meilleur modèle selon"</span>, criteria_name, <span class="st">" = "</span>, <span class="fu">round</span>(<span class="fu">max</span>(criteria), <span class="dv">3</span>), <span class="st">" : Modèle avec"</span>, best_model_criteria, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>]), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## On a ensuite les critères à minimiser</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    criteria_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(criteria_df)[i]</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    criteria <span class="ot">&lt;-</span> criteria_df[,i]</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    best_model_criteria <span class="ot">&lt;-</span> <span class="fu">which.min</span>(criteria)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>which[best_model_criteria,]</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Meilleur modèle selon"</span>, criteria_name, <span class="st">" = "</span>, <span class="fu">round</span>(<span class="fu">min</span>(criteria), <span class="dv">3</span>),<span class="st">" : Modèle avec"</span>, best_model_criteria, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>]), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="données" class="level1">
<h1>Données</h1>
<p>On étudie le jeu de données <a href="https://rdrr.io/cran/ISLR/man/Hitters.html"><strong>Hitters</strong></a> disponible dans la libraire <em><code>{ISLR}</code></em> de <em><code>R</code></em>. Il s’agit d’un jeu de données de la <em>Major League Baseball</em> provenant des saisons de 1986 et 1987.</p>
<p>Le jeu de données possède 322 lignes/individus pour les différents joueurs et 20 variables.<br>
Parmi les variables, on trouve les informations suivantes :</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-hover table-condensed caption-top table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">AtBat</span></td>
<td style="text-align: left;">Number of times at bat in 1986</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Hits</span></td>
<td style="text-align: left;">Number of hits in 1986</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">HmRun</span></td>
<td style="text-align: left;">Number of home runs in 1986</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Runs</span></td>
<td style="text-align: left;">Number of runs in 1986</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">RBI</span></td>
<td style="text-align: left;">Number of runs batted in in 1986</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Walks</span></td>
<td style="text-align: left;">Number of walks in 1986</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Years</span></td>
<td style="text-align: left;">Number of years in the major leagues</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">CAtBat</span></td>
<td style="text-align: left;">Number of times at bat during his career</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">CHits</span></td>
<td style="text-align: left;">Number of hits during his career</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">CHmRun</span></td>
<td style="text-align: left;">Number of home runs during his career</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">CRuns</span></td>
<td style="text-align: left;">Number of runs during his career</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">CRBI</span></td>
<td style="text-align: left;">Number of runs batted in during his career</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">CWalks</span></td>
<td style="text-align: left;">Number of walks during his career</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">League</span></td>
<td style="text-align: left;">A factor with levels A and N indicating player's league at the end of 1986</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Division</span></td>
<td style="text-align: left;">A factor with levels E and W indicating player's division at the end of 1986</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">PutOuts</span></td>
<td style="text-align: left;">Number of put outs in 1986</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Assists</span></td>
<td style="text-align: left;">Number of assists in 1986</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Errors</span></td>
<td style="text-align: left;">Number of errors in 1986</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Salary</span></td>
<td style="text-align: left;">1987 annual salary on opening day in thousands of dollars</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">NewLeague</span></td>
<td style="text-align: left;">A factor with levels A and N indicating player's league at the beginning of 1987</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Regardons maintenant le <em><code>summary</code></em> pour examiner les différentes variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ?Hitters</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Hitters <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     AtBat            Hits         HmRun            Runs       
 Min.   : 16.0   Min.   :  1   Min.   : 0.00   Min.   :  0.00  
 1st Qu.:255.2   1st Qu.: 64   1st Qu.: 4.00   1st Qu.: 30.25  
 Median :379.5   Median : 96   Median : 8.00   Median : 48.00  
 Mean   :380.9   Mean   :101   Mean   :10.77   Mean   : 50.91  
 3rd Qu.:512.0   3rd Qu.:137   3rd Qu.:16.00   3rd Qu.: 69.00  
 Max.   :687.0   Max.   :238   Max.   :40.00   Max.   :130.00  
                                                               
      RBI             Walks            Years            CAtBat       
 Min.   :  0.00   Min.   :  0.00   Min.   : 1.000   Min.   :   19.0  
 1st Qu.: 28.00   1st Qu.: 22.00   1st Qu.: 4.000   1st Qu.:  816.8  
 Median : 44.00   Median : 35.00   Median : 6.000   Median : 1928.0  
 Mean   : 48.03   Mean   : 38.74   Mean   : 7.444   Mean   : 2648.7  
 3rd Qu.: 64.75   3rd Qu.: 53.00   3rd Qu.:11.000   3rd Qu.: 3924.2  
 Max.   :121.00   Max.   :105.00   Max.   :24.000   Max.   :14053.0  
                                                                     
     CHits            CHmRun           CRuns             CRBI        
 Min.   :   4.0   Min.   :  0.00   Min.   :   1.0   Min.   :   0.00  
 1st Qu.: 209.0   1st Qu.: 14.00   1st Qu.: 100.2   1st Qu.:  88.75  
 Median : 508.0   Median : 37.50   Median : 247.0   Median : 220.50  
 Mean   : 717.6   Mean   : 69.49   Mean   : 358.8   Mean   : 330.12  
 3rd Qu.:1059.2   3rd Qu.: 90.00   3rd Qu.: 526.2   3rd Qu.: 426.25  
 Max.   :4256.0   Max.   :548.00   Max.   :2165.0   Max.   :1659.00  
                                                                     
     CWalks        League  Division    PutOuts          Assists     
 Min.   :   0.00   A:175   E:157    Min.   :   0.0   Min.   :  0.0  
 1st Qu.:  67.25   N:147   W:165    1st Qu.: 109.2   1st Qu.:  7.0  
 Median : 170.50                    Median : 212.0   Median : 39.5  
 Mean   : 260.24                    Mean   : 288.9   Mean   :106.9  
 3rd Qu.: 339.25                    3rd Qu.: 325.0   3rd Qu.:166.0  
 Max.   :1566.00                    Max.   :1378.0   Max.   :492.0  
                                                                    
     Errors          Salary       NewLeague
 Min.   : 0.00   Min.   :  67.5   A:176    
 1st Qu.: 3.00   1st Qu.: 190.0   N:146    
 Median : 6.00   Median : 425.0            
 Mean   : 8.04   Mean   : 535.9            
 3rd Qu.:11.00   3rd Qu.: 750.0            
 Max.   :32.00   Max.   :2460.0            
                 NA's   :59                </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>On peut déjà remarquer la présence de 59 valeurs manquantes pour la variable <em>Salary</em>.</p>
</div>
</div>
<p>On va donc commencer par s’en débarasser (il ne s’agit que de 59 joueurs sur les 322).<br>
Puis on va également créer un sous jeu de données ne conservant que les variables quantitatives et un autre conservant les variables qualitatives. Ces jeux de données seront ensuite utilisés dans les analyses descriptives</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA_quant <span class="ot">&lt;-</span> Hitters_Without_NA <span class="sc">%&gt;%</span> <span class="fu">subset</span>(, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(League, Division, NewLeague))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA_quali <span class="ot">&lt;-</span> Hitters_Without_NA <span class="sc">%&gt;%</span> <span class="fu">subset</span>(, <span class="at">select =</span> <span class="fu">c</span>(League, Division, NewLeague))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="analyse-descriptive" class="level1">
<h1>Analyse descriptive</h1>
<p>Avant de se lancer dans des analyses inférentielles avec de l’estimation, prédiction, etc… Il convient toujours de commencer par quelques analyses descritpives afin de mieux comprendre les données sur lesquelles on travail.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Variables quantitatives</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Variables qualitatives</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">PCA</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Corrélations</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>On peut regarder un peu la distribution de nos différentes variables quantitatives via des boxplots.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_boxplot</span>(Hitters_Without_NA_quant)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Comme on pouvait s’y attendre, on retrouve des distributions assez variées selon les différentes statistques des joueurs.</p>
<p>On peut tout de même remarquer que nos variables ont en général peu de valeurs <em>outliers</em> (valeurs extrêmes par rapport aux autres).</p>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>On regarde ici la corrélation calculée entre chacune de nos variables quantitative.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_pairs.panels</span>(Hitters_Without_NA_quant)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="3072"></p>
</figure>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>On voit la présence de plusieurs fortes corrélations qui peut déjà nous alerter si l’on veut faire des modèles de régressions linéaires car on risque d’avoir un problème de colinéarité entre les varibales explicatives.<br>
Parmi ces fortes corrélations, on arrive même à distiguer deux zones où les variables sont très corrélées entre elles (de <em>AtBat</em> à <em>RBI</em> et de <em>Years</em> à <em>Cwalks</em>)</p>
<p>Par contre, il n’y a aucune forte corrélation entre la variable <em>Salary</em> et les autres variables du jeu de données. Ce qui peut nous indiquer qu’il n’y aura pas une variable avec très forte influence sur <em>Salary</em>.</p>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Heatmap</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Ici, regardons un peu le nombre des joueurs par ligue, selon la division. Et on fera cela pour les variables <em>League</em> et <em>NewLeague</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">my_barplot</span>(Hitters_Without_NA_quali, League, Division),</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">my_barplot</span>(Hitters_Without_NA_quali, NewLeague, Division)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>             , <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>De manière globale, on peut remarquer que de fin 1986 à début 1987, il ne semble pas y avoir beaucoup de changement dans la répartition des joueurs par ligue selon la division.</p>
<p>De manière plus locale, on remarque qu’il y a un peu plus de joueur en division Ouest (<em>West</em>) que division Est (<em>East</em>). Et ça, qu’on soit en ligue Américaine (<em>American League</em>) ou ligue Nationale (<em>National League</em>)</p>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>On peut regarder la <em>Heatmap</em> nous donnans la transition des joueurs entre les ligues, i.e on regarde la similarité des variables <em>League</em> et <em>NewLeague</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_League_heatmap</span>(Hitters_Without_NA_quali)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>On voit bien ici qu’effectivement les joueurs n’ont globalement pas changer de ligue entre fin 1986 et début 1987. Seulement 8 joueurs sont passés de ligue américaine à ligue nationale et 10 de ligue nationale à ligue américaine.</p>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>Avec une Analyse en Composantes Principales (<em>PCA</em>) on peut regarder un peu le comportement de nos données.</p>
<p>En effet, Cette méthode respose sur la transformation des variables d’origine en nouvelles variables non corrélées, appelées composantes principales, qui capturent successivement la plus grande variance possible des données.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>res_pca <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">PCA</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  Hitters_Without_NA,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">quali.sup =</span> <span class="fu">c</span>(<span class="fu">which</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(Hitters_Without_NA) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"League"</span>, <span class="st">"Division"</span>, <span class="st">"NewLeague"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  )),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">quanti.sup =</span> <span class="fu">which</span>(<span class="fu">colnames</span>(Hitters_Without_NA) <span class="sc">==</span> <span class="st">"Salary"</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">graph =</span> <span class="cn">FALSE</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ici, on spécifi nos variables qualitatives et on décide de mettre la variable <em>Salary</em> en variable supplémentaire, ce qui veut dire qu’elle ne sera pas considéré pour la formation de nos composantes principales (variable que l’on cherchera à estimer plus tard).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Barplot des variances</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Individus</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Tout d’abord, on peut commencer par regarder le pourcentage de variance expliqué par nos différentes composantes principales.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_eig</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncp =</span> <span class="dv">10</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">addlabels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">barfill =</span> <span class="st">"coral"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">barcolor =</span> <span class="st">"coral"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Percentage of variance of the 10 first components"</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>On voit ainsi que la majorité de la variance est expliquée par nos deux premières composantes principales avec la présence d’un fort effet de coude après celle-ci.</p>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Le plan des individus est une projection des observations (dans notre cas, les joueurs de baseball) sur les axes principaux de la PCA. Cette visualisation permet d’identifier des regroupements, tendances et anomalies au sein des données.</p>
<p>Ainsi, des individus proches sur le graphique ont des caractéristiques similaires par rapport aux variables utilisées.</p>
<p>Puis, le placement d’un individu en fonction des axes peut permettre de savoir comment le jouer se caractérise par rapport aux variables qui contribuent le plus à ces axes.<br>
On peut ensuite regarder ce placement en fonction de nos différentes variables qualitatives.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Simple</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><em>League</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false"><em>NewLeague</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false"><em>Division</em></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointsize =</span> <span class="dv">2</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.ind =</span> <span class="st">"cyan3"</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">habillage =</span> Hitters_Without_NA<span class="sc">$</span>League,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">addEllipses=</span><span class="cn">TRUE</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipse.level=</span><span class="fl">0.95</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointsize =</span> <span class="dv">2</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.ind =</span> <span class="st">"cyan3"</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">habillage =</span> Hitters_Without_NA<span class="sc">$</span>NewLeague,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">addEllipses=</span><span class="cn">TRUE</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipse.level=</span><span class="fl">0.95</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointsize =</span> <span class="dv">2</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.ind =</span> <span class="st">"cyan3"</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">habillage =</span> Hitters_Without_NA<span class="sc">$</span>Division,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">addEllipses=</span><span class="cn">TRUE</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipse.level=</span><span class="fl">0.95</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointsize =</span> <span class="dv">2</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.ind =</span> <span class="st">"cyan3"</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Ici, on voit que les joueurs se répartissent de manière plûtot uniforme sur le plan ce qui témoignent de la présence d’une grande variété de type de joueurs.</p>
<p>Et on ne voit pas de regroupement se faire en fonction de nos différentes variables qualitatives.</p>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>Le cercle des variables est une représentation graphique qui permet d’analyser les relations entre les variables initiales et les composantes principales qui forment nos axes. Il est basé sur les corrélations entre les variables et les axes principaux.</p>
<p>Ainsi, plus une variable est proche du bord du cercle, plus elle est bien représentée sur le plan factoriel et contribue fortement à la formation des axes. Ici, on utilise le cos2 pour le gradient de couleur qui va aider à l’indentifictation de ces différentes qualitées de représentation.</p>
<p>De plus, selon l’angle entre deux varibles, on peut faire des suppositions sur leur corrélation :</p>
<ul>
<li><p>Si deux variables ont des vecteurs proches (petit angle), elles sont fortement corrélées positivement</p></li>
<li><p>Si deux variables ont des vecteurs opposés (angle proche de 180°), elles sont corrélées négativement</p></li>
<li><p>Si l’angle est proche de 90°, alors les variables ne sont pas corrélées</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_var</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.var =</span> <span class="st">"cos2"</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">gradient.cols =</span> <span class="fu">rainbow</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">start =</span> .<span class="dv">6</span>, <span class="at">end =</span> .<span class="dv">9</span>),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Dans notre cas, ce que l’on peut voir c’est que la majorité de nos variables sont bien représentées par nos deux axes (cumulant plus de 70% d’explication). Mais beaucoup semblent aussi fortement corrélées avec la formation de deux groupes et la variable <em>Salary</em> se trouvant au milieu. Cette corrélation entre nos variables quantitatives ayant déjà pu être observé précédemment.<br>
Pour aller un peu plus loin dans la compréhension de ce phénomène, on peut remarquer que les deux groupes correspondent en fait aux variables qui sont des statistiques de joueurs pour la saison de 1986 (<em>Hits</em>, <em>AtBat</em>, <em>Runs</em>, <em>RBI</em>, …) et des statistiques de joueurs sur toute leur carrière (<em>Cwalks</em>, <em>CAtBat</em>, <em>CHmRun</em>, <em>CRBI</em>, …). Ainsi cela explique la présence de fortes corrélations corrélation.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="analyse-inférentielle" class="level1">
<h1>Analyse inférentielle</h1>
<section id="modèle-brut" class="level2">
<h2 class="anchored" data-anchor-id="modèle-brut">Modèle brut</h2>
<p>On désire modéliser le salaire <em>Salary</em> en fonction des variables disponibles.</p>
<p>On va donc ajuster un modèle de régression linéaire en utilisant toutes les variables à disposition et analyser la qualité de cet ajustement.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>           Hitters_Without_NA) </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>mod1 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ ., data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-907.62 -178.35  -31.11  139.09 1877.04 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  163.10359   90.77854   1.797 0.073622 .  
AtBat         -1.97987    0.63398  -3.123 0.002008 ** 
Hits           7.50077    2.37753   3.155 0.001808 ** 
HmRun          4.33088    6.20145   0.698 0.485616    
Runs          -2.37621    2.98076  -0.797 0.426122    
RBI           -1.04496    2.60088  -0.402 0.688204    
Walks          6.23129    1.82850   3.408 0.000766 ***
Years         -3.48905   12.41219  -0.281 0.778874    
CAtBat        -0.17134    0.13524  -1.267 0.206380    
CHits          0.13399    0.67455   0.199 0.842713    
CHmRun        -0.17286    1.61724  -0.107 0.914967    
CRuns          1.45430    0.75046   1.938 0.053795 .  
CRBI           0.80771    0.69262   1.166 0.244691    
CWalks        -0.81157    0.32808  -2.474 0.014057 *  
LeagueN       62.59942   79.26140   0.790 0.430424    
DivisionW   -116.84925   40.36695  -2.895 0.004141 ** 
PutOuts        0.28189    0.07744   3.640 0.000333 ***
Assists        0.37107    0.22120   1.678 0.094723 .  
Errors        -3.36076    4.39163  -0.765 0.444857    
NewLeagueN   -24.76233   79.00263  -0.313 0.754218    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 315.6 on 243 degrees of freedom
Multiple R-squared:  0.5461,    Adjusted R-squared:  0.5106 
F-statistic: 15.39 on 19 and 243 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nous sommes sur un modèle comprenant des variables quantitatives et qualitative ce qui le rapproche d’une modélisation <a href="https://en.wikipedia.org/wiki/Analysis_of_variance"><strong>ANOVA</strong></a>.</p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Ce qu’on peut remarquer en premier sur ce modèle c’est que beaucoup de variables ont un effet non significatif.</p>
<p>Aussi, ce modèle offre des valeurs de <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> autour de 0.5 ce qui témoigne d’une mauvaise qualité d’ajustement du modèle.</p>
<p>Et enfin, l’écart type résiduel est de 315.6 ce qui est assez important et témoigne d’un modèle peu précis.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Le coefficient de détermination linéaire, noté <span class="math inline">\(R^2\)</span>, est une mesure de la qualité de la prédiction d’une régression linéaire.<br>
Une formulation simple serait : <span class="math display">\[R^2 = 1 - \frac{\sum_{i=1}^n(y_i - \hat{y}_i)^2}{\sum_{i=1}^n(y_i - \bar{y}_i)^2}\]</span> où <span class="math inline">\(n\)</span> est le nombre de mesures, <span class="math inline">\(y_i\)</span> la valeur de la ième mesure , <span class="math inline">\(\hat{y}_i\)</span> la valeur prédite correspondante et <span class="math inline">\(\bar{y}_i\)</span> la moyenne des mesures.</p>
<p>Ainsi, si le coefficient est proche de 1, cela veut dire que notre prediction est proche de la réalité. Tandis qu’un modèle “de base” prédirait toujours une valeur de <span class="math inline">\(y_i\)</span> proche de la moyenne <span class="math inline">\(\bar{y}_i\)</span> ce qui nous donnerait un <span class="math inline">\(R^2\)</span> proche de 0.<br>
</p>
<p>Le <span class="math inline">\(R^2_{adjusted}\)</span> permet quant à lui de rendre compte du phénomène d’augmentation automatique du <span class="math inline">\(R^2\)</span> lorsque des variables explicatives supplémentaires sont ajoutées au modèle. Il est donc très utile à regarder dans les cas de grande dimension.</p>
</div>
</div>
<p>Pour tenter de trouver un meilleur ajustment, il est important d’analyser d’avantage le lien entre toutes les variables explicatives. On utilise alors communément le <em>VIF</em> (<em>variance inflation factor</em>).</p>
<p>On obtient alors pour chacune de nos variable une valeur qui, plus elle est élevée, témoigne de la multicolinéarité entre nos variables explicatives.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     AtBat       Hits      HmRun       Runs        RBI      Walks      Years 
 22.944366  30.281255   7.758668  15.246418  11.921715   4.148712   9.313280 
    CAtBat      CHits     CHmRun      CRuns       CRBI     CWalks     League 
251.561160 502.954289  46.488462 162.520810 131.965858  19.744105   4.134115 
  Division    PutOuts    Assists     Errors  NewLeague 
  1.075398   1.236317   2.709341   2.214543   4.099063 </code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_VIFplot</span>(<span class="fu">vif</span>(mod1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
<p>On remarque ainsi que beaucoup de valeurs sont supérieurs à 10 ce qui s’interprète communément comme la précence d’une forte colinéarité sur nos variables explicatives.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Cette colinéarité se constatait déjà durant les analyses descriptives via les graphes de corrélations (d’où l’importance de ne pas se lancer trop rapidement dans les analyses inférentielles).</p>
</div>
</div>
</section>
<section id="modèles-parcimonieux" class="level2">
<h2 class="anchored" data-anchor-id="modèles-parcimonieux">Modèles parcimonieux</h2>
<p>Maintenant, on va donc tenter de trouver le meilleur sous-modèle possible. Pour cela on va suivre la procédure suivante :</p>
<ul>
<li><p>mettre en oeuvre une méthode de sélection automatique exhaustive et observer l’évolution des SCR (Sommes de Carrés Résiduels) pour les modèles retenus en fonction de leur taille.</p></li>
<li><p>déduire de ces SCR le <span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2_{adjusted}\)</span>, <em>AIC</em>, <em>BIC</em> et <span class="math inline">\(C_p\)</span> correspondants. Les comparer avec les valeurs fournies dans le <em><code>summary</code></em> de <em><code>regsubsets</code></em> et tracer leur évolution en fonction de la taille du modèle.</p></li>
</ul>
<p>Puis reproduire la même procédure avec des séléctions <em>backward</em>, <em>forward</em> et <em>stepwise</em></p>
<p>Tout d’abord, on va définir un nouveau modèle simple ne comprenant que l’<em>intercept</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Salary<span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>           Hitters_Without_NA)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod0)<span class="sc">$</span>call</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lm(formula = Salary ~ 1, data = Hitters_Without_NA)</code></pre>
</div>
</div>
<p>Le principe de ces méthodes de régression avec sélection de variables est de tester et comparer les différents modèles possibles avec nos variables en allant du modèle le plus simple <span class="math inline">\(y \sim 1\)</span> jusqu’au modèle le plus complet <span class="math inline">\(y \sim .\)</span> ou l’inverse. Puis à chaque étape de rajout ou de suppression d’une variable dans le modèles, on sélectionne le meilleur modèle via le critère de notre choix.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Un rappel sur nos critère se trouve dans la partie <strong>Setup</strong>, onglet <strong>Fonction</strong>, de ce document avec la création de fonction pour les calculer.</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">Exhaustive</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Backward</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Forward</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false">Both</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Modèle</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Evolution des critères</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Meilleur modèle</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>selec_auto <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"exhaustive"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span> <span class="co"># maximum size of subsets to examine</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                         )</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># selec_auto %&gt;% summary()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>On va déjà commencer par regarder la valeur du critère en fonction des variables des différents modèles testés.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'bic'</span>) </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'Cp'</span>) </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'r2'</span>) </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'adjr2'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Ici on remarque clairement que toutes nos variables ne sont pas gardés lorsque l’on cherche à optimiser nos critères.</p>
<p>Aussi, on peut voir encore de faibles valeurs pour les <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> pouvant témoigner d’un mauvais ajustement de modèle.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><em><code>plot.regsubsets</code></em> de <em><code>{leaps}</code></em> ne prend pas directement “aic” comme option de scale. Pour une sélection basée sur AIC, une approche alternative consiste à utiliser la fonction <em><code>stepAIC</code></em> du package <em><code>{MASS}</code></em>, qui permet une sélection pas à pas basée sur AIC.</p>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>Regardons un peut l’évolution de la Somme des Carrés Résiduels (SCR).</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>SCR <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>rss</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Criteria_plot</span>(SCR, <span class="at">crit_name =</span> <span class="st">"Somme des Carrés Résiduels"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
<p>Maintenant regardons les autres critères mentionnés précédemment.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">r2_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>r2a <span class="ot">&lt;-</span> <span class="fu">r2a_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">cp_fun</span>(mod1, SCR)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">aic_fun</span>(SCR)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">&lt;-</span> <span class="fu">bic_fun</span>(SCR)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(r2, <span class="at">crit_name =</span> <span class="st">"R2"</span>),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(r2a, <span class="at">crit_name =</span> <span class="st">"R2 ajusté"</span>),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(cp, <span class="at">crit_name =</span> <span class="st">"Cp"</span>),</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(aic, <span class="at">crit_name =</span> <span class="st">"AIC"</span>),</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="2880"></p>
</figure>
</div>
</div>
</div>
<p>On peut ainsi voir que ce sont plutôt des modèles entre 5 et 10 variables qui optimisent nos critères (donc pas un modèle avec toutes nos variables).</p>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Regardons donc pour chaque critère quel est le modèle qui ressort comme le meilleur</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>criteria_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(r2, r2a, cp, aic, bic)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Best_model</span>(selec_auto, criteria_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Meilleur modèle selon r2  =  0.546  : Modèle avec 19 variables
 (Intercept) AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun CRuns CRBI CWalks LeagueN DivisionW PutOuts Assists Errors NewLeagueN 
 
Meilleur modèle selon r2a  =  0.523  : Modèle avec 11 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks LeagueN DivisionW PutOuts Assists 
 
Meilleur modèle selon cp  =  5.009  : Modèle avec 10 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks DivisionW PutOuts Assists 
 
Meilleur modèle selon aic  =  3031.258  : Modèle avec 10 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks DivisionW PutOuts Assists 
 
Meilleur modèle selon bic  =  3065.851  : Modèle avec 6 variables
 (Intercept) AtBat Hits Walks CRBI DivisionW PutOuts 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<p>Cette fois ci on va regarder en sélection backward. D’abord, on fait à nouveau avec la fonction <em><code>regsubset</code></em>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Modèle</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Evolution des critères</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Meilleur modèle</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>selec_back <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"backward"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_back, <span class="at">scale =</span> <span class="st">'bic'</span>) </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_back, <span class="at">scale =</span> <span class="st">'Cp'</span>) </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_back, <span class="at">scale =</span> <span class="st">'r2'</span>) </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_back, <span class="at">scale =</span> <span class="st">'adjr2'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>On remarque à nouveau une importante sélection de variables.</p>
<p>Mais ici aussi on a encore de faibles valeurs pour les <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> pouvant témoigner d’un mauvais ajustement de modèle.</p>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>SCR <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_back)<span class="sc">$</span>rss</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">r2_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>r2a <span class="ot">&lt;-</span> <span class="fu">r2a_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">cp_fun</span>(mod1, SCR)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">aic_fun</span>(SCR)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">&lt;-</span> <span class="fu">bic_fun</span>(SCR)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(r2, <span class="at">crit_name =</span> <span class="st">"R2"</span>),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(r2a, <span class="at">crit_name =</span> <span class="st">"R2 ajusté"</span>),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(cp, <span class="at">crit_name =</span> <span class="st">"Cp"</span>),</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(SCR, <span class="at">crit_name =</span> <span class="st">"Somme des Carrés Résiduels"</span>),</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(aic, <span class="at">crit_name =</span> <span class="st">"AIC"</span>),</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="2880"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Regardons donc pour chaque critère quel est le modèle qui ressort comme le meilleur</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>criteria_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(r2, r2a, cp, aic, bic)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Best_model</span>(selec_back, criteria_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Meilleur modèle selon r2  =  0.546  : Modèle avec 19 variables
 (Intercept) AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun CRuns CRBI CWalks LeagueN DivisionW PutOuts Assists Errors NewLeagueN 
 
Meilleur modèle selon r2a  =  0.523  : Modèle avec 11 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks LeagueN DivisionW PutOuts Assists 
 
Meilleur modèle selon cp  =  5.009  : Modèle avec 10 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks DivisionW PutOuts Assists 
 
Meilleur modèle selon aic  =  3031.258  : Modèle avec 10 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks DivisionW PutOuts Assists 
 
Meilleur modèle selon bic  =  3066.386  : Modèle avec 8 variables
 (Intercept) AtBat Hits Walks CRuns CRBI CWalks DivisionW PutOuts 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="utilisation-de-la-fonction-step" class="level4">
<h4 class="anchored" data-anchor-id="utilisation-de-la-fonction-step"><strong>Utilisation de la fonction step</strong></h4>
<hr>
<p>On peut également utiliser la fonction <em><code>step</code></em> de la library <em><code>{stats}</code></em>. Pour cela, on part du plus gros modèle défini précédemment par <em>mod1.</em></p>
<p>La fonction <em><code>step</code></em> nous propose quel critère nous voulons utiliser pour la sélection entre le <em>BIC</em>, <em>AIC</em> et <span class="math inline">\(C_p\)</span>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">BIC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">AIC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false"><span class="math inline">\(C_p\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Hitters_Without_NA)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>modselect_back_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="co"># trace = TRUE permet de voir le détail des étapes</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="fu">log</span>(n) <span class="co"># BIC selection</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Puis on peut regarder le modèle qui optimise le critère utilisé pour la selection.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>modselect_back_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ AtBat + Hits + Walks + CRuns + CRBI + CWalks + 
    Division + PutOuts, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-794.06 -171.94  -28.48  133.36 2017.83 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  117.15204   65.07016   1.800 0.072985 .  
AtBat         -2.03392    0.52282  -3.890 0.000128 ***
Hits           6.85491    1.65215   4.149 4.56e-05 ***
Walks          6.44066    1.52212   4.231 3.25e-05 ***
CRuns          0.70454    0.24869   2.833 0.004981 ** 
CRBI           0.52732    0.18861   2.796 0.005572 ** 
CWalks        -0.80661    0.26395  -3.056 0.002483 ** 
DivisionW   -123.77984   39.28749  -3.151 0.001824 ** 
PutOuts        0.27539    0.07431   3.706 0.000259 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 314.7 on 254 degrees of freedom
Multiple R-squared:  0.5281,    Adjusted R-squared:  0.5133 
F-statistic: 35.54 on 8 and 254 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>La fonction step propose aussi une selection avec AIC et Cp.</p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>modselect_back_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">2</span> <span class="co"># AIC selection</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>modselect_back_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ AtBat + Hits + Walks + CAtBat + CRuns + 
    CRBI + CWalks + Division + PutOuts + Assists, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-939.11 -176.87  -34.08  130.90 1910.55 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  162.53544   66.90784   2.429 0.015830 *  
AtBat         -2.16865    0.53630  -4.044 7.00e-05 ***
Hits           6.91802    1.64665   4.201 3.69e-05 ***
Walks          5.77322    1.58483   3.643 0.000327 ***
CAtBat        -0.13008    0.05550  -2.344 0.019858 *  
CRuns          1.40825    0.39040   3.607 0.000373 ***
CRBI           0.77431    0.20961   3.694 0.000271 ***
CWalks        -0.83083    0.26359  -3.152 0.001818 ** 
DivisionW   -112.38006   39.21438  -2.866 0.004511 ** 
PutOuts        0.29737    0.07444   3.995 8.50e-05 ***
Assists        0.28317    0.15766   1.796 0.073673 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.8 on 252 degrees of freedom
Multiple R-squared:  0.5405,    Adjusted R-squared:  0.5223 
F-statistic: 29.64 on 10 and 252 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>modselect_back_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">1</span> <span class="co"># Cp selection</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>modselect_back_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ AtBat + Hits + Walks + CAtBat + CRuns + 
    CRBI + CWalks + League + Division + PutOuts + Assists, data = Hitters_Without_NA)

Residuals:
   Min     1Q Median     3Q    Max 
-932.2 -175.4  -29.2  130.4 1897.2 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  135.75122   71.34623   1.903 0.058223 .  
AtBat         -2.12775    0.53746  -3.959 9.81e-05 ***
Hits           6.92370    1.64612   4.206 3.62e-05 ***
Walks          5.62028    1.59064   3.533 0.000488 ***
CAtBat        -0.13899    0.05609  -2.478 0.013870 *  
CRuns          1.45533    0.39270   3.706 0.000259 ***
CRBI           0.78525    0.20978   3.743 0.000225 ***
CWalks        -0.82286    0.26361  -3.121 0.002010 ** 
LeagueN       43.11162   39.96612   1.079 0.281755    
DivisionW   -111.14603   39.21835  -2.834 0.004970 ** 
PutOuts        0.28941    0.07478   3.870 0.000139 ***
Assists        0.26883    0.15816   1.700 0.090430 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.7 on 251 degrees of freedom
Multiple R-squared:  0.5426,    Adjusted R-squared:  0.5226 
F-statistic: 27.07 on 11 and 251 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Avec la fonction <em><code>step</code></em> nous avons le modèle utilisant le critère <em>BIC</em> qui nous permet d’avoir toutes nos variables significatives (sauf l’<em>intercept</em> ce qui pourrait nous donner envie de faire des modèles sans).</p>
<p>Par contre, nos valeurs de <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> sont encore assez faible pour considérer ces modèles comme étant de très bonne qualité.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Aussi, si on veut comparer le modèle initial et le modèle final, on peut utiliser la fonction <em><code>anova</code></em>. Cela permet de voir si la sélection de variables a significativement amélioré l’ajustement.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod0, modselect_back_bic, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Salary ~ 1
Model 2: Salary ~ AtBat + Hits + Walks + CRuns + CRBI + CWalks + Division + 
    PutOuts
  Res.Df      RSS Df Sum of Sq  Pr(&gt;Chi)    
1    262 53319113                           
2    254 25159234  8  28159879 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>De manière logique on voit donc tout de même que le modèle avec nos variable explicatives sélectionnées (ici celui avec selection via le critère <em>BIC</em>) propose un meilleur ajustement que celui sans variable.</p>
</div>
</div>
</section>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<p>Cette fois ci on va regarder en sélection <em>forward</em>. D’abord, on fait à nouveau avec la fonction <em><code>regsubset</code></em>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Modèle</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Evolution des critères</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">Meilleur modèle</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>selec_forw <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"forward"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_forw, <span class="at">scale =</span> <span class="st">'bic'</span>) </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_forw, <span class="at">scale =</span> <span class="st">'Cp'</span>) </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_forw, <span class="at">scale =</span> <span class="st">'r2'</span>) </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_forw, <span class="at">scale =</span> <span class="st">'adjr2'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>On remarque à nouveau une importante sélection de variables.</p>
<p>Mais ici aussi on a encore de faibles valeurs pour les <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> pouvant témoigner d’un mauvais ajustement de modèle.</p>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>SCR <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_forw)<span class="sc">$</span>rss</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">r2_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>r2a <span class="ot">&lt;-</span> <span class="fu">r2a_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">cp_fun</span>(mod1, SCR)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">aic_fun</span>(SCR)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">&lt;-</span> <span class="fu">bic_fun</span>(SCR)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(r2, <span class="at">crit_name =</span> <span class="st">"R2"</span>),</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(r2a, <span class="at">crit_name =</span> <span class="st">"R2 ajusté"</span>),</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(cp, <span class="at">crit_name =</span> <span class="st">"Cp"</span>),</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(SCR, <span class="at">crit_name =</span> <span class="st">"Somme des Carrés Résiduels"</span>),</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(aic, <span class="at">crit_name =</span> <span class="st">"AIC"</span>),</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="2880"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Regardons donc pour chaque critère quel est le modèle qui ressort comme le meilleur</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>criteria_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(r2, r2a, cp, aic, bic)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Best_model</span>(selec_forw, criteria_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Meilleur modèle selon r2  =  0.546  : Modèle avec 19 variables
 (Intercept) AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun CRuns CRBI CWalks LeagueN DivisionW PutOuts Assists Errors NewLeagueN 
 
Meilleur modèle selon r2a  =  0.523  : Modèle avec 11 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks LeagueN DivisionW PutOuts Assists 
 
Meilleur modèle selon cp  =  5.009  : Modèle avec 10 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks DivisionW PutOuts Assists 
 
Meilleur modèle selon aic  =  3031.258  : Modèle avec 10 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks DivisionW PutOuts Assists 
 
Meilleur modèle selon bic  =  3065.851  : Modèle avec 6 variables
 (Intercept) AtBat Hits Walks CRBI DivisionW PutOuts 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="utilisation-de-la-fonction-step-1" class="level4">
<h4 class="anchored" data-anchor-id="utilisation-de-la-fonction-step-1"><strong>Utilisation de la fonction step</strong></h4>
<hr>
<p>On peut également utiliser la fonction <em><code>step</code></em> de la library <em><code>{stats}</code></em>. Cette fois ci il faut définir en modèle de départ le plus petit modèle (celui composé seulement de l’intercept).</p>
<p>La fonction <em><code>step</code></em> nous propose quel critère nous voulons utiliser pour la sélection entre le <em>BIC</em>, <em>AIC</em> et <span class="math inline">\(C_p\)</span>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">BIC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">AIC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false"><span class="math inline">\(C_p\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>modselect_forw_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="co"># trace = TRUE permet de voir le détail des étapes</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="fu">log</span>(n) <span class="co"># BIC selection</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Puis on peut regarder le modèle qui optimise le critère utilisé pour la selection.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>modselect_forw_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-873.11 -181.72  -25.91  141.77 2040.47 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   91.51180   65.00006   1.408 0.160382    
CRBI           0.64302    0.06443   9.979  &lt; 2e-16 ***
Hits           7.60440    1.66254   4.574 7.46e-06 ***
PutOuts        0.26431    0.07477   3.535 0.000484 ***
DivisionW   -122.95153   39.82029  -3.088 0.002239 ** 
AtBat         -1.86859    0.52742  -3.543 0.000470 ***
Walks          3.69765    1.21036   3.055 0.002488 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 319.9 on 256 degrees of freedom
Multiple R-squared:  0.5087,    Adjusted R-squared:  0.4972 
F-statistic: 44.18 on 6 and 256 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>La fonction step propose aussi une selection avec AIC et Cp.</p>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>modselect_forw_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">2</span> <span class="co"># AIC selection</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>modselect_forw_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks + CWalks + CRuns + CAtBat + Assists, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-939.11 -176.87  -34.08  130.90 1910.55 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  162.53544   66.90784   2.429 0.015830 *  
CRBI           0.77431    0.20961   3.694 0.000271 ***
Hits           6.91802    1.64665   4.201 3.69e-05 ***
PutOuts        0.29737    0.07444   3.995 8.50e-05 ***
DivisionW   -112.38006   39.21438  -2.866 0.004511 ** 
AtBat         -2.16865    0.53630  -4.044 7.00e-05 ***
Walks          5.77322    1.58483   3.643 0.000327 ***
CWalks        -0.83083    0.26359  -3.152 0.001818 ** 
CRuns          1.40825    0.39040   3.607 0.000373 ***
CAtBat        -0.13008    0.05550  -2.344 0.019858 *  
Assists        0.28317    0.15766   1.796 0.073673 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.8 on 252 degrees of freedom
Multiple R-squared:  0.5405,    Adjusted R-squared:  0.5223 
F-statistic: 29.64 on 10 and 252 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>modselect_forw_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">1</span> <span class="co"># Cp selection</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>modselect_forw_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks + CWalks + CRuns + CAtBat + Assists + League, data = Hitters_Without_NA)

Residuals:
   Min     1Q Median     3Q    Max 
-932.2 -175.4  -29.2  130.4 1897.2 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  135.75122   71.34623   1.903 0.058223 .  
CRBI           0.78525    0.20978   3.743 0.000225 ***
Hits           6.92370    1.64612   4.206 3.62e-05 ***
PutOuts        0.28941    0.07478   3.870 0.000139 ***
DivisionW   -111.14603   39.21835  -2.834 0.004970 ** 
AtBat         -2.12775    0.53746  -3.959 9.81e-05 ***
Walks          5.62028    1.59064   3.533 0.000488 ***
CWalks        -0.82286    0.26361  -3.121 0.002010 ** 
CRuns          1.45533    0.39270   3.706 0.000259 ***
CAtBat        -0.13899    0.05609  -2.478 0.013870 *  
Assists        0.26883    0.15816   1.700 0.090430 .  
LeagueN       43.11162   39.96612   1.079 0.281755    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.7 on 251 degrees of freedom
Multiple R-squared:  0.5426,    Adjusted R-squared:  0.5226 
F-statistic: 27.07 on 11 and 251 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Avec la fonction <em><code>step</code></em> nous avons le modèle utilisant le critère <em>BIC</em> qui nous permet d’avoir toutes nos variables significatives (sauf l’<em>intercept</em> ce qui pourrait nous donner envie de faire des modèles sans).</p>
<p>Par contre, nos valeurs de <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> sont encore assez faible pour considérer ces modèles comme étant de très bonne qualité.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Aussi, si on veut comparer le modèle initial et le modèle final, on peut utiliser la fonction <em><code>anova</code></em>. Cela permet de voir si la sélection de variables a significativement amélioré l’ajustement.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod0, modselect_forw_bic, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Salary ~ 1
Model 2: Salary ~ CRBI + Hits + PutOuts + Division + AtBat + Walks
  Res.Df      RSS Df Sum of Sq  Pr(&gt;Chi)    
1    262 53319113                           
2    256 26194904  6  27124209 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>De manière logique on voit donc tout de même que le modèle avec nos variable explicatives sélectionnées (ici celui avec selection via le critère <em>BIC</em>) propose un meilleur ajustement que celui sans variable.</p>
</div>
</div>
</section>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<p>Maintenant on va regarder en sélection <em>both</em>. D’abord, on fait à nouveau avec la fonction <em><code>regsubset</code></em>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Modèle</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Evolution des critères</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Meilleur modèle</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>selec_seq <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"seqrep"</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_seq, <span class="at">scale =</span> <span class="st">'bic'</span>) </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_seq, <span class="at">scale =</span> <span class="st">'Cp'</span>) </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_seq, <span class="at">scale =</span> <span class="st">'r2'</span>) </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_seq, <span class="at">scale =</span> <span class="st">'adjr2'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>On remarque à nouveau une importante sélection de variables.</p>
<p>Mais ici aussi on a encore de faibles valeurs pour les <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> pouvant témoigner d’un mauvais ajustement de modèle.</p>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>SCR <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_seq)<span class="sc">$</span>rss</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">r2_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>r2a <span class="ot">&lt;-</span> <span class="fu">r2a_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">cp_fun</span>(mod1, SCR)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">aic_fun</span>(SCR)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">&lt;-</span> <span class="fu">bic_fun</span>(SCR)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(r2, <span class="at">crit_name =</span> <span class="st">"R2"</span>),</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(r2a, <span class="at">crit_name =</span> <span class="st">"R2 ajusté"</span>),</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(cp, <span class="at">crit_name =</span> <span class="st">"Cp"</span>),</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(SCR, <span class="at">crit_name =</span> <span class="st">"Somme des Carrés Résiduels"</span>),</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(aic, <span class="at">crit_name =</span> <span class="st">"AIC"</span>),</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="2880"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Regardons donc pour chaque critère quel est le modèle qui ressort comme le meilleur</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>criteria_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(r2, r2a, cp, aic, bic)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Best_model</span>(selec_seq, criteria_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Meilleur modèle selon r2  =  0.546  : Modèle avec 19 variables
 (Intercept) AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits CHmRun CRuns CRBI CWalks LeagueN DivisionW PutOuts Assists Errors NewLeagueN 
 
Meilleur modèle selon r2a  =  0.523  : Modèle avec 11 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks LeagueN DivisionW PutOuts Assists 
 
Meilleur modèle selon cp  =  5.009  : Modèle avec 10 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks DivisionW PutOuts Assists 
 
Meilleur modèle selon aic  =  3031.258  : Modèle avec 10 variables
 (Intercept) AtBat Hits Walks CAtBat CRuns CRBI CWalks DivisionW PutOuts Assists 
 
Meilleur modèle selon bic  =  3065.851  : Modèle avec 6 variables
 (Intercept) AtBat Hits Walks CRBI DivisionW PutOuts 
 </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="utilisation-de-la-fonction-step-2" class="level4">
<h4 class="anchored" data-anchor-id="utilisation-de-la-fonction-step-2"><strong>Utilisation de la fonction step</strong></h4>
<hr>
<p>On peut également utiliser la fonction <em><code>step</code></em> de la library <em><code>{stats}</code></em>.</p>
<p>La fonction <em><code>step</code></em> nous propose quel critère nous voulons utiliser pour la sélection entre le <em>BIC</em>, <em>AIC</em> et <span class="math inline">\(C_p\)</span>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">BIC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">AIC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false"><span class="math inline">\(C_p\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>modselect_seq_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="fu">log</span>(n))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>modselect_seq_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-873.11 -181.72  -25.91  141.77 2040.47 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   91.51180   65.00006   1.408 0.160382    
CRBI           0.64302    0.06443   9.979  &lt; 2e-16 ***
Hits           7.60440    1.66254   4.574 7.46e-06 ***
PutOuts        0.26431    0.07477   3.535 0.000484 ***
DivisionW   -122.95153   39.82029  -3.088 0.002239 ** 
AtBat         -1.86859    0.52742  -3.543 0.000470 ***
Walks          3.69765    1.21036   3.055 0.002488 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 319.9 on 256 degrees of freedom
Multiple R-squared:  0.5087,    Adjusted R-squared:  0.4972 
F-statistic: 44.18 on 6 and 256 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>modselect_seq_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>modselect_seq_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks + CWalks + CRuns + CAtBat + Assists, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-939.11 -176.87  -34.08  130.90 1910.55 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  162.53544   66.90784   2.429 0.015830 *  
CRBI           0.77431    0.20961   3.694 0.000271 ***
Hits           6.91802    1.64665   4.201 3.69e-05 ***
PutOuts        0.29737    0.07444   3.995 8.50e-05 ***
DivisionW   -112.38006   39.21438  -2.866 0.004511 ** 
AtBat         -2.16865    0.53630  -4.044 7.00e-05 ***
Walks          5.77322    1.58483   3.643 0.000327 ***
CWalks        -0.83083    0.26359  -3.152 0.001818 ** 
CRuns          1.40825    0.39040   3.607 0.000373 ***
CAtBat        -0.13008    0.05550  -2.344 0.019858 *  
Assists        0.28317    0.15766   1.796 0.073673 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.8 on 252 degrees of freedom
Multiple R-squared:  0.5405,    Adjusted R-squared:  0.5223 
F-statistic: 29.64 on 10 and 252 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>modselect_seq_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>modselect_seq_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks + CWalks + CRuns + CAtBat + Assists + League, data = Hitters_Without_NA)

Residuals:
   Min     1Q Median     3Q    Max 
-932.2 -175.4  -29.2  130.4 1897.2 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  135.75122   71.34623   1.903 0.058223 .  
CRBI           0.78525    0.20978   3.743 0.000225 ***
Hits           6.92370    1.64612   4.206 3.62e-05 ***
PutOuts        0.28941    0.07478   3.870 0.000139 ***
DivisionW   -111.14603   39.21835  -2.834 0.004970 ** 
AtBat         -2.12775    0.53746  -3.959 9.81e-05 ***
Walks          5.62028    1.59064   3.533 0.000488 ***
CWalks        -0.82286    0.26361  -3.121 0.002010 ** 
CRuns          1.45533    0.39270   3.706 0.000259 ***
CAtBat        -0.13899    0.05609  -2.478 0.013870 *  
Assists        0.26883    0.15816   1.700 0.090430 .  
LeagueN       43.11162   39.96612   1.079 0.281755    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.7 on 251 degrees of freedom
Multiple R-squared:  0.5426,    Adjusted R-squared:  0.5226 
F-statistic: 27.07 on 11 and 251 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Avec la fonction <em><code>step</code></em> nous avons le modèle utilisant le critère <em>BIC</em> qui nous permet d’avoir toutes nos variables significatives (sauf l’<em>intercept</em> ce qui pourrait nous donner envie de faire des modèles sans).</p>
<p>Par contre, nos valeurs de <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> sont encore assez faible pour considérer ces modèles comme étant de très bonne qualité.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Aussi, si on veut comparer le modèle initial et le modèle final, on peut utiliser la fonction <em><code>anova</code></em>. Cela permet de voir si la sélection de variables a significativement amélioré l’ajustement.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod0, modselect_seq_bic, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Salary ~ 1
Model 2: Salary ~ CRBI + Hits + PutOuts + Division + AtBat + Walks
  Res.Df      RSS Df Sum of Sq  Pr(&gt;Chi)    
1    262 53319113                           
2    256 26194904  6  27124209 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>De manière logique on voit donc tout de même que le modèle avec nos variable explicatives sélectionnées (ici celui avec selection via le critère <em>BIC</em>) propose un meilleur ajustement que celui sans variable.</p>
</div>
</div>
</section>
</div>
</div>
</div>
</section>
</section>
<section id="comparaison-des-critères" class="level1">
<h1>Comparaison des critères</h1>
<p>Avant de finir, comparons un peut les critères que nous avons calculés avec ceux que l’on peut récupérer via le <em><code>summary</code></em> de <em><code>regsubset</code></em> (pour tous sauf l’<em>AIC</em> qui n’est pas présent). On se contentera de faire se comparatif seulement pour le modèle <em>stepwise</em>.</p>
<p>Pour cela regardons si nous avons régulièrement la valeur 0 (ou valeur proche) lorsque l’on fait la soustraction du critère calculé et du critère donné par regsubset :</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"(valeur calculée - valeur récupérée) pour le R2 :"</span>,  <span class="fu">round</span>(r2<span class="sc">-</span><span class="fu">summary</span>(selec_seq)<span class="sc">$</span>rsq) <span class="sc">%&gt;%</span> <span class="fu">mean</span>(),</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">(valeur calculée - valeur récupérée) pour le R2 ajusté:"</span>,  <span class="fu">round</span>(r2a<span class="sc">-</span><span class="fu">summary</span>(selec_seq)<span class="sc">$</span>adjr2) <span class="sc">%&gt;%</span> <span class="fu">mean</span>(),</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">(valeur calculée - valeur récupérée) pour le Cp :"</span>,  <span class="fu">round</span>(cp<span class="sc">-</span><span class="fu">summary</span>(selec_seq)<span class="sc">$</span>cp) <span class="sc">%&gt;%</span> <span class="fu">mean</span>(),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">(valeur calculée - valeur récupérée) pour le BIC :"</span>,  <span class="fu">round</span>(bic<span class="sc">-</span><span class="fu">summary</span>(selec_seq)<span class="sc">$</span>bic) <span class="sc">%&gt;%</span> <span class="fu">mean</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(valeur calculée - valeur récupérée) pour le R2 : 0 
(valeur calculée - valeur récupérée) pour le R2 ajusté: 0 
(valeur calculée - valeur récupérée) pour le Cp : 0 
(valeur calculée - valeur récupérée) pour le BIC : 3214</code></pre>
</div>
</div>
<p>on voit une grosse différence seulement pour le <em>BIC</em> donc regardons plus en détail via les représentations visuelles de l’évolution du critère.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(<span class="fu">summary</span>(selec_seq)<span class="sc">$</span>bic, <span class="at">crit_name =</span> <span class="st">"BIC regsubstet ajusté"</span>),</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Exercice_01_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="2496"></p>
</figure>
</div>
</div>
</div>
<p>On voit que les valeurs sont différentes mais en fait le comportement est identique. Ce qui veut dire que la différence est seulement due à une constant multiplicative près.</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>À la lumière des résultats de notre analyse, on peut envisager le modèle <em>both</em> car bien qu’il n’ait pas montré de grandes améliorations en termes de <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span>, il a une démarche plus “souple” pour permettre de réduire le nombre de variables tout en maintenant celles qui sont significatives. Ce modèle est donc plus parcimonieux tout en conservant des variables importantes. Cependant, une réflexion supplémentaire pourrait être menée sur l’éventuelle suppression de l’<em>intercept</em>, ce qui nécessiterait une validation supplémentaire.</p>
<p>En ce qui concerne le choix final du modèle, on peut opter pour celui qui maximise le critère <em>BIC</em>, ce qui nous mène à un modèle avec 6 variables. Le <em>BIC</em> est particulièrement utile pour privilégier un modèle plus simple et plus parcimonieux, ce qui est un atout lorsqu’on cherche à éviter un surajustement. Toutefois, il est important de noter que la qualité de l’ajustement n’est pas optimale, ce qui suggère qu’il pourrait manquer certaines informations pour expliquer pleinement la variable cible (le salaire).</p>
<p>Enfin, la validité interne est un aspect crucial qui n’a pas été suffisamment exploré dans cette analyse. Il aurait été pertinent de vérifier que toutes les hypothèses sous-jacentes des modèles étaient satisfaites. Cela aurait permis de renforcer la robustesse de nos résultats et de garantir que les conclusions qu’on sont fiables.</p>
<p>Donc, il serait pertinent d’examiner plus en profondeur des modèles sans <em>intercept</em> et la validité interne, notamment en testant les hypothèses de normalité, d’homoscédasticité, et d’indépendance des résidus.</p>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>(<span class="at">pkgs =</span> <span class="st">"attached"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.4.2 (2024-10-31)
 os       Ubuntu 24.04.1 LTS
 system   x86_64, linux-gnu
 ui       X11
 language (EN)
 collate  fr_FR.UTF-8
 ctype    fr_FR.UTF-8
 tz       Europe/Paris
 date     2025-03-13
 pandoc   3.2 @ /usr/lib/rstudio/resources/app/bin/quarto/bin/tools/x86_64/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package    * version date (UTC) lib source
 car        * 3.1-3   2024-09-27 [1] CRAN (R 4.4.2)
 carData    * 3.0-5   2022-01-06 [1] CRAN (R 4.4.2)
 dplyr      * 1.1.4   2023-11-17 [1] CRAN (R 4.4.2)
 forcats    * 1.0.0   2023-01-29 [1] CRAN (R 4.4.2)
 ggplot2    * 3.5.1   2024-04-23 [1] CRAN (R 4.4.2)
 gridExtra  * 2.3     2017-09-09 [1] CRAN (R 4.4.2)
 ISLR       * 1.4     2021-09-15 [1] CRAN (R 4.4.2)
 kableExtra * 1.4.0   2024-01-24 [1] CRAN (R 4.4.2)
 leaps      * 3.2     2024-06-10 [1] CRAN (R 4.4.2)
 lubridate  * 1.9.4   2024-12-08 [1] CRAN (R 4.4.2)
 purrr      * 1.0.4   2025-02-05 [1] CRAN (R 4.4.2)
 readr      * 2.1.5   2024-01-10 [1] CRAN (R 4.4.2)
 stringr    * 1.5.1   2023-11-14 [2] CRAN (R 4.3.3)
 tibble     * 3.2.1   2023-03-20 [2] CRAN (R 4.3.3)
 tidyr      * 1.3.1   2024-01-24 [1] CRAN (R 4.4.2)
 tidyverse  * 2.0.0   2023-02-22 [1] CRAN (R 4.4.2)

 [1] /home/clement/R/x86_64-pc-linux-gnu-library/4.4
 [2] /usr/local/lib/R/site-library
 [3] /usr/lib/R/site-library
 [4] /usr/lib/R/library

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/clement-poupelin\.github\.io\/Statistique_en_grande_dimension\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb87" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Exercice 01"</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Clément Poupelin"</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-02-17"</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co">    embed-resources: false</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: article</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> false</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> ["Régression linéaire", "Sélection automatique"]</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "/img/baseball.png"</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Il s'agit d'une première utilisation des méthodes de régression avec **sélection automatique de variables** sur des données de baseball"</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a><span class="fu"># Intervenant.e.s</span></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a><span class="fu">### Rédaction</span></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Clément Poupelin**, <span class="co">[</span><span class="ot">clementjc.poupelin\@gmail.com</span><span class="co">](mailto:clementjc.poupelin@gmail.com)</span>{.email}\</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a><span class="fu">### Relecture</span></span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span></span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup</span></span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>:::: panel-tabset</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages</span></span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, setup, warning=FALSE, message=FALSE}</span></span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a><span class="in"># Données</span></span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a><span class="in">library(ISLR)         # Hitters data </span></span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)        # manipulation des données</span></span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a><span class="in"># Inférence</span></span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a><span class="in">library(leaps)        # regsubsets </span></span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a><span class="in">library(car)          # pour VIF</span></span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a><span class="in"># Plots</span></span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a><span class="in">## ggplot</span></span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a><span class="in">library(gridExtra)</span></span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fonctions</span></span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb87-57"><a href="#cb87-57" aria-hidden="true" tabindex="-1"></a><span class="fu">### Boxplot</span></span>
<span id="cb87-58"><a href="#cb87-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-61"><a href="#cb87-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-62"><a href="#cb87-62" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb87-63"><a href="#cb87-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transformer les données en format long pour ggplot</span></span>
<span id="cb87-64"><a href="#cb87-64" aria-hidden="true" tabindex="-1"></a>  data_long <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(data)</span>
<span id="cb87-65"><a href="#cb87-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-66"><a href="#cb87-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb87-67"><a href="#cb87-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb87-68"><a href="#cb87-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span>  <span class="co"># Palette de couleurs harmonieuse</span></span>
<span id="cb87-69"><a href="#cb87-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Variables (Boxplot)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Valeurs"</span>) <span class="sc">+</span></span>
<span id="cb87-70"><a href="#cb87-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Thème épuré</span></span>
<span id="cb87-71"><a href="#cb87-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotation des étiquettes</span></span>
<span id="cb87-72"><a href="#cb87-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-73"><a href="#cb87-73" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-74"><a href="#cb87-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-75"><a href="#cb87-75" aria-hidden="true" tabindex="-1"></a><span class="fu">### barplot</span></span>
<span id="cb87-76"><a href="#cb87-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-79"><a href="#cb87-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-80"><a href="#cb87-80" aria-hidden="true" tabindex="-1"></a>my_barplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, variable1, variable2) {</span>
<span id="cb87-81"><a href="#cb87-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> {{ variable1 }}, <span class="at">fill =</span> {{ variable2 }})) <span class="sc">+</span></span>
<span id="cb87-82"><a href="#cb87-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb87-83"><a href="#cb87-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#C41E3A"</span>, <span class="st">"#0033A0"</span>)) <span class="sc">+</span>  </span>
<span id="cb87-84"><a href="#cb87-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb87-85"><a href="#cb87-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Répartition des joueurs par ligue et division"</span>,</span>
<span id="cb87-86"><a href="#cb87-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(variable1)), </span>
<span id="cb87-87"><a href="#cb87-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Nombre de joueurs"</span></span>
<span id="cb87-88"><a href="#cb87-88" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb87-89"><a href="#cb87-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb87-90"><a href="#cb87-90" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-91"><a href="#cb87-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-92"><a href="#cb87-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-93"><a href="#cb87-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-94"><a href="#cb87-94" aria-hidden="true" tabindex="-1"></a><span class="fu">### Heatmap</span></span>
<span id="cb87-95"><a href="#cb87-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-98"><a href="#cb87-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-99"><a href="#cb87-99" aria-hidden="true" tabindex="-1"></a>my_League_heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb87-100"><a href="#cb87-100" aria-hidden="true" tabindex="-1"></a>  table_league <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(</span>
<span id="cb87-101"><a href="#cb87-101" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>League,</span>
<span id="cb87-102"><a href="#cb87-102" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>NewLeague</span>
<span id="cb87-103"><a href="#cb87-103" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb87-104"><a href="#cb87-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(table_league) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"League"</span>, <span class="st">"NewLeague"</span>, <span class="st">"Count"</span>)</span>
<span id="cb87-105"><a href="#cb87-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-106"><a href="#cb87-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(table_league, <span class="fu">aes</span>(<span class="at">x =</span> League, <span class="at">y =</span> NewLeague, <span class="at">fill =</span> Count)) <span class="sc">+</span></span>
<span id="cb87-107"><a href="#cb87-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb87-108"><a href="#cb87-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"deeppink"</span>, <span class="at">high =</span> <span class="st">"deeppink4"</span>) <span class="sc">+</span></span>
<span id="cb87-109"><a href="#cb87-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Count), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb87-110"><a href="#cb87-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb87-111"><a href="#cb87-111" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Transition des Joueurs entre les Ligues"</span>,</span>
<span id="cb87-112"><a href="#cb87-112" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Ligue d'origine"</span>,</span>
<span id="cb87-113"><a href="#cb87-113" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Nouvelle Ligue"</span>,</span>
<span id="cb87-114"><a href="#cb87-114" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Nombre de joueurs"</span></span>
<span id="cb87-115"><a href="#cb87-115" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb87-116"><a href="#cb87-116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb87-117"><a href="#cb87-117" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-118"><a href="#cb87-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-119"><a href="#cb87-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-120"><a href="#cb87-120" aria-hidden="true" tabindex="-1"></a><span class="fu">### pairs.panels</span></span>
<span id="cb87-121"><a href="#cb87-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-124"><a href="#cb87-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-125"><a href="#cb87-125" aria-hidden="true" tabindex="-1"></a>my_pairs.panels <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb87-126"><a href="#cb87-126" aria-hidden="true" tabindex="-1"></a>  psych<span class="sc">::</span><span class="fu">pairs.panels</span>(</span>
<span id="cb87-127"><a href="#cb87-127" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb87-128"><a href="#cb87-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pearson"</span>,  <span class="co"># Méthode de corrélation</span></span>
<span id="cb87-129"><a href="#cb87-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">hist.col =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Set3"</span>),  <span class="co"># Couleurs des histogrammes</span></span>
<span id="cb87-130"><a href="#cb87-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout des courbes de densité</span></span>
<span id="cb87-131"><a href="#cb87-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">ellipses =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout d'ellipses</span></span>
<span id="cb87-132"><a href="#cb87-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">smooth =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout de régressions lissées</span></span>
<span id="cb87-133"><a href="#cb87-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">lm =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout des droites de régression</span></span>
<span id="cb87-134"><a href="#cb87-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"#69b3a2"</span>,</span>
<span id="cb87-135"><a href="#cb87-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,  <span class="co"># Transparence</span></span>
<span id="cb87-136"><a href="#cb87-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.labels =</span> <span class="fl">3.5</span>,  <span class="co"># Taille du texte des variables</span></span>
<span id="cb87-137"><a href="#cb87-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">font.labels =</span> <span class="dv">2</span>  <span class="co"># Mettre en gras</span></span>
<span id="cb87-138"><a href="#cb87-138" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-139"><a href="#cb87-139" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-140"><a href="#cb87-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-141"><a href="#cb87-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-142"><a href="#cb87-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-143"><a href="#cb87-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-144"><a href="#cb87-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-145"><a href="#cb87-145" aria-hidden="true" tabindex="-1"></a><span class="fu">### VIF plot</span></span>
<span id="cb87-146"><a href="#cb87-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-149"><a href="#cb87-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-150"><a href="#cb87-150" aria-hidden="true" tabindex="-1"></a>my_VIFplot <span class="ot">&lt;-</span> <span class="cf">function</span>(vif) {</span>
<span id="cb87-151"><a href="#cb87-151" aria-hidden="true" tabindex="-1"></a>  vif_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">names</span>(vif), <span class="at">VIF =</span> vif)</span>
<span id="cb87-152"><a href="#cb87-152" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-153"><a href="#cb87-153" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(vif_df, <span class="fu">aes</span>(</span>
<span id="cb87-154"><a href="#cb87-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">reorder</span>(Variable, VIF),</span>
<span id="cb87-155"><a href="#cb87-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">pmin</span>(VIF, <span class="dv">15</span>),</span>
<span id="cb87-156"><a href="#cb87-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> VIF <span class="sc">&gt;</span> <span class="dv">10</span></span>
<span id="cb87-157"><a href="#cb87-157" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb87-158"><a href="#cb87-158" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb87-159"><a href="#cb87-159" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(VIF <span class="sc">&gt;</span> <span class="dv">10</span>, <span class="fu">round</span>(VIF, <span class="dv">1</span>), <span class="st">""</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb87-160"><a href="#cb87-160" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb87-161"><a href="#cb87-161" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>)) <span class="sc">+</span></span>
<span id="cb87-162"><a href="#cb87-162" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variance Inflation Factor (VIF)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"VIF (limité à 15)"</span>) <span class="sc">+</span></span>
<span id="cb87-163"><a href="#cb87-163" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb87-164"><a href="#cb87-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb87-165"><a href="#cb87-165" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">34</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb87-166"><a href="#cb87-166" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb87-167"><a href="#cb87-167" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">54</span>,</span>
<span id="cb87-168"><a href="#cb87-168" aria-hidden="true" tabindex="-1"></a>        <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb87-169"><a href="#cb87-169" aria-hidden="true" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb87-170"><a href="#cb87-170" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb87-171"><a href="#cb87-171" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">26</span>),</span>
<span id="cb87-172"><a href="#cb87-172" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb87-173"><a href="#cb87-173" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">30</span>),</span>
<span id="cb87-174"><a href="#cb87-174" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">38</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb87-175"><a href="#cb87-175" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb87-176"><a href="#cb87-176" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-177"><a href="#cb87-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb87-178"><a href="#cb87-178" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-179"><a href="#cb87-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-180"><a href="#cb87-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-181"><a href="#cb87-181" aria-hidden="true" tabindex="-1"></a><span class="fu">### Critères</span></span>
<span id="cb87-182"><a href="#cb87-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-183"><a href="#cb87-183" aria-hidden="true" tabindex="-1"></a>On rappel que $SCR = \sum_i (y_i - f(x_i))^2$ et $SCT = \sum_i (y_i - \bar{y})^2$.\</span>
<span id="cb87-184"><a href="#cb87-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-185"><a href="#cb87-185" aria-hidden="true" tabindex="-1"></a>Ainsi, on peut trouver les différents critères :</span>
<span id="cb87-186"><a href="#cb87-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-187"><a href="#cb87-187" aria-hidden="true" tabindex="-1"></a>$$ R^2 = 1 - \frac{SCR}{SCT}$$</span>
<span id="cb87-188"><a href="#cb87-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-191"><a href="#cb87-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-192"><a href="#cb87-192" aria-hidden="true" tabindex="-1"></a>r2_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb87-193"><a href="#cb87-193" aria-hidden="true" tabindex="-1"></a>  <span class="co"># r2 = SSE/SST = (SST - SSR)/SST = 1 - ssr/sst</span></span>
<span id="cb87-194"><a href="#cb87-194" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb87-195"><a href="#cb87-195" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SCR<span class="sc">/</span>SCT</span>
<span id="cb87-196"><a href="#cb87-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2)</span>
<span id="cb87-197"><a href="#cb87-197" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-198"><a href="#cb87-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-199"><a href="#cb87-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-200"><a href="#cb87-200" aria-hidden="true" tabindex="-1"></a>$$ R^2_{adjusted} = 1 - \frac{SCR (n-1)}{SCT(n-(p+1))}$$</span>
<span id="cb87-201"><a href="#cb87-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-204"><a href="#cb87-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-205"><a href="#cb87-205" aria-hidden="true" tabindex="-1"></a>r2a_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb87-206"><a href="#cb87-206" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb87-207"><a href="#cb87-207" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb87-208"><a href="#cb87-208" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb87-209"><a href="#cb87-209" aria-hidden="true" tabindex="-1"></a>  r2a <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SCR<span class="sc">/</span>(n<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">/</span>(SCT<span class="sc">/</span>(n<span class="dv">-1</span>))</span>
<span id="cb87-210"><a href="#cb87-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2a)</span>
<span id="cb87-211"><a href="#cb87-211" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-212"><a href="#cb87-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-213"><a href="#cb87-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-214"><a href="#cb87-214" aria-hidden="true" tabindex="-1"></a>$$ C_p = \frac{SCR}{\sigma^2} + 2(p+1) - n$$</span>
<span id="cb87-215"><a href="#cb87-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-218"><a href="#cb87-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-219"><a href="#cb87-219" aria-hidden="true" tabindex="-1"></a>cp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, SCR){</span>
<span id="cb87-220"><a href="#cb87-220" aria-hidden="true" tabindex="-1"></a>  sig <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb87-221"><a href="#cb87-221" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb87-222"><a href="#cb87-222" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb87-223"><a href="#cb87-223" aria-hidden="true" tabindex="-1"></a>  cp <span class="ot">&lt;-</span> SCR<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>) <span class="sc">-</span> n</span>
<span id="cb87-224"><a href="#cb87-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cp)</span>
<span id="cb87-225"><a href="#cb87-225" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-226"><a href="#cb87-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-227"><a href="#cb87-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-228"><a href="#cb87-228" aria-hidden="true" tabindex="-1"></a>$$ AIC = n\text{log}\left(\frac{SCR}{n}\right) + 2(p+1)$$</span>
<span id="cb87-229"><a href="#cb87-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-232"><a href="#cb87-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-233"><a href="#cb87-233" aria-hidden="true" tabindex="-1"></a>aic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb87-234"><a href="#cb87-234" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb87-235"><a href="#cb87-235" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb87-236"><a href="#cb87-236" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb87-237"><a href="#cb87-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(aic)</span>
<span id="cb87-238"><a href="#cb87-238" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-239"><a href="#cb87-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-240"><a href="#cb87-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-241"><a href="#cb87-241" aria-hidden="true" tabindex="-1"></a>$$ BIC = n\text{log}\left(\frac{SCR}{n}\right) + \text{log}(n)(p+1)$$</span>
<span id="cb87-242"><a href="#cb87-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-245"><a href="#cb87-245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-246"><a href="#cb87-246" aria-hidden="true" tabindex="-1"></a>bic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb87-247"><a href="#cb87-247" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb87-248"><a href="#cb87-248" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb87-249"><a href="#cb87-249" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="fu">log</span>(n)<span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb87-250"><a href="#cb87-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(bic)</span>
<span id="cb87-251"><a href="#cb87-251" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-252"><a href="#cb87-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-253"><a href="#cb87-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-254"><a href="#cb87-254" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot pour nos critères</span></span>
<span id="cb87-255"><a href="#cb87-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-258"><a href="#cb87-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-259"><a href="#cb87-259" aria-hidden="true" tabindex="-1"></a>Criteria_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(Criteria, <span class="at">crit_name =</span> <span class="st">"Critère"</span>) {</span>
<span id="cb87-260"><a href="#cb87-260" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création d'un data frame pour ggplot</span></span>
<span id="cb87-261"><a href="#cb87-261" aria-hidden="true" tabindex="-1"></a>  df_criteria <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb87-262"><a href="#cb87-262" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb_var =</span> <span class="fu">seq_along</span>(Criteria),  <span class="co"># Nombre de variables du modèle</span></span>
<span id="cb87-263"><a href="#cb87-263" aria-hidden="true" tabindex="-1"></a>    <span class="at">Criteria =</span> Criteria            <span class="co"># Critère</span></span>
<span id="cb87-264"><a href="#cb87-264" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-265"><a href="#cb87-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-266"><a href="#cb87-266" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création du plot avec ggplot2</span></span>
<span id="cb87-267"><a href="#cb87-267" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_criteria, <span class="fu">aes</span>(<span class="at">x =</span> nb_var, <span class="at">y =</span> Criteria)) <span class="sc">+</span></span>
<span id="cb87-268"><a href="#cb87-268" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb87-269"><a href="#cb87-269" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb87-270"><a href="#cb87-270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb87-271"><a href="#cb87-271" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Évolution de"</span>, crit_name, <span class="st">"en fonction du nombre de variables"</span>),</span>
<span id="cb87-272"><a href="#cb87-272" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Nombre de variables sélectionnées"</span>,</span>
<span id="cb87-273"><a href="#cb87-273" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> crit_name</span>
<span id="cb87-274"><a href="#cb87-274" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb87-275"><a href="#cb87-275" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb87-276"><a href="#cb87-276" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb87-277"><a href="#cb87-277" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">26</span>),  <span class="co"># Titre centré et agrandi</span></span>
<span id="cb87-278"><a href="#cb87-278" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb87-279"><a href="#cb87-279" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb87-280"><a href="#cb87-280" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)</span>
<span id="cb87-281"><a href="#cb87-281" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb87-282"><a href="#cb87-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-283"><a href="#cb87-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(g)</span>
<span id="cb87-284"><a href="#cb87-284" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-285"><a href="#cb87-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-286"><a href="#cb87-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-287"><a href="#cb87-287" aria-hidden="true" tabindex="-1"></a><span class="fu">### Meilleur modèle après *`regsubset`*</span></span>
<span id="cb87-288"><a href="#cb87-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-291"><a href="#cb87-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-292"><a href="#cb87-292" aria-hidden="true" tabindex="-1"></a>Best_model <span class="ot">&lt;-</span> <span class="cf">function</span>(model, criteria_df){</span>
<span id="cb87-293"><a href="#cb87-293" aria-hidden="true" tabindex="-1"></a>  <span class="do">## On a d'abord les critères à maximiser</span></span>
<span id="cb87-294"><a href="#cb87-294" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb87-295"><a href="#cb87-295" aria-hidden="true" tabindex="-1"></a>    criteria_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(criteria_df)[i]</span>
<span id="cb87-296"><a href="#cb87-296" aria-hidden="true" tabindex="-1"></a>    criteria <span class="ot">&lt;-</span> criteria_df[,i]</span>
<span id="cb87-297"><a href="#cb87-297" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb87-298"><a href="#cb87-298" aria-hidden="true" tabindex="-1"></a>    best_model_criteria <span class="ot">&lt;-</span> <span class="fu">which.max</span>(criteria)</span>
<span id="cb87-299"><a href="#cb87-299" aria-hidden="true" tabindex="-1"></a>    selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>which[best_model_criteria,]</span>
<span id="cb87-300"><a href="#cb87-300" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb87-301"><a href="#cb87-301" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Meilleur modèle selon"</span>, criteria_name, <span class="st">" = "</span>, <span class="fu">round</span>(<span class="fu">max</span>(criteria), <span class="dv">3</span>), <span class="st">" : Modèle avec"</span>, best_model_criteria, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb87-302"><a href="#cb87-302" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>]), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb87-303"><a href="#cb87-303" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-304"><a href="#cb87-304" aria-hidden="true" tabindex="-1"></a>  <span class="do">## On a ensuite les critères à minimiser</span></span>
<span id="cb87-305"><a href="#cb87-305" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb87-306"><a href="#cb87-306" aria-hidden="true" tabindex="-1"></a>    criteria_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(criteria_df)[i]</span>
<span id="cb87-307"><a href="#cb87-307" aria-hidden="true" tabindex="-1"></a>    criteria <span class="ot">&lt;-</span> criteria_df[,i]</span>
<span id="cb87-308"><a href="#cb87-308" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb87-309"><a href="#cb87-309" aria-hidden="true" tabindex="-1"></a>    best_model_criteria <span class="ot">&lt;-</span> <span class="fu">which.min</span>(criteria)</span>
<span id="cb87-310"><a href="#cb87-310" aria-hidden="true" tabindex="-1"></a>    selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>which[best_model_criteria,]</span>
<span id="cb87-311"><a href="#cb87-311" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb87-312"><a href="#cb87-312" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Meilleur modèle selon"</span>, criteria_name, <span class="st">" = "</span>, <span class="fu">round</span>(<span class="fu">min</span>(criteria), <span class="dv">3</span>),<span class="st">" : Modèle avec"</span>, best_model_criteria, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb87-313"><a href="#cb87-313" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>]), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb87-314"><a href="#cb87-314" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-315"><a href="#cb87-315" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-316"><a href="#cb87-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-317"><a href="#cb87-317" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-318"><a href="#cb87-318" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-319"><a href="#cb87-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-320"><a href="#cb87-320" aria-hidden="true" tabindex="-1"></a><span class="fu"># Données</span></span>
<span id="cb87-321"><a href="#cb87-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-322"><a href="#cb87-322" aria-hidden="true" tabindex="-1"></a>On étudie le jeu de données <span class="co">[</span><span class="ot">**Hitters**</span><span class="co">](https://rdrr.io/cran/ISLR/man/Hitters.html)</span> disponible dans la libraire *`{ISLR}`* de *`R`*. Il s'agit d'un jeu de données de la *Major League Baseball* provenant des saisons de 1986 et 1987.</span>
<span id="cb87-323"><a href="#cb87-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-324"><a href="#cb87-324" aria-hidden="true" tabindex="-1"></a>Le jeu de données possède <span class="in">`r dim(Hitters)[1]`</span> lignes/individus pour les différents joueurs et <span class="in">`r dim(Hitters)[2]`</span> variables.\</span>
<span id="cb87-325"><a href="#cb87-325" aria-hidden="true" tabindex="-1"></a>Parmi les variables, on trouve les informations suivantes :</span>
<span id="cb87-326"><a href="#cb87-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-327"><a href="#cb87-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb87-328"><a href="#cb87-328" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb87-329"><a href="#cb87-329" aria-hidden="true" tabindex="-1"></a><span class="in">library(kableExtra)</span></span>
<span id="cb87-330"><a href="#cb87-330" aria-hidden="true" tabindex="-1"></a><span class="in">identity_keys &lt;- cell_spec(</span></span>
<span id="cb87-331"><a href="#cb87-331" aria-hidden="true" tabindex="-1"></a><span class="in">  x = colnames(Hitters), format = "html", bold = TRUE)</span></span>
<span id="cb87-332"><a href="#cb87-332" aria-hidden="true" tabindex="-1"></a><span class="in">identity_values &lt;- c("Number of times at bat in 1986", "Number of hits in 1986", "Number of home runs in 1986", "Number of runs in 1986", "Number of runs batted in in 1986", "Number of walks in 1986", "Number of years in the major leagues", "Number of times at bat during his career", "Number of hits during his career", "Number of home runs during his career", "Number of runs during his career", "Number of runs batted in during his career", "Number of walks during his career", "A factor with levels A and N indicating player's league at the end of 1986", "A factor with levels E and W indicating player's division at the end of 1986", "Number of put outs in 1986", "Number of assists in 1986", "Number of errors in 1986", "1987 annual salary on opening day in thousands of dollars", "A factor with levels A and N indicating player's league at the beginning of 1987")</span></span>
<span id="cb87-333"><a href="#cb87-333" aria-hidden="true" tabindex="-1"></a><span class="in">tibble(</span></span>
<span id="cb87-334"><a href="#cb87-334" aria-hidden="true" tabindex="-1"></a><span class="in">  keys = identity_keys, </span></span>
<span id="cb87-335"><a href="#cb87-335" aria-hidden="true" tabindex="-1"></a><span class="in">  values = identity_values, </span></span>
<span id="cb87-336"><a href="#cb87-336" aria-hidden="true" tabindex="-1"></a><span class="in">) %&gt;% </span></span>
<span id="cb87-337"><a href="#cb87-337" aria-hidden="true" tabindex="-1"></a><span class="in">  kbl(</span></span>
<span id="cb87-338"><a href="#cb87-338" aria-hidden="true" tabindex="-1"></a><span class="in">    format = "html", </span></span>
<span id="cb87-339"><a href="#cb87-339" aria-hidden="true" tabindex="-1"></a><span class="in">    booktabs = TRUE, </span></span>
<span id="cb87-340"><a href="#cb87-340" aria-hidden="true" tabindex="-1"></a><span class="in">    escape = FALSE, </span></span>
<span id="cb87-341"><a href="#cb87-341" aria-hidden="true" tabindex="-1"></a><span class="in">    col.names = NULL</span></span>
<span id="cb87-342"><a href="#cb87-342" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb87-343"><a href="#cb87-343" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("hover", "condensed"))</span></span>
<span id="cb87-344"><a href="#cb87-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-345"><a href="#cb87-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-346"><a href="#cb87-346" aria-hidden="true" tabindex="-1"></a>Regardons maintenant le *`summary`* pour examiner les différentes variables.</span>
<span id="cb87-347"><a href="#cb87-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-350"><a href="#cb87-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-351"><a href="#cb87-351" aria-hidden="true" tabindex="-1"></a><span class="co"># ?Hitters</span></span>
<span id="cb87-352"><a href="#cb87-352" aria-hidden="true" tabindex="-1"></a>Hitters <span class="sc">%&gt;%</span></span>
<span id="cb87-353"><a href="#cb87-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb87-354"><a href="#cb87-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-355"><a href="#cb87-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-356"><a href="#cb87-356" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb87-357"><a href="#cb87-357" aria-hidden="true" tabindex="-1"></a>On peut déjà remarquer la présence de 59 valeurs manquantes pour la variable *Salary*.</span>
<span id="cb87-358"><a href="#cb87-358" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-359"><a href="#cb87-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-360"><a href="#cb87-360" aria-hidden="true" tabindex="-1"></a>On va donc commencer par s'en débarasser (il ne s'agit que de 59 joueurs sur les 322).\</span>
<span id="cb87-361"><a href="#cb87-361" aria-hidden="true" tabindex="-1"></a>Puis on va également créer un sous jeu de données ne conservant que les variables quantitatives et un autre conservant les variables qualitatives. Ces jeux de données seront ensuite utilisés dans les analyses descriptives</span>
<span id="cb87-362"><a href="#cb87-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-365"><a href="#cb87-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-366"><a href="#cb87-366" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span>
<span id="cb87-367"><a href="#cb87-367" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA_quant <span class="ot">&lt;-</span> Hitters_Without_NA <span class="sc">%&gt;%</span> <span class="fu">subset</span>(, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(League, Division, NewLeague))</span>
<span id="cb87-368"><a href="#cb87-368" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA_quali <span class="ot">&lt;-</span> Hitters_Without_NA <span class="sc">%&gt;%</span> <span class="fu">subset</span>(, <span class="at">select =</span> <span class="fu">c</span>(League, Division, NewLeague))</span>
<span id="cb87-369"><a href="#cb87-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-370"><a href="#cb87-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-371"><a href="#cb87-371" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyse descriptive</span></span>
<span id="cb87-372"><a href="#cb87-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-373"><a href="#cb87-373" aria-hidden="true" tabindex="-1"></a>Avant de se lancer dans des analyses inférentielles avec de l'estimation, prédiction, etc... Il convient toujours de commencer par quelques analyses descritpives afin de mieux comprendre les données sur lesquelles on travail.</span>
<span id="cb87-374"><a href="#cb87-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-375"><a href="#cb87-375" aria-hidden="true" tabindex="-1"></a>:::::::::::::::::::::::::::: panel-tabset</span>
<span id="cb87-376"><a href="#cb87-376" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variables quantitatives</span></span>
<span id="cb87-377"><a href="#cb87-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-378"><a href="#cb87-378" aria-hidden="true" tabindex="-1"></a>::::::::: panel-tabset</span>
<span id="cb87-379"><a href="#cb87-379" aria-hidden="true" tabindex="-1"></a><span class="fu">### Boxplot</span></span>
<span id="cb87-380"><a href="#cb87-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-381"><a href="#cb87-381" aria-hidden="true" tabindex="-1"></a>On peut regarder un peu la distribution de nos différentes variables quantitatives via des boxplots.</span>
<span id="cb87-382"><a href="#cb87-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-383"><a href="#cb87-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, fig.height=6, fig.width=8}</span></span>
<span id="cb87-384"><a href="#cb87-384" aria-hidden="true" tabindex="-1"></a><span class="in">my_boxplot(Hitters_Without_NA_quant)</span></span>
<span id="cb87-385"><a href="#cb87-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-386"><a href="#cb87-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-387"><a href="#cb87-387" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-388"><a href="#cb87-388" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-389"><a href="#cb87-389" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-390"><a href="#cb87-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-391"><a href="#cb87-391" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-392"><a href="#cb87-392" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-393"><a href="#cb87-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-394"><a href="#cb87-394" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-395"><a href="#cb87-395" aria-hidden="true" tabindex="-1"></a>Comme on pouvait s'y attendre, on retrouve des distributions assez variées selon les différentes statistques des joueurs.</span>
<span id="cb87-396"><a href="#cb87-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-397"><a href="#cb87-397" aria-hidden="true" tabindex="-1"></a>On peut tout de même remarquer que nos variables ont en général peu de valeurs *outliers* (valeurs extrêmes par rapport aux autres).</span>
<span id="cb87-398"><a href="#cb87-398" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-399"><a href="#cb87-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-400"><a href="#cb87-400" aria-hidden="true" tabindex="-1"></a><span class="fu">### Corrélations</span></span>
<span id="cb87-401"><a href="#cb87-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-402"><a href="#cb87-402" aria-hidden="true" tabindex="-1"></a>On regarde ici la corrélation calculée entre chacune de nos variables quantitative.</span>
<span id="cb87-403"><a href="#cb87-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-404"><a href="#cb87-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=26, fig.width=32}</span></span>
<span id="cb87-405"><a href="#cb87-405" aria-hidden="true" tabindex="-1"></a><span class="in">my_pairs.panels(Hitters_Without_NA_quant)</span></span>
<span id="cb87-406"><a href="#cb87-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-407"><a href="#cb87-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-408"><a href="#cb87-408" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-409"><a href="#cb87-409" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-410"><a href="#cb87-410" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-411"><a href="#cb87-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-412"><a href="#cb87-412" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-413"><a href="#cb87-413" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-414"><a href="#cb87-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-415"><a href="#cb87-415" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-416"><a href="#cb87-416" aria-hidden="true" tabindex="-1"></a>On voit la présence de plusieurs fortes corrélations qui peut déjà nous alerter si l'on veut faire des modèles de régressions linéaires car on risque d'avoir un problème de colinéarité entre les varibales explicatives.\</span>
<span id="cb87-417"><a href="#cb87-417" aria-hidden="true" tabindex="-1"></a>Parmi ces fortes corrélations, on arrive même à distiguer deux zones où les variables sont très corrélées entre elles (de *AtBat* à *RBI* et de *Years* à *Cwalks*)</span>
<span id="cb87-418"><a href="#cb87-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-419"><a href="#cb87-419" aria-hidden="true" tabindex="-1"></a>Par contre, il n'y a aucune forte corrélation entre la variable *Salary* et les autres variables du jeu de données. Ce qui peut nous indiquer qu'il n'y aura pas une variable avec très forte influence sur *Salary*.</span>
<span id="cb87-420"><a href="#cb87-420" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-421"><a href="#cb87-421" aria-hidden="true" tabindex="-1"></a>:::::::::</span>
<span id="cb87-422"><a href="#cb87-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-423"><a href="#cb87-423" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variables qualitatives</span></span>
<span id="cb87-424"><a href="#cb87-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-425"><a href="#cb87-425" aria-hidden="true" tabindex="-1"></a>::::::::: panel-tabset</span>
<span id="cb87-426"><a href="#cb87-426" aria-hidden="true" tabindex="-1"></a><span class="fu">### Barplot</span></span>
<span id="cb87-427"><a href="#cb87-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-428"><a href="#cb87-428" aria-hidden="true" tabindex="-1"></a>Ici, regardons un peu le nombre des joueurs par ligue, selon la division. Et on fera cela pour les variables *League* et *NewLeague*.</span>
<span id="cb87-429"><a href="#cb87-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-430"><a href="#cb87-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=12}</span></span>
<span id="cb87-431"><a href="#cb87-431" aria-hidden="true" tabindex="-1"></a><span class="in">grid.arrange(my_barplot(Hitters_Without_NA_quali, League, Division),</span></span>
<span id="cb87-432"><a href="#cb87-432" aria-hidden="true" tabindex="-1"></a><span class="in">             my_barplot(Hitters_Without_NA_quali, NewLeague, Division)</span></span>
<span id="cb87-433"><a href="#cb87-433" aria-hidden="true" tabindex="-1"></a><span class="in">             , ncol=2)</span></span>
<span id="cb87-434"><a href="#cb87-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-435"><a href="#cb87-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-436"><a href="#cb87-436" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-437"><a href="#cb87-437" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-438"><a href="#cb87-438" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-439"><a href="#cb87-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-440"><a href="#cb87-440" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-441"><a href="#cb87-441" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-442"><a href="#cb87-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-443"><a href="#cb87-443" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-444"><a href="#cb87-444" aria-hidden="true" tabindex="-1"></a>De manière globale, on peut remarquer que de fin 1986 à début 1987, il ne semble pas y avoir beaucoup de changement dans la répartition des joueurs par ligue selon la division.</span>
<span id="cb87-445"><a href="#cb87-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-446"><a href="#cb87-446" aria-hidden="true" tabindex="-1"></a>De manière plus locale, on remarque qu'il y a un peu plus de joueur en division Ouest (*West*) que division Est (*East*). Et ça, qu'on soit en ligue Américaine (*American League*) ou ligue Nationale (*National League*)</span>
<span id="cb87-447"><a href="#cb87-447" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-448"><a href="#cb87-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-449"><a href="#cb87-449" aria-hidden="true" tabindex="-1"></a><span class="fu">### Heatmap</span></span>
<span id="cb87-450"><a href="#cb87-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-451"><a href="#cb87-451" aria-hidden="true" tabindex="-1"></a>On peut regarder la *Heatmap* nous donnans la transition des joueurs entre les ligues, i.e on regarde la similarité des variables *League* et *NewLeague*.</span>
<span id="cb87-452"><a href="#cb87-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-455"><a href="#cb87-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-456"><a href="#cb87-456" aria-hidden="true" tabindex="-1"></a><span class="fu">my_League_heatmap</span>(Hitters_Without_NA_quali)</span>
<span id="cb87-457"><a href="#cb87-457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-458"><a href="#cb87-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-459"><a href="#cb87-459" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-460"><a href="#cb87-460" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-461"><a href="#cb87-461" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-462"><a href="#cb87-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-463"><a href="#cb87-463" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-464"><a href="#cb87-464" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-465"><a href="#cb87-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-466"><a href="#cb87-466" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-467"><a href="#cb87-467" aria-hidden="true" tabindex="-1"></a>On voit bien ici qu'effectivement les joueurs n'ont globalement pas changer de ligue entre fin 1986 et début 1987. Seulement 8 joueurs sont passés de ligue américaine à ligue nationale et 10 de ligue nationale à ligue américaine.</span>
<span id="cb87-468"><a href="#cb87-468" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-469"><a href="#cb87-469" aria-hidden="true" tabindex="-1"></a>:::::::::</span>
<span id="cb87-470"><a href="#cb87-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-471"><a href="#cb87-471" aria-hidden="true" tabindex="-1"></a><span class="fu">## PCA</span></span>
<span id="cb87-472"><a href="#cb87-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-473"><a href="#cb87-473" aria-hidden="true" tabindex="-1"></a>Avec une Analyse en Composantes Principales (*PCA*) on peut regarder un peu le comportement de nos données.</span>
<span id="cb87-474"><a href="#cb87-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-475"><a href="#cb87-475" aria-hidden="true" tabindex="-1"></a>En effet, Cette méthode respose sur la transformation des variables d'origine en nouvelles variables non corrélées, appelées composantes principales, qui capturent successivement la plus grande variance possible des données.</span>
<span id="cb87-476"><a href="#cb87-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-479"><a href="#cb87-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-480"><a href="#cb87-480" aria-hidden="true" tabindex="-1"></a>res_pca <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">PCA</span>(</span>
<span id="cb87-481"><a href="#cb87-481" aria-hidden="true" tabindex="-1"></a>  Hitters_Without_NA,</span>
<span id="cb87-482"><a href="#cb87-482" aria-hidden="true" tabindex="-1"></a>  <span class="at">quali.sup =</span> <span class="fu">c</span>(<span class="fu">which</span>(</span>
<span id="cb87-483"><a href="#cb87-483" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(Hitters_Without_NA) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"League"</span>, <span class="st">"Division"</span>, <span class="st">"NewLeague"</span>)</span>
<span id="cb87-484"><a href="#cb87-484" aria-hidden="true" tabindex="-1"></a>  )),</span>
<span id="cb87-485"><a href="#cb87-485" aria-hidden="true" tabindex="-1"></a>  <span class="at">quanti.sup =</span> <span class="fu">which</span>(<span class="fu">colnames</span>(Hitters_Without_NA) <span class="sc">==</span> <span class="st">"Salary"</span>),</span>
<span id="cb87-486"><a href="#cb87-486" aria-hidden="true" tabindex="-1"></a>  <span class="at">graph =</span> <span class="cn">FALSE</span></span>
<span id="cb87-487"><a href="#cb87-487" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-488"><a href="#cb87-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-489"><a href="#cb87-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-490"><a href="#cb87-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-491"><a href="#cb87-491" aria-hidden="true" tabindex="-1"></a>Ici, on spécifi nos variables qualitatives et on décide de mettre la variable *Salary* en variable supplémentaire, ce qui veut dire qu'elle ne sera pas considéré pour la formation de nos composantes principales (variable que l'on cherchera à estimer plus tard).</span>
<span id="cb87-492"><a href="#cb87-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-493"><a href="#cb87-493" aria-hidden="true" tabindex="-1"></a>::::::::::::: panel-tabset</span>
<span id="cb87-494"><a href="#cb87-494" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Barplot des variances</span></span>
<span id="cb87-495"><a href="#cb87-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-496"><a href="#cb87-496" aria-hidden="true" tabindex="-1"></a>Tout d'abord, on peut commencer par regarder le pourcentage de variance expliqué par nos différentes composantes principales.</span>
<span id="cb87-497"><a href="#cb87-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-500"><a href="#cb87-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-501"><a href="#cb87-501" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_eig</span>(</span>
<span id="cb87-502"><a href="#cb87-502" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb87-503"><a href="#cb87-503" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncp =</span> <span class="dv">10</span>,</span>
<span id="cb87-504"><a href="#cb87-504" aria-hidden="true" tabindex="-1"></a>  <span class="at">addlabels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-505"><a href="#cb87-505" aria-hidden="true" tabindex="-1"></a>  <span class="at">barfill =</span> <span class="st">"coral"</span>,</span>
<span id="cb87-506"><a href="#cb87-506" aria-hidden="true" tabindex="-1"></a>  <span class="at">barcolor =</span> <span class="st">"coral"</span>,</span>
<span id="cb87-507"><a href="#cb87-507" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb87-508"><a href="#cb87-508" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Percentage of variance of the 10 first components"</span></span>
<span id="cb87-509"><a href="#cb87-509" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-510"><a href="#cb87-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-511"><a href="#cb87-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-512"><a href="#cb87-512" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-513"><a href="#cb87-513" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-514"><a href="#cb87-514" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-515"><a href="#cb87-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-516"><a href="#cb87-516" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-517"><a href="#cb87-517" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-518"><a href="#cb87-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-519"><a href="#cb87-519" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-520"><a href="#cb87-520" aria-hidden="true" tabindex="-1"></a>On voit ainsi que la majorité de la variance est expliquée par nos deux premières composantes principales avec la présence d'un fort effet de coude après celle-ci.</span>
<span id="cb87-521"><a href="#cb87-521" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-522"><a href="#cb87-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-523"><a href="#cb87-523" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individus</span></span>
<span id="cb87-524"><a href="#cb87-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-525"><a href="#cb87-525" aria-hidden="true" tabindex="-1"></a>Le plan des individus est une projection des observations (dans notre cas, les joueurs de baseball) sur les axes principaux de la PCA. Cette visualisation permet d’identifier des regroupements, tendances et anomalies au sein des données.</span>
<span id="cb87-526"><a href="#cb87-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-527"><a href="#cb87-527" aria-hidden="true" tabindex="-1"></a>Ainsi, des individus proches sur le graphique ont des caractéristiques similaires par rapport aux variables utilisées.</span>
<span id="cb87-528"><a href="#cb87-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-529"><a href="#cb87-529" aria-hidden="true" tabindex="-1"></a>Puis, le placement d'un individu en fonction des axes peut permettre de savoir comment le jouer se caractérise par rapport aux variables qui contribuent le plus à ces axes.\</span>
<span id="cb87-530"><a href="#cb87-530" aria-hidden="true" tabindex="-1"></a>On peut ensuite regarder ce placement en fonction de nos différentes variables qualitatives.</span>
<span id="cb87-531"><a href="#cb87-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-532"><a href="#cb87-532" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb87-533"><a href="#cb87-533" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Simple</span></span>
<span id="cb87-534"><a href="#cb87-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-535"><a href="#cb87-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb87-536"><a href="#cb87-536" aria-hidden="true" tabindex="-1"></a><span class="in">factoextra::fviz_pca_ind(</span></span>
<span id="cb87-537"><a href="#cb87-537" aria-hidden="true" tabindex="-1"></a><span class="in">  res_pca,</span></span>
<span id="cb87-538"><a href="#cb87-538" aria-hidden="true" tabindex="-1"></a><span class="in">  label = "none",</span></span>
<span id="cb87-539"><a href="#cb87-539" aria-hidden="true" tabindex="-1"></a><span class="in">  pointsize = 2,</span></span>
<span id="cb87-540"><a href="#cb87-540" aria-hidden="true" tabindex="-1"></a><span class="in">  col.ind = "cyan3"</span></span>
<span id="cb87-541"><a href="#cb87-541" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb87-542"><a href="#cb87-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-543"><a href="#cb87-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-544"><a href="#cb87-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-545"><a href="#cb87-545" aria-hidden="true" tabindex="-1"></a><span class="fu">##### *League*</span></span>
<span id="cb87-546"><a href="#cb87-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-547"><a href="#cb87-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb87-548"><a href="#cb87-548" aria-hidden="true" tabindex="-1"></a><span class="in">factoextra::fviz_pca_ind(</span></span>
<span id="cb87-549"><a href="#cb87-549" aria-hidden="true" tabindex="-1"></a><span class="in">  res_pca,</span></span>
<span id="cb87-550"><a href="#cb87-550" aria-hidden="true" tabindex="-1"></a><span class="in">  habillage = Hitters_Without_NA$League,</span></span>
<span id="cb87-551"><a href="#cb87-551" aria-hidden="true" tabindex="-1"></a><span class="in">  addEllipses=TRUE,</span></span>
<span id="cb87-552"><a href="#cb87-552" aria-hidden="true" tabindex="-1"></a><span class="in">  ellipse.level=0.95,</span></span>
<span id="cb87-553"><a href="#cb87-553" aria-hidden="true" tabindex="-1"></a><span class="in">  label = "none",</span></span>
<span id="cb87-554"><a href="#cb87-554" aria-hidden="true" tabindex="-1"></a><span class="in">  pointsize = 2,</span></span>
<span id="cb87-555"><a href="#cb87-555" aria-hidden="true" tabindex="-1"></a><span class="in">  col.ind = "cyan3"</span></span>
<span id="cb87-556"><a href="#cb87-556" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb87-557"><a href="#cb87-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-558"><a href="#cb87-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-559"><a href="#cb87-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-560"><a href="#cb87-560" aria-hidden="true" tabindex="-1"></a><span class="fu">##### *NewLeague*</span></span>
<span id="cb87-561"><a href="#cb87-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-562"><a href="#cb87-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb87-563"><a href="#cb87-563" aria-hidden="true" tabindex="-1"></a><span class="in">factoextra::fviz_pca_ind(</span></span>
<span id="cb87-564"><a href="#cb87-564" aria-hidden="true" tabindex="-1"></a><span class="in">  res_pca,</span></span>
<span id="cb87-565"><a href="#cb87-565" aria-hidden="true" tabindex="-1"></a><span class="in">  habillage = Hitters_Without_NA$NewLeague,</span></span>
<span id="cb87-566"><a href="#cb87-566" aria-hidden="true" tabindex="-1"></a><span class="in">  addEllipses=TRUE,</span></span>
<span id="cb87-567"><a href="#cb87-567" aria-hidden="true" tabindex="-1"></a><span class="in">  ellipse.level=0.95,</span></span>
<span id="cb87-568"><a href="#cb87-568" aria-hidden="true" tabindex="-1"></a><span class="in">  label = "none",</span></span>
<span id="cb87-569"><a href="#cb87-569" aria-hidden="true" tabindex="-1"></a><span class="in">  pointsize = 2,</span></span>
<span id="cb87-570"><a href="#cb87-570" aria-hidden="true" tabindex="-1"></a><span class="in">  col.ind = "cyan3"</span></span>
<span id="cb87-571"><a href="#cb87-571" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb87-572"><a href="#cb87-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-573"><a href="#cb87-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-574"><a href="#cb87-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-575"><a href="#cb87-575" aria-hidden="true" tabindex="-1"></a><span class="fu">##### *Division*</span></span>
<span id="cb87-576"><a href="#cb87-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-577"><a href="#cb87-577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb87-578"><a href="#cb87-578" aria-hidden="true" tabindex="-1"></a><span class="in">factoextra::fviz_pca_ind(</span></span>
<span id="cb87-579"><a href="#cb87-579" aria-hidden="true" tabindex="-1"></a><span class="in">  res_pca,</span></span>
<span id="cb87-580"><a href="#cb87-580" aria-hidden="true" tabindex="-1"></a><span class="in">  habillage = Hitters_Without_NA$Division,</span></span>
<span id="cb87-581"><a href="#cb87-581" aria-hidden="true" tabindex="-1"></a><span class="in">  addEllipses=TRUE,</span></span>
<span id="cb87-582"><a href="#cb87-582" aria-hidden="true" tabindex="-1"></a><span class="in">  ellipse.level=0.95,</span></span>
<span id="cb87-583"><a href="#cb87-583" aria-hidden="true" tabindex="-1"></a><span class="in">  label = "none",</span></span>
<span id="cb87-584"><a href="#cb87-584" aria-hidden="true" tabindex="-1"></a><span class="in">  pointsize = 2,</span></span>
<span id="cb87-585"><a href="#cb87-585" aria-hidden="true" tabindex="-1"></a><span class="in">  col.ind = "cyan3"</span></span>
<span id="cb87-586"><a href="#cb87-586" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb87-587"><a href="#cb87-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-588"><a href="#cb87-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-589"><a href="#cb87-589" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-590"><a href="#cb87-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-591"><a href="#cb87-591" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-592"><a href="#cb87-592" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-593"><a href="#cb87-593" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-594"><a href="#cb87-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-595"><a href="#cb87-595" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-596"><a href="#cb87-596" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-597"><a href="#cb87-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-598"><a href="#cb87-598" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-599"><a href="#cb87-599" aria-hidden="true" tabindex="-1"></a>Ici, on voit que les joueurs se répartissent de manière plûtot uniforme sur le plan ce qui témoignent de la présence d'une grande variété de type de joueurs.</span>
<span id="cb87-600"><a href="#cb87-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-601"><a href="#cb87-601" aria-hidden="true" tabindex="-1"></a>Et on ne voit pas de regroupement se faire en fonction de nos différentes variables qualitatives.</span>
<span id="cb87-602"><a href="#cb87-602" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-603"><a href="#cb87-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-604"><a href="#cb87-604" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb87-605"><a href="#cb87-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-606"><a href="#cb87-606" aria-hidden="true" tabindex="-1"></a>Le cercle des variables est une représentation graphique qui permet d’analyser les relations entre les variables initiales et les composantes principales qui forment nos axes. Il est basé sur les corrélations entre les variables et les axes principaux.</span>
<span id="cb87-607"><a href="#cb87-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-608"><a href="#cb87-608" aria-hidden="true" tabindex="-1"></a>Ainsi, plus une variable est proche du bord du cercle, plus elle est bien représentée sur le plan factoriel et contribue fortement à la formation des axes. Ici, on utilise le cos2 pour le gradient de couleur qui va aider à l'indentifictation de ces différentes qualitées de représentation.</span>
<span id="cb87-609"><a href="#cb87-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-610"><a href="#cb87-610" aria-hidden="true" tabindex="-1"></a>De plus, selon l'angle entre deux varibles, on peut faire des suppositions sur leur corrélation :</span>
<span id="cb87-611"><a href="#cb87-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-612"><a href="#cb87-612" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Si deux variables ont des vecteurs proches (petit angle), elles sont fortement corrélées positivement</span>
<span id="cb87-613"><a href="#cb87-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-614"><a href="#cb87-614" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Si deux variables ont des vecteurs opposés (angle proche de 180°), elles sont corrélées négativement</span>
<span id="cb87-615"><a href="#cb87-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-616"><a href="#cb87-616" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Si l’angle est proche de 90°, alors les variables ne sont pas corrélées</span>
<span id="cb87-617"><a href="#cb87-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-618"><a href="#cb87-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb87-619"><a href="#cb87-619" aria-hidden="true" tabindex="-1"></a><span class="in">factoextra::fviz_pca_var(</span></span>
<span id="cb87-620"><a href="#cb87-620" aria-hidden="true" tabindex="-1"></a><span class="in">  res_pca,</span></span>
<span id="cb87-621"><a href="#cb87-621" aria-hidden="true" tabindex="-1"></a><span class="in">  col.var = "cos2",</span></span>
<span id="cb87-622"><a href="#cb87-622" aria-hidden="true" tabindex="-1"></a><span class="in">  gradient.cols = rainbow(n = 8, start = .6, end = .9),</span></span>
<span id="cb87-623"><a href="#cb87-623" aria-hidden="true" tabindex="-1"></a><span class="in">  repel = TRUE</span></span>
<span id="cb87-624"><a href="#cb87-624" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb87-625"><a href="#cb87-625" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-626"><a href="#cb87-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-627"><a href="#cb87-627" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-628"><a href="#cb87-628" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-629"><a href="#cb87-629" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-630"><a href="#cb87-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-631"><a href="#cb87-631" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-632"><a href="#cb87-632" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-633"><a href="#cb87-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-634"><a href="#cb87-634" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-635"><a href="#cb87-635" aria-hidden="true" tabindex="-1"></a>Dans notre cas, ce que l'on peut voir c'est que la majorité de nos variables sont bien représentées par nos deux axes (cumulant plus de 70% d'explication). Mais beaucoup semblent aussi fortement corrélées avec la formation de deux groupes et la variable *Salary* se trouvant au milieu. Cette corrélation entre nos variables quantitatives ayant déjà pu être observé précédemment.\</span>
<span id="cb87-636"><a href="#cb87-636" aria-hidden="true" tabindex="-1"></a>Pour aller un peu plus loin dans la compréhension de ce phénomène, on peut remarquer que les deux groupes correspondent en fait aux variables qui sont des statistiques de joueurs pour la saison de 1986 (*Hits*, *AtBat*, *Runs*, *RBI*, ...) et des statistiques de joueurs sur toute leur carrière (*Cwalks*, *CAtBat*, *CHmRun*, *CRBI*, ...). Ainsi cela explique la présence de fortes corrélations corrélation.</span>
<span id="cb87-637"><a href="#cb87-637" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-638"><a href="#cb87-638" aria-hidden="true" tabindex="-1"></a>:::::::::::::</span>
<span id="cb87-639"><a href="#cb87-639" aria-hidden="true" tabindex="-1"></a>::::::::::::::::::::::::::::</span>
<span id="cb87-640"><a href="#cb87-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-641"><a href="#cb87-641" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyse inférentielle</span></span>
<span id="cb87-642"><a href="#cb87-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-643"><a href="#cb87-643" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modèle brut</span></span>
<span id="cb87-644"><a href="#cb87-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-645"><a href="#cb87-645" aria-hidden="true" tabindex="-1"></a>On désire modéliser le salaire *Salary* en fonction des variables disponibles.</span>
<span id="cb87-646"><a href="#cb87-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-647"><a href="#cb87-647" aria-hidden="true" tabindex="-1"></a>On va donc ajuster un modèle de régression linéaire en utilisant toutes les variables à disposition et analyser la qualité de cet ajustement.</span>
<span id="cb87-648"><a href="#cb87-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-651"><a href="#cb87-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-652"><a href="#cb87-652" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb87-653"><a href="#cb87-653" aria-hidden="true" tabindex="-1"></a>           Hitters_Without_NA) </span>
<span id="cb87-654"><a href="#cb87-654" aria-hidden="true" tabindex="-1"></a>mod1 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb87-655"><a href="#cb87-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-656"><a href="#cb87-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-657"><a href="#cb87-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-658"><a href="#cb87-658" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb87-659"><a href="#cb87-659" aria-hidden="true" tabindex="-1"></a>Nous sommes sur un modèle comprenant des variables quantitatives et qualitative ce qui le rapproche d'une modélisation <span class="co">[</span><span class="ot">**ANOVA**</span><span class="co">](https://en.wikipedia.org/wiki/Analysis_of_variance)</span>.</span>
<span id="cb87-660"><a href="#cb87-660" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-661"><a href="#cb87-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-662"><a href="#cb87-662" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-663"><a href="#cb87-663" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-664"><a href="#cb87-664" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-665"><a href="#cb87-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-666"><a href="#cb87-666" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-667"><a href="#cb87-667" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-668"><a href="#cb87-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-669"><a href="#cb87-669" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-670"><a href="#cb87-670" aria-hidden="true" tabindex="-1"></a>Ce qu'on peut remarquer en premier sur ce modèle c'est que beaucoup de variables ont un effet non significatif.</span>
<span id="cb87-671"><a href="#cb87-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-672"><a href="#cb87-672" aria-hidden="true" tabindex="-1"></a>Aussi, ce modèle offre des valeurs de $R^2$ et $R^2_{adjusted}$ autour de 0.5 ce qui témoigne d'une mauvaise qualité d'ajustement du modèle.</span>
<span id="cb87-673"><a href="#cb87-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-674"><a href="#cb87-674" aria-hidden="true" tabindex="-1"></a>Et enfin, l'écart type résiduel est de 315.6 ce qui est assez important et témoigne d'un modèle peu précis.</span>
<span id="cb87-675"><a href="#cb87-675" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-676"><a href="#cb87-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-677"><a href="#cb87-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-678"><a href="#cb87-678" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb87-679"><a href="#cb87-679" aria-hidden="true" tabindex="-1"></a>Le coefficient de détermination linéaire, noté $R^2$, est une mesure de la qualité de la prédiction d'une régression linéaire.\</span>
<span id="cb87-680"><a href="#cb87-680" aria-hidden="true" tabindex="-1"></a>Une formulation simple serait : </span>
<span id="cb87-681"><a href="#cb87-681" aria-hidden="true" tabindex="-1"></a>$$R^2 = 1 - \frac{\sum_{i=1}^n(y_i - \hat{y}_i)^2}{\sum_{i=1}^n(y_i - \bar{y}_i)^2}$$</span>
<span id="cb87-682"><a href="#cb87-682" aria-hidden="true" tabindex="-1"></a>où $n$ est le nombre de mesures, $y_i$ la valeur de la ième mesure , $\hat{y}_i$ la valeur prédite correspondante et $\bar{y}_i$ la moyenne des mesures. </span>
<span id="cb87-683"><a href="#cb87-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-684"><a href="#cb87-684" aria-hidden="true" tabindex="-1"></a>Ainsi, si le coefficient est proche de 1, cela veut dire que notre prediction est proche de la réalité. Tandis qu'un modèle "de base" prédirait toujours une valeur de $y_i$ proche de la moyenne $\bar{y}_i$ ce qui nous donnerait un $R^2$ proche de 0.\</span>
<span id="cb87-685"><a href="#cb87-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-686"><a href="#cb87-686" aria-hidden="true" tabindex="-1"></a>Le $R^2_{adjusted}$ permet quant à lui de rendre compte du phénomène d'augmentation automatique du $R^2$ lorsque des variables explicatives supplémentaires sont ajoutées au modèle. Il est donc très utile à regarder dans les cas de grande dimension.</span>
<span id="cb87-687"><a href="#cb87-687" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-688"><a href="#cb87-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-689"><a href="#cb87-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-690"><a href="#cb87-690" aria-hidden="true" tabindex="-1"></a>Pour tenter de trouver un meilleur ajustment, il est important d'analyser d'avantage le lien entre toutes les variables explicatives. On utilise alors communément le *VIF* (*variance inflation factor*).</span>
<span id="cb87-691"><a href="#cb87-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-692"><a href="#cb87-692" aria-hidden="true" tabindex="-1"></a>On obtient alors pour chacune de nos variable une valeur qui, plus elle est élevée, témoigne de la multicolinéarité entre nos variables explicatives.</span>
<span id="cb87-693"><a href="#cb87-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-694"><a href="#cb87-694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=12, fig.width=20}</span></span>
<span id="cb87-695"><a href="#cb87-695" aria-hidden="true" tabindex="-1"></a><span class="in">vif(mod1) </span></span>
<span id="cb87-696"><a href="#cb87-696" aria-hidden="true" tabindex="-1"></a><span class="in">my_VIFplot(vif(mod1))</span></span>
<span id="cb87-697"><a href="#cb87-697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-698"><a href="#cb87-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-699"><a href="#cb87-699" aria-hidden="true" tabindex="-1"></a>On remarque ainsi que beaucoup de valeurs sont supérieurs à 10 ce qui s'interprète communément comme la précence d'une forte colinéarité sur nos variables explicatives.</span>
<span id="cb87-700"><a href="#cb87-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-701"><a href="#cb87-701" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb87-702"><a href="#cb87-702" aria-hidden="true" tabindex="-1"></a>Cette colinéarité se constatait déjà durant les analyses descriptives via les graphes de corrélations (d'où l'importance de ne pas se lancer trop rapidement dans les analyses inférentielles).</span>
<span id="cb87-703"><a href="#cb87-703" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-704"><a href="#cb87-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-705"><a href="#cb87-705" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modèles parcimonieux</span></span>
<span id="cb87-706"><a href="#cb87-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-707"><a href="#cb87-707" aria-hidden="true" tabindex="-1"></a>Maintenant, on va donc tenter de trouver le meilleur sous-modèle possible. Pour cela on va suivre la procédure suivante :</span>
<span id="cb87-708"><a href="#cb87-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-709"><a href="#cb87-709" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>mettre en oeuvre une méthode de sélection automatique exhaustive et observer l’évolution des SCR (Sommes de Carrés Résiduels) pour les modèles retenus en fonction de leur taille.</span>
<span id="cb87-710"><a href="#cb87-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-711"><a href="#cb87-711" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>déduire de ces SCR le $R^2$, $R^2_{adjusted}$, *AIC*, *BIC* et $C_p$ correspondants. Les comparer avec les valeurs fournies dans le *`summary`* de *`regsubsets`* et tracer leur évolution en fonction de la taille du modèle.</span>
<span id="cb87-712"><a href="#cb87-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-713"><a href="#cb87-713" aria-hidden="true" tabindex="-1"></a>Puis reproduire la même procédure avec des séléctions *backward*, *forward* et *stepwise*</span>
<span id="cb87-714"><a href="#cb87-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-715"><a href="#cb87-715" aria-hidden="true" tabindex="-1"></a>Tout d'abord, on va définir un nouveau modèle simple ne comprenant que l'*intercept*.</span>
<span id="cb87-716"><a href="#cb87-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-719"><a href="#cb87-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-720"><a href="#cb87-720" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Salary<span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb87-721"><a href="#cb87-721" aria-hidden="true" tabindex="-1"></a>           Hitters_Without_NA)</span>
<span id="cb87-722"><a href="#cb87-722" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod0)<span class="sc">$</span>call</span>
<span id="cb87-723"><a href="#cb87-723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-724"><a href="#cb87-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-725"><a href="#cb87-725" aria-hidden="true" tabindex="-1"></a>Le principe de ces méthodes de régression avec sélection de variables est de tester et comparer les différents modèles possibles avec nos variables en allant du modèle le plus simple $y \sim 1$ jusqu'au modèle le plus complet $y \sim .$ ou l'inverse. Puis à chaque étape de rajout ou de suppression d'une variable dans le modèles, on sélectionne le meilleur modèle via le critère de notre choix.</span>
<span id="cb87-726"><a href="#cb87-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-727"><a href="#cb87-727" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb87-728"><a href="#cb87-728" aria-hidden="true" tabindex="-1"></a>Un rappel sur nos critère se trouve dans la partie **Setup**, onglet **Fonction**, de ce document avec la création de fonction pour les calculer.</span>
<span id="cb87-729"><a href="#cb87-729" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-730"><a href="#cb87-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-731"><a href="#cb87-731" aria-hidden="true" tabindex="-1"></a>::::::::::::::::::::::::::::::::::::::::::::::: panel-tabset</span>
<span id="cb87-732"><a href="#cb87-732" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exhaustive</span></span>
<span id="cb87-733"><a href="#cb87-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-734"><a href="#cb87-734" aria-hidden="true" tabindex="-1"></a>:::::::::: panel-tabset</span>
<span id="cb87-735"><a href="#cb87-735" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modèle</span></span>
<span id="cb87-736"><a href="#cb87-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-739"><a href="#cb87-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-740"><a href="#cb87-740" aria-hidden="true" tabindex="-1"></a>selec_auto <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb87-741"><a href="#cb87-741" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb87-742"><a href="#cb87-742" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"exhaustive"</span>,</span>
<span id="cb87-743"><a href="#cb87-743" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span> <span class="co"># maximum size of subsets to examine</span></span>
<span id="cb87-744"><a href="#cb87-744" aria-hidden="true" tabindex="-1"></a>                         )</span>
<span id="cb87-745"><a href="#cb87-745" aria-hidden="true" tabindex="-1"></a><span class="co"># selec_auto %&gt;% summary()</span></span>
<span id="cb87-746"><a href="#cb87-746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-747"><a href="#cb87-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-748"><a href="#cb87-748" aria-hidden="true" tabindex="-1"></a>On va déjà commencer par regarder la valeur du critère en fonction des variables des différents modèles testés.</span>
<span id="cb87-749"><a href="#cb87-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-750"><a href="#cb87-750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=12}</span></span>
<span id="cb87-751"><a href="#cb87-751" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow=c(2,2))</span></span>
<span id="cb87-752"><a href="#cb87-752" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_auto, scale = 'bic') </span></span>
<span id="cb87-753"><a href="#cb87-753" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_auto, scale = 'Cp') </span></span>
<span id="cb87-754"><a href="#cb87-754" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_auto, scale = 'r2') </span></span>
<span id="cb87-755"><a href="#cb87-755" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_auto, scale = 'adjr2') </span></span>
<span id="cb87-756"><a href="#cb87-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-757"><a href="#cb87-757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-758"><a href="#cb87-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-759"><a href="#cb87-759" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-760"><a href="#cb87-760" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-761"><a href="#cb87-761" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-762"><a href="#cb87-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-763"><a href="#cb87-763" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-764"><a href="#cb87-764" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-765"><a href="#cb87-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-766"><a href="#cb87-766" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-767"><a href="#cb87-767" aria-hidden="true" tabindex="-1"></a>Ici on remarque clairement que toutes nos variables ne sont pas gardés lorsque l'on cherche à optimiser nos critères.</span>
<span id="cb87-768"><a href="#cb87-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-769"><a href="#cb87-769" aria-hidden="true" tabindex="-1"></a>Aussi, on peut voir encore de faibles valeurs pour les $R^2$ et $R^2_{adjusted}$ pouvant témoigner d'un mauvais ajustement de modèle.</span>
<span id="cb87-770"><a href="#cb87-770" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-771"><a href="#cb87-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-772"><a href="#cb87-772" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb87-773"><a href="#cb87-773" aria-hidden="true" tabindex="-1"></a>*`plot.regsubsets`* de *`{leaps}`* ne prend pas directement "aic" comme option de scale. Pour une sélection basée sur AIC, une approche alternative consiste à utiliser la fonction *`stepAIC`* du package *`{MASS}`*, qui permet une sélection pas à pas basée sur AIC.</span>
<span id="cb87-774"><a href="#cb87-774" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-775"><a href="#cb87-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-776"><a href="#cb87-776" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Evolution des critères</span></span>
<span id="cb87-777"><a href="#cb87-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-778"><a href="#cb87-778" aria-hidden="true" tabindex="-1"></a>Regardons un peut l'évolution de la Somme des Carrés Résiduels (SCR).</span>
<span id="cb87-779"><a href="#cb87-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-780"><a href="#cb87-780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=12, fig.width=16}</span></span>
<span id="cb87-781"><a href="#cb87-781" aria-hidden="true" tabindex="-1"></a><span class="in">SCR &lt;- summary(selec_auto)$rss</span></span>
<span id="cb87-782"><a href="#cb87-782" aria-hidden="true" tabindex="-1"></a><span class="in">Criteria_plot(SCR, crit_name = "Somme des Carrés Résiduels")</span></span>
<span id="cb87-783"><a href="#cb87-783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-784"><a href="#cb87-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-785"><a href="#cb87-785" aria-hidden="true" tabindex="-1"></a>Maintenant regardons les autres critères mentionnés précédemment.</span>
<span id="cb87-786"><a href="#cb87-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-787"><a href="#cb87-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=18, fig.width=30}</span></span>
<span id="cb87-788"><a href="#cb87-788" aria-hidden="true" tabindex="-1"></a><span class="in">r2 &lt;- r2_fun(Hitters_Without_NA$Salary, SCR)</span></span>
<span id="cb87-789"><a href="#cb87-789" aria-hidden="true" tabindex="-1"></a><span class="in">r2a &lt;- r2a_fun(Hitters_Without_NA$Salary, SCR)</span></span>
<span id="cb87-790"><a href="#cb87-790" aria-hidden="true" tabindex="-1"></a><span class="in">cp &lt;- cp_fun(mod1, SCR)</span></span>
<span id="cb87-791"><a href="#cb87-791" aria-hidden="true" tabindex="-1"></a><span class="in">aic &lt;- aic_fun(SCR)</span></span>
<span id="cb87-792"><a href="#cb87-792" aria-hidden="true" tabindex="-1"></a><span class="in">bic &lt;- bic_fun(SCR)</span></span>
<span id="cb87-793"><a href="#cb87-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-794"><a href="#cb87-794" aria-hidden="true" tabindex="-1"></a><span class="in">grid.arrange(Criteria_plot(r2, crit_name = "R2"),</span></span>
<span id="cb87-795"><a href="#cb87-795" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(r2a, crit_name = "R2 ajusté"),</span></span>
<span id="cb87-796"><a href="#cb87-796" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(cp, crit_name = "Cp"),</span></span>
<span id="cb87-797"><a href="#cb87-797" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(aic, crit_name = "AIC"),</span></span>
<span id="cb87-798"><a href="#cb87-798" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(bic, crit_name = "BIC"),</span></span>
<span id="cb87-799"><a href="#cb87-799" aria-hidden="true" tabindex="-1"></a><span class="in">             ncol = 3)</span></span>
<span id="cb87-800"><a href="#cb87-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-801"><a href="#cb87-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-802"><a href="#cb87-802" aria-hidden="true" tabindex="-1"></a>On peut ainsi voir que ce sont plutôt des modèles entre 5 et 10 variables qui optimisent nos critères (donc pas un modèle avec toutes nos variables).</span>
<span id="cb87-803"><a href="#cb87-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-804"><a href="#cb87-804" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Meilleur modèle</span></span>
<span id="cb87-805"><a href="#cb87-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-806"><a href="#cb87-806" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-807"><a href="#cb87-807" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-808"><a href="#cb87-808" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-809"><a href="#cb87-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-810"><a href="#cb87-810" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-811"><a href="#cb87-811" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-812"><a href="#cb87-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-813"><a href="#cb87-813" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-814"><a href="#cb87-814" aria-hidden="true" tabindex="-1"></a>Regardons donc pour chaque critère quel est le modèle qui ressort comme le meilleur</span>
<span id="cb87-815"><a href="#cb87-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-818"><a href="#cb87-818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-819"><a href="#cb87-819" aria-hidden="true" tabindex="-1"></a>criteria_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(r2, r2a, cp, aic, bic)</span>
<span id="cb87-820"><a href="#cb87-820" aria-hidden="true" tabindex="-1"></a><span class="fu">Best_model</span>(selec_auto, criteria_df)</span>
<span id="cb87-821"><a href="#cb87-821" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-822"><a href="#cb87-822" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-823"><a href="#cb87-823" aria-hidden="true" tabindex="-1"></a>::::::::::</span>
<span id="cb87-824"><a href="#cb87-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-825"><a href="#cb87-825" aria-hidden="true" tabindex="-1"></a><span class="fu">### Backward</span></span>
<span id="cb87-826"><a href="#cb87-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-827"><a href="#cb87-827" aria-hidden="true" tabindex="-1"></a>Cette fois ci on va regarder en sélection backward. D'abord, on fait à nouveau avec la fonction *`regsubset`*.</span>
<span id="cb87-828"><a href="#cb87-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-829"><a href="#cb87-829" aria-hidden="true" tabindex="-1"></a>::::::::: panel-tabset</span>
<span id="cb87-830"><a href="#cb87-830" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modèle</span></span>
<span id="cb87-831"><a href="#cb87-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-834"><a href="#cb87-834" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-835"><a href="#cb87-835" aria-hidden="true" tabindex="-1"></a>selec_back <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb87-836"><a href="#cb87-836" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb87-837"><a href="#cb87-837" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"backward"</span>,</span>
<span id="cb87-838"><a href="#cb87-838" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span>)</span>
<span id="cb87-839"><a href="#cb87-839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-840"><a href="#cb87-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-841"><a href="#cb87-841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=12}</span></span>
<span id="cb87-842"><a href="#cb87-842" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow=c(2,2))</span></span>
<span id="cb87-843"><a href="#cb87-843" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_back, scale = 'bic') </span></span>
<span id="cb87-844"><a href="#cb87-844" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_back, scale = 'Cp') </span></span>
<span id="cb87-845"><a href="#cb87-845" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_back, scale = 'r2') </span></span>
<span id="cb87-846"><a href="#cb87-846" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_back, scale = 'adjr2') </span></span>
<span id="cb87-847"><a href="#cb87-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-848"><a href="#cb87-848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-849"><a href="#cb87-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-850"><a href="#cb87-850" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-851"><a href="#cb87-851" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-852"><a href="#cb87-852" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-853"><a href="#cb87-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-854"><a href="#cb87-854" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-855"><a href="#cb87-855" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-856"><a href="#cb87-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-857"><a href="#cb87-857" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-858"><a href="#cb87-858" aria-hidden="true" tabindex="-1"></a>On remarque à nouveau une importante sélection de variables.</span>
<span id="cb87-859"><a href="#cb87-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-860"><a href="#cb87-860" aria-hidden="true" tabindex="-1"></a>Mais ici aussi on a encore de faibles valeurs pour les $R^2$ et $R^2_{adjusted}$ pouvant témoigner d'un mauvais ajustement de modèle.</span>
<span id="cb87-861"><a href="#cb87-861" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-862"><a href="#cb87-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-863"><a href="#cb87-863" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Evolution des critères</span></span>
<span id="cb87-864"><a href="#cb87-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-865"><a href="#cb87-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=18, fig.width=30}</span></span>
<span id="cb87-866"><a href="#cb87-866" aria-hidden="true" tabindex="-1"></a><span class="in">SCR &lt;- summary(selec_back)$rss</span></span>
<span id="cb87-867"><a href="#cb87-867" aria-hidden="true" tabindex="-1"></a><span class="in">r2 &lt;- r2_fun(Hitters_Without_NA$Salary, SCR)</span></span>
<span id="cb87-868"><a href="#cb87-868" aria-hidden="true" tabindex="-1"></a><span class="in">r2a &lt;- r2a_fun(Hitters_Without_NA$Salary, SCR)</span></span>
<span id="cb87-869"><a href="#cb87-869" aria-hidden="true" tabindex="-1"></a><span class="in">cp &lt;- cp_fun(mod1, SCR)</span></span>
<span id="cb87-870"><a href="#cb87-870" aria-hidden="true" tabindex="-1"></a><span class="in">aic &lt;- aic_fun(SCR)</span></span>
<span id="cb87-871"><a href="#cb87-871" aria-hidden="true" tabindex="-1"></a><span class="in">bic &lt;- bic_fun(SCR)</span></span>
<span id="cb87-872"><a href="#cb87-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-873"><a href="#cb87-873" aria-hidden="true" tabindex="-1"></a><span class="in">grid.arrange(Criteria_plot(r2, crit_name = "R2"),</span></span>
<span id="cb87-874"><a href="#cb87-874" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(r2a, crit_name = "R2 ajusté"),</span></span>
<span id="cb87-875"><a href="#cb87-875" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(cp, crit_name = "Cp"),</span></span>
<span id="cb87-876"><a href="#cb87-876" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(SCR, crit_name = "Somme des Carrés Résiduels"),</span></span>
<span id="cb87-877"><a href="#cb87-877" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(aic, crit_name = "AIC"),</span></span>
<span id="cb87-878"><a href="#cb87-878" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(bic, crit_name = "BIC"),</span></span>
<span id="cb87-879"><a href="#cb87-879" aria-hidden="true" tabindex="-1"></a><span class="in">             ncol = 3)</span></span>
<span id="cb87-880"><a href="#cb87-880" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-881"><a href="#cb87-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-882"><a href="#cb87-882" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Meilleur modèle</span></span>
<span id="cb87-883"><a href="#cb87-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-884"><a href="#cb87-884" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-885"><a href="#cb87-885" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-886"><a href="#cb87-886" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-887"><a href="#cb87-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-888"><a href="#cb87-888" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-889"><a href="#cb87-889" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-890"><a href="#cb87-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-891"><a href="#cb87-891" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-892"><a href="#cb87-892" aria-hidden="true" tabindex="-1"></a>Regardons donc pour chaque critère quel est le modèle qui ressort comme le meilleur</span>
<span id="cb87-893"><a href="#cb87-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-896"><a href="#cb87-896" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-897"><a href="#cb87-897" aria-hidden="true" tabindex="-1"></a>criteria_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(r2, r2a, cp, aic, bic)</span>
<span id="cb87-898"><a href="#cb87-898" aria-hidden="true" tabindex="-1"></a><span class="fu">Best_model</span>(selec_back, criteria_df)</span>
<span id="cb87-899"><a href="#cb87-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-900"><a href="#cb87-900" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-901"><a href="#cb87-901" aria-hidden="true" tabindex="-1"></a>:::::::::</span>
<span id="cb87-902"><a href="#cb87-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-903"><a href="#cb87-903" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Utilisation de la fonction step**</span></span>
<span id="cb87-904"><a href="#cb87-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-905"><a href="#cb87-905" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb87-906"><a href="#cb87-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-907"><a href="#cb87-907" aria-hidden="true" tabindex="-1"></a>On peut également utiliser la fonction *`step`* de la library *`{stats}`*. Pour cela, on part du plus gros modèle défini précédemment par *mod1.*</span>
<span id="cb87-908"><a href="#cb87-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-909"><a href="#cb87-909" aria-hidden="true" tabindex="-1"></a>La fonction *`step`* nous propose quel critère nous voulons utiliser pour la sélection entre le *BIC*, *AIC* et $C_p$.</span>
<span id="cb87-910"><a href="#cb87-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-911"><a href="#cb87-911" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb87-912"><a href="#cb87-912" aria-hidden="true" tabindex="-1"></a><span class="fu">#### BIC</span></span>
<span id="cb87-913"><a href="#cb87-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-916"><a href="#cb87-916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-917"><a href="#cb87-917" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Hitters_Without_NA)</span>
<span id="cb87-918"><a href="#cb87-918" aria-hidden="true" tabindex="-1"></a>modselect_back_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb87-919"><a href="#cb87-919" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb87-920"><a href="#cb87-920" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="co"># trace = TRUE permet de voir le détail des étapes</span></span>
<span id="cb87-921"><a href="#cb87-921" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb87-922"><a href="#cb87-922" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="fu">log</span>(n) <span class="co"># BIC selection</span></span>
<span id="cb87-923"><a href="#cb87-923" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb87-924"><a href="#cb87-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-925"><a href="#cb87-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-926"><a href="#cb87-926" aria-hidden="true" tabindex="-1"></a>Puis on peut regarder le modèle qui optimise le critère utilisé pour la selection.</span>
<span id="cb87-927"><a href="#cb87-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-930"><a href="#cb87-930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-931"><a href="#cb87-931" aria-hidden="true" tabindex="-1"></a>modselect_back_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb87-932"><a href="#cb87-932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-933"><a href="#cb87-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-934"><a href="#cb87-934" aria-hidden="true" tabindex="-1"></a>La fonction step propose aussi une selection avec AIC et Cp.</span>
<span id="cb87-935"><a href="#cb87-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-936"><a href="#cb87-936" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AIC</span></span>
<span id="cb87-937"><a href="#cb87-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-940"><a href="#cb87-940" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-941"><a href="#cb87-941" aria-hidden="true" tabindex="-1"></a>modselect_back_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb87-942"><a href="#cb87-942" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb87-943"><a href="#cb87-943" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb87-944"><a href="#cb87-944" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb87-945"><a href="#cb87-945" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">2</span> <span class="co"># AIC selection</span></span>
<span id="cb87-946"><a href="#cb87-946" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb87-947"><a href="#cb87-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-948"><a href="#cb87-948" aria-hidden="true" tabindex="-1"></a>modselect_back_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb87-949"><a href="#cb87-949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-950"><a href="#cb87-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-951"><a href="#cb87-951" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $C_p$</span></span>
<span id="cb87-952"><a href="#cb87-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-955"><a href="#cb87-955" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-956"><a href="#cb87-956" aria-hidden="true" tabindex="-1"></a>modselect_back_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb87-957"><a href="#cb87-957" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb87-958"><a href="#cb87-958" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb87-959"><a href="#cb87-959" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb87-960"><a href="#cb87-960" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">1</span> <span class="co"># Cp selection</span></span>
<span id="cb87-961"><a href="#cb87-961" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb87-962"><a href="#cb87-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-963"><a href="#cb87-963" aria-hidden="true" tabindex="-1"></a>modselect_back_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb87-964"><a href="#cb87-964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-965"><a href="#cb87-965" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-966"><a href="#cb87-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-967"><a href="#cb87-967" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-968"><a href="#cb87-968" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-969"><a href="#cb87-969" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-970"><a href="#cb87-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-971"><a href="#cb87-971" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-972"><a href="#cb87-972" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-973"><a href="#cb87-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-974"><a href="#cb87-974" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-975"><a href="#cb87-975" aria-hidden="true" tabindex="-1"></a>Avec la fonction *`step`* nous avons le modèle utilisant le critère *BIC* qui nous permet d'avoir toutes nos variables significatives (sauf l'*intercept* ce qui pourrait nous donner envie de faire des modèles sans).</span>
<span id="cb87-976"><a href="#cb87-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-977"><a href="#cb87-977" aria-hidden="true" tabindex="-1"></a>Par contre, nos valeurs de $R^2$ et $R^2_{adjusted}$ sont encore assez faible pour considérer ces modèles comme étant de très bonne qualité.</span>
<span id="cb87-978"><a href="#cb87-978" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-979"><a href="#cb87-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-980"><a href="#cb87-980" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb87-981"><a href="#cb87-981" aria-hidden="true" tabindex="-1"></a>Aussi, si on veut comparer le modèle initial et le modèle final, on peut utiliser la fonction *`anova`*. Cela permet de voir si la sélection de variables a significativement amélioré l'ajustement.</span>
<span id="cb87-982"><a href="#cb87-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-985"><a href="#cb87-985" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-986"><a href="#cb87-986" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod0, modselect_back_bic, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb87-987"><a href="#cb87-987" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-988"><a href="#cb87-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-989"><a href="#cb87-989" aria-hidden="true" tabindex="-1"></a>De manière logique on voit donc tout de même que le modèle avec nos variable explicatives sélectionnées (ici celui avec selection via le critère *BIC*) propose un meilleur ajustement que celui sans variable.</span>
<span id="cb87-990"><a href="#cb87-990" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-991"><a href="#cb87-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-992"><a href="#cb87-992" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forward</span></span>
<span id="cb87-993"><a href="#cb87-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-994"><a href="#cb87-994" aria-hidden="true" tabindex="-1"></a>Cette fois ci on va regarder en sélection *forward*. D'abord, on fait à nouveau avec la fonction *`regsubset`*.</span>
<span id="cb87-995"><a href="#cb87-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-996"><a href="#cb87-996" aria-hidden="true" tabindex="-1"></a>::::::::: panel-tabset</span>
<span id="cb87-997"><a href="#cb87-997" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modèle</span></span>
<span id="cb87-998"><a href="#cb87-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1001"><a href="#cb87-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1002"><a href="#cb87-1002" aria-hidden="true" tabindex="-1"></a>selec_forw <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb87-1003"><a href="#cb87-1003" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb87-1004"><a href="#cb87-1004" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"forward"</span>,</span>
<span id="cb87-1005"><a href="#cb87-1005" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span>)</span>
<span id="cb87-1006"><a href="#cb87-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1007"><a href="#cb87-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1008"><a href="#cb87-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=12}</span></span>
<span id="cb87-1009"><a href="#cb87-1009" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow=c(2,2))</span></span>
<span id="cb87-1010"><a href="#cb87-1010" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_forw, scale = 'bic') </span></span>
<span id="cb87-1011"><a href="#cb87-1011" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_forw, scale = 'Cp') </span></span>
<span id="cb87-1012"><a href="#cb87-1012" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_forw, scale = 'r2') </span></span>
<span id="cb87-1013"><a href="#cb87-1013" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_forw, scale = 'adjr2') </span></span>
<span id="cb87-1014"><a href="#cb87-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1015"><a href="#cb87-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1016"><a href="#cb87-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1017"><a href="#cb87-1017" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-1018"><a href="#cb87-1018" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-1019"><a href="#cb87-1019" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1020"><a href="#cb87-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1021"><a href="#cb87-1021" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-1022"><a href="#cb87-1022" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-1023"><a href="#cb87-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1024"><a href="#cb87-1024" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-1025"><a href="#cb87-1025" aria-hidden="true" tabindex="-1"></a>On remarque à nouveau une importante sélection de variables.</span>
<span id="cb87-1026"><a href="#cb87-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1027"><a href="#cb87-1027" aria-hidden="true" tabindex="-1"></a>Mais ici aussi on a encore de faibles valeurs pour les $R^2$ et $R^2_{adjusted}$ pouvant témoigner d'un mauvais ajustement de modèle.</span>
<span id="cb87-1028"><a href="#cb87-1028" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1029"><a href="#cb87-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1030"><a href="#cb87-1030" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Evolution des critères</span></span>
<span id="cb87-1031"><a href="#cb87-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1032"><a href="#cb87-1032" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=18, fig.width=30}</span></span>
<span id="cb87-1033"><a href="#cb87-1033" aria-hidden="true" tabindex="-1"></a><span class="in">SCR &lt;- summary(selec_forw)$rss</span></span>
<span id="cb87-1034"><a href="#cb87-1034" aria-hidden="true" tabindex="-1"></a><span class="in">r2 &lt;- r2_fun(Hitters_Without_NA$Salary, SCR)</span></span>
<span id="cb87-1035"><a href="#cb87-1035" aria-hidden="true" tabindex="-1"></a><span class="in">r2a &lt;- r2a_fun(Hitters_Without_NA$Salary, SCR)</span></span>
<span id="cb87-1036"><a href="#cb87-1036" aria-hidden="true" tabindex="-1"></a><span class="in">cp &lt;- cp_fun(mod1, SCR)</span></span>
<span id="cb87-1037"><a href="#cb87-1037" aria-hidden="true" tabindex="-1"></a><span class="in">aic &lt;- aic_fun(SCR)</span></span>
<span id="cb87-1038"><a href="#cb87-1038" aria-hidden="true" tabindex="-1"></a><span class="in">bic &lt;- bic_fun(SCR)</span></span>
<span id="cb87-1039"><a href="#cb87-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1040"><a href="#cb87-1040" aria-hidden="true" tabindex="-1"></a><span class="in">grid.arrange(Criteria_plot(r2, crit_name = "R2"),</span></span>
<span id="cb87-1041"><a href="#cb87-1041" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(r2a, crit_name = "R2 ajusté"),</span></span>
<span id="cb87-1042"><a href="#cb87-1042" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(cp, crit_name = "Cp"),</span></span>
<span id="cb87-1043"><a href="#cb87-1043" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(SCR, crit_name = "Somme des Carrés Résiduels"),</span></span>
<span id="cb87-1044"><a href="#cb87-1044" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(aic, crit_name = "AIC"),</span></span>
<span id="cb87-1045"><a href="#cb87-1045" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(bic, crit_name = "BIC"),</span></span>
<span id="cb87-1046"><a href="#cb87-1046" aria-hidden="true" tabindex="-1"></a><span class="in">             ncol = 3)</span></span>
<span id="cb87-1047"><a href="#cb87-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1048"><a href="#cb87-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1049"><a href="#cb87-1049" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Meilleur modèle</span></span>
<span id="cb87-1050"><a href="#cb87-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1051"><a href="#cb87-1051" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-1052"><a href="#cb87-1052" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-1053"><a href="#cb87-1053" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1054"><a href="#cb87-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1055"><a href="#cb87-1055" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-1056"><a href="#cb87-1056" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-1057"><a href="#cb87-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1058"><a href="#cb87-1058" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-1059"><a href="#cb87-1059" aria-hidden="true" tabindex="-1"></a>Regardons donc pour chaque critère quel est le modèle qui ressort comme le meilleur</span>
<span id="cb87-1060"><a href="#cb87-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1063"><a href="#cb87-1063" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1064"><a href="#cb87-1064" aria-hidden="true" tabindex="-1"></a>criteria_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(r2, r2a, cp, aic, bic)</span>
<span id="cb87-1065"><a href="#cb87-1065" aria-hidden="true" tabindex="-1"></a><span class="fu">Best_model</span>(selec_forw, criteria_df)</span>
<span id="cb87-1066"><a href="#cb87-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1067"><a href="#cb87-1067" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1068"><a href="#cb87-1068" aria-hidden="true" tabindex="-1"></a>:::::::::</span>
<span id="cb87-1069"><a href="#cb87-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1070"><a href="#cb87-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Utilisation de la fonction step**</span></span>
<span id="cb87-1071"><a href="#cb87-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1072"><a href="#cb87-1072" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb87-1073"><a href="#cb87-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1074"><a href="#cb87-1074" aria-hidden="true" tabindex="-1"></a>On peut également utiliser la fonction *`step`* de la library *`{stats}`*. Cette fois ci il faut définir en modèle de départ le plus petit modèle (celui composé seulement de l'intercept).</span>
<span id="cb87-1075"><a href="#cb87-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1076"><a href="#cb87-1076" aria-hidden="true" tabindex="-1"></a>La fonction *`step`* nous propose quel critère nous voulons utiliser pour la sélection entre le *BIC*, *AIC* et $C_p$.</span>
<span id="cb87-1077"><a href="#cb87-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1078"><a href="#cb87-1078" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb87-1079"><a href="#cb87-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">#### BIC</span></span>
<span id="cb87-1080"><a href="#cb87-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1083"><a href="#cb87-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1084"><a href="#cb87-1084" aria-hidden="true" tabindex="-1"></a>modselect_forw_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb87-1085"><a href="#cb87-1085" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb87-1086"><a href="#cb87-1086" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="co"># trace = TRUE permet de voir le détail des étapes</span></span>
<span id="cb87-1087"><a href="#cb87-1087" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb87-1088"><a href="#cb87-1088" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="fu">log</span>(n) <span class="co"># BIC selection</span></span>
<span id="cb87-1089"><a href="#cb87-1089" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb87-1090"><a href="#cb87-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1091"><a href="#cb87-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1092"><a href="#cb87-1092" aria-hidden="true" tabindex="-1"></a>Puis on peut regarder le modèle qui optimise le critère utilisé pour la selection.</span>
<span id="cb87-1093"><a href="#cb87-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1096"><a href="#cb87-1096" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1097"><a href="#cb87-1097" aria-hidden="true" tabindex="-1"></a>modselect_forw_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb87-1098"><a href="#cb87-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1099"><a href="#cb87-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1100"><a href="#cb87-1100" aria-hidden="true" tabindex="-1"></a>La fonction step propose aussi une selection avec AIC et Cp.</span>
<span id="cb87-1101"><a href="#cb87-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1102"><a href="#cb87-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AIC</span></span>
<span id="cb87-1103"><a href="#cb87-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1106"><a href="#cb87-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1107"><a href="#cb87-1107" aria-hidden="true" tabindex="-1"></a>modselect_forw_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb87-1108"><a href="#cb87-1108" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb87-1109"><a href="#cb87-1109" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb87-1110"><a href="#cb87-1110" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb87-1111"><a href="#cb87-1111" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">2</span> <span class="co"># AIC selection</span></span>
<span id="cb87-1112"><a href="#cb87-1112" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb87-1113"><a href="#cb87-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1114"><a href="#cb87-1114" aria-hidden="true" tabindex="-1"></a>modselect_forw_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb87-1115"><a href="#cb87-1115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1116"><a href="#cb87-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1117"><a href="#cb87-1117" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $C_p$</span></span>
<span id="cb87-1118"><a href="#cb87-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1121"><a href="#cb87-1121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1122"><a href="#cb87-1122" aria-hidden="true" tabindex="-1"></a>modselect_forw_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb87-1123"><a href="#cb87-1123" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb87-1124"><a href="#cb87-1124" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb87-1125"><a href="#cb87-1125" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb87-1126"><a href="#cb87-1126" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">1</span> <span class="co"># Cp selection</span></span>
<span id="cb87-1127"><a href="#cb87-1127" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb87-1128"><a href="#cb87-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1129"><a href="#cb87-1129" aria-hidden="true" tabindex="-1"></a>modselect_forw_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb87-1130"><a href="#cb87-1130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1131"><a href="#cb87-1131" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1132"><a href="#cb87-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1133"><a href="#cb87-1133" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-1134"><a href="#cb87-1134" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-1135"><a href="#cb87-1135" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1136"><a href="#cb87-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1137"><a href="#cb87-1137" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-1138"><a href="#cb87-1138" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-1139"><a href="#cb87-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1140"><a href="#cb87-1140" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-1141"><a href="#cb87-1141" aria-hidden="true" tabindex="-1"></a>Avec la fonction *`step`* nous avons le modèle utilisant le critère *BIC* qui nous permet d'avoir toutes nos variables significatives (sauf l'*intercept* ce qui pourrait nous donner envie de faire des modèles sans).</span>
<span id="cb87-1142"><a href="#cb87-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1143"><a href="#cb87-1143" aria-hidden="true" tabindex="-1"></a>Par contre, nos valeurs de $R^2$ et $R^2_{adjusted}$ sont encore assez faible pour considérer ces modèles comme étant de très bonne qualité.</span>
<span id="cb87-1144"><a href="#cb87-1144" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1145"><a href="#cb87-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1146"><a href="#cb87-1146" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb87-1147"><a href="#cb87-1147" aria-hidden="true" tabindex="-1"></a>Aussi, si on veut comparer le modèle initial et le modèle final, on peut utiliser la fonction *`anova`*. Cela permet de voir si la sélection de variables a significativement amélioré l'ajustement.</span>
<span id="cb87-1148"><a href="#cb87-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1151"><a href="#cb87-1151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1152"><a href="#cb87-1152" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod0, modselect_forw_bic, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb87-1153"><a href="#cb87-1153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1154"><a href="#cb87-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1155"><a href="#cb87-1155" aria-hidden="true" tabindex="-1"></a>De manière logique on voit donc tout de même que le modèle avec nos variable explicatives sélectionnées (ici celui avec selection via le critère *BIC*) propose un meilleur ajustement que celui sans variable.</span>
<span id="cb87-1156"><a href="#cb87-1156" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1157"><a href="#cb87-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1158"><a href="#cb87-1158" aria-hidden="true" tabindex="-1"></a><span class="fu">### Both</span></span>
<span id="cb87-1159"><a href="#cb87-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1160"><a href="#cb87-1160" aria-hidden="true" tabindex="-1"></a>Maintenant on va regarder en sélection *both*. D'abord, on fait à nouveau avec la fonction *`regsubset`*.</span>
<span id="cb87-1161"><a href="#cb87-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1162"><a href="#cb87-1162" aria-hidden="true" tabindex="-1"></a>::::::::: panel-tabset</span>
<span id="cb87-1163"><a href="#cb87-1163" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modèle</span></span>
<span id="cb87-1164"><a href="#cb87-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1167"><a href="#cb87-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1168"><a href="#cb87-1168" aria-hidden="true" tabindex="-1"></a>selec_seq <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb87-1169"><a href="#cb87-1169" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb87-1170"><a href="#cb87-1170" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"seqrep"</span>,</span>
<span id="cb87-1171"><a href="#cb87-1171" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span>)</span>
<span id="cb87-1172"><a href="#cb87-1172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1173"><a href="#cb87-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1174"><a href="#cb87-1174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=12}</span></span>
<span id="cb87-1175"><a href="#cb87-1175" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow=c(2,2))</span></span>
<span id="cb87-1176"><a href="#cb87-1176" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_seq, scale = 'bic') </span></span>
<span id="cb87-1177"><a href="#cb87-1177" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_seq, scale = 'Cp') </span></span>
<span id="cb87-1178"><a href="#cb87-1178" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_seq, scale = 'r2') </span></span>
<span id="cb87-1179"><a href="#cb87-1179" aria-hidden="true" tabindex="-1"></a><span class="in">plot(selec_seq, scale = 'adjr2') </span></span>
<span id="cb87-1180"><a href="#cb87-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1181"><a href="#cb87-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1182"><a href="#cb87-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1183"><a href="#cb87-1183" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-1184"><a href="#cb87-1184" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-1185"><a href="#cb87-1185" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1186"><a href="#cb87-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1187"><a href="#cb87-1187" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-1188"><a href="#cb87-1188" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-1189"><a href="#cb87-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1190"><a href="#cb87-1190" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-1191"><a href="#cb87-1191" aria-hidden="true" tabindex="-1"></a>On remarque à nouveau une importante sélection de variables.</span>
<span id="cb87-1192"><a href="#cb87-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1193"><a href="#cb87-1193" aria-hidden="true" tabindex="-1"></a>Mais ici aussi on a encore de faibles valeurs pour les $R^2$ et $R^2_{adjusted}$ pouvant témoigner d'un mauvais ajustement de modèle.</span>
<span id="cb87-1194"><a href="#cb87-1194" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1195"><a href="#cb87-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1196"><a href="#cb87-1196" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Evolution des critères</span></span>
<span id="cb87-1197"><a href="#cb87-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1198"><a href="#cb87-1198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=18, fig.width=30}</span></span>
<span id="cb87-1199"><a href="#cb87-1199" aria-hidden="true" tabindex="-1"></a><span class="in">SCR &lt;- summary(selec_seq)$rss</span></span>
<span id="cb87-1200"><a href="#cb87-1200" aria-hidden="true" tabindex="-1"></a><span class="in">r2 &lt;- r2_fun(Hitters_Without_NA$Salary, SCR)</span></span>
<span id="cb87-1201"><a href="#cb87-1201" aria-hidden="true" tabindex="-1"></a><span class="in">r2a &lt;- r2a_fun(Hitters_Without_NA$Salary, SCR)</span></span>
<span id="cb87-1202"><a href="#cb87-1202" aria-hidden="true" tabindex="-1"></a><span class="in">cp &lt;- cp_fun(mod1, SCR)</span></span>
<span id="cb87-1203"><a href="#cb87-1203" aria-hidden="true" tabindex="-1"></a><span class="in">aic &lt;- aic_fun(SCR)</span></span>
<span id="cb87-1204"><a href="#cb87-1204" aria-hidden="true" tabindex="-1"></a><span class="in">bic &lt;- bic_fun(SCR)</span></span>
<span id="cb87-1205"><a href="#cb87-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1206"><a href="#cb87-1206" aria-hidden="true" tabindex="-1"></a><span class="in">grid.arrange(Criteria_plot(r2, crit_name = "R2"),</span></span>
<span id="cb87-1207"><a href="#cb87-1207" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(r2a, crit_name = "R2 ajusté"),</span></span>
<span id="cb87-1208"><a href="#cb87-1208" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(cp, crit_name = "Cp"),</span></span>
<span id="cb87-1209"><a href="#cb87-1209" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(SCR, crit_name = "Somme des Carrés Résiduels"),</span></span>
<span id="cb87-1210"><a href="#cb87-1210" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(aic, crit_name = "AIC"),</span></span>
<span id="cb87-1211"><a href="#cb87-1211" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(bic, crit_name = "BIC"),</span></span>
<span id="cb87-1212"><a href="#cb87-1212" aria-hidden="true" tabindex="-1"></a><span class="in">             ncol = 3)</span></span>
<span id="cb87-1213"><a href="#cb87-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1214"><a href="#cb87-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1215"><a href="#cb87-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Meilleur modèle</span></span>
<span id="cb87-1216"><a href="#cb87-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1217"><a href="#cb87-1217" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-1218"><a href="#cb87-1218" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-1219"><a href="#cb87-1219" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1220"><a href="#cb87-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1221"><a href="#cb87-1221" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-1222"><a href="#cb87-1222" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-1223"><a href="#cb87-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1224"><a href="#cb87-1224" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-1225"><a href="#cb87-1225" aria-hidden="true" tabindex="-1"></a>Regardons donc pour chaque critère quel est le modèle qui ressort comme le meilleur</span>
<span id="cb87-1226"><a href="#cb87-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1229"><a href="#cb87-1229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1230"><a href="#cb87-1230" aria-hidden="true" tabindex="-1"></a>criteria_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(r2, r2a, cp, aic, bic)</span>
<span id="cb87-1231"><a href="#cb87-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">Best_model</span>(selec_seq, criteria_df)</span>
<span id="cb87-1232"><a href="#cb87-1232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1233"><a href="#cb87-1233" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1234"><a href="#cb87-1234" aria-hidden="true" tabindex="-1"></a>:::::::::</span>
<span id="cb87-1235"><a href="#cb87-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1236"><a href="#cb87-1236" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Utilisation de la fonction step**</span></span>
<span id="cb87-1237"><a href="#cb87-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1238"><a href="#cb87-1238" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb87-1239"><a href="#cb87-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1240"><a href="#cb87-1240" aria-hidden="true" tabindex="-1"></a>On peut également utiliser la fonction *`step`* de la library *`{stats}`*.</span>
<span id="cb87-1241"><a href="#cb87-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1242"><a href="#cb87-1242" aria-hidden="true" tabindex="-1"></a>La fonction *`step`* nous propose quel critère nous voulons utiliser pour la sélection entre le *BIC*, *AIC* et $C_p$.</span>
<span id="cb87-1243"><a href="#cb87-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1244"><a href="#cb87-1244" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb87-1245"><a href="#cb87-1245" aria-hidden="true" tabindex="-1"></a><span class="fu">#### BIC</span></span>
<span id="cb87-1246"><a href="#cb87-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1249"><a href="#cb87-1249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1250"><a href="#cb87-1250" aria-hidden="true" tabindex="-1"></a>modselect_seq_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb87-1251"><a href="#cb87-1251" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb87-1252"><a href="#cb87-1252" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb87-1253"><a href="#cb87-1253" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb87-1254"><a href="#cb87-1254" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="fu">log</span>(n))</span>
<span id="cb87-1255"><a href="#cb87-1255" aria-hidden="true" tabindex="-1"></a>modselect_seq_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb87-1256"><a href="#cb87-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1257"><a href="#cb87-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1258"><a href="#cb87-1258" aria-hidden="true" tabindex="-1"></a><span class="fu">#### AIC</span></span>
<span id="cb87-1259"><a href="#cb87-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1262"><a href="#cb87-1262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1263"><a href="#cb87-1263" aria-hidden="true" tabindex="-1"></a>modselect_seq_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb87-1264"><a href="#cb87-1264" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb87-1265"><a href="#cb87-1265" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb87-1266"><a href="#cb87-1266" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb87-1267"><a href="#cb87-1267" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb87-1268"><a href="#cb87-1268" aria-hidden="true" tabindex="-1"></a>modselect_seq_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb87-1269"><a href="#cb87-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1270"><a href="#cb87-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1271"><a href="#cb87-1271" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $C_p$</span></span>
<span id="cb87-1272"><a href="#cb87-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1275"><a href="#cb87-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1276"><a href="#cb87-1276" aria-hidden="true" tabindex="-1"></a>modselect_seq_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb87-1277"><a href="#cb87-1277" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb87-1278"><a href="#cb87-1278" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb87-1279"><a href="#cb87-1279" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb87-1280"><a href="#cb87-1280" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb87-1281"><a href="#cb87-1281" aria-hidden="true" tabindex="-1"></a>modselect_seq_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb87-1282"><a href="#cb87-1282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1283"><a href="#cb87-1283" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1284"><a href="#cb87-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1285"><a href="#cb87-1285" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb87-1286"><a href="#cb87-1286" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb87-1287"><a href="#cb87-1287" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1288"><a href="#cb87-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1289"><a href="#cb87-1289" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb87-1290"><a href="#cb87-1290" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb87-1291"><a href="#cb87-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1292"><a href="#cb87-1292" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb87-1293"><a href="#cb87-1293" aria-hidden="true" tabindex="-1"></a>Avec la fonction *`step`* nous avons le modèle utilisant le critère *BIC* qui nous permet d'avoir toutes nos variables significatives (sauf l'*intercept* ce qui pourrait nous donner envie de faire des modèles sans).</span>
<span id="cb87-1294"><a href="#cb87-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1295"><a href="#cb87-1295" aria-hidden="true" tabindex="-1"></a>Par contre, nos valeurs de $R^2$ et $R^2_{adjusted}$ sont encore assez faible pour considérer ces modèles comme étant de très bonne qualité.</span>
<span id="cb87-1296"><a href="#cb87-1296" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1297"><a href="#cb87-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1298"><a href="#cb87-1298" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb87-1299"><a href="#cb87-1299" aria-hidden="true" tabindex="-1"></a>Aussi, si on veut comparer le modèle initial et le modèle final, on peut utiliser la fonction *`anova`*. Cela permet de voir si la sélection de variables a significativement amélioré l'ajustement.</span>
<span id="cb87-1300"><a href="#cb87-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1303"><a href="#cb87-1303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1304"><a href="#cb87-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod0, modselect_seq_bic, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb87-1305"><a href="#cb87-1305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1306"><a href="#cb87-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1307"><a href="#cb87-1307" aria-hidden="true" tabindex="-1"></a>De manière logique on voit donc tout de même que le modèle avec nos variable explicatives sélectionnées (ici celui avec selection via le critère *BIC*) propose un meilleur ajustement que celui sans variable.</span>
<span id="cb87-1308"><a href="#cb87-1308" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb87-1309"><a href="#cb87-1309" aria-hidden="true" tabindex="-1"></a>:::::::::::::::::::::::::::::::::::::::::::::::</span>
<span id="cb87-1310"><a href="#cb87-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1311"><a href="#cb87-1311" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparaison des critères</span></span>
<span id="cb87-1312"><a href="#cb87-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1313"><a href="#cb87-1313" aria-hidden="true" tabindex="-1"></a>Avant de finir, comparons un peut les critères que nous avons calculés avec ceux que l'on peut récupérer via le *`summary`* de *`regsubset`* (pour tous sauf l'*AIC* qui n'est pas présent). On se contentera de faire se comparatif seulement pour le modèle *stepwise*.</span>
<span id="cb87-1314"><a href="#cb87-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1315"><a href="#cb87-1315" aria-hidden="true" tabindex="-1"></a>Pour cela regardons si nous avons régulièrement la valeur 0 (ou valeur proche) lorsque l'on fait la soustraction du critère calculé et du critère donné par regsubset :</span>
<span id="cb87-1316"><a href="#cb87-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1319"><a href="#cb87-1319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1320"><a href="#cb87-1320" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"(valeur calculée - valeur récupérée) pour le R2 :"</span>,  <span class="fu">round</span>(r2<span class="sc">-</span><span class="fu">summary</span>(selec_seq)<span class="sc">$</span>rsq) <span class="sc">%&gt;%</span> <span class="fu">mean</span>(),</span>
<span id="cb87-1321"><a href="#cb87-1321" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">(valeur calculée - valeur récupérée) pour le R2 ajusté:"</span>,  <span class="fu">round</span>(r2a<span class="sc">-</span><span class="fu">summary</span>(selec_seq)<span class="sc">$</span>adjr2) <span class="sc">%&gt;%</span> <span class="fu">mean</span>(),</span>
<span id="cb87-1322"><a href="#cb87-1322" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">(valeur calculée - valeur récupérée) pour le Cp :"</span>,  <span class="fu">round</span>(cp<span class="sc">-</span><span class="fu">summary</span>(selec_seq)<span class="sc">$</span>cp) <span class="sc">%&gt;%</span> <span class="fu">mean</span>(),</span>
<span id="cb87-1323"><a href="#cb87-1323" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">(valeur calculée - valeur récupérée) pour le BIC :"</span>,  <span class="fu">round</span>(bic<span class="sc">-</span><span class="fu">summary</span>(selec_seq)<span class="sc">$</span>bic) <span class="sc">%&gt;%</span> <span class="fu">mean</span>())</span>
<span id="cb87-1324"><a href="#cb87-1324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1325"><a href="#cb87-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1326"><a href="#cb87-1326" aria-hidden="true" tabindex="-1"></a>on voit une grosse différence seulement pour le *BIC* donc regardons plus en détail via les représentations visuelles de l'évolution du critère.</span>
<span id="cb87-1327"><a href="#cb87-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1328"><a href="#cb87-1328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=14, fig.width=26}</span></span>
<span id="cb87-1329"><a href="#cb87-1329" aria-hidden="true" tabindex="-1"></a><span class="in">grid.arrange(Criteria_plot(bic, crit_name = "BIC"),</span></span>
<span id="cb87-1330"><a href="#cb87-1330" aria-hidden="true" tabindex="-1"></a><span class="in">             Criteria_plot(summary(selec_seq)$bic, crit_name = "BIC regsubstet ajusté"),</span></span>
<span id="cb87-1331"><a href="#cb87-1331" aria-hidden="true" tabindex="-1"></a><span class="in">             ncol = 2)</span></span>
<span id="cb87-1332"><a href="#cb87-1332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb87-1333"><a href="#cb87-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1334"><a href="#cb87-1334" aria-hidden="true" tabindex="-1"></a>On voit que les valeurs sont différentes mais en fait le comportement est identique. Ce qui veut dire que la différence est seulement due à une constant multiplicative près.</span>
<span id="cb87-1335"><a href="#cb87-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1336"><a href="#cb87-1336" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb87-1337"><a href="#cb87-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1338"><a href="#cb87-1338" aria-hidden="true" tabindex="-1"></a>À la lumière des résultats de notre analyse, on peut envisager le modèle *both* car bien qu'il n'ait pas montré de grandes améliorations en termes de $R^2$ et $R^2_{adjusted}$, il a une démarche plus "souple" pour permettre de réduire le nombre de variables tout en maintenant celles qui sont significatives. Ce modèle est donc plus parcimonieux tout en conservant des variables importantes. Cependant, une réflexion supplémentaire pourrait être menée sur l'éventuelle suppression de l'*intercept*, ce qui nécessiterait une validation supplémentaire.</span>
<span id="cb87-1339"><a href="#cb87-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1340"><a href="#cb87-1340" aria-hidden="true" tabindex="-1"></a>En ce qui concerne le choix final du modèle, on peut opter pour celui qui maximise le critère *BIC*, ce qui nous mène à un modèle avec 6 variables. Le *BIC* est particulièrement utile pour privilégier un modèle plus simple et plus parcimonieux, ce qui est un atout lorsqu'on cherche à éviter un surajustement. Toutefois, il est important de noter que la qualité de l'ajustement n'est pas optimale, ce qui suggère qu'il pourrait manquer certaines informations pour expliquer pleinement la variable cible (le salaire).</span>
<span id="cb87-1341"><a href="#cb87-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1342"><a href="#cb87-1342" aria-hidden="true" tabindex="-1"></a>Enfin, la validité interne est un aspect crucial qui n'a pas été suffisamment exploré dans cette analyse. Il aurait été pertinent de vérifier que toutes les hypothèses sous-jacentes des modèles étaient satisfaites. Cela aurait permis de renforcer la robustesse de nos résultats et de garantir que les conclusions qu'on sont fiables.</span>
<span id="cb87-1343"><a href="#cb87-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1344"><a href="#cb87-1344" aria-hidden="true" tabindex="-1"></a>Donc, il serait pertinent d'examiner plus en profondeur des modèles sans *intercept* et la validité interne, notamment en testant les hypothèses de normalité, d'homoscédasticité, et d'indépendance des résidus.</span>
<span id="cb87-1345"><a href="#cb87-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1346"><a href="#cb87-1346" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session info</span></span>
<span id="cb87-1347"><a href="#cb87-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-1350"><a href="#cb87-1350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb87-1351"><a href="#cb87-1351" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>(<span class="at">pkgs =</span> <span class="st">"attached"</span>)</span>
<span id="cb87-1352"><a href="#cb87-1352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025, Clément Poupelin</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This blog is built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>