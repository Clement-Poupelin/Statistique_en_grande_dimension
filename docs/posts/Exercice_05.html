<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Clément Poupelin">
<meta name="dcterms.date" content="2025-02-20">
<meta name="description" content="On va illustrer dans ce document les problèmes de biais de séléction et de corrélation fortuite pour des données simulé">

<title>Statistique en grande dimension - Exercice 05</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../img/logo_univ_nantes_simple.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/logo_univ_nantes_complet.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">X3MS020</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../TP_StatGdeDim.pdf" rel="" target=""><i class="bi bi-file-earmark-font-fill" role="img">
</i> 
 <span class="menu-text">Feuille de TP</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/Clement-Poupelin" rel="" target="">
 <span class="dropdown-text">Clément Poupelin</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/nonomtrt" rel="" target="">
 <span class="dropdown-text">Noémie Matrat</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-linkedin" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-linkedin">    
        <li>
    <a class="dropdown-item" href="http://www.linkedin.com/in/cl%C3%A9ment-poupelin-7675311a7/" rel="" target="">
 <span class="dropdown-text">Clément Poupelin</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.linkedin.com/in/no%C3%A9mie-matrat-86a34a200/" rel="" target="">
 <span class="dropdown-text">Noémie Matrat</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:clementjc.poupelin@gmail.com" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://clement-poupelin.github.io/" rel="" target=""><i class="bi bi-person-circle" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/clement__poupelin" rel="" target=""><i class="bi bi-instagram" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Exercice 05</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          On va illustrer dans ce document les problèmes de biais de séléction et de corrélation fortuite pour des données simulé
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">regression logistique</div>
                <div class="quarto-category">Correlations fortuites</div>
                <div class="quarto-category">biais de sélection</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Clément Poupelin </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 20, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#données" id="toc-données" class="nav-link" data-scroll-target="#données">Données</a></li>
  <li><a href="#analyse-descriptive" id="toc-analyse-descriptive" class="nav-link" data-scroll-target="#analyse-descriptive">Analyse descriptive</a>
  <ul class="collapse">
  <li><a href="#corrélation" id="toc-corrélation" class="nav-link" data-scroll-target="#corrélation">Corrélation</a></li>
  </ul></li>
  <li><a href="#biais-de-sélection" id="toc-biais-de-sélection" class="nav-link" data-scroll-target="#biais-de-sélection">Biais de sélection</a></li>
  <li><a href="#correlations-fortuites" id="toc-correlations-fortuites" class="nav-link" data-scroll-target="#correlations-fortuites">Correlations fortuites</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session info</a>
  <ul class="collapse">
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a></li>
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a></li>
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question 5</a></li>
  <li><a href="#question-6" id="toc-question-6" class="nav-link" data-scroll-target="#question-6">Question 6</a></li>
  <li><a href="#question-7" id="toc-question-7" class="nav-link" data-scroll-target="#question-7">Question 7</a></li>
  <li><a href="#question-8" id="toc-question-8" class="nav-link" data-scroll-target="#question-8">Question 8</a></li>
  <li><a href="#question-9" id="toc-question-9" class="nav-link" data-scroll-target="#question-9">Question 9</a></li>
  <li><a href="#question-10" id="toc-question-10" class="nav-link" data-scroll-target="#question-10">Question 10</a></li>
  <li><a href="#question-11" id="toc-question-11" class="nav-link" data-scroll-target="#question-11">Question 11</a></li>
  <li><a href="#question-12" id="toc-question-12" class="nav-link" data-scroll-target="#question-12">Question 12</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="setup" class="level1">
<h1>Setup</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Fonctions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Seed</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Données</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)         <span class="co"># Hitters data </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)        <span class="co"># manipulation des données</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inférence</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)        <span class="co"># regsubsets </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)          <span class="co"># pour VIF</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ggplot</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Heatmap</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">pairs.panels</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">VIF plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Critères</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">plot pour nos critères</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false">Meilleur modèle après regsubset</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transformer les données en format long pour ggplot</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  data_long <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(data)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span>  <span class="co"># Palette de couleurs harmonieuse</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Variables (Boxplot)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Valeurs"</span>) <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Thème épuré</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotation des étiquettes</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my_barplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, variable1, variable2) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> {{ variable1 }}, <span class="at">fill =</span> {{ variable2 }})) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#C41E3A"</span>, <span class="st">"#0033A0"</span>)) <span class="sc">+</span>  </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Répartition des joueurs par League et Division"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(variable1)), </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Nombre de joueurs"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>my_League_heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  table_league <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>League,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>NewLeague</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(table_league) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"League"</span>, <span class="st">"NewLeague"</span>, <span class="st">"Count"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(table_league, <span class="fu">aes</span>(<span class="at">x =</span> League, <span class="at">y =</span> NewLeague, <span class="at">fill =</span> Count)) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"deeppink"</span>, <span class="at">high =</span> <span class="st">"deeppink4"</span>) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Count), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Transition des Joueurs entre les Ligues"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"League d'origine"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Nouvelle League"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Nombre de joueurs"</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>my_pairs.panels <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  psych<span class="sc">::</span><span class="fu">pairs.panels</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pearson"</span>,  <span class="co"># Méthode de corrélation</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">hist.col =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Set3"</span>),  <span class="co"># Couleurs des histogrammes</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout des courbes de densité</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ellipses =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout d'ellipses</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">smooth =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout de régressions lissées</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">lm =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout des droites de régression</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"#69b3a2"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,  <span class="co"># Transparence</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.labels =</span> <span class="fl">3.5</span>,  <span class="co"># Taille du texte des variables</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">font.labels =</span> <span class="dv">2</span>  <span class="co"># Mettre en gras</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>my_VIFplot <span class="ot">&lt;-</span> <span class="cf">function</span>(vif) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  vif_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">names</span>(vif), <span class="at">VIF =</span> vif)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(vif_df, <span class="fu">aes</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">reorder</span>(Variable, VIF),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">pmin</span>(VIF, <span class="dv">15</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> VIF <span class="sc">&gt;</span> <span class="dv">10</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(VIF <span class="sc">&gt;</span> <span class="dv">10</span>, <span class="fu">round</span>(VIF, <span class="dv">1</span>), <span class="st">""</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>)) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variance Inflation Factor (VIF)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"VIF (limité à 15)"</span>) <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">34</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">54</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">26</span>),</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">30</span>),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">38</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<p>On rappel que <span class="math inline">\(SCR = \sum_i (y_i - f(x_i))^2\)</span> et <span class="math inline">\(SCT = \sum_i (y_i - \bar{y})^2\)</span>.<br>
</p>
<p>Ainsi, on peut aretrouver les différents critères :</p>
<p><span class="math display">\[ R^2 = 1 - \frac{SCR}{SCT}\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>r2_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># r2 = SSE/SST = (SST - SSR)/SST = 1 - ssr/sst</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SCR<span class="sc">/</span>SCT</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[ R^2_{adjusted} = 1 - \frac{SCR (n-1)}{SCT(n-(p+1))}\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>r2a_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  r2a <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SCR<span class="sc">/</span>(n<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">/</span>(SCT<span class="sc">/</span>(n<span class="dv">-1</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2a)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[ C_p = \frac{SCR}{\sigma^2} + 2(p+1) - n\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, SCR){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  sig <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  cp <span class="ot">&lt;-</span> SCR<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>) <span class="sc">-</span> n</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cp)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[ AIC = n\text{log}\left(\frac{SCR}{n}\right) + 2(p+1)\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>aic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(aic)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[ BIC = n\text{log}\left(\frac{SCR}{n}\right) + \text{log}(n)(p+1)\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>bic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="fu">log</span>(n)<span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(bic)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Criteria_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(Criteria, <span class="at">crit_name =</span> <span class="st">"Critère"</span>) {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création d'un data frame pour ggplot</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  df_criteria <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb_var =</span> <span class="fu">seq_along</span>(Criteria),  <span class="co"># Nombre de variables du modèle</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Criteria =</span> Criteria            <span class="co"># Critère</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création du plot avec ggplot2</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_criteria, <span class="fu">aes</span>(<span class="at">x =</span> nb_var, <span class="at">y =</span> Criteria)) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Évolution de"</span>, crit_name, <span class="st">"en fonction du nombre de variables"</span>),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Nombre de variables sélectionnées"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> crit_name</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">26</span>),  <span class="co"># Titre centré et agrandi</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(g)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Best_model <span class="ot">&lt;-</span> <span class="cf">function</span>(model, criteria_df){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## On a d'abord les critères à maximiser</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    criteria_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(criteria_df)[i]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    criteria <span class="ot">&lt;-</span> criteria_df[,i]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    best_model_criteria <span class="ot">&lt;-</span> <span class="fu">which.max</span>(criteria)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>which[best_model_criteria,]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Meilleur modèle selon"</span>, criteria_name, <span class="st">" = "</span>, <span class="fu">round</span>(<span class="fu">max</span>(criteria), <span class="dv">3</span>), <span class="st">" : Modèle avec"</span>, best_model_criteria, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>]), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## On a ensuite les critères à minimiser</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    criteria_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(criteria_df)[i]</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    criteria <span class="ot">&lt;-</span> criteria_df[,i]</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    best_model_criteria <span class="ot">&lt;-</span> <span class="fu">which.min</span>(criteria)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>which[best_model_criteria,]</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Meilleur modèle selon"</span>, criteria_name, <span class="st">" = "</span>, <span class="fu">round</span>(<span class="fu">min</span>(criteria), <span class="dv">3</span>),<span class="st">" : Modèle avec"</span>, best_model_criteria, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>]), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">140400</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="données" class="level1">
<h1>Données</h1>
<p>Dans ce rapport, nous allons pouvoir illustrer deux grands problèmes qui apparaissent dans le domaine de la statistique en grande dimension :</p>
<ul>
<li><p>le biais de sélection</p></li>
<li><p>et les corrélations fortuites</p></li>
</ul>
<p>Pour faire cela, nous nous baserons sur un jeu de données que l’on créera. On génère alors</p>
<ul>
<li><p><span class="math inline">\(y\)</span> de taille <span class="math inline">\(n=100\)</span> avec <span class="math inline">\(y_i \sim \mathcal{B}(0.5)\)</span></p></li>
<li><p><span class="math inline">\(X\)</span> qui contient <span class="math inline">\(p=5000\)</span> variables explicatives qui seront toutes des réalisations indépendantes de <span class="math inline">\(n=100\)</span> valeurs issues d’une loi <span class="math inline">\(\mathcal{N}_{(0,1)}\)</span></p></li>
</ul>
<p>Pour cela, nous pouvons utiliser les fonction de <em><code>R</code></em> qui permettent de générer des variables aléatoire.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>p, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol =</span> p) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>Simu_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y, x) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pour la variable <span class="math inline">\(y\)</span>, il est possible de la simuler de manière deterministe <code>y &lt;- rep(c(0,1), n/2)</code></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>pour des raisons de repouctibilité, une graine ou seed a été défini dans le setup afin que la génération aléatoire reste identique.</p>
</div>
</div>
</section>
<section id="analyse-descriptive" class="level1">
<h1>Analyse descriptive</h1>
<section id="corrélation" class="level2">
<h2 class="anchored" data-anchor-id="corrélation">Corrélation</h2>
<p>Maintenant, nous pouvons déjà souligner que, théoriquement, il ne devrait pas y avoir de lien entre <span class="math inline">\(y\)</span> et <span class="math inline">\(X\)</span> puisque les simulations sont faites indépendament.<br>
Pour visualiser cela, il suffit simplement de créer un vecteur qui stockera les différentes valeurs de corrélation entre <span class="math inline">\(y\)</span> et <span class="math inline">\(x^i\)</span> pour <span class="math inline">\(i\)</span> allant de 1 à 5000.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cor_vect <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(x, <span class="cf">function</span>(col) <span class="fu">cor</span>(col, y)))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>my_hist <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  cor_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Correlation =</span> data)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cor_df, <span class="fu">aes</span>(<span class="at">x =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des corrélations entre y et les variables explicatives"</span>, <span class="at">x =</span> <span class="st">"Corrélation"</span>, <span class="at">y =</span> <span class="st">"Fréquence"</span>) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">16</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="fu">my_hist</span>(cor_vect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_05_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Texte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Preuve</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>De manière général, il faut savoir qu’une méthode de prévision de <span class="math inline">\(y\)</span> basée sur les variables explicatives s’exprime nécessairement sous la forme <span class="math inline">\(\hat{y} = f(x^1, ..., x^{5000})\)</span>. La forme de la fonction <span class="math inline">\(f\)</span> étant généralement obtenue grâce à une estimation sur un échantillon d’apprentissage. Il faut alors découper notre jeu de données en deux échantillons, un pour l’apprentissage et un pour le test.<br>
</p>
<p>Dans ces méthodes, nous nous intéressons principalement au taux d’erreur de classification “test”, c’est-à-dire à la probabilité que <span class="math inline">\(\hat{y}\)</span> soit différent de <span class="math inline">\(y\)</span>, lorsque <span class="math inline">\(y\)</span> et <span class="math inline">\(x^1, ..., x^{5000}\)</span> sont dans l’échantillon test et donc indépendants de l’échantillon d’apprentissage.<br>
On peut facilement démontrer que cette probabilité est de 50% quelle que soit la méthode utilisée (cf <strong>Preuve</strong>).</p>
<p>Pourtant, pour illustrer nos problèmes, supposons que nous avons observé le jeu de données simulé ci-dessus, sans connaître les liens théoriques entre les variables. Nous souhaitons alors ajuster un modèle expliquant au mieux <span class="math inline">\(y\)</span> en fonction des variables à disposition, et estimer le taux d’erreur des prévisions associées.</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Nous remarquons déjà que, <span class="math inline">\(\hat{y}\)</span> étant une combinaisons de nos variables <span class="math inline">\(x^1, ..., x^{5000}\)</span> qui sont indépendantes de <span class="math inline">\(y\)</span>, on a <span class="math inline">\(\hat{y}\)</span> et y sont deux variables indépendantes l’une de l’autre.<br>
</p>
<p>Ainsi <span class="math display">\[\mathbb{P}(\hat{y} \neq y) = \mathbb{P}(\hat{y}=0, y=1) + \mathbb{P}(\hat{y}=1, y=0)\]</span> <span class="math display">\[ \quad \quad \quad \quad \quad \quad \quad \quad = \mathbb{P}(\hat{y}=0)\mathbb{P}(y=1) + \mathbb{P}(\hat{y}=1)\mathbb{P}(y=0) \quad  ^{(*)}\]</span> <span class="math display">\[ \quad \quad \quad \quad = 0.5\mathbb{P}(\hat{y}=0) + 0.5\mathbb{P}(\hat{y}=1)  \quad  ^{(**)} \]</span> <span class="math display">\[ \quad \quad = 0.5 \left( \mathbb{P}(\hat{y}=0) + \mathbb{P}(\hat{y}=1) \right)\]</span></p>
<p>Nous reconnaissons ici une somme sur l’univers des possible de la densité discrète de <span class="math inline">\(\hat{y}\)</span>.<br>
Celle ci est donc égale à 1 et on obtient</p>
<p><span class="math display">\[\mathbb{P}(\hat{y} \neq y) = 0.5\]</span></p>
<ul>
<li><p><span class="math inline">\(^{(*)} \quad \text{par indépendance de} \quad \hat{y} \quad \text{et} \quad y\)</span></p></li>
<li><p><span class="math inline">\(^{(**)} \quad \text{car} \quad y \quad \text{suit une loi de Bernoulli de paramètre} \quad 0.5\)</span></p></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="biais-de-sélection" class="level1">
<h1>Biais de sélection</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Texte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Preuve</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Étant donné le très grand nombre de variables explicatives, on ne va garder que les 5 variables les plus corrélées avec <span class="math inline">\(y\)</span> afin d’ajuster un modèle de régression logistique. Pour quantifier la corrélation entre la variable <span class="math inline">\(y\)</span>, qui est binaire, et une variable quantitative, deux possibilités s’offrent :</p>
<ul>
<li><p>utiliser la corrélation de Pearson <span class="math inline">\(\hat{\rho}\)</span> comme si <span class="math inline">\(y\)</span> était une variable</p></li>
<li><p>utiliser le “rapport de corrélation” quantifiant le lien entre une variable qualitative et une variable quantitative : <span class="math display">\[\hat{\eta}^2 = \frac{S^2_{inter}}{S^2_{total}}\]</span> où <span class="math inline">\(S^2_{inter}\)</span> est la somme des carrés “inter-classes” et <span class="math inline">\(S^2_{total}\)</span> la somme des carrés total.</p></li>
</ul>
<p>Par chance, dans notre cas nous avons que <span class="math inline">\(\hat{\eta}^2 = \hat{\rho}^2\)</span>.<br>
Mais rassurez vous, la chance n’ayant pas forcément sa place en mathématiques, la démonstration de cette égalité pourra être trouvé dans la partie <strong>Preuve</strong><br>
Ainsi, la corrélation de Pearson pourra suffire pour quantifier le lien entre notre variable binaire et nos variables explicatives. Ce qui tombe bien puisqu’il s’agit de la méthode de corrélation par défaut sous <span class="math inline">\(\textit{R}\)</span> quand on utilise la fonction <span class="math inline">\(\textit{cor}\)</span>.<br>
Nous allons donc pouvoir garder les 5 variables les plus corrélées en valeur absolue avec <span class="math inline">\(y\)</span> et ajuster un modèle de régression logistique faisant intervenir ces 5 variables.</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Nous voulons ici montrer que dans le cas des donnés que nous simulons, il y a égalité entre les deux coefficients suivants. <span class="math display">\[\hat{\rho}^2 = \left(\frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y}) }{\sqrt{\sum_{i=1}^n (x_i - \bar{x})^2} \sqrt{\sum_{i=1}^n(y_i -\bar{y})^2}}\right)^2\]</span></p>
<p><span class="math display">\[\hat{\eta}^2 = \frac{\sum_{k=0}^1 n_k(\bar{x}_k - \bar{x})^2}{\sum_{i=1}^n (x_i - \bar{x})^2}\]</span></p>
<p>Nous pouvons déjà reconnaitre un terme en commun.<br>
Pour des raisons de simplicité, on notera <span class="math inline">\(S_x^2 = \sum_{i=1}^n (x_i - \bar{x})^2\)</span><br>
</p>
<p>Nous pouvons alors manipuler un peu les termes de <span class="math inline">\(\hat{\rho}\)</span><br>
<span class="math inline">\(\sum_{i=1}^n (x_i-\bar{x})(y_i - \bar{y})= \sum_{i=1}^n x_iy_i - n\bar{x}\bar{y}\)</span><br>
et<br>
<span class="math inline">\(\sum_{i=1}^n(y_i -\bar{y})^2= \sum_{i=1}^n y_i^2 - n\bar{y}^2\)</span><br>
</p>
<p>Maintenant, rappelons que dans notre cas précis, <span class="math inline">\(\forall i=1, ...,n\)</span> où <span class="math inline">\(n=100\)</span>, <span class="math inline">\(y_i \sim \mathcal{B}(0.5)\)</span>. Nous pouvons donc supposer qu’idéalement on a une parfaite séparation en deux groupes avec autant de 0 que de 1. Et ainsi en déduire les simplifications suivantes :</p>
<ul>
<li><p><span class="math inline">\(\sum_{i=1}^n y_i^2 = \sum_{i=1}^n y_i\)</span></p></li>
<li><p><span class="math inline">\(\bar{y} = \frac{n_1}{n}\)</span></p></li>
<li><p><span class="math inline">\(\sum_{i=1}^n x_iy_i = n_1\bar{x}_1 \quad\)</span> puisque l’on multipli par <span class="math inline">\(0\)</span> les <span class="math inline">\(x_i\)</span> associés au groupe <span class="math inline">\(0\)</span></p></li>
</ul>
<p>Dès lors, nous avons <span class="math inline">\(\hat{\eta}^2 = \frac{n_0(\bar{x}_0 - \bar{x})^2 + n_1(\bar{x}_1 - \bar{x})^2}{S_x^2}\)</span> et</p>
<p><span class="math display">\[\hat{\rho}^2 = \frac{1}{S_x^2} \times \frac{(n_1\bar{x}_1 - n_1\bar{x})^2}{n_1 - \frac{n_1^2}{n}}\]</span> <span class="math display">\[\quad  = \frac{1}{S_x^2} \times \frac{n_1(\bar{x}_1 - \bar{x})^2}{1 - \frac{n_1}{n}}\]</span> <span class="math display">\[\quad  = \frac{1}{S_x^2} \times \frac{n_1(\bar{x}_1 - \bar{x})^2}{\frac{n_0}{n}}\]</span> <span class="math display">\[\quad \quad = \frac{1}{S_x^2} \times \frac{n n_1(\bar{x}_1 - \bar{x})^2}{n_0}\]</span></p>
<p>Cela veut donc dire que l’on cherchera à montrer que</p>
<p><span class="math display">\[\frac{n n_1(\bar{x}_1 - \bar{x})^2}{n_0} = n_0(\bar{x}_0 - \bar{x})^2 + n_1(\bar{x}_1 - \bar{x})^2\]</span><br>
<span class="math display">\[\quad \quad \Leftrightarrow 1 = \frac{n_0^2(\bar{x}_0 - \bar{x})^2}{n n_1(\bar{x}_1 - \bar{x})^2} \times \frac{n_0}{n}\]</span></p>
<p>Mais si on suppose que <span class="math inline">\(y\)</span> est “parfaitement équilibrée”, c’est à dire qu’il y aurait autant de 0 que de 1, on aura que <span class="math inline">\(n_0 = n_1 = \frac{n}{2}\)</span> et aussi <span class="math display">\[n\bar{x} = n_0\bar{x}_0 + n_1\bar{x}_1 \Leftrightarrow \bar{x} = \frac{1}{2}(\bar{x}_0 + \bar{x}_1) \Leftrightarrow \bar{x}-\bar{x}_0 = \bar{x}_1 - \bar{x}\]</span></p>
<p>Nous aurons donc que <span class="math inline">\((\bar{x}_0-\bar{x})^2 = (\bar{x}_1 - \bar{x})^2\)</span></p>
<p>Finalement, <span class="math display">\[\frac{n_0^2(\bar{x}_0 - \bar{x})^2}{n n_1(\bar{x}_1 - \bar{x})^2} \times \frac{n_0}{n} = \frac{(\frac{n}{2})^2}{n (\frac{n}{2})} + \frac{(\frac{n}{2})}{n}\]</span> <span class="math display">\[\quad \quad \quad \quad \quad \quad = \frac{(\frac{n}{2})}{n} + \frac{(\frac{n}{2})}{n}\]</span> <span class="math display">\[\quad \quad \quad \quad \quad \quad = \frac{1}{2} + \frac{1}{2}\]</span> <span class="math display">\[\quad \quad \quad \quad \quad \quad= 1\]</span></p>
<p>Dans la situation que nous avons ici, nous pouvons donc conclure que <span class="math inline">\(\hat{\rho}^2 = \hat{\eta}^2\)</span>. On peut également supposer que cette égalité reste approximativement vrai dans des cas où “l’équilibre” n’est pas parfait.</p>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>keep_variables <span class="ot">&lt;-</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing=</span><span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Sub_Simu_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(y, x[,keep_variables]))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> Sub_Simu_data, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = y ~ ., family = "binomial", data = Sub_Simu_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1392  -0.6649   0.2322   0.8332   2.0389  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)   0.5826     0.2868   2.031  0.04223 * 
V3530        -0.8820     0.2864  -3.079  0.00207 **
V2416         0.5686     0.2744   2.073  0.03821 * 
V1512         1.0119     0.3180   3.182  0.00146 **
V1480        -0.4042     0.3044  -1.328  0.18417   
V3875         0.9207     0.3254   2.830  0.00466 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 137.628  on 99  degrees of freedom
Residual deviance:  90.046  on 94  degrees of freedom
AIC: 102.05

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="correlations-fortuites" class="level1">
<h1>Correlations fortuites</h1>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>En conclusion, avec cette étude nous avons pu illustrer deux grands problèmes que nous pouvons observer dans le cas de la Statistique en grande dimension.<br>
</p>
<p>Nous avons le <strong>biais de sélection</strong> qui arrive lorsque l’on utilise notre échantillon test dans la sélection de variable ou l’ajustement du modèle. Et donc quand on confronte nos prévisions à l’échantillon test, ces dernières seront beaucoup trop optimistes. C’est pour ca que la séparation de notre échantillon doit être faite avant la sélection de nos variables.<br>
</p>
<p>Puis, il y a la <strong>corrélation fortuite</strong> qui est propre à la grande dimension et qui nous montre qu’il faut bien connaître nos données. Lorsque l’on veut construire un modèle, il faut déjà avoir une connaissance sur les variables qui peuvent être liées. Et si on cherche des corrélation sur un jeu de grande dimension, on risque probablement d’en trouver même si théoriquement il n’y en à pas.<br>
</p>
<p>Nous voyons donc qu’il faut comprendre les données sur lesquelles nous travaillons et même si les ordinateurs sont des outils performants, il faut que le statisticien garde toujours un regard critique sur les résultats.</p>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>(<span class="at">pkgs =</span> <span class="st">"attached"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.2.1 (2022-06-23 ucrt)
 os       Windows 10 x64 (build 22631)
 system   x86_64, mingw32
 ui       RTerm
 language (EN)
 collate  French_France.utf8
 ctype    French_France.utf8
 tz       Europe/Paris
 date     2025-02-20
 pandoc   3.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package   * version date (UTC) lib source
 car       * 3.1-2   2023-03-30 [1] CRAN (R 4.2.3)
 carData   * 3.0-5   2022-01-06 [1] CRAN (R 4.2.1)
 dplyr     * 1.1.4   2023-11-17 [1] CRAN (R 4.2.3)
 ggplot2   * 3.5.1   2024-04-23 [1] CRAN (R 4.2.3)
 gridExtra * 2.3     2017-09-09 [1] CRAN (R 4.2.1)
 ISLR      * 1.4     2021-09-15 [1] CRAN (R 4.2.3)
 leaps     * 3.1     2020-01-16 [1] CRAN (R 4.2.1)

 [1] C:/Users/cleme/AppData/Local/R/win-library/4.2
 [2] C:/Program Files/R/R-4.2.1/library

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We simulate our Data Frame</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span><span class="dv">5000</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">5000</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">cbind.data.frame</span>(y, X)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df) <span class="co"># We can verify the dimensions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  100 5001</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Other way to simulate </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#y = rep(c(0,1), n/2)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#X = matrix(rnorm(n*5000,0,1), ncol = 5000)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Statistique descriptive</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We build a vector to store the correlation between y and each explanatory variables</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cor_vect <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X)[<span class="dv">2</span>]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X)[<span class="dv">2</span>]){</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  cor_vect[i]<span class="ot">=</span><span class="fu">cor</span>(X[,i],y)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(cor_vect,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span><span class="st">"Histogram of the correlation between</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="st">     y and the explanatory variables"</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Correlation"</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"skyblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_05_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="question-2" class="level3">
<h3 class="anchored" data-anchor-id="question-2">Question 2</h3>
<p>Quel est le lien attendu entre y et les variables explicatives ?</p>
<p>On s’attend à ce qu’il n’y ait pas forcément de lien puisqu’on est dans les cas de variables aléatoires créées indépendamment</p>
</section>
<section id="question-3" class="level3">
<h3 class="anchored" data-anchor-id="question-3">Question 3</h3>
<p>Une méthode de prévision de y basée sur les variables explicatives <span class="math inline">\(x^1, ..., x^{5000}\)</span> s’exprime nécessairement sous la forme <span class="math inline">\(\hat{y} = f(x^1, ..., x^{5000})\)</span>. La forme de la fonction <span class="math inline">\(f\)</span> est généralement obtenue grâce à une estimation sur un échantillon d’apprentissage. On s’intéresse au taux d’erreur de classification “test”, c’est-à-dire à la probabilité que <span class="math inline">\(\hat{y}\)</span> soit différent de <span class="math inline">\(y\)</span>, lorsque <span class="math inline">\(y\)</span> et <span class="math inline">\(x^1, ..., x^{5000}\)</span> sont indépendants de l’échantillon d’apprentissage. Montrer que quelle que soit la méthode utilisée, le taux d’erreur sera de 50%</p>
<p>FAIRE SUR PAPIER</p>
<p>Dans la suite de l’exercice, on suppose qu’on a observé le jeu de données simulé ci-dessus, sans connaître les liens théoriques entre les variables. On souhaite ajuster un modèle expliquant au mieux <span class="math inline">\(y\)</span> en fonction des variables à disposition, et estimer le taux d’erreur des prévisions associées. Etant donné le très grand nombre de variables explicatives, un statisticien décide de ne garder que les 5 variables les plus corrélées avec <span class="math inline">\(y\)</span> afin d’ajuster un modèle de régression logistique.</p>
</section>
<section id="question-4" class="level3">
<h3 class="anchored" data-anchor-id="question-4">Question 4</h3>
<p>Pour quantifier la corrélation entre la variable y, qui est binaire, et une variable quantitative, deux possibilités s’offrent a priori au statisticien : (i) soit utiliser la corrélation de Pearson <span class="math inline">\(\hat{\rho}\)</span> (comme si <span class="math inline">\(y\)</span> était une variable quantitative),</p>
<ol start="2" type="i">
<li>soit utiliser le “rapport de corrélation” quantifiant le lien entre une variable qualitative et une variable quantitative : <span class="math display">\[\hat{\eta}^2 = \frac{S^2_{inter}}{S^2_{total}}\]</span> où <span class="math inline">\(S^2_{inter}\)</span> est la somme des carrés “inter-classes” et <span class="math inline">\(S^2_{total}\)</span> la somme des carrés total.</li>
</ol>
<p>Montrer que dans notre cas : <span class="math display">\[ \hat{\eta}^2 = \hat{\rho}^2 \]</span></p>
</section>
<section id="question-5" class="level3">
<h3 class="anchored" data-anchor-id="question-5">Question 5</h3>
<p>Quelles sont les 5 variables les plus corrélées (en valeur absolue) avec <span class="math inline">\(y\)</span> ?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can isolate the highest correlations (positive or negative)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing=</span><span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3852168 0.3707116 0.3702511 0.3513121 0.3474799</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We see that we have no correlation above 40%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We isolate the index of the 5 variables with the highest correlation </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>index <span class="ot">=</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing=</span><span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We create our new Data Frame</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>df_cut <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(y, X[,index]))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df_cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100   6</code></pre>
</div>
</div>
</section>
<section id="question-6" class="level3">
<h3 class="anchored" data-anchor-id="question-6">Question 6</h3>
<p>Ajuster un modèle de régression logistique faisant intervenir ces 5 variables et analyser la qualité du modèle.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">glm</span>(y<span class="sc">~</span>., <span class="at">data =</span> df_cut, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = y ~ ., family = "binomial", data = df_cut)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.3156  -0.5999   0.2005   0.6587   2.0247  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)   0.1902     0.2698   0.705  0.48097   
V2           -0.6138     0.2988  -2.054  0.03993 * 
V3            0.6526     0.2889   2.259  0.02390 * 
V4           -0.6729     0.3117  -2.159  0.03088 * 
V5            0.8727     0.2878   3.033  0.00242 **
V6            0.7080     0.2680   2.641  0.00826 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 138.469  on 99  degrees of freedom
Residual deviance:  87.238  on 94  degrees of freedom
AIC: 99.238

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="question-7" class="level3">
<h3 class="anchored" data-anchor-id="question-7">Question 7</h3>
<p>Afin d’estimer le taux d’erreur de classification associé à ce modèle, le statisticien décide de procéder à une validation croisée K-fold avec K = 10. Estimer de cette manière le taux d’erreur.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">=</span> <span class="cf">function</span>(r, pi ){</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(r <span class="sc">-</span> pi) <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(c)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross validation K-fold</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cv.glm</span>(df_cut, fit, cost, <span class="dv">10</span>)<span class="sc">$</span>delta[<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.24</code></pre>
</div>
</div>
</section>
<section id="question-8" class="level3">
<h3 class="anchored" data-anchor-id="question-8">Question 8</h3>
<p>Recommencer 10 fois la démarche précédente, c’est à dire les questions 1., 5., 6. et 7, et stocker les 10 taux d’erreurs estimés. Que valent ces estimations. Quelle est leur moyenne ? Ces résultats sont-ils conformes à la valeur théorique attendue ?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>K <span class="co"># Vector to store the raw cross-validation estimate of prediction error</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(i, <span class="st">"-&gt;"</span>)) <span class="co"># counter to see progress</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We recreate our explanatory variables and look at correlations</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span><span class="dv">5000</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">5000</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  cor_vect <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X)[<span class="dv">2</span>]</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X)[<span class="dv">2</span>]){</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    cor_vect[j] <span class="ot">=</span> <span class="fu">cor</span>(X[,j], y)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We keep the variables with the higher correlation</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">=</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing =</span> T)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(y, X[, index]))</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We fit our glm</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">=</span> <span class="fu">glm</span>(y<span class="sc">~</span>., <span class="at">data =</span> tab, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  res[i] <span class="ot">=</span> <span class="fu">cv.glm</span>(tab, fit, cost, <span class="dv">10</span>)<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1 -&gt;2 -&gt;3 -&gt;4 -&gt;5 -&gt;6 -&gt;7 -&gt;8 -&gt;9 -&gt;10 -&gt;</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.23 0.18 0.25 0.21 0.19 0.20 0.18 0.25 0.26 0.20</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.215</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># erreur dans notre demarche, pas normal on obtient 0.22 alors que c'est 0.5 qui est attendu</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Le problème précédent est appelé biais de sélection. Lorsque l’on effectue la validation croisée, l’échantillon test n’est certes pas utilisé pour l’estimation du modèle, mais il a été utilisé initialement pour sélectionner les variables. Ainsi lorsqu’on confronte les prévisions à l’échantillon test, ces dernières sont trop optimistes car elles ont déjà utilisé l’information contenue dans cet échantillon test. Pour estimer convenablement le taux d’erreur, il faut que l’échantillon test ne soit utilisé à aucun moment dans la procédure de modélisation.</p>
</section>
<section id="question-9" class="level3">
<h3 class="anchored" data-anchor-id="question-9">Question 9</h3>
<p>Mettre en oeuvre une validation croisée valide, respectant la règle précédente, pour estimer le taux d’erreur associé à la démarche de modélisation choisie par le statisticien. Recommencer la démarche 10 fois, comme dans la question 7., afin d’obtenir 10 estimation du taux d’erreur. Comparer avec la valeur théorique attendue. On pourra utiliser la fonction cvsegments de la librairie pls pour découper l’échantillon aléatoirement en K parties de taille égale.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'pls' a été compilé avec la version R 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attachement du package : 'pls'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>L'objet suivant est masqué depuis 'package:stats':

    loadings</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To avoid selection bias, we create a list of kf segments in order to separate sample </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>kf <span class="ot">=</span> <span class="dv">10</span> <span class="co"># number of segments </span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>seg <span class="ot">=</span> <span class="fu">cvsegments</span>(<span class="fu">nrow</span>(X), kf)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>kf</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>kf) {</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We define our sample test</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  sample_test <span class="ot">=</span> seg[[i]]</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We build a vector to store the correlation between y and each explanatory variables contain into the segment</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  cor_vect <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>){</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    cor_vect[j] <span class="ot">=</span> <span class="fu">cor</span>(X[<span class="sc">-</span>sample_test, j], y[<span class="sc">-</span>sample_test])</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We keep the variables with the higher correlation</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  indexvar <span class="ot">=</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing=</span>T)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(y, X[, indexvar[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]))</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We fit our glm </span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">=</span> <span class="fu">glm</span>(y<span class="sc">~</span>., <span class="at">data =</span> tab, <span class="at">subset =</span> <span class="sc">-</span>sample_test, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">=</span> <span class="fu">predict</span>(fit, tab[sample_test,], <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  tmp[i] <span class="ot">=</span> <span class="fu">cost</span>(y[sample_test], pred)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(tmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.45</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We repeat the process 10 times </span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(k, <span class="st">"-&gt;"</span>)) <span class="co"># counter to see progress</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We recreate our explanatory variables</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span><span class="dv">5000</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">5000</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We create a list of kf segments in order to separate sample</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  Kf <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  seg <span class="ot">=</span> <span class="fu">cvsegments</span>(<span class="fu">nrow</span>(X),Kf) </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>Kf</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Kf){</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We define our sample test</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">=</span> seg[[i]]</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We build a vector to store the correlation between y and each explanatory variables contain into the segment</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    cor_vect <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>){</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>      cor_vect[j] <span class="ot">=</span> <span class="fu">cor</span>(X[<span class="sc">-</span>test,j],y[<span class="sc">-</span>test])</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We keep the variables with the higher correlation</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>    indexvar <span class="ot">=</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing =</span> T)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>    tab <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(y, X[, indexvar[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]))</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We fit our glm </span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">=</span> <span class="fu">glm</span>(y<span class="sc">~</span>., <span class="at">data =</span> tab, <span class="at">subset =</span> <span class="sc">-</span>test, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>    pred <span class="ot">=</span> <span class="fu">predict</span>(fit, tab[test,], <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>    tmp[i] <span class="ot">=</span> <span class="fu">cost</span>(y[test], pred)</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  res2[k] <span class="ot">=</span> <span class="fu">mean</span>(tmp)</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1 -&gt;2 -&gt;3 -&gt;4 -&gt;5 -&gt;6 -&gt;7 -&gt;8 -&gt;9 -&gt;10 -&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>res2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.53 0.70 0.52 0.51 0.69 0.42 0.46 0.51 0.61 0.51</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(res2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.546</code></pre>
</div>
</div>
</section>
<section id="question-10" class="level3">
<h3 class="anchored" data-anchor-id="question-10">Question 10</h3>
<p>à partir de quelle valeur <span class="math inline">\(|\hat{\rho}|\)</span> peut-on considérer que deux variables ont une corrélation significativement non-nulle au seuil <span class="math inline">\(α = 5\%\)</span> ?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span><span class="dv">5000</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">5000</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We build a vector to store the correlation between y and each explanatory variables</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>cor_vect <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>){</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  cor_vect[i] <span class="ot">=</span> <span class="fu">cor</span>(X[,i], y)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># We look at the quantile</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>quant <span class="ot">=</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>quant</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1959964</code></pre>
</div>
</div>
</section>
<section id="question-11" class="level3">
<h3 class="anchored" data-anchor-id="question-11">Question 11</h3>
<p>Comparer les corrélations des variables dans le modèle précédent avec ce seuil ?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We keep the variables with the higher correlation</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>index <span class="ot">=</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing =</span> T)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>index[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  663 3121 2740 3782  259</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>cor_vect[index[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3548252 -0.3541487  0.3525526 -0.3479385 -0.3453889</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For our 5 variables with the higher correlation, we look this correlation is more than our quantile</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((<span class="fu">abs</span>(cor_vect[index[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]))<span class="sc">&gt;</span>quant)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
</section>
<section id="question-12" class="level3">
<h3 class="anchored" data-anchor-id="question-12">Question 12</h3>
<p>Parmi 5000 variables théoriquement non corrélées avec <span class="math inline">\(y\)</span>, environ combien de variables observées sur <span class="math inline">\(n = 100\)</span> individus présenteront une corrélation empirique significativement non nulles avec y au seuil <span class="math inline">\(α = 5\%\)</span> ? Le vérifier sur le jeu de données simulé.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We look at the number of variables in our model where the correlation with y is more than our quantile</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((<span class="fu">abs</span>(cor_vect))<span class="sc">&gt;</span>quant)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 283</code></pre>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb63" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Exercice 05"</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Clément Poupelin"</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">    embed-resources: false</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: article</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> false</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> ["regression logistique", "Correlations fortuites", "biais de sélection"]</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> ""</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "On va illustrer dans ce document les problèmes de biais de séléction et de corrélation fortuite pour des données simulé"</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup </span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>:::: panel-tabset</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, setup, warning=FALSE, message=FALSE}</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Données</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)         <span class="co"># Hitters data </span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)        <span class="co"># manipulation des données</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Inférence</span></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)        <span class="co"># regsubsets </span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)          <span class="co"># pour VIF</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a><span class="do">## ggplot</span></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fonctions</span></span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a><span class="fu">### boxplot</span></span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transformer les données en format long pour ggplot</span></span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>  data_long <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(data)</span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span>  <span class="co"># Palette de couleurs harmonieuse</span></span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Variables (Boxplot)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Valeurs"</span>) <span class="sc">+</span></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Thème épuré</span></span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotation des étiquettes</span></span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a><span class="fu">### barplot</span></span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>my_barplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, variable1, variable2) {</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> {{ variable1 }}, <span class="at">fill =</span> {{ variable2 }})) <span class="sc">+</span></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#C41E3A"</span>, <span class="st">"#0033A0"</span>)) <span class="sc">+</span>  </span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Répartition des joueurs par League et Division"</span>,</span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(variable1)), </span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Nombre de joueurs"</span></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a><span class="fu">### Heatmap</span></span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a>my_League_heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a>  table_league <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(</span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>League,</span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">$</span>NewLeague</span>
<span id="cb63-93"><a href="#cb63-93" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb63-94"><a href="#cb63-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(table_league) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"League"</span>, <span class="st">"NewLeague"</span>, <span class="st">"Count"</span>)</span>
<span id="cb63-95"><a href="#cb63-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-96"><a href="#cb63-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(table_league, <span class="fu">aes</span>(<span class="at">x =</span> League, <span class="at">y =</span> NewLeague, <span class="at">fill =</span> Count)) <span class="sc">+</span></span>
<span id="cb63-97"><a href="#cb63-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb63-98"><a href="#cb63-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"deeppink"</span>, <span class="at">high =</span> <span class="st">"deeppink4"</span>) <span class="sc">+</span></span>
<span id="cb63-99"><a href="#cb63-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Count), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb63-100"><a href="#cb63-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb63-101"><a href="#cb63-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Transition des Joueurs entre les Ligues"</span>,</span>
<span id="cb63-102"><a href="#cb63-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"League d'origine"</span>,</span>
<span id="cb63-103"><a href="#cb63-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Nouvelle League"</span>,</span>
<span id="cb63-104"><a href="#cb63-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"Nombre de joueurs"</span></span>
<span id="cb63-105"><a href="#cb63-105" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb63-106"><a href="#cb63-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb63-107"><a href="#cb63-107" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-108"><a href="#cb63-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-109"><a href="#cb63-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-110"><a href="#cb63-110" aria-hidden="true" tabindex="-1"></a><span class="fu">### pairs.panels</span></span>
<span id="cb63-111"><a href="#cb63-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-114"><a href="#cb63-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-115"><a href="#cb63-115" aria-hidden="true" tabindex="-1"></a>my_pairs.panels <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb63-116"><a href="#cb63-116" aria-hidden="true" tabindex="-1"></a>  psych<span class="sc">::</span><span class="fu">pairs.panels</span>(</span>
<span id="cb63-117"><a href="#cb63-117" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb63-118"><a href="#cb63-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pearson"</span>,  <span class="co"># Méthode de corrélation</span></span>
<span id="cb63-119"><a href="#cb63-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">hist.col =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Set3"</span>),  <span class="co"># Couleurs des histogrammes</span></span>
<span id="cb63-120"><a href="#cb63-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout des courbes de densité</span></span>
<span id="cb63-121"><a href="#cb63-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">ellipses =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout d'ellipses</span></span>
<span id="cb63-122"><a href="#cb63-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">smooth =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout de régressions lissées</span></span>
<span id="cb63-123"><a href="#cb63-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">lm =</span> <span class="cn">TRUE</span>,  <span class="co"># Ajout des droites de régression</span></span>
<span id="cb63-124"><a href="#cb63-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"#69b3a2"</span>,</span>
<span id="cb63-125"><a href="#cb63-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,  <span class="co"># Transparence</span></span>
<span id="cb63-126"><a href="#cb63-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.labels =</span> <span class="fl">3.5</span>,  <span class="co"># Taille du texte des variables</span></span>
<span id="cb63-127"><a href="#cb63-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">font.labels =</span> <span class="dv">2</span>  <span class="co"># Mettre en gras</span></span>
<span id="cb63-128"><a href="#cb63-128" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-129"><a href="#cb63-129" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-130"><a href="#cb63-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-131"><a href="#cb63-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-132"><a href="#cb63-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-133"><a href="#cb63-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-134"><a href="#cb63-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-135"><a href="#cb63-135" aria-hidden="true" tabindex="-1"></a><span class="fu">### VIF plot</span></span>
<span id="cb63-136"><a href="#cb63-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-139"><a href="#cb63-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-140"><a href="#cb63-140" aria-hidden="true" tabindex="-1"></a>my_VIFplot <span class="ot">&lt;-</span> <span class="cf">function</span>(vif) {</span>
<span id="cb63-141"><a href="#cb63-141" aria-hidden="true" tabindex="-1"></a>  vif_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">names</span>(vif), <span class="at">VIF =</span> vif)</span>
<span id="cb63-142"><a href="#cb63-142" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-143"><a href="#cb63-143" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(vif_df, <span class="fu">aes</span>(</span>
<span id="cb63-144"><a href="#cb63-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">reorder</span>(Variable, VIF),</span>
<span id="cb63-145"><a href="#cb63-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">pmin</span>(VIF, <span class="dv">15</span>),</span>
<span id="cb63-146"><a href="#cb63-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> VIF <span class="sc">&gt;</span> <span class="dv">10</span></span>
<span id="cb63-147"><a href="#cb63-147" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb63-148"><a href="#cb63-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb63-149"><a href="#cb63-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(VIF <span class="sc">&gt;</span> <span class="dv">10</span>, <span class="fu">round</span>(VIF, <span class="dv">1</span>), <span class="st">""</span>)), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb63-150"><a href="#cb63-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb63-151"><a href="#cb63-151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>)) <span class="sc">+</span></span>
<span id="cb63-152"><a href="#cb63-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variance Inflation Factor (VIF)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"VIF (limité à 15)"</span>) <span class="sc">+</span></span>
<span id="cb63-153"><a href="#cb63-153" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-154"><a href="#cb63-154" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb63-155"><a href="#cb63-155" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">34</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb63-156"><a href="#cb63-156" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb63-157"><a href="#cb63-157" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">54</span>,</span>
<span id="cb63-158"><a href="#cb63-158" aria-hidden="true" tabindex="-1"></a>        <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb63-159"><a href="#cb63-159" aria-hidden="true" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb63-160"><a href="#cb63-160" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb63-161"><a href="#cb63-161" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">26</span>),</span>
<span id="cb63-162"><a href="#cb63-162" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb63-163"><a href="#cb63-163" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">30</span>),</span>
<span id="cb63-164"><a href="#cb63-164" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">38</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb63-165"><a href="#cb63-165" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-166"><a href="#cb63-166" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-167"><a href="#cb63-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb63-168"><a href="#cb63-168" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-169"><a href="#cb63-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-170"><a href="#cb63-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-171"><a href="#cb63-171" aria-hidden="true" tabindex="-1"></a><span class="fu">### Critères</span></span>
<span id="cb63-172"><a href="#cb63-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-173"><a href="#cb63-173" aria-hidden="true" tabindex="-1"></a>On rappel que $SCR = \sum_i (y_i - f(x_i))^2$ et $SCT = \sum_i (y_i - \bar{y})^2$.\</span>
<span id="cb63-174"><a href="#cb63-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-175"><a href="#cb63-175" aria-hidden="true" tabindex="-1"></a>Ainsi, on peut aretrouver les différents critères :</span>
<span id="cb63-176"><a href="#cb63-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-177"><a href="#cb63-177" aria-hidden="true" tabindex="-1"></a>$$ R^2 = 1 - \frac{SCR}{SCT}$$</span>
<span id="cb63-178"><a href="#cb63-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-181"><a href="#cb63-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-182"><a href="#cb63-182" aria-hidden="true" tabindex="-1"></a>r2_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb63-183"><a href="#cb63-183" aria-hidden="true" tabindex="-1"></a>  <span class="co"># r2 = SSE/SST = (SST - SSR)/SST = 1 - ssr/sst</span></span>
<span id="cb63-184"><a href="#cb63-184" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-185"><a href="#cb63-185" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SCR<span class="sc">/</span>SCT</span>
<span id="cb63-186"><a href="#cb63-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2)</span>
<span id="cb63-187"><a href="#cb63-187" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-188"><a href="#cb63-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-189"><a href="#cb63-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-190"><a href="#cb63-190" aria-hidden="true" tabindex="-1"></a>$$ R^2_{adjusted} = 1 - \frac{SCR (n-1)}{SCT(n-(p+1))}$$</span>
<span id="cb63-191"><a href="#cb63-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-194"><a href="#cb63-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-195"><a href="#cb63-195" aria-hidden="true" tabindex="-1"></a>r2a_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb63-196"><a href="#cb63-196" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb63-197"><a href="#cb63-197" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb63-198"><a href="#cb63-198" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-199"><a href="#cb63-199" aria-hidden="true" tabindex="-1"></a>  r2a <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SCR<span class="sc">/</span>(n<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">/</span>(SCT<span class="sc">/</span>(n<span class="dv">-1</span>))</span>
<span id="cb63-200"><a href="#cb63-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2a)</span>
<span id="cb63-201"><a href="#cb63-201" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-202"><a href="#cb63-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-203"><a href="#cb63-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-204"><a href="#cb63-204" aria-hidden="true" tabindex="-1"></a>$$ C_p = \frac{SCR}{\sigma^2} + 2(p+1) - n$$</span>
<span id="cb63-205"><a href="#cb63-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-208"><a href="#cb63-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-209"><a href="#cb63-209" aria-hidden="true" tabindex="-1"></a>cp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, SCR){</span>
<span id="cb63-210"><a href="#cb63-210" aria-hidden="true" tabindex="-1"></a>  sig <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb63-211"><a href="#cb63-211" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb63-212"><a href="#cb63-212" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb63-213"><a href="#cb63-213" aria-hidden="true" tabindex="-1"></a>  cp <span class="ot">&lt;-</span> SCR<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>) <span class="sc">-</span> n</span>
<span id="cb63-214"><a href="#cb63-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cp)</span>
<span id="cb63-215"><a href="#cb63-215" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-216"><a href="#cb63-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-217"><a href="#cb63-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-218"><a href="#cb63-218" aria-hidden="true" tabindex="-1"></a>$$ AIC = n\text{log}\left(\frac{SCR}{n}\right) + 2(p+1)$$</span>
<span id="cb63-219"><a href="#cb63-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-222"><a href="#cb63-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-223"><a href="#cb63-223" aria-hidden="true" tabindex="-1"></a>aic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb63-224"><a href="#cb63-224" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb63-225"><a href="#cb63-225" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb63-226"><a href="#cb63-226" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb63-227"><a href="#cb63-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(aic)</span>
<span id="cb63-228"><a href="#cb63-228" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-229"><a href="#cb63-229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-230"><a href="#cb63-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-231"><a href="#cb63-231" aria-hidden="true" tabindex="-1"></a>$$ BIC = n\text{log}\left(\frac{SCR}{n}\right) + \text{log}(n)(p+1)$$</span>
<span id="cb63-232"><a href="#cb63-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-235"><a href="#cb63-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-236"><a href="#cb63-236" aria-hidden="true" tabindex="-1"></a>bic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb63-237"><a href="#cb63-237" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb63-238"><a href="#cb63-238" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb63-239"><a href="#cb63-239" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="fu">log</span>(n)<span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb63-240"><a href="#cb63-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(bic)</span>
<span id="cb63-241"><a href="#cb63-241" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-242"><a href="#cb63-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-243"><a href="#cb63-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-244"><a href="#cb63-244" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot pour nos critères</span></span>
<span id="cb63-245"><a href="#cb63-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-248"><a href="#cb63-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-249"><a href="#cb63-249" aria-hidden="true" tabindex="-1"></a>Criteria_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(Criteria, <span class="at">crit_name =</span> <span class="st">"Critère"</span>) {</span>
<span id="cb63-250"><a href="#cb63-250" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création d'un data frame pour ggplot</span></span>
<span id="cb63-251"><a href="#cb63-251" aria-hidden="true" tabindex="-1"></a>  df_criteria <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb63-252"><a href="#cb63-252" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb_var =</span> <span class="fu">seq_along</span>(Criteria),  <span class="co"># Nombre de variables du modèle</span></span>
<span id="cb63-253"><a href="#cb63-253" aria-hidden="true" tabindex="-1"></a>    <span class="at">Criteria =</span> Criteria            <span class="co"># Critère</span></span>
<span id="cb63-254"><a href="#cb63-254" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-255"><a href="#cb63-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-256"><a href="#cb63-256" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création du plot avec ggplot2</span></span>
<span id="cb63-257"><a href="#cb63-257" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_criteria, <span class="fu">aes</span>(<span class="at">x =</span> nb_var, <span class="at">y =</span> Criteria)) <span class="sc">+</span></span>
<span id="cb63-258"><a href="#cb63-258" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb63-259"><a href="#cb63-259" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb63-260"><a href="#cb63-260" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb63-261"><a href="#cb63-261" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Évolution de"</span>, crit_name, <span class="st">"en fonction du nombre de variables"</span>),</span>
<span id="cb63-262"><a href="#cb63-262" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Nombre de variables sélectionnées"</span>,</span>
<span id="cb63-263"><a href="#cb63-263" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> crit_name</span>
<span id="cb63-264"><a href="#cb63-264" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb63-265"><a href="#cb63-265" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb63-266"><a href="#cb63-266" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb63-267"><a href="#cb63-267" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">26</span>),  <span class="co"># Titre centré et agrandi</span></span>
<span id="cb63-268"><a href="#cb63-268" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb63-269"><a href="#cb63-269" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb63-270"><a href="#cb63-270" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)</span>
<span id="cb63-271"><a href="#cb63-271" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-272"><a href="#cb63-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-273"><a href="#cb63-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(g)</span>
<span id="cb63-274"><a href="#cb63-274" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-275"><a href="#cb63-275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-276"><a href="#cb63-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-277"><a href="#cb63-277" aria-hidden="true" tabindex="-1"></a><span class="fu">### Meilleur modèle après regsubset</span></span>
<span id="cb63-278"><a href="#cb63-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-281"><a href="#cb63-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-282"><a href="#cb63-282" aria-hidden="true" tabindex="-1"></a>Best_model <span class="ot">&lt;-</span> <span class="cf">function</span>(model, criteria_df){</span>
<span id="cb63-283"><a href="#cb63-283" aria-hidden="true" tabindex="-1"></a>  <span class="do">## On a d'abord les critères à maximiser</span></span>
<span id="cb63-284"><a href="#cb63-284" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb63-285"><a href="#cb63-285" aria-hidden="true" tabindex="-1"></a>    criteria_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(criteria_df)[i]</span>
<span id="cb63-286"><a href="#cb63-286" aria-hidden="true" tabindex="-1"></a>    criteria <span class="ot">&lt;-</span> criteria_df[,i]</span>
<span id="cb63-287"><a href="#cb63-287" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-288"><a href="#cb63-288" aria-hidden="true" tabindex="-1"></a>    best_model_criteria <span class="ot">&lt;-</span> <span class="fu">which.max</span>(criteria)</span>
<span id="cb63-289"><a href="#cb63-289" aria-hidden="true" tabindex="-1"></a>    selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>which[best_model_criteria,]</span>
<span id="cb63-290"><a href="#cb63-290" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-291"><a href="#cb63-291" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Meilleur modèle selon"</span>, criteria_name, <span class="st">" = "</span>, <span class="fu">round</span>(<span class="fu">max</span>(criteria), <span class="dv">3</span>), <span class="st">" : Modèle avec"</span>, best_model_criteria, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb63-292"><a href="#cb63-292" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>]), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-293"><a href="#cb63-293" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-294"><a href="#cb63-294" aria-hidden="true" tabindex="-1"></a>  <span class="do">## On a ensuite les critères à minimiser</span></span>
<span id="cb63-295"><a href="#cb63-295" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb63-296"><a href="#cb63-296" aria-hidden="true" tabindex="-1"></a>    criteria_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(criteria_df)[i]</span>
<span id="cb63-297"><a href="#cb63-297" aria-hidden="true" tabindex="-1"></a>    criteria <span class="ot">&lt;-</span> criteria_df[,i]</span>
<span id="cb63-298"><a href="#cb63-298" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-299"><a href="#cb63-299" aria-hidden="true" tabindex="-1"></a>    best_model_criteria <span class="ot">&lt;-</span> <span class="fu">which.min</span>(criteria)</span>
<span id="cb63-300"><a href="#cb63-300" aria-hidden="true" tabindex="-1"></a>    selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>which[best_model_criteria,]</span>
<span id="cb63-301"><a href="#cb63-301" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-302"><a href="#cb63-302" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Meilleur modèle selon"</span>, criteria_name, <span class="st">" = "</span>, <span class="fu">round</span>(<span class="fu">min</span>(criteria), <span class="dv">3</span>),<span class="st">" : Modèle avec"</span>, best_model_criteria, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb63-303"><a href="#cb63-303" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>]), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-304"><a href="#cb63-304" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-305"><a href="#cb63-305" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-306"><a href="#cb63-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-307"><a href="#cb63-307" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-308"><a href="#cb63-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-309"><a href="#cb63-309" aria-hidden="true" tabindex="-1"></a><span class="fu">## Seed</span></span>
<span id="cb63-310"><a href="#cb63-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-313"><a href="#cb63-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-314"><a href="#cb63-314" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">140400</span>)</span>
<span id="cb63-315"><a href="#cb63-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-316"><a href="#cb63-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-317"><a href="#cb63-317" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb63-318"><a href="#cb63-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-319"><a href="#cb63-319" aria-hidden="true" tabindex="-1"></a><span class="fu"># Données</span></span>
<span id="cb63-320"><a href="#cb63-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-321"><a href="#cb63-321" aria-hidden="true" tabindex="-1"></a>Dans ce rapport, nous allons pouvoir illustrer deux grands problèmes qui apparaissent dans le domaine de la statistique en grande dimension :</span>
<span id="cb63-322"><a href="#cb63-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-323"><a href="#cb63-323" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>le biais de sélection</span>
<span id="cb63-324"><a href="#cb63-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-325"><a href="#cb63-325" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>et les corrélations fortuites</span>
<span id="cb63-326"><a href="#cb63-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-327"><a href="#cb63-327" aria-hidden="true" tabindex="-1"></a>Pour faire cela, nous nous baserons sur un jeu de données que l'on créera.  On génère alors</span>
<span id="cb63-328"><a href="#cb63-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-329"><a href="#cb63-329" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$y$ de taille $n=100$ avec $y_i \sim \mathcal{B}(0.5)$</span>
<span id="cb63-330"><a href="#cb63-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-331"><a href="#cb63-331" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$X$ qui contient $p=5000$ variables explicatives qui seront toutes des réalisations indépendantes de $n=100$ valeurs issues d'une loi $\mathcal{N}_{(0,1)}$ </span>
<span id="cb63-332"><a href="#cb63-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-333"><a href="#cb63-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-334"><a href="#cb63-334" aria-hidden="true" tabindex="-1"></a>Pour cela, nous pouvons utiliser les fonction de *`R`* qui permettent de générer des variables aléatoire.</span>
<span id="cb63-337"><a href="#cb63-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-338"><a href="#cb63-338" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb63-339"><a href="#cb63-339" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb63-340"><a href="#cb63-340" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb63-341"><a href="#cb63-341" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>p, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol =</span> p) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb63-342"><a href="#cb63-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-343"><a href="#cb63-343" aria-hidden="true" tabindex="-1"></a>Simu_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y, x) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb63-344"><a href="#cb63-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-345"><a href="#cb63-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-346"><a href="#cb63-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-347"><a href="#cb63-347" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb63-348"><a href="#cb63-348" aria-hidden="true" tabindex="-1"></a>Pour la variable $y$, il est possible de la simuler de manière deterministe <span class="in">`y &lt;- rep(c(0,1), n/2)`</span></span>
<span id="cb63-349"><a href="#cb63-349" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-350"><a href="#cb63-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-351"><a href="#cb63-351" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb63-352"><a href="#cb63-352" aria-hidden="true" tabindex="-1"></a>pour des raisons de repouctibilité, une graine ou seed a été défini dans le setup afin que la génération aléatoire reste identique.</span>
<span id="cb63-353"><a href="#cb63-353" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-354"><a href="#cb63-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-355"><a href="#cb63-355" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyse descriptive</span></span>
<span id="cb63-356"><a href="#cb63-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-357"><a href="#cb63-357" aria-hidden="true" tabindex="-1"></a><span class="fu">## Corrélation</span></span>
<span id="cb63-358"><a href="#cb63-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-359"><a href="#cb63-359" aria-hidden="true" tabindex="-1"></a>Maintenant, nous pouvons déjà souligner que, théoriquement, il ne devrait pas y avoir de lien entre $y$ et $X$ puisque les simulations sont faites indépendament. \</span>
<span id="cb63-360"><a href="#cb63-360" aria-hidden="true" tabindex="-1"></a>Pour visualiser cela, il suffit simplement de créer un vecteur qui stockera les différentes valeurs de corrélation entre $y$ et $x^i$ pour $i$ allant de 1 à 5000.</span>
<span id="cb63-361"><a href="#cb63-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-362"><a href="#cb63-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-363"><a href="#cb63-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb63-364"><a href="#cb63-364" aria-hidden="true" tabindex="-1"></a>cor_vect <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(x, <span class="cf">function</span>(col) <span class="fu">cor</span>(col, y)))</span>
<span id="cb63-365"><a href="#cb63-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-366"><a href="#cb63-366" aria-hidden="true" tabindex="-1"></a>my_hist <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb63-367"><a href="#cb63-367" aria-hidden="true" tabindex="-1"></a>  cor_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Correlation =</span> data)</span>
<span id="cb63-368"><a href="#cb63-368" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-369"><a href="#cb63-369" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cor_df, <span class="fu">aes</span>(<span class="at">x =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb63-370"><a href="#cb63-370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>,</span>
<span id="cb63-371"><a href="#cb63-371" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb63-372"><a href="#cb63-372" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb63-373"><a href="#cb63-373" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des corrélations entre y et les variables explicatives"</span>, <span class="at">x =</span> <span class="st">"Corrélation"</span>, <span class="at">y =</span> <span class="st">"Fréquence"</span>) <span class="sc">+</span></span>
<span id="cb63-374"><a href="#cb63-374" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-375"><a href="#cb63-375" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb63-376"><a href="#cb63-376" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb63-377"><a href="#cb63-377" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">16</span>,</span>
<span id="cb63-378"><a href="#cb63-378" aria-hidden="true" tabindex="-1"></a>        <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb63-379"><a href="#cb63-379" aria-hidden="true" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb63-380"><a href="#cb63-380" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb63-381"><a href="#cb63-381" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb63-382"><a href="#cb63-382" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb63-383"><a href="#cb63-383" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-384"><a href="#cb63-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb63-385"><a href="#cb63-385" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-386"><a href="#cb63-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-387"><a href="#cb63-387" aria-hidden="true" tabindex="-1"></a><span class="fu">my_hist</span>(cor_vect)</span>
<span id="cb63-388"><a href="#cb63-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-389"><a href="#cb63-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-390"><a href="#cb63-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-391"><a href="#cb63-391" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb63-392"><a href="#cb63-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-393"><a href="#cb63-393" aria-hidden="true" tabindex="-1"></a><span class="fu">## Texte</span></span>
<span id="cb63-394"><a href="#cb63-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-395"><a href="#cb63-395" aria-hidden="true" tabindex="-1"></a>De manière général, il faut savoir qu'une méthode de prévision de $y$ basée sur les variables explicatives s’exprime nécessairement sous la forme $\hat{y} = f(x^1, ..., x^{5000})$. La forme de la fonction $f$ étant généralement obtenue grâce à une estimation sur un échantillon d’apprentissage. Il faut alors découper notre jeu de données en deux échantillons, un pour l'apprentissage et un pour le test.\</span>
<span id="cb63-396"><a href="#cb63-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-397"><a href="#cb63-397" aria-hidden="true" tabindex="-1"></a>Dans ces méthodes, nous nous intéressons principalement au taux d’erreur de classification "test", c’est-à-dire à la probabilité que $\hat{y}$ soit différent de $y$, lorsque $y$ et $x^1, ..., x^{5000}$ sont dans l'échantillon test et donc indépendants de l’échantillon d’apprentissage.\</span>
<span id="cb63-398"><a href="#cb63-398" aria-hidden="true" tabindex="-1"></a>On peut facilement démontrer que cette probabilité est de 50% quelle que soit la méthode utilisée (cf **Preuve**).</span>
<span id="cb63-399"><a href="#cb63-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-400"><a href="#cb63-400" aria-hidden="true" tabindex="-1"></a>Pourtant, pour illustrer nos problèmes, supposons que nous avons observé le jeu de données simulé ci-dessus, sans connaître les liens théoriques entre les variables. Nous souhaitons alors ajuster un modèle expliquant au mieux $y$ en fonction des variables à disposition, et estimer le taux d’erreur des prévisions associées.</span>
<span id="cb63-401"><a href="#cb63-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-402"><a href="#cb63-402" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preuve</span></span>
<span id="cb63-403"><a href="#cb63-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-404"><a href="#cb63-404" aria-hidden="true" tabindex="-1"></a>Nous remarquons déjà que, $\hat{y}$ étant une combinaisons de nos variables $x^1, ..., x^{5000}$ qui sont indépendantes de $y$, on a $\hat{y}$ et y sont deux variables indépendantes l'une de l'autre.\</span>
<span id="cb63-405"><a href="#cb63-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-406"><a href="#cb63-406" aria-hidden="true" tabindex="-1"></a>Ainsi</span>
<span id="cb63-407"><a href="#cb63-407" aria-hidden="true" tabindex="-1"></a>$$\mathbb{P}(\hat{y} \neq y) = \mathbb{P}(\hat{y}=0, y=1) + \mathbb{P}(\hat{y}=1, y=0)$$</span>
<span id="cb63-408"><a href="#cb63-408" aria-hidden="true" tabindex="-1"></a>$$ \quad \quad \quad \quad \quad \quad \quad \quad = \mathbb{P}(\hat{y}=0)\mathbb{P}(y=1) + \mathbb{P}(\hat{y}=1)\mathbb{P}(y=0) \quad  ^{(*)}$$</span>
<span id="cb63-409"><a href="#cb63-409" aria-hidden="true" tabindex="-1"></a>$$ \quad \quad \quad \quad = 0.5\mathbb{P}(\hat{y}=0) + 0.5\mathbb{P}(\hat{y}=1)  \quad  ^{(**)} $$</span>
<span id="cb63-410"><a href="#cb63-410" aria-hidden="true" tabindex="-1"></a>$$ \quad \quad = 0.5 \left( \mathbb{P}(\hat{y}=0) + \mathbb{P}(\hat{y}=1) \right)$$</span>
<span id="cb63-411"><a href="#cb63-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-412"><a href="#cb63-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-413"><a href="#cb63-413" aria-hidden="true" tabindex="-1"></a>Nous reconnaissons ici une somme sur l'univers des possible de la densité discrète de $\hat{y}$.\</span>
<span id="cb63-414"><a href="#cb63-414" aria-hidden="true" tabindex="-1"></a>Celle ci est donc égale à 1 et on obtient</span>
<span id="cb63-415"><a href="#cb63-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-416"><a href="#cb63-416" aria-hidden="true" tabindex="-1"></a>$$\mathbb{P}(\hat{y} \neq y) = 0.5$$</span>
<span id="cb63-417"><a href="#cb63-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-418"><a href="#cb63-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-419"><a href="#cb63-419" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$^{(*)} \quad \text{par indépendance de} \quad \hat{y} \quad \text{et} \quad y$</span>
<span id="cb63-420"><a href="#cb63-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-421"><a href="#cb63-421" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$^{(**)} \quad \text{car} \quad y \quad \text{suit une loi de Bernoulli de paramètre} \quad 0.5$</span>
<span id="cb63-422"><a href="#cb63-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-423"><a href="#cb63-423" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-424"><a href="#cb63-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-425"><a href="#cb63-425" aria-hidden="true" tabindex="-1"></a><span class="fu"># Biais de sélection</span></span>
<span id="cb63-426"><a href="#cb63-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-427"><a href="#cb63-427" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb63-428"><a href="#cb63-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-429"><a href="#cb63-429" aria-hidden="true" tabindex="-1"></a><span class="fu">## Texte</span></span>
<span id="cb63-430"><a href="#cb63-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-431"><a href="#cb63-431" aria-hidden="true" tabindex="-1"></a>Étant donné le très grand nombre de variables explicatives, on ne va garder que les 5 variables les plus corrélées avec $y$ afin d’ajuster un modèle</span>
<span id="cb63-432"><a href="#cb63-432" aria-hidden="true" tabindex="-1"></a>de régression logistique. Pour quantifier la corrélation entre la variable $y$, qui est binaire, et une variable quantitative, deux possibilités s’offrent :</span>
<span id="cb63-433"><a href="#cb63-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-434"><a href="#cb63-434" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>utiliser la corrélation de Pearson $\hat{\rho}$ comme si $y$ était une variable</span>
<span id="cb63-435"><a href="#cb63-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-436"><a href="#cb63-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-437"><a href="#cb63-437" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>utiliser le "rapport de corrélation" quantifiant le lien entre une variable qualitative et une variable quantitative : </span>
<span id="cb63-438"><a href="#cb63-438" aria-hidden="true" tabindex="-1"></a>$$\hat{\eta}^2 = \frac{S^2_{inter}}{S^2_{total}}$$</span>
<span id="cb63-439"><a href="#cb63-439" aria-hidden="true" tabindex="-1"></a>où $S^2_{inter}$ est la somme des carrés "inter-classes" et $S^2_{total}$ la somme des carrés</span>
<span id="cb63-440"><a href="#cb63-440" aria-hidden="true" tabindex="-1"></a>total.</span>
<span id="cb63-441"><a href="#cb63-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-442"><a href="#cb63-442" aria-hidden="true" tabindex="-1"></a>Par chance, dans notre cas nous avons que $\hat{\eta}^2 = \hat{\rho}^2$.\</span>
<span id="cb63-443"><a href="#cb63-443" aria-hidden="true" tabindex="-1"></a>Mais rassurez vous, la chance n'ayant pas forcément sa place en mathématiques, la démonstration de cette égalité pourra être trouvé dans la partie **Preuve**\</span>
<span id="cb63-444"><a href="#cb63-444" aria-hidden="true" tabindex="-1"></a>Ainsi, la corrélation de Pearson pourra suffire pour quantifier le lien entre notre variable binaire et nos variables explicatives. Ce qui tombe bien puisqu'il s'agit de la méthode de corrélation par défaut sous $\textit{R}$ quand on utilise la fonction $\textit{cor}$.\</span>
<span id="cb63-445"><a href="#cb63-445" aria-hidden="true" tabindex="-1"></a>Nous allons donc pouvoir garder les 5 variables les plus corrélées en valeur absolue avec $y$ et ajuster un modèle de régression logistique faisant intervenir ces 5 variables.</span>
<span id="cb63-446"><a href="#cb63-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-447"><a href="#cb63-447" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preuve</span></span>
<span id="cb63-448"><a href="#cb63-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-449"><a href="#cb63-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-450"><a href="#cb63-450" aria-hidden="true" tabindex="-1"></a>Nous voulons ici montrer que dans le cas des donnés que nous simulons, il y a égalité entre les deux coefficients suivants.</span>
<span id="cb63-451"><a href="#cb63-451" aria-hidden="true" tabindex="-1"></a>$$\hat{\rho}^2 = \left(\frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y}) }{\sqrt{\sum_{i=1}^n (x_i - \bar{x})^2} \sqrt{\sum_{i=1}^n(y_i -\bar{y})^2}}\right)^2$$</span>
<span id="cb63-452"><a href="#cb63-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-453"><a href="#cb63-453" aria-hidden="true" tabindex="-1"></a>$$\hat{\eta}^2 = \frac{\sum_{k=0}^1 n_k(\bar{x}_k - \bar{x})^2}{\sum_{i=1}^n (x_i - \bar{x})^2}$$</span>
<span id="cb63-454"><a href="#cb63-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-455"><a href="#cb63-455" aria-hidden="true" tabindex="-1"></a>Nous pouvons déjà reconnaitre un terme en commun.\</span>
<span id="cb63-456"><a href="#cb63-456" aria-hidden="true" tabindex="-1"></a>Pour des raisons de simplicité, on notera $S_x^2 = \sum_{i=1}^n (x_i - \bar{x})^2$\</span>
<span id="cb63-457"><a href="#cb63-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-458"><a href="#cb63-458" aria-hidden="true" tabindex="-1"></a>Nous pouvons alors manipuler un peu les termes de $\hat{\rho}$\</span>
<span id="cb63-459"><a href="#cb63-459" aria-hidden="true" tabindex="-1"></a>$\sum_{i=1}^n (x_i-\bar{x})(y_i - \bar{y})= \sum_{i=1}^n x_iy_i - n\bar{x}\bar{y}$\</span>
<span id="cb63-460"><a href="#cb63-460" aria-hidden="true" tabindex="-1"></a>et\</span>
<span id="cb63-461"><a href="#cb63-461" aria-hidden="true" tabindex="-1"></a>$\sum_{i=1}^n(y_i -\bar{y})^2= \sum_{i=1}^n y_i^2 - n\bar{y}^2$\</span>
<span id="cb63-462"><a href="#cb63-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-463"><a href="#cb63-463" aria-hidden="true" tabindex="-1"></a>Maintenant, rappelons que dans notre cas précis, $\forall i=1, ...,n$ où $n=100$, $y_i \sim \mathcal{B}(0.5)$. Nous pouvons donc supposer qu'idéalement on a une parfaite séparation en deux groupes avec autant de 0 que de 1. Et ainsi en déduire les simplifications suivantes :</span>
<span id="cb63-464"><a href="#cb63-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-465"><a href="#cb63-465" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\sum_{i=1}^n y_i^2 = \sum_{i=1}^n y_i$</span>
<span id="cb63-466"><a href="#cb63-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-467"><a href="#cb63-467" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\bar{y} = \frac{n_1}{n}$</span>
<span id="cb63-468"><a href="#cb63-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-469"><a href="#cb63-469" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\sum_{i=1}^n x_iy_i = n_1\bar{x}_1 \quad$ puisque l'on multipli par $0$ les $x_i$ associés au groupe $0$</span>
<span id="cb63-470"><a href="#cb63-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-471"><a href="#cb63-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-472"><a href="#cb63-472" aria-hidden="true" tabindex="-1"></a>Dès lors, nous avons $\hat{\eta}^2 = \frac{n_0(\bar{x}_0 - \bar{x})^2 + n_1(\bar{x}_1 - \bar{x})^2}{S_x^2}$ et </span>
<span id="cb63-473"><a href="#cb63-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-474"><a href="#cb63-474" aria-hidden="true" tabindex="-1"></a>$$\hat{\rho}^2 = \frac{1}{S_x^2} \times \frac{(n_1\bar{x}_1 - n_1\bar{x})^2}{n_1 - \frac{n_1^2}{n}}$$</span>
<span id="cb63-475"><a href="#cb63-475" aria-hidden="true" tabindex="-1"></a>    $$\quad  = \frac{1}{S_x^2} \times \frac{n_1(\bar{x}_1 - \bar{x})^2}{1 - \frac{n_1}{n}}$$</span>
<span id="cb63-476"><a href="#cb63-476" aria-hidden="true" tabindex="-1"></a>    $$\quad  = \frac{1}{S_x^2} \times \frac{n_1(\bar{x}_1 - \bar{x})^2}{\frac{n_0}{n}}$$</span>
<span id="cb63-477"><a href="#cb63-477" aria-hidden="true" tabindex="-1"></a>    $$\quad \quad = \frac{1}{S_x^2} \times \frac{n n_1(\bar{x}_1 - \bar{x})^2}{n_0}$$</span>
<span id="cb63-478"><a href="#cb63-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-479"><a href="#cb63-479" aria-hidden="true" tabindex="-1"></a>Cela veut donc dire que l'on cherchera à montrer que</span>
<span id="cb63-480"><a href="#cb63-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-481"><a href="#cb63-481" aria-hidden="true" tabindex="-1"></a>$$\frac{n n_1(\bar{x}_1 - \bar{x})^2}{n_0} = n_0(\bar{x}_0 - \bar{x})^2 + n_1(\bar{x}_1 - \bar{x})^2$$    </span>
<span id="cb63-482"><a href="#cb63-482" aria-hidden="true" tabindex="-1"></a>$$\quad \quad \Leftrightarrow 1 = \frac{n_0^2(\bar{x}_0 - \bar{x})^2}{n n_1(\bar{x}_1 - \bar{x})^2} \times \frac{n_0}{n}$$</span>
<span id="cb63-483"><a href="#cb63-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-484"><a href="#cb63-484" aria-hidden="true" tabindex="-1"></a>Mais si on suppose que $y$ est "parfaitement équilibrée", c'est à dire qu'il y aurait autant de 0 que de 1, on aura que $n_0 = n_1 = \frac{n}{2}$ et aussi </span>
<span id="cb63-485"><a href="#cb63-485" aria-hidden="true" tabindex="-1"></a>$$n\bar{x} = n_0\bar{x}_0 + n_1\bar{x}_1 \Leftrightarrow \bar{x} = \frac{1}{2}(\bar{x}_0 + \bar{x}_1) \Leftrightarrow \bar{x}-\bar{x}_0 = \bar{x}_1 - \bar{x}$$</span>
<span id="cb63-486"><a href="#cb63-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-487"><a href="#cb63-487" aria-hidden="true" tabindex="-1"></a>\noindent Nous aurons donc que $(\bar{x}_0-\bar{x})^2  = (\bar{x}_1 - \bar{x})^2$</span>
<span id="cb63-488"><a href="#cb63-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-489"><a href="#cb63-489" aria-hidden="true" tabindex="-1"></a>Finalement,</span>
<span id="cb63-490"><a href="#cb63-490" aria-hidden="true" tabindex="-1"></a>$$\frac{n_0^2(\bar{x}_0 - \bar{x})^2}{n n_1(\bar{x}_1 - \bar{x})^2} \times \frac{n_0}{n} = \frac{(\frac{n}{2})^2}{n (\frac{n}{2})} + \frac{(\frac{n}{2})}{n}$$</span>
<span id="cb63-491"><a href="#cb63-491" aria-hidden="true" tabindex="-1"></a>  $$\quad \quad \quad \quad \quad \quad = \frac{(\frac{n}{2})}{n} + \frac{(\frac{n}{2})}{n}$$</span>
<span id="cb63-492"><a href="#cb63-492" aria-hidden="true" tabindex="-1"></a>    $$\quad \quad \quad \quad \quad \quad = \frac{1}{2} + \frac{1}{2}$$</span>
<span id="cb63-493"><a href="#cb63-493" aria-hidden="true" tabindex="-1"></a>    $$\quad \quad \quad \quad \quad \quad= 1$$</span>
<span id="cb63-494"><a href="#cb63-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-495"><a href="#cb63-495" aria-hidden="true" tabindex="-1"></a>Dans la situation que nous avons ici, nous pouvons donc conclure que $\hat{\rho}^2 = \hat{\eta}^2$. On peut également supposer que cette égalité reste approximativement vrai dans des cas où "l'équilibre" n'est pas parfait.</span>
<span id="cb63-496"><a href="#cb63-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-497"><a href="#cb63-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-498"><a href="#cb63-498" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb63-499"><a href="#cb63-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-500"><a href="#cb63-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-501"><a href="#cb63-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-504"><a href="#cb63-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-505"><a href="#cb63-505" aria-hidden="true" tabindex="-1"></a>keep_variables <span class="ot">&lt;-</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing=</span><span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb63-506"><a href="#cb63-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-507"><a href="#cb63-507" aria-hidden="true" tabindex="-1"></a>Sub_Simu_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(y, x[,keep_variables]))</span>
<span id="cb63-508"><a href="#cb63-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-509"><a href="#cb63-509" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> Sub_Simu_data, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb63-510"><a href="#cb63-510" aria-hidden="true" tabindex="-1"></a>mod <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb63-511"><a href="#cb63-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-512"><a href="#cb63-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-513"><a href="#cb63-513" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-514"><a href="#cb63-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-515"><a href="#cb63-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-516"><a href="#cb63-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-517"><a href="#cb63-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-518"><a href="#cb63-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-519"><a href="#cb63-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-520"><a href="#cb63-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-521"><a href="#cb63-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-522"><a href="#cb63-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-523"><a href="#cb63-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-524"><a href="#cb63-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-525"><a href="#cb63-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-526"><a href="#cb63-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-527"><a href="#cb63-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-528"><a href="#cb63-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-529"><a href="#cb63-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-530"><a href="#cb63-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-531"><a href="#cb63-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-532"><a href="#cb63-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-533"><a href="#cb63-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-534"><a href="#cb63-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-535"><a href="#cb63-535" aria-hidden="true" tabindex="-1"></a><span class="fu"># Correlations fortuites</span></span>
<span id="cb63-536"><a href="#cb63-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-537"><a href="#cb63-537" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb63-538"><a href="#cb63-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-539"><a href="#cb63-539" aria-hidden="true" tabindex="-1"></a>En conclusion, avec cette étude nous avons pu illustrer deux grands problèmes que nous pouvons observer dans le cas de la Statistique en grande dimension. \</span>
<span id="cb63-540"><a href="#cb63-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-541"><a href="#cb63-541" aria-hidden="true" tabindex="-1"></a>Nous avons le **biais de sélection** qui arrive lorsque l'on utilise notre échantillon test dans la sélection de variable ou l'ajustement du modèle. Et donc quand on confronte nos prévisions à l'échantillon test, ces dernières seront beaucoup trop optimistes. C'est pour ca que la séparation de notre échantillon doit être faite avant la sélection de nos variables.\</span>
<span id="cb63-542"><a href="#cb63-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-543"><a href="#cb63-543" aria-hidden="true" tabindex="-1"></a>Puis, il y a la **corrélation fortuite** qui est propre à la grande dimension et qui nous montre qu'il faut bien connaître nos données. Lorsque l'on veut construire un modèle, il faut déjà avoir une connaissance sur les variables qui peuvent être liées. Et si on cherche des corrélation sur un jeu de grande dimension, on risque probablement d'en trouver même si théoriquement il n'y en à pas.\</span>
<span id="cb63-544"><a href="#cb63-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-545"><a href="#cb63-545" aria-hidden="true" tabindex="-1"></a>Nous voyons donc qu'il faut comprendre les données sur lesquelles nous travaillons et même si les ordinateurs sont des outils performants, il faut que le statisticien garde toujours un regard critique sur les résultats.</span>
<span id="cb63-546"><a href="#cb63-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-547"><a href="#cb63-547" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session info</span></span>
<span id="cb63-548"><a href="#cb63-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-551"><a href="#cb63-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-552"><a href="#cb63-552" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>(<span class="at">pkgs =</span> <span class="st">"attached"</span>)</span>
<span id="cb63-553"><a href="#cb63-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-554"><a href="#cb63-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-555"><a href="#cb63-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-556"><a href="#cb63-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-557"><a href="#cb63-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-558"><a href="#cb63-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-559"><a href="#cb63-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-560"><a href="#cb63-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-561"><a href="#cb63-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-562"><a href="#cb63-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-563"><a href="#cb63-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-564"><a href="#cb63-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-565"><a href="#cb63-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-566"><a href="#cb63-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-567"><a href="#cb63-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-568"><a href="#cb63-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-569"><a href="#cb63-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-570"><a href="#cb63-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-571"><a href="#cb63-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-572"><a href="#cb63-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-573"><a href="#cb63-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-574"><a href="#cb63-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-577"><a href="#cb63-577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-578"><a href="#cb63-578" aria-hidden="true" tabindex="-1"></a><span class="co"># We simulate our Data Frame</span></span>
<span id="cb63-579"><a href="#cb63-579" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb63-580"><a href="#cb63-580" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb63-581"><a href="#cb63-581" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span><span class="dv">5000</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">5000</span>)</span>
<span id="cb63-582"><a href="#cb63-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-583"><a href="#cb63-583" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">cbind.data.frame</span>(y, X)</span>
<span id="cb63-584"><a href="#cb63-584" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df) <span class="co"># We can verify the dimensions</span></span>
<span id="cb63-585"><a href="#cb63-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-586"><a href="#cb63-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-587"><a href="#cb63-587" aria-hidden="true" tabindex="-1"></a><span class="co"># Other way to simulate </span></span>
<span id="cb63-588"><a href="#cb63-588" aria-hidden="true" tabindex="-1"></a><span class="co">#y = rep(c(0,1), n/2)</span></span>
<span id="cb63-589"><a href="#cb63-589" aria-hidden="true" tabindex="-1"></a><span class="co">#X = matrix(rnorm(n*5000,0,1), ncol = 5000)</span></span>
<span id="cb63-590"><a href="#cb63-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-591"><a href="#cb63-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-592"><a href="#cb63-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-593"><a href="#cb63-593" aria-hidden="true" tabindex="-1"></a>Statistique descriptive </span>
<span id="cb63-594"><a href="#cb63-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-597"><a href="#cb63-597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-598"><a href="#cb63-598" aria-hidden="true" tabindex="-1"></a><span class="co"># We build a vector to store the correlation between y and each explanatory variables</span></span>
<span id="cb63-599"><a href="#cb63-599" aria-hidden="true" tabindex="-1"></a>cor_vect <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X)[<span class="dv">2</span>]</span>
<span id="cb63-600"><a href="#cb63-600" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X)[<span class="dv">2</span>]){</span>
<span id="cb63-601"><a href="#cb63-601" aria-hidden="true" tabindex="-1"></a>  cor_vect[i]<span class="ot">=</span><span class="fu">cor</span>(X[,i],y)</span>
<span id="cb63-602"><a href="#cb63-602" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-603"><a href="#cb63-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-604"><a href="#cb63-604" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(cor_vect,</span>
<span id="cb63-605"><a href="#cb63-605" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span><span class="st">"Histogram of the correlation between</span></span>
<span id="cb63-606"><a href="#cb63-606" aria-hidden="true" tabindex="-1"></a><span class="st">     y and the explanatory variables"</span>,</span>
<span id="cb63-607"><a href="#cb63-607" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Correlation"</span>,</span>
<span id="cb63-608"><a href="#cb63-608" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb63-609"><a href="#cb63-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-610"><a href="#cb63-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-611"><a href="#cb63-611" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 2</span></span>
<span id="cb63-612"><a href="#cb63-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-613"><a href="#cb63-613" aria-hidden="true" tabindex="-1"></a>Quel est le lien attendu entre y et les variables explicatives ?</span>
<span id="cb63-614"><a href="#cb63-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-615"><a href="#cb63-615" aria-hidden="true" tabindex="-1"></a>On s'attend à ce qu'il n'y ait pas forcément de lien puisqu'on est dans les cas de variables aléatoires créées indépendamment </span>
<span id="cb63-616"><a href="#cb63-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-617"><a href="#cb63-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-618"><a href="#cb63-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-619"><a href="#cb63-619" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 3</span></span>
<span id="cb63-620"><a href="#cb63-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-621"><a href="#cb63-621" aria-hidden="true" tabindex="-1"></a>Une méthode de prévision de y basée sur les variables explicatives $x^1, ..., x^{5000}$ s’exprime nécessairement sous la forme $\hat{y} = f(x^1, ..., x^{5000})$. La forme de la fonction $f$ est généralement obtenue grâce à une estimation sur un échantillon d’apprentissage. On s’intéresse au taux d’erreur de classification "test", c’est-à-dire à la probabilité que $\hat{y}$ soit différent de $y$, lorsque $y$ et $x^1, ..., x^{5000}$ sont indépendants de l’échantillon d’apprentissage.</span>
<span id="cb63-622"><a href="#cb63-622" aria-hidden="true" tabindex="-1"></a>Montrer que quelle que soit la méthode utilisée, le taux d’erreur sera de 50%</span>
<span id="cb63-623"><a href="#cb63-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-624"><a href="#cb63-624" aria-hidden="true" tabindex="-1"></a>FAIRE SUR PAPIER</span>
<span id="cb63-625"><a href="#cb63-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-626"><a href="#cb63-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-627"><a href="#cb63-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-628"><a href="#cb63-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-629"><a href="#cb63-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-630"><a href="#cb63-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-631"><a href="#cb63-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-632"><a href="#cb63-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-633"><a href="#cb63-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-634"><a href="#cb63-634" aria-hidden="true" tabindex="-1"></a>Dans la suite de l’exercice, on suppose qu’on a observé le jeu de données</span>
<span id="cb63-635"><a href="#cb63-635" aria-hidden="true" tabindex="-1"></a>simulé ci-dessus, sans connaître les liens théoriques entre les variables. On</span>
<span id="cb63-636"><a href="#cb63-636" aria-hidden="true" tabindex="-1"></a>souhaite ajuster un modèle expliquant au mieux $y$ en fonction des variables à</span>
<span id="cb63-637"><a href="#cb63-637" aria-hidden="true" tabindex="-1"></a>disposition, et estimer le taux d’erreur des prévisions associées. Etant donné</span>
<span id="cb63-638"><a href="#cb63-638" aria-hidden="true" tabindex="-1"></a>le très grand nombre de variables explicatives, un statisticien décide de ne</span>
<span id="cb63-639"><a href="#cb63-639" aria-hidden="true" tabindex="-1"></a>garder que les 5 variables les plus corrélées avec $y$ afin d’ajuster un modèle</span>
<span id="cb63-640"><a href="#cb63-640" aria-hidden="true" tabindex="-1"></a>de régression logistique.</span>
<span id="cb63-641"><a href="#cb63-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-642"><a href="#cb63-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-643"><a href="#cb63-643" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 4</span></span>
<span id="cb63-644"><a href="#cb63-644" aria-hidden="true" tabindex="-1"></a>Pour quantifier la corrélation entre la variable y, qui est binaire, et une</span>
<span id="cb63-645"><a href="#cb63-645" aria-hidden="true" tabindex="-1"></a>variable quantitative, deux possibilités s’offrent a priori au statisticien :</span>
<span id="cb63-646"><a href="#cb63-646" aria-hidden="true" tabindex="-1"></a>(i) soit utiliser la corrélation de Pearson $\hat{\rho}$ (comme si $y$ était une variable</span>
<span id="cb63-647"><a href="#cb63-647" aria-hidden="true" tabindex="-1"></a>quantitative),</span>
<span id="cb63-648"><a href="#cb63-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-651"><a href="#cb63-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-652"><a href="#cb63-652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-653"><a href="#cb63-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-654"><a href="#cb63-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-655"><a href="#cb63-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-656"><a href="#cb63-656" aria-hidden="true" tabindex="-1"></a>(ii) soit utiliser le "rapport de corrélation" quantifiant le lien entre une variable qualitative et une variable quantitative :</span>
<span id="cb63-657"><a href="#cb63-657" aria-hidden="true" tabindex="-1"></a>$$\hat{\eta}^2 = \frac{S^2_{inter}}{S^2_{total}}$$</span>
<span id="cb63-658"><a href="#cb63-658" aria-hidden="true" tabindex="-1"></a>où $S^2_{inter}$ est la somme des carrés "inter-classes" et $S^2_{total}$ la somme des carrés</span>
<span id="cb63-659"><a href="#cb63-659" aria-hidden="true" tabindex="-1"></a>total.</span>
<span id="cb63-660"><a href="#cb63-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-663"><a href="#cb63-663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-664"><a href="#cb63-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-665"><a href="#cb63-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-666"><a href="#cb63-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-667"><a href="#cb63-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-668"><a href="#cb63-668" aria-hidden="true" tabindex="-1"></a>Montrer que dans notre cas :</span>
<span id="cb63-669"><a href="#cb63-669" aria-hidden="true" tabindex="-1"></a>$$ \hat{\eta}^2 = \hat{\rho}^2 $$ </span>
<span id="cb63-670"><a href="#cb63-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-671"><a href="#cb63-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-672"><a href="#cb63-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-673"><a href="#cb63-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-674"><a href="#cb63-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-675"><a href="#cb63-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-676"><a href="#cb63-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-677"><a href="#cb63-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-678"><a href="#cb63-678" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 5</span></span>
<span id="cb63-679"><a href="#cb63-679" aria-hidden="true" tabindex="-1"></a>Quelles sont les 5 variables les plus corrélées (en valeur absolue) avec $y$ ?</span>
<span id="cb63-680"><a href="#cb63-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-683"><a href="#cb63-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-684"><a href="#cb63-684" aria-hidden="true" tabindex="-1"></a><span class="co"># We can isolate the highest correlations (positive or negative)</span></span>
<span id="cb63-685"><a href="#cb63-685" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing=</span><span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] </span>
<span id="cb63-686"><a href="#cb63-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-687"><a href="#cb63-687" aria-hidden="true" tabindex="-1"></a><span class="co"># We see that we have no correlation above 40%</span></span>
<span id="cb63-688"><a href="#cb63-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-689"><a href="#cb63-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-692"><a href="#cb63-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-693"><a href="#cb63-693" aria-hidden="true" tabindex="-1"></a><span class="co"># We isolate the index of the 5 variables with the highest correlation </span></span>
<span id="cb63-694"><a href="#cb63-694" aria-hidden="true" tabindex="-1"></a>index <span class="ot">=</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing=</span><span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb63-695"><a href="#cb63-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-696"><a href="#cb63-696" aria-hidden="true" tabindex="-1"></a><span class="co"># We create our new Data Frame</span></span>
<span id="cb63-697"><a href="#cb63-697" aria-hidden="true" tabindex="-1"></a>df_cut <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(y, X[,index]))</span>
<span id="cb63-698"><a href="#cb63-698" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df_cut)</span>
<span id="cb63-699"><a href="#cb63-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-700"><a href="#cb63-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-701"><a href="#cb63-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-702"><a href="#cb63-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-703"><a href="#cb63-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-704"><a href="#cb63-704" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 6</span></span>
<span id="cb63-705"><a href="#cb63-705" aria-hidden="true" tabindex="-1"></a>Ajuster un modèle de régression logistique faisant intervenir ces 5 variables et analyser la qualité du modèle.</span>
<span id="cb63-706"><a href="#cb63-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-709"><a href="#cb63-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-710"><a href="#cb63-710" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">glm</span>(y<span class="sc">~</span>., <span class="at">data =</span> df_cut, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb63-711"><a href="#cb63-711" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb63-712"><a href="#cb63-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-713"><a href="#cb63-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-714"><a href="#cb63-714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-715"><a href="#cb63-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-716"><a href="#cb63-716" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 7</span></span>
<span id="cb63-717"><a href="#cb63-717" aria-hidden="true" tabindex="-1"></a>Afin d’estimer le taux d’erreur de classification associé à ce modèle, le statisticien décide de procéder à une validation croisée K-fold avec K = 10.</span>
<span id="cb63-718"><a href="#cb63-718" aria-hidden="true" tabindex="-1"></a>Estimer de cette manière le taux d’erreur.</span>
<span id="cb63-719"><a href="#cb63-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-720"><a href="#cb63-720" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb63-721"><a href="#cb63-721" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb63-722"><a href="#cb63-722" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-723"><a href="#cb63-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-726"><a href="#cb63-726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-727"><a href="#cb63-727" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">=</span> <span class="cf">function</span>(r, pi ){</span>
<span id="cb63-728"><a href="#cb63-728" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(r <span class="sc">-</span> pi) <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb63-729"><a href="#cb63-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(c)</span>
<span id="cb63-730"><a href="#cb63-730" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb63-731"><a href="#cb63-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-732"><a href="#cb63-732" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross validation K-fold</span></span>
<span id="cb63-733"><a href="#cb63-733" aria-hidden="true" tabindex="-1"></a><span class="fu">cv.glm</span>(df_cut, fit, cost, <span class="dv">10</span>)<span class="sc">$</span>delta[<span class="dv">1</span>] </span>
<span id="cb63-734"><a href="#cb63-734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-735"><a href="#cb63-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-736"><a href="#cb63-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-737"><a href="#cb63-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-738"><a href="#cb63-738" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 8</span></span>
<span id="cb63-739"><a href="#cb63-739" aria-hidden="true" tabindex="-1"></a>Recommencer 10 fois la démarche précédente, c’est à dire les questions 1.,</span>
<span id="cb63-740"><a href="#cb63-740" aria-hidden="true" tabindex="-1"></a>5., 6. et 7, et stocker les 10 taux d’erreurs estimés. Que valent ces estimations. Quelle est leur moyenne ? Ces résultats sont-ils conformes à la valeur</span>
<span id="cb63-741"><a href="#cb63-741" aria-hidden="true" tabindex="-1"></a>théorique attendue ?</span>
<span id="cb63-742"><a href="#cb63-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-745"><a href="#cb63-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-746"><a href="#cb63-746" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb63-747"><a href="#cb63-747" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>K <span class="co"># Vector to store the raw cross-validation estimate of prediction error</span></span>
<span id="cb63-748"><a href="#cb63-748" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb63-749"><a href="#cb63-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(i, <span class="st">"-&gt;"</span>)) <span class="co"># counter to see progress</span></span>
<span id="cb63-750"><a href="#cb63-750" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-751"><a href="#cb63-751" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We recreate our explanatory variables and look at correlations</span></span>
<span id="cb63-752"><a href="#cb63-752" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span><span class="dv">5000</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">5000</span>)</span>
<span id="cb63-753"><a href="#cb63-753" aria-hidden="true" tabindex="-1"></a>  cor_vect <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X)[<span class="dv">2</span>]</span>
<span id="cb63-754"><a href="#cb63-754" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X)[<span class="dv">2</span>]){</span>
<span id="cb63-755"><a href="#cb63-755" aria-hidden="true" tabindex="-1"></a>    cor_vect[j] <span class="ot">=</span> <span class="fu">cor</span>(X[,j], y)</span>
<span id="cb63-756"><a href="#cb63-756" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-757"><a href="#cb63-757" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-758"><a href="#cb63-758" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We keep the variables with the higher correlation</span></span>
<span id="cb63-759"><a href="#cb63-759" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">=</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing =</span> T)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb63-760"><a href="#cb63-760" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(y, X[, index]))</span>
<span id="cb63-761"><a href="#cb63-761" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-762"><a href="#cb63-762" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We fit our glm</span></span>
<span id="cb63-763"><a href="#cb63-763" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">=</span> <span class="fu">glm</span>(y<span class="sc">~</span>., <span class="at">data =</span> tab, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb63-764"><a href="#cb63-764" aria-hidden="true" tabindex="-1"></a>  res[i] <span class="ot">=</span> <span class="fu">cv.glm</span>(tab, fit, cost, <span class="dv">10</span>)<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb63-765"><a href="#cb63-765" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-766"><a href="#cb63-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-769"><a href="#cb63-769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-770"><a href="#cb63-770" aria-hidden="true" tabindex="-1"></a>res</span>
<span id="cb63-771"><a href="#cb63-771" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(res)</span>
<span id="cb63-772"><a href="#cb63-772" aria-hidden="true" tabindex="-1"></a><span class="co"># erreur dans notre demarche, pas normal on obtient 0.22 alors que c'est 0.5 qui est attendu</span></span>
<span id="cb63-773"><a href="#cb63-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-774"><a href="#cb63-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-775"><a href="#cb63-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-776"><a href="#cb63-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-777"><a href="#cb63-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-778"><a href="#cb63-778" aria-hidden="true" tabindex="-1"></a>Le problème précédent est appelé biais de sélection. Lorsque l’on effectue la</span>
<span id="cb63-779"><a href="#cb63-779" aria-hidden="true" tabindex="-1"></a>validation croisée, l’échantillon test n’est certes pas utilisé pour l’estimation</span>
<span id="cb63-780"><a href="#cb63-780" aria-hidden="true" tabindex="-1"></a>du modèle, mais il a été utilisé initialement pour sélectionner les variables.</span>
<span id="cb63-781"><a href="#cb63-781" aria-hidden="true" tabindex="-1"></a>Ainsi lorsqu’on confronte les prévisions à l’échantillon test, ces dernières</span>
<span id="cb63-782"><a href="#cb63-782" aria-hidden="true" tabindex="-1"></a>sont trop optimistes car elles ont déjà utilisé l’information contenue dans</span>
<span id="cb63-783"><a href="#cb63-783" aria-hidden="true" tabindex="-1"></a>cet échantillon test. Pour estimer convenablement le taux d’erreur, il faut</span>
<span id="cb63-784"><a href="#cb63-784" aria-hidden="true" tabindex="-1"></a>que l’échantillon test ne soit utilisé à aucun moment dans la procédure de</span>
<span id="cb63-785"><a href="#cb63-785" aria-hidden="true" tabindex="-1"></a>modélisation.</span>
<span id="cb63-786"><a href="#cb63-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-787"><a href="#cb63-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-788"><a href="#cb63-788" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 9</span></span>
<span id="cb63-789"><a href="#cb63-789" aria-hidden="true" tabindex="-1"></a>Mettre en oeuvre une validation croisée valide, respectant la règle précédente,</span>
<span id="cb63-790"><a href="#cb63-790" aria-hidden="true" tabindex="-1"></a>pour estimer le taux d’erreur associé à la démarche de modélisation choisie</span>
<span id="cb63-791"><a href="#cb63-791" aria-hidden="true" tabindex="-1"></a>par le statisticien. Recommencer la démarche 10 fois, comme dans la question</span>
<span id="cb63-792"><a href="#cb63-792" aria-hidden="true" tabindex="-1"></a>7., afin d’obtenir 10 estimation du taux d’erreur. Comparer avec la valeur</span>
<span id="cb63-793"><a href="#cb63-793" aria-hidden="true" tabindex="-1"></a>théorique attendue.</span>
<span id="cb63-794"><a href="#cb63-794" aria-hidden="true" tabindex="-1"></a>On pourra utiliser la fonction cvsegments de la librairie pls pour découper</span>
<span id="cb63-795"><a href="#cb63-795" aria-hidden="true" tabindex="-1"></a>l’échantillon aléatoirement en K parties de taille égale.</span>
<span id="cb63-798"><a href="#cb63-798" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-799"><a href="#cb63-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-800"><a href="#cb63-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-803"><a href="#cb63-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-804"><a href="#cb63-804" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pls)</span>
<span id="cb63-805"><a href="#cb63-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-806"><a href="#cb63-806" aria-hidden="true" tabindex="-1"></a><span class="co"># To avoid selection bias, we create a list of kf segments in order to separate sample </span></span>
<span id="cb63-807"><a href="#cb63-807" aria-hidden="true" tabindex="-1"></a>kf <span class="ot">=</span> <span class="dv">10</span> <span class="co"># number of segments </span></span>
<span id="cb63-808"><a href="#cb63-808" aria-hidden="true" tabindex="-1"></a>seg <span class="ot">=</span> <span class="fu">cvsegments</span>(<span class="fu">nrow</span>(X), kf)</span>
<span id="cb63-809"><a href="#cb63-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-810"><a href="#cb63-810" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>kf</span>
<span id="cb63-811"><a href="#cb63-811" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>kf) {</span>
<span id="cb63-812"><a href="#cb63-812" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We define our sample test</span></span>
<span id="cb63-813"><a href="#cb63-813" aria-hidden="true" tabindex="-1"></a>  sample_test <span class="ot">=</span> seg[[i]]</span>
<span id="cb63-814"><a href="#cb63-814" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-815"><a href="#cb63-815" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We build a vector to store the correlation between y and each explanatory variables contain into the segment</span></span>
<span id="cb63-816"><a href="#cb63-816" aria-hidden="true" tabindex="-1"></a>  cor_vect <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span></span>
<span id="cb63-817"><a href="#cb63-817" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>){</span>
<span id="cb63-818"><a href="#cb63-818" aria-hidden="true" tabindex="-1"></a>    cor_vect[j] <span class="ot">=</span> <span class="fu">cor</span>(X[<span class="sc">-</span>sample_test, j], y[<span class="sc">-</span>sample_test])</span>
<span id="cb63-819"><a href="#cb63-819" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-820"><a href="#cb63-820" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-821"><a href="#cb63-821" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We keep the variables with the higher correlation</span></span>
<span id="cb63-822"><a href="#cb63-822" aria-hidden="true" tabindex="-1"></a>  indexvar <span class="ot">=</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing=</span>T)</span>
<span id="cb63-823"><a href="#cb63-823" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(y, X[, indexvar[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]))</span>
<span id="cb63-824"><a href="#cb63-824" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-825"><a href="#cb63-825" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We fit our glm </span></span>
<span id="cb63-826"><a href="#cb63-826" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">=</span> <span class="fu">glm</span>(y<span class="sc">~</span>., <span class="at">data =</span> tab, <span class="at">subset =</span> <span class="sc">-</span>sample_test, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb63-827"><a href="#cb63-827" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">=</span> <span class="fu">predict</span>(fit, tab[sample_test,], <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb63-828"><a href="#cb63-828" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-829"><a href="#cb63-829" aria-hidden="true" tabindex="-1"></a>  tmp[i] <span class="ot">=</span> <span class="fu">cost</span>(y[sample_test], pred)</span>
<span id="cb63-830"><a href="#cb63-830" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-831"><a href="#cb63-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-832"><a href="#cb63-832" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(tmp)</span>
<span id="cb63-833"><a href="#cb63-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-834"><a href="#cb63-834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-835"><a href="#cb63-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-838"><a href="#cb63-838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-839"><a href="#cb63-839" aria-hidden="true" tabindex="-1"></a><span class="co"># We repeat the process 10 times </span></span>
<span id="cb63-840"><a href="#cb63-840" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb63-841"><a href="#cb63-841" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb63-842"><a href="#cb63-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(k, <span class="st">"-&gt;"</span>)) <span class="co"># counter to see progress</span></span>
<span id="cb63-843"><a href="#cb63-843" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-844"><a href="#cb63-844" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We recreate our explanatory variables</span></span>
<span id="cb63-845"><a href="#cb63-845" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span><span class="dv">5000</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">5000</span>)</span>
<span id="cb63-846"><a href="#cb63-846" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-847"><a href="#cb63-847" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We create a list of kf segments in order to separate sample</span></span>
<span id="cb63-848"><a href="#cb63-848" aria-hidden="true" tabindex="-1"></a>  Kf <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb63-849"><a href="#cb63-849" aria-hidden="true" tabindex="-1"></a>  seg <span class="ot">=</span> <span class="fu">cvsegments</span>(<span class="fu">nrow</span>(X),Kf) </span>
<span id="cb63-850"><a href="#cb63-850" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-851"><a href="#cb63-851" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>Kf</span>
<span id="cb63-852"><a href="#cb63-852" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Kf){</span>
<span id="cb63-853"><a href="#cb63-853" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We define our sample test</span></span>
<span id="cb63-854"><a href="#cb63-854" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">=</span> seg[[i]]</span>
<span id="cb63-855"><a href="#cb63-855" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-856"><a href="#cb63-856" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We build a vector to store the correlation between y and each explanatory variables contain into the segment</span></span>
<span id="cb63-857"><a href="#cb63-857" aria-hidden="true" tabindex="-1"></a>    cor_vect <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span></span>
<span id="cb63-858"><a href="#cb63-858" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>){</span>
<span id="cb63-859"><a href="#cb63-859" aria-hidden="true" tabindex="-1"></a>      cor_vect[j] <span class="ot">=</span> <span class="fu">cor</span>(X[<span class="sc">-</span>test,j],y[<span class="sc">-</span>test])</span>
<span id="cb63-860"><a href="#cb63-860" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-861"><a href="#cb63-861" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-862"><a href="#cb63-862" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We keep the variables with the higher correlation</span></span>
<span id="cb63-863"><a href="#cb63-863" aria-hidden="true" tabindex="-1"></a>    indexvar <span class="ot">=</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing =</span> T)</span>
<span id="cb63-864"><a href="#cb63-864" aria-hidden="true" tabindex="-1"></a>    tab <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(y, X[, indexvar[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]))</span>
<span id="cb63-865"><a href="#cb63-865" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-866"><a href="#cb63-866" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We fit our glm </span></span>
<span id="cb63-867"><a href="#cb63-867" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">=</span> <span class="fu">glm</span>(y<span class="sc">~</span>., <span class="at">data =</span> tab, <span class="at">subset =</span> <span class="sc">-</span>test, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb63-868"><a href="#cb63-868" aria-hidden="true" tabindex="-1"></a>    pred <span class="ot">=</span> <span class="fu">predict</span>(fit, tab[test,], <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb63-869"><a href="#cb63-869" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-870"><a href="#cb63-870" aria-hidden="true" tabindex="-1"></a>    tmp[i] <span class="ot">=</span> <span class="fu">cost</span>(y[test], pred)</span>
<span id="cb63-871"><a href="#cb63-871" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-872"><a href="#cb63-872" aria-hidden="true" tabindex="-1"></a>  res2[k] <span class="ot">=</span> <span class="fu">mean</span>(tmp)</span>
<span id="cb63-873"><a href="#cb63-873" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-874"><a href="#cb63-874" aria-hidden="true" tabindex="-1"></a>res2</span>
<span id="cb63-875"><a href="#cb63-875" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(res2) </span>
<span id="cb63-876"><a href="#cb63-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-877"><a href="#cb63-877" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-878"><a href="#cb63-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-879"><a href="#cb63-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-880"><a href="#cb63-880" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 10</span></span>
<span id="cb63-881"><a href="#cb63-881" aria-hidden="true" tabindex="-1"></a>à partir de quelle valeur $|\hat{\rho}|$ peut-on considérer que deux variables ont une corrélation significativement non-nulle au seuil $α = 5\%$ ?</span>
<span id="cb63-884"><a href="#cb63-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-885"><a href="#cb63-885" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb63-886"><a href="#cb63-886" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span><span class="dv">5000</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">5000</span>)</span>
<span id="cb63-887"><a href="#cb63-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-888"><a href="#cb63-888" aria-hidden="true" tabindex="-1"></a><span class="co"># We build a vector to store the correlation between y and each explanatory variables</span></span>
<span id="cb63-889"><a href="#cb63-889" aria-hidden="true" tabindex="-1"></a>cor_vect <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span></span>
<span id="cb63-890"><a href="#cb63-890" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>){</span>
<span id="cb63-891"><a href="#cb63-891" aria-hidden="true" tabindex="-1"></a>  cor_vect[i] <span class="ot">=</span> <span class="fu">cor</span>(X[,i], y)</span>
<span id="cb63-892"><a href="#cb63-892" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-893"><a href="#cb63-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-894"><a href="#cb63-894" aria-hidden="true" tabindex="-1"></a><span class="co"># We look at the quantile</span></span>
<span id="cb63-895"><a href="#cb63-895" aria-hidden="true" tabindex="-1"></a>quant <span class="ot">=</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb63-896"><a href="#cb63-896" aria-hidden="true" tabindex="-1"></a>quant</span>
<span id="cb63-897"><a href="#cb63-897" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-898"><a href="#cb63-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-899"><a href="#cb63-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-900"><a href="#cb63-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-901"><a href="#cb63-901" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 11</span></span>
<span id="cb63-902"><a href="#cb63-902" aria-hidden="true" tabindex="-1"></a>Comparer les corrélations des variables dans le modèle précédent avec ce seuil ?</span>
<span id="cb63-905"><a href="#cb63-905" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-906"><a href="#cb63-906" aria-hidden="true" tabindex="-1"></a><span class="co"># We keep the variables with the higher correlation</span></span>
<span id="cb63-907"><a href="#cb63-907" aria-hidden="true" tabindex="-1"></a>index <span class="ot">=</span> <span class="fu">order</span>(<span class="fu">abs</span>(cor_vect), <span class="at">decreasing =</span> T)</span>
<span id="cb63-908"><a href="#cb63-908" aria-hidden="true" tabindex="-1"></a>index[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] </span>
<span id="cb63-909"><a href="#cb63-909" aria-hidden="true" tabindex="-1"></a>cor_vect[index[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]</span>
<span id="cb63-910"><a href="#cb63-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-911"><a href="#cb63-911" aria-hidden="true" tabindex="-1"></a><span class="co"># For our 5 variables with the higher correlation, we look this correlation is more than our quantile</span></span>
<span id="cb63-912"><a href="#cb63-912" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((<span class="fu">abs</span>(cor_vect[index[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]]))<span class="sc">&gt;</span>quant)</span>
<span id="cb63-913"><a href="#cb63-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-914"><a href="#cb63-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-915"><a href="#cb63-915" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-916"><a href="#cb63-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-917"><a href="#cb63-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-918"><a href="#cb63-918" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question 12</span></span>
<span id="cb63-919"><a href="#cb63-919" aria-hidden="true" tabindex="-1"></a>Parmi 5000 variables théoriquement non corrélées avec $y$, environ combien de variables observées sur $n = 100$ individus présenteront une corrélation empirique significativement non nulles avec y au seuil $α = 5\%$ ? Le vérifier sur le jeu de données simulé.</span>
<span id="cb63-920"><a href="#cb63-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-921"><a href="#cb63-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-924"><a href="#cb63-924" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-925"><a href="#cb63-925" aria-hidden="true" tabindex="-1"></a><span class="co"># We look at the number of variables in our model where the correlation with y is more than our quantile</span></span>
<span id="cb63-926"><a href="#cb63-926" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((<span class="fu">abs</span>(cor_vect))<span class="sc">&gt;</span>quant)</span>
<span id="cb63-927"><a href="#cb63-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-928"><a href="#cb63-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-929"><a href="#cb63-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-930"><a href="#cb63-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-931"><a href="#cb63-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-932"><a href="#cb63-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-933"><a href="#cb63-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-934"><a href="#cb63-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-935"><a href="#cb63-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-936"><a href="#cb63-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-937"><a href="#cb63-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-938"><a href="#cb63-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-939"><a href="#cb63-939" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2025, Clément Poupelin</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This blog is built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>