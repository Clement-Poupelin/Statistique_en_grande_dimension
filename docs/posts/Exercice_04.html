<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Clément Poupelin">
<meta name="dcterms.date" content="2025-02-19">

<title>Statistique en grande dimension - Exercice 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../img/logo_univ_nantes_simple.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/logo_univ_nantes_complet.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">X3MS020</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../TP_StatGdeDim.pdf" rel="" target=""><i class="bi bi-file-earmark-font-fill" role="img">
</i> 
 <span class="menu-text">Feuille de TP</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Clement-Poupelin" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://www.linkedin.com/in/cl%C3%A9ment-poupelin-7675311a7/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:clementjc.poupelin@gmail.com" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://clement-poupelin.github.io/" rel="" target=""><i class="bi bi-person-circle" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/clement__poupelin" rel="" target=""><i class="bi bi-instagram" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Exercice 4</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">TP</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Clément Poupelin </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 19, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#données" id="toc-données" class="nav-link" data-scroll-target="#données">Données</a></li>
  <li><a href="#analyse-descriptive" id="toc-analyse-descriptive" class="nav-link" data-scroll-target="#analyse-descriptive">Analyse descriptive</a></li>
  <li><a href="#analyse-inférentielle" id="toc-analyse-inférentielle" class="nav-link" data-scroll-target="#analyse-inférentielle">Analyse inférentielle</a>
  <ul class="collapse">
  <li><a href="#modèle-brut" id="toc-modèle-brut" class="nav-link" data-scroll-target="#modèle-brut">Modèle brut</a></li>
  <li><a href="#sélecion-automatique" id="toc-sélecion-automatique" class="nav-link" data-scroll-target="#sélecion-automatique">Sélecion automatique</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session info</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="setup" class="level1">
<h1>Setup</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">fonctions</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Données</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)         <span class="co"># Caravan data </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'ISLR' a été compilé avec la version R 4.2.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)        <span class="co"># manipulation des données</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'dplyr' a été compilé avec la version R 4.2.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)          <span class="co"># pour VIF</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'car' a été compilé avec la version R 4.2.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'FactoMineR' a été compilé avec la version R 4.2.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'ggplot2' a été compilé avec la version R 4.2.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ggplot</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)     <span class="co"># transformer les données en format long</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">## for pairs panel</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'psych' a été compilé avec la version R 4.2.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">pairs.panels</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transformer les données en format long pour ggplot</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  data_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(data)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span>  <span class="co"># Palette de couleurs harmonieuse</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Variables (Boxplot)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Valeurs"</span>) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Thème épuré</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotation des étiquettes</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>my_pairs.panels <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs.panels</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pearson"</span>,      <span class="co"># Méthode de corrélation </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">hist.col =</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Set3"</span>), <span class="co"># Couleurs des histogrammes</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> <span class="cn">TRUE</span>,          <span class="co"># Ajout des courbes de densité</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ellipses =</span> <span class="cn">TRUE</span>,         <span class="co"># Ajout d'ellipses </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">smooth =</span> <span class="cn">TRUE</span>,           <span class="co"># Ajout de régressions lissées</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">lm =</span> <span class="cn">TRUE</span>,               <span class="co"># Ajout des droites de régression</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"#69b3a2"</span>,         <span class="co"># Couleur des points</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>              <span class="co"># Transparence </span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="données" class="level1">
<h1>Données</h1>
<p>On considère le jeu de données Caravan de la librairie ISLR de R. Ce jeu de données contient, pour 5822 clients d’une assurance, 86 variables décrivant leur profil. La dernière variable Purchase indique si le client a souscrit une assurance pour caravane ou non.</p>
<p>Au vu des dimensions, on se passera de regarder le summary.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Caravan <span class="sc">%&gt;%</span> <span class="fu">dim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5822   86</code></pre>
</div>
</div>
<p>Vérifions juste s’il y a des valeurs manquantes</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anyNA</span>(Caravan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>On s’intéressera à la variable purchase. Celle ci peut déjà nous indiquer que le pourcentage de clients ayant souscrit à une assurance Caravan est de 5.98%</p>
</section>
<section id="analyse-descriptive" class="level1">
<h1>Analyse descriptive</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Correlation panel</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">PCA</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>On peut regarder un peu la distribution de nos différents variables quantitatives via des boxplots.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_boxplot</span>(Caravan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">

</div>
<p>Pour confirmer cela, on peut faire des boxplot pour uniquement une varibale et ses différents points de temps.</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>On regarde ici la corrélation calculée entre chacune de nos variables.</p>
<p>Comme nos données sont de grande dimension, on se propose de réduire le nombre d’individus et de prendre seulement quelques variables. Cela ne permettra donc pas d’avoir une étude précise des corrélation mais juste voir si sur un sous échantillon on peut déjà déceler des particularité</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_pairs.panels</span>(Caravan[<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="2688"></p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">

</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Avec une Analyse en Composantes Principales (PCA) on peut regarder un peu le comportement de nos données.</p>
<p>En effet, Cette méthode respose sur la transformation des variables d’origine en nouvelles variables non corrélées, appelées composantes principales, qui capturent successivement la plus grande variance possible des données.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>res_pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(Caravan, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">quali.sup =</span> <span class="fu">c</span>(<span class="fu">which</span>(<span class="fu">colnames</span>(Caravan) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Purchase"</span>))),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ici, on spécifi notre variable qualitative en variable supplémentaire, ce qui veut d’ire qu’elles ne seront pas considérés pour la formation de nos composantes principales (variable que l’on cherchera à estimer plus tard).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Barplot des variances</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Individus</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Tout d’abord, on peut commencer par regarder le pourcentage de variance expliqué par nos différentes composantes principales.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(res_pca, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">ncp =</span> <span class="dv">15</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">addlabels =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">barfill =</span> <span class="st">"coral"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">barcolor =</span> <span class="st">"coral"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">"Percentage of variance of the 15 first components"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>On voit ainsi que la variance expliqué par nos deux premiers axes est d’environ 16%. Ce qui est une situation que l’on peut facilement retrouver dans des cas de grandes dimensions avec beaucoup de variables.</p>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Le plan des individus est une projection des observations sur les axes principaux de la PCA. Cette visualisation permet d’identifier des regroupements, tendances et anomalies au sein des données.</p>
<p>Ainsi, des individus proches sur le graphique ont des caractéristiques similaires par rapport aux variables utilisées.</p>
<p>Puis, le placement d’un individu en fonction des axes peut permettre de savoir comment le jouer se caractérise par rapport aux variables qui contribuent le plus à ces axes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(res_pca,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">label=</span><span class="st">"none"</span>, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">pointsize =</span> <span class="dv">2</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">habillage=</span><span class="fu">as.factor</span>(Caravan<span class="sc">$</span>Purchase),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">addEllipses=</span><span class="cn">TRUE</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Ici on voit une repartition plutot uniforme sur le plan qui ne semble pas permettre de distinguer une séparation forte correspodant à notre variable qualitative.</p>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Le cercle des variables est une représentation graphique qui permet d’analyser les relations entre les variables initiales et les composantes principales qui forment nos axes. Il est basé sur les corrélations entre les variables et les axes principaux.</p>
<p>Ainsi, plus une variable est proche du bord du cercle, plus elle est bien représentée sur le plan factoriel et contribue fortement à la formation des axes. Ici, on utilise le cos2 pour le gradient de couleur qui va aider à l’indentifictation de ces différentes qualitées de représentation.</p>
<p>De plus, selon l’angle entre deux varibles, on peut faire des suppositions sur leur corrélation :</p>
<ul>
<li><p>Si deux variables ont des vecteurs proches (petit angle), elles sont fortement corrélées positivement</p></li>
<li><p>Si deux variables ont des vecteurs opposés (angle proche de 180°), elles sont corrélées négativement</p></li>
<li><p>Si l’angle est proche de 90°, alors les variables ne sont pas corrélées</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res_pca, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.var =</span> <span class="st">"cos2"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">rainbow</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">start =</span> .<span class="dv">6</span>, <span class="at">end =</span> .<span class="dv">9</span>),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Ici aussi, du fait du grand nombre de variable il est difficile de dicerner quelque chose de pertinent.</p>
<p>Maintenant, certaines variables sont tout de même bien représenter sur nos premiers axes et sont assez proche, ce qui témoigne d’une corrélation entre elles.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="analyse-inférentielle" class="level1">
<h1>Analyse inférentielle</h1>
<section id="modèle-brut" class="level2">
<h2 class="anchored" data-anchor-id="modèle-brut">Modèle brut</h2>
<p>Ajustons un modèle de régression logistique modélisant la probabilité de souscrire une assurance caravane en fonction de toutes les autres variables à disposition</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Caravan<span class="sc">$</span>Purchase<span class="sc">~</span>.,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> binomial,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                Caravan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Caravan$Purchase ~ ., family = binomial, data = Caravan)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7047  -0.3711  -0.2450  -0.1588   3.2916  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.542e+02  1.116e+04   0.023  0.98183    
MOSTYPE      6.580e-02  4.624e-02   1.423  0.15468    
MAANTHUI    -1.832e-01  1.927e-01  -0.951  0.34157    
MGEMOMV     -2.696e-02  1.399e-01  -0.193  0.84723    
MGEMLEEF     2.096e-01  1.016e-01   2.063  0.03911 *  
MOSHOOFD    -2.767e-01  2.076e-01  -1.333  0.18247    
MGODRK      -1.142e-01  1.069e-01  -1.068  0.28535    
MGODPR      -1.910e-02  1.177e-01  -0.162  0.87112    
MGODOV      -1.618e-02  1.055e-01  -0.153  0.87818    
MGODGE      -6.817e-02  1.113e-01  -0.612  0.54024    
MRELGE       2.310e-01  1.566e-01   1.475  0.14031    
MRELSA       8.509e-02  1.466e-01   0.580  0.56169    
MRELOV       1.467e-01  1.562e-01   0.939  0.34759    
MFALLEEN    -8.291e-02  1.311e-01  -0.633  0.52702    
MFGEKIND    -1.154e-01  1.337e-01  -0.863  0.38813    
MFWEKIND    -8.140e-02  1.417e-01  -0.575  0.56561    
MOPLHOOG     9.717e-04  1.311e-01   0.007  0.99408    
MOPLMIDD    -9.077e-02  1.365e-01  -0.665  0.50605    
MOPLLAAG    -1.994e-01  1.376e-01  -1.449  0.14740    
MBERHOOG     8.883e-02  9.349e-02   0.950  0.34204    
MBERZELF     3.918e-02  9.897e-02   0.396  0.69219    
MBERBOER    -1.169e-01  1.104e-01  -1.059  0.28951    
MBERMIDD     1.353e-01  9.191e-02   1.472  0.14106    
MBERARBG     3.976e-02  9.067e-02   0.438  0.66104    
MBERARBO     9.954e-02  9.143e-02   1.089  0.27628    
MSKA         2.690e-02  1.035e-01   0.260  0.79502    
MSKB1       -8.801e-03  1.011e-01  -0.087  0.93064    
MSKB2        1.200e-02  9.081e-02   0.132  0.89485    
MSKC         9.016e-02  9.958e-02   0.905  0.36527    
MSKD        -2.468e-02  9.724e-02  -0.254  0.79967    
MHHUUR      -1.472e+01  8.140e+02  -0.018  0.98557    
MHKOOP      -1.469e+01  8.140e+02  -0.018  0.98561    
MAUT1        1.819e-01  1.514e-01   1.202  0.22953    
MAUT2        1.507e-01  1.371e-01   1.099  0.27162    
MAUT0        9.325e-02  1.436e-01   0.649  0.51603    
MZFONDS     -1.445e+01  9.359e+02  -0.015  0.98768    
MZPART      -1.451e+01  9.359e+02  -0.016  0.98763    
MINKM30      1.181e-01  1.006e-01   1.174  0.24039    
MINK3045     1.366e-01  9.650e-02   1.415  0.15694    
MINK4575     1.009e-01  9.667e-02   1.043  0.29678    
MINK7512     1.144e-01  1.027e-01   1.114  0.26513    
MINK123M    -1.607e-01  1.449e-01  -1.109  0.26738    
MINKGEM      9.214e-02  9.945e-02   0.927  0.35417    
MKOOPKLA     6.856e-02  4.642e-02   1.477  0.13966    
PWAPART      5.954e-01  3.901e-01   1.526  0.12693    
PWABEDR     -2.757e-01  4.635e-01  -0.595  0.55196    
PWALAND     -4.405e-01  1.035e+00  -0.425  0.67052    
PPERSAUT     2.306e-01  4.199e-02   5.491 4.01e-08 ***
PBESAUT      1.215e+01  4.029e+02   0.030  0.97595    
PMOTSCO     -8.101e-02  1.147e-01  -0.706  0.48006    
PVRAAUT     -2.106e+00  2.557e+03  -0.001  0.99934    
PAANHANG     1.014e+00  9.371e-01   1.082  0.27917    
PTRACTOR     7.229e-01  4.278e-01   1.690  0.09107 .  
PWERKT      -5.525e+00  4.805e+03  -0.001  0.99908    
PBROM        2.170e-01  4.865e-01   0.446  0.65559    
PLEVEN      -2.382e-01  1.170e-01  -2.036  0.04173 *  
PPERSONG    -4.523e-01  2.094e+00  -0.216  0.82901    
PGEZONG      1.444e+00  1.029e+00   1.404  0.16033    
PWAOREG      8.239e-01  5.943e-01   1.386  0.16565    
PBRAND       2.401e-01  7.714e-02   3.113  0.00185 ** 
PZEILPL     -8.658e+00  3.261e+03  -0.003  0.99788    
PPLEZIER    -1.886e-01  3.259e-01  -0.579  0.56289    
PFIETS       3.664e-01  8.325e-01   0.440  0.65985    
PINBOED     -1.068e+00  8.764e-01  -1.219  0.22301    
PBYSTAND    -1.676e-01  3.321e-01  -0.505  0.61373    
AWAPART     -9.293e-01  7.802e-01  -1.191  0.23364    
AWABEDR      4.197e-01  1.082e+00   0.388  0.69824    
AWALAND      2.762e-01  3.528e+00   0.078  0.93758    
APERSAUT    -3.902e-02  1.772e-01  -0.220  0.82566    
ABESAUT     -7.298e+01  2.417e+03  -0.030  0.97591    
AMOTSCO      2.418e-01  3.772e-01   0.641  0.52142    
AVRAAUT     -4.490e+00  1.078e+04   0.000  0.99967    
AAANHANG    -1.351e+00  1.687e+00  -0.801  0.42322    
ATRACTOR    -2.376e+00  1.524e+00  -1.559  0.11899    
AWERKT      -8.749e-01  9.682e+03   0.000  0.99993    
ABROM       -1.060e+00  1.549e+00  -0.684  0.49367    
ALEVEN       4.789e-01  2.245e-01   2.133  0.03291 *  
APERSONG     3.997e-01  4.329e+00   0.092  0.92644    
AGEZONG     -3.163e+00  2.706e+00  -1.169  0.24247    
AWAOREG     -3.212e+00  3.433e+00  -0.936  0.34939    
ABRAND      -4.118e-01  2.787e-01  -1.477  0.13956    
AZEILPL      1.047e+01  3.261e+03   0.003  0.99744    
APLEZIER     2.516e+00  1.010e+00   2.490  0.01276 *  
AFIETS       2.318e-01  5.699e-01   0.407  0.68420    
AINBOED      1.947e+00  1.412e+00   1.378  0.16812    
ABYSTAND     1.078e+00  1.103e+00   0.977  0.32870    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2635.5  on 5821  degrees of freedom
Residual deviance: 2243.5  on 5736  degrees of freedom
AIC: 2415.5

Number of Fisher Scoring iterations: 17</code></pre>
</div>
</div>
<p>on a ici un modèle avec beaucoup de variable. Mais si on analyse le summary, on constate que seulement 6 varaibales sont significative.</p>
<p>Regardons un peu le VIF pour toutes les variables.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(mod1)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer en data frame pour ggplot</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>vif_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(vif_values),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">VIF =</span> vif_values</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vif_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Variable, VIF), <span class="at">y =</span> <span class="fu">pmin</span>(VIF, <span class="dv">15</span>), <span class="at">fill =</span> VIF <span class="sc">&gt;</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(VIF <span class="sc">&gt;</span> <span class="dv">15</span>, <span class="fu">round</span>(VIF, <span class="dv">1</span>), <span class="st">""</span>)),  </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span>  <span class="co"># Affiche seulement si VIF &gt; 15</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>)) <span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variance Inflation Factor (VIF)"</span>,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variables"</span>,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"VIF (limité à 15)"</span>) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="2688"></p>
</div>
</div>
<p>On constate la présence de beaucoup de valeurs avec un VIF très élevé et donc une forte colinéarité.</p>
</section>
<section id="sélecion-automatique" class="level2">
<h2 class="anchored" data-anchor-id="sélecion-automatique">Sélecion automatique</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">AIC</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">BIC</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Forward</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Backward</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Both</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">

</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">

</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">

</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Forward</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Backward</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Both</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">

</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">

</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">

</div>
</div>
</div>
</div>
</div>
</div>
<p>Après toute ces modélisations, rappelons nous tout de même l’objectif de l’assureur est de démarcher des clients de manière ciblée pour leurs faire souscrire une assurance caravane. On pourrait alors de demander : s’il démarchait les clients de façon aléatoire, sans tenir compte de leurs caractéristiques, quel serait environ son taux de réussite ?</p>
<p>Pour cela il suffit juste de ce rappeler du pourcentage donné précédemment qui nous disait la proportion de oui actuellement.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">table</span>(Caravan<span class="sc">$</span>Purchase)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="fu">nrow</span>(Caravan), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    No    Yes 
94.023  5.977 </code></pre>
</div>
</div>
<p>Le pourcentage étant très bas, on va souhaiter utiliser l’un des 3 modèles estimés ci-dessus (le global, un de ceux sélectionnés par AIC et un de ceux sélectionnés par BIC) pour cibler les clients à démarcher.</p>
<p>Ainsi on regardera</p>
<p>Si l’on choisissait de démarcher tous les clients ayant une probabilité de souscrire l’assurance supérieure à 0.5, quel pourcentage de clients cela représenterait il pour chacun des 3 modèles estimés ? Quel seuil faudrait-il choisir à la place de 0.5 pour que ce pourcentage corresponde à environ 6% des clients ? On décide dans la suite de fixer ce seuil à 0.2 et on cherche à sélectionner le meilleur modèle parmi les 3 précédents.</p>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>(<span class="at">pkgs =</span> <span class="st">"attached"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.2.1 (2022-06-23 ucrt)
 os       Windows 10 x64 (build 22631)
 system   x86_64, mingw32
 ui       RTerm
 language (EN)
 collate  French_France.utf8
 ctype    French_France.utf8
 tz       Europe/Paris
 date     2025-02-19
 pandoc   3.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package      * version date (UTC) lib source
 car          * 3.1-2   2023-03-30 [1] CRAN (R 4.2.3)
 carData      * 3.0-5   2022-01-06 [1] CRAN (R 4.2.1)
 dplyr        * 1.1.4   2023-11-17 [1] CRAN (R 4.2.3)
 factoextra   * 1.0.7   2020-04-01 [1] CRAN (R 4.2.1)
 FactoMineR   * 2.9     2023-10-12 [1] CRAN (R 4.2.3)
 ggplot2      * 3.5.1   2024-04-23 [1] CRAN (R 4.2.3)
 gridExtra    * 2.3     2017-09-09 [1] CRAN (R 4.2.1)
 ISLR         * 1.4     2021-09-15 [1] CRAN (R 4.2.3)
 psych        * 2.4.1   2024-01-18 [1] CRAN (R 4.2.3)
 RColorBrewer * 1.1-3   2022-04-03 [1] CRAN (R 4.2.0)
 reshape2     * 1.4.4   2020-04-09 [1] CRAN (R 4.2.1)

 [1] C:/Users/cleme/AppData/Local/R/win-library/4.2
 [2] C:/Program Files/R/R-4.2.1/library

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>car <span class="ot">&lt;-</span> Caravan</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 3 --------------------------------------------------------------</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>mod_full <span class="ot">=</span> <span class="fu">glm</span>(car<span class="sc">$</span>Purchase<span class="sc">~</span>., <span class="at">family =</span> binomial, car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = car$Purchase ~ ., family = binomial, data = car)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7047  -0.3711  -0.2450  -0.1588   3.2916  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.542e+02  1.116e+04   0.023  0.98183    
MOSTYPE      6.580e-02  4.624e-02   1.423  0.15468    
MAANTHUI    -1.832e-01  1.927e-01  -0.951  0.34157    
MGEMOMV     -2.696e-02  1.399e-01  -0.193  0.84723    
MGEMLEEF     2.096e-01  1.016e-01   2.063  0.03911 *  
MOSHOOFD    -2.767e-01  2.076e-01  -1.333  0.18247    
MGODRK      -1.142e-01  1.069e-01  -1.068  0.28535    
MGODPR      -1.910e-02  1.177e-01  -0.162  0.87112    
MGODOV      -1.618e-02  1.055e-01  -0.153  0.87818    
MGODGE      -6.817e-02  1.113e-01  -0.612  0.54024    
MRELGE       2.310e-01  1.566e-01   1.475  0.14031    
MRELSA       8.509e-02  1.466e-01   0.580  0.56169    
MRELOV       1.467e-01  1.562e-01   0.939  0.34759    
MFALLEEN    -8.291e-02  1.311e-01  -0.633  0.52702    
MFGEKIND    -1.154e-01  1.337e-01  -0.863  0.38813    
MFWEKIND    -8.140e-02  1.417e-01  -0.575  0.56561    
MOPLHOOG     9.717e-04  1.311e-01   0.007  0.99408    
MOPLMIDD    -9.077e-02  1.365e-01  -0.665  0.50605    
MOPLLAAG    -1.994e-01  1.376e-01  -1.449  0.14740    
MBERHOOG     8.883e-02  9.349e-02   0.950  0.34204    
MBERZELF     3.918e-02  9.897e-02   0.396  0.69219    
MBERBOER    -1.169e-01  1.104e-01  -1.059  0.28951    
MBERMIDD     1.353e-01  9.191e-02   1.472  0.14106    
MBERARBG     3.976e-02  9.067e-02   0.438  0.66104    
MBERARBO     9.954e-02  9.143e-02   1.089  0.27628    
MSKA         2.690e-02  1.035e-01   0.260  0.79502    
MSKB1       -8.801e-03  1.011e-01  -0.087  0.93064    
MSKB2        1.200e-02  9.081e-02   0.132  0.89485    
MSKC         9.016e-02  9.958e-02   0.905  0.36527    
MSKD        -2.468e-02  9.724e-02  -0.254  0.79967    
MHHUUR      -1.472e+01  8.140e+02  -0.018  0.98557    
MHKOOP      -1.469e+01  8.140e+02  -0.018  0.98561    
MAUT1        1.819e-01  1.514e-01   1.202  0.22953    
MAUT2        1.507e-01  1.371e-01   1.099  0.27162    
MAUT0        9.325e-02  1.436e-01   0.649  0.51603    
MZFONDS     -1.445e+01  9.359e+02  -0.015  0.98768    
MZPART      -1.451e+01  9.359e+02  -0.016  0.98763    
MINKM30      1.181e-01  1.006e-01   1.174  0.24039    
MINK3045     1.366e-01  9.650e-02   1.415  0.15694    
MINK4575     1.009e-01  9.667e-02   1.043  0.29678    
MINK7512     1.144e-01  1.027e-01   1.114  0.26513    
MINK123M    -1.607e-01  1.449e-01  -1.109  0.26738    
MINKGEM      9.214e-02  9.945e-02   0.927  0.35417    
MKOOPKLA     6.856e-02  4.642e-02   1.477  0.13966    
PWAPART      5.954e-01  3.901e-01   1.526  0.12693    
PWABEDR     -2.757e-01  4.635e-01  -0.595  0.55196    
PWALAND     -4.405e-01  1.035e+00  -0.425  0.67052    
PPERSAUT     2.306e-01  4.199e-02   5.491 4.01e-08 ***
PBESAUT      1.215e+01  4.029e+02   0.030  0.97595    
PMOTSCO     -8.101e-02  1.147e-01  -0.706  0.48006    
PVRAAUT     -2.106e+00  2.557e+03  -0.001  0.99934    
PAANHANG     1.014e+00  9.371e-01   1.082  0.27917    
PTRACTOR     7.229e-01  4.278e-01   1.690  0.09107 .  
PWERKT      -5.525e+00  4.805e+03  -0.001  0.99908    
PBROM        2.170e-01  4.865e-01   0.446  0.65559    
PLEVEN      -2.382e-01  1.170e-01  -2.036  0.04173 *  
PPERSONG    -4.523e-01  2.094e+00  -0.216  0.82901    
PGEZONG      1.444e+00  1.029e+00   1.404  0.16033    
PWAOREG      8.239e-01  5.943e-01   1.386  0.16565    
PBRAND       2.401e-01  7.714e-02   3.113  0.00185 ** 
PZEILPL     -8.658e+00  3.261e+03  -0.003  0.99788    
PPLEZIER    -1.886e-01  3.259e-01  -0.579  0.56289    
PFIETS       3.664e-01  8.325e-01   0.440  0.65985    
PINBOED     -1.068e+00  8.764e-01  -1.219  0.22301    
PBYSTAND    -1.676e-01  3.321e-01  -0.505  0.61373    
AWAPART     -9.293e-01  7.802e-01  -1.191  0.23364    
AWABEDR      4.197e-01  1.082e+00   0.388  0.69824    
AWALAND      2.762e-01  3.528e+00   0.078  0.93758    
APERSAUT    -3.902e-02  1.772e-01  -0.220  0.82566    
ABESAUT     -7.298e+01  2.417e+03  -0.030  0.97591    
AMOTSCO      2.418e-01  3.772e-01   0.641  0.52142    
AVRAAUT     -4.490e+00  1.078e+04   0.000  0.99967    
AAANHANG    -1.351e+00  1.687e+00  -0.801  0.42322    
ATRACTOR    -2.376e+00  1.524e+00  -1.559  0.11899    
AWERKT      -8.749e-01  9.682e+03   0.000  0.99993    
ABROM       -1.060e+00  1.549e+00  -0.684  0.49367    
ALEVEN       4.789e-01  2.245e-01   2.133  0.03291 *  
APERSONG     3.997e-01  4.329e+00   0.092  0.92644    
AGEZONG     -3.163e+00  2.706e+00  -1.169  0.24247    
AWAOREG     -3.212e+00  3.433e+00  -0.936  0.34939    
ABRAND      -4.118e-01  2.787e-01  -1.477  0.13956    
AZEILPL      1.047e+01  3.261e+03   0.003  0.99744    
APLEZIER     2.516e+00  1.010e+00   2.490  0.01276 *  
AFIETS       2.318e-01  5.699e-01   0.407  0.68420    
AINBOED      1.947e+00  1.412e+00   1.378  0.16812    
ABYSTAND     1.078e+00  1.103e+00   0.977  0.32870    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2635.5  on 5821  degrees of freedom
Residual deviance: 2243.5  on 5736  degrees of freedom
AIC: 2415.5

Number of Fisher Scoring iterations: 17</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod_full) <span class="co"># quelques de vif elevé </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     MOSTYPE     MAANTHUI      MGEMOMV     MGEMLEEF     MOSHOOFD       MGODRK 
1.176524e+02 1.129402e+00 3.502955e+00 1.843805e+00 1.159758e+02 3.254979e+00 
      MGODPR       MGODOV       MGODGE       MRELGE       MRELSA       MRELOV 
1.149989e+01 3.403490e+00 9.654767e+00 2.092478e+01 4.738546e+00 1.755829e+01 
    MFALLEEN     MFGEKIND     MFWEKIND     MOPLHOOG     MOPLMIDD     MOPLLAAG 
1.396957e+01 1.484774e+01 2.401911e+01 1.697423e+01 1.707883e+01 2.881042e+01 
    MBERHOOG     MBERZELF     MBERBOER     MBERMIDD     MBERARBG     MBERARBO 
1.005928e+01 2.005447e+00 2.032453e+00 9.340155e+00 6.998429e+00 6.263887e+00 
        MSKA        MSKB1        MSKB2         MSKC         MSKD       MHHUUR 
1.143795e+01 5.439487e+00 5.554208e+00 1.173787e+01 3.231964e+00 1.742646e+09 
      MHKOOP        MAUT1        MAUT2        MAUT0      MZFONDS       MZPART 
1.742646e+09 1.434527e+01 8.048254e+00 1.242104e+01 1.102939e+09 1.102939e+09 
     MINKM30     MINK3045     MINK4575     MINK7512     MINK123M      MINKGEM 
1.022040e+01 1.002438e+01 9.896903e+00 5.441997e+00 1.649801e+00 5.338352e+00 
    MKOOPKLA      PWAPART      PWABEDR      PWALAND     PPERSAUT      PBESAUT 
2.649650e+00 4.429193e+01 6.632572e+00 3.321309e+01 3.113930e+00 9.398932e+06 
     PMOTSCO      PVRAAUT     PAANHANG     PTRACTOR       PWERKT        PBROM 
3.450522e+00 5.470096e+01 1.397225e+01 1.333457e+01 1.707055e+02 1.778348e+01 
      PLEVEN     PPERSONG      PGEZONG      PWAOREG       PBRAND      PZEILPL 
4.287040e+00 1.688445e+01 2.897539e+01 3.110765e+01 6.246956e+00 2.891237e+06 
    PPLEZIER       PFIETS      PINBOED     PBYSTAND      AWAPART      AWABEDR 
6.860219e+00 7.914642e+00 6.966391e+00 1.333206e+01 4.493341e+01 5.984836e+00 
     AWALAND     APERSAUT      ABESAUT      AMOTSCO      AVRAAUT     AAANHANG 
3.329385e+01 3.236914e+00 9.398929e+06 3.397310e+00 5.470096e+01 1.391263e+01 
    ATRACTOR       AWERKT        ABROM       ALEVEN     APERSONG      AGEZONG 
1.327892e+01 1.707055e+02 1.775902e+01 4.383663e+00 1.691406e+01 2.912335e+01 
     AWAOREG       ABRAND      AZEILPL     APLEZIER       AFIETS      AINBOED 
3.115261e+01 5.907867e+00 2.891237e+06 6.611109e+00 7.924550e+00 6.980250e+00 
    ABYSTAND 
1.320138e+01 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## courbe ROC</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'pROC' a été compilé avec la version R 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attachement du package : 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Les objets suivants sont masqués depuis 'package:stats':

    cov, smooth, var</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PresenceAbsence) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'PresenceAbsence' a été compilé avec la version R 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attachement du package : 'PresenceAbsence'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>L'objet suivant est masqué depuis 'package:pROC':

    auc</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df_rocr_mod <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase)), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>df_rocr_mod[,<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase))</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>df_rocr_mod[,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">as.numeric</span>(mod_full<span class="sc">$</span>y)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>df_rocr_mod[,<span class="dv">3</span>] <span class="ot">=</span> mod_full<span class="sc">$</span>fitted</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>df_rocr_mod <span class="ot">=</span> <span class="fu">as.data.frame</span>(df_rocr_mod)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod)[[<span class="dv">2</span>]] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'ID'</span>, <span class="st">"Observed"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod)[[<span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ID"        "Observed"  "Predicted"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matrice de confusion </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cmx</span>(df_rocr_mod, <span class="at">threshold =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         observed
predicted    1    0
        1    7    8
        0  341 5466</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la specificite et de la sensibilite</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sensitivity</span>(<span class="fu">cmx</span>(df_rocr_mod,<span class="at">threshold=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  sensitivity sensitivity.sd
1  0.02011494    0.007536717</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">specificity</span>(<span class="fu">cmx</span>(df_rocr_mod,<span class="at">threshold=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  specificity specificity.sd
1   0.9985385   0.0005163715</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Courbe ROC pour le modele logistique CHD</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.plot.calculate</span>(df_rocr_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    threshold        PCC sensitivity specificity       Kappa
1        0.00 0.05977327 1.000000000   0.0000000 0.000000000
2        0.01 0.19958777 0.994252874   0.1490683 0.019729331
3        0.02 0.37117829 0.948275862   0.3344903 0.048112212
4        0.03 0.49793885 0.882183908   0.4735111 0.073758972
5        0.04 0.58381999 0.818965517   0.5688710 0.094814495
6        0.05 0.64943318 0.767241379   0.6419437 0.115979442
7        0.06 0.70611474 0.718390805   0.7053343 0.139459289
8        0.07 0.74544830 0.678160920   0.7497260 0.158914265
9        0.08 0.78461010 0.640804598   0.7937523 0.184853124
10       0.09 0.80951563 0.609195402   0.8222506 0.202925152
11       0.10 0.83081415 0.557471264   0.8481915 0.212292894
12       0.11 0.84455514 0.508620690   0.8659116 0.213107179
13       0.12 0.85915493 0.459770115   0.8845451 0.215550569
14       0.13 0.87478530 0.428160920   0.9031787 0.229246669
15       0.14 0.88302989 0.396551724   0.9139569 0.229808908
16       0.15 0.89350739 0.382183908   0.9260139 0.245451984
17       0.16 0.90243902 0.367816092   0.9364267 0.259544938
18       0.17 0.91016833 0.341954023   0.9462916 0.265064708
19       0.18 0.91429062 0.293103448   0.9537815 0.244581472
20       0.19 0.91738234 0.267241379   0.9587139 0.235129532
21       0.20 0.92133288 0.250000000   0.9640117 0.234176183
22       0.21 0.92476812 0.229885057   0.9689441 0.229027112
23       0.22 0.92751632 0.209770115   0.9731458 0.220970671
24       0.23 0.92923394 0.181034483   0.9767994 0.200444267
25       0.24 0.93026451 0.155172414   0.9795396 0.178395897
26       0.25 0.93198214 0.146551724   0.9819145 0.175116889
27       0.26 0.93318447 0.143678161   0.9833760 0.176098707
28       0.27 0.93421505 0.126436782   0.9855681 0.160632157
29       0.28 0.93507386 0.120689655   0.9868469 0.156949456
30       0.29 0.93490210 0.094827586   0.9883084 0.125527191
31       0.30 0.93644796 0.091954023   0.9901352 0.126779770
32       0.31 0.93576091 0.077586207   0.9903179 0.106196042
33       0.32 0.93541738 0.063218391   0.9908659 0.086031310
34       0.33 0.93610443 0.060344828   0.9917793 0.083991859
35       0.34 0.93661972 0.048850575   0.9930581 0.069180662
36       0.35 0.93713501 0.045977011   0.9937888 0.066380530
37       0.36 0.93730677 0.040229885   0.9943369 0.058357107
38       0.37 0.93799382 0.040229885   0.9950676 0.060137142
39       0.38 0.93782205 0.037356322   0.9950676 0.055368303
40       0.39 0.93799382 0.031609195   0.9956156 0.047030424
41       0.40 0.93850910 0.031609195   0.9961637 0.048314040
42       0.41 0.93868087 0.028735632   0.9965290 0.044261534
43       0.42 0.93868087 0.028735632   0.9965290 0.044261534
44       0.43 0.93919615 0.028735632   0.9970771 0.045543714
45       0.44 0.93936791 0.028735632   0.9972598 0.045975176
46       0.45 0.93953968 0.028735632   0.9974425 0.046408696
47       0.46 0.93971144 0.028735632   0.9976251 0.046844289
48       0.47 0.93953968 0.025862069   0.9976251 0.041837866
49       0.48 0.93953968 0.022988506   0.9978078 0.037223007
50       0.49 0.93988320 0.020114943   0.9983559 0.033382162
51       0.50 0.94005496 0.020114943   0.9985385 0.033794496
52       0.51 0.93988320 0.017241379   0.9985385 0.028658321
53       0.52 0.93988320 0.014367816   0.9987212 0.023888084
54       0.53 0.94005496 0.014367816   0.9989039 0.024281108
55       0.54 0.94022673 0.011494253   0.9992693 0.019838766
56       0.55 0.94022673 0.011494253   0.9992693 0.019838766
57       0.56 0.94022673 0.011494253   0.9992693 0.019838766
58       0.57 0.94022673 0.011494253   0.9992693 0.019838766
59       0.58 0.94022673 0.011494253   0.9992693 0.019838766
60       0.59 0.94039849 0.011494253   0.9994520 0.020225632
61       0.60 0.94039849 0.011494253   0.9994520 0.020225632
62       0.61 0.94039849 0.011494253   0.9994520 0.020225632
63       0.62 0.94039849 0.011494253   0.9994520 0.020225632
64       0.63 0.94039849 0.011494253   0.9994520 0.020225632
65       0.64 0.94039849 0.011494253   0.9994520 0.020225632
66       0.65 0.94057025 0.011494253   0.9996346 0.020614427
67       0.66 0.94039849 0.008620690   0.9996346 0.015329831
68       0.67 0.94022673 0.005747126   0.9996346 0.010018763
69       0.68 0.94022673 0.005747126   0.9996346 0.010018763
70       0.69 0.94022673 0.005747126   0.9996346 0.010018763
71       0.70 0.94022673 0.005747126   0.9996346 0.010018763
72       0.71 0.94022673 0.005747126   0.9996346 0.010018763
73       0.72 0.94022673 0.005747126   0.9996346 0.010018763
74       0.73 0.94022673 0.005747126   0.9996346 0.010018763
75       0.74 0.94022673 0.005747126   0.9996346 0.010018763
76       0.75 0.94022673 0.005747126   0.9996346 0.010018763
77       0.76 0.94039849 0.005747126   0.9998173 0.010384857
78       0.77 0.94057025 0.005747126   1.0000000 0.010752794
79       0.78 0.94057025 0.005747126   1.0000000 0.010752794
80       0.79 0.94057025 0.005747126   1.0000000 0.010752794
81       0.80 0.94057025 0.005747126   1.0000000 0.010752794
82       0.81 0.94057025 0.005747126   1.0000000 0.010752794
83       0.82 0.94057025 0.005747126   1.0000000 0.010752794
84       0.83 0.94057025 0.005747126   1.0000000 0.010752794
85       0.84 0.94039849 0.002873563   1.0000000 0.005389965
86       0.85 0.94039849 0.002873563   1.0000000 0.005389965
87       0.86 0.94039849 0.002873563   1.0000000 0.005389965
88       0.87 0.94039849 0.002873563   1.0000000 0.005389965
89       0.88 0.94039849 0.002873563   1.0000000 0.005389965
90       0.89 0.94039849 0.002873563   1.0000000 0.005389965
91       0.90 0.94039849 0.002873563   1.0000000 0.005389965
92       0.91 0.94039849 0.002873563   1.0000000 0.005389965
93       0.92 0.94039849 0.002873563   1.0000000 0.005389965
94       0.93 0.94039849 0.002873563   1.0000000 0.005389965
95       0.94 0.94039849 0.002873563   1.0000000 0.005389965
96       0.95 0.94039849 0.002873563   1.0000000 0.005389965
97       0.96 0.94039849 0.002873563   1.0000000 0.005389965
98       0.97 0.94022673 0.000000000   1.0000000 0.000000000
99       0.98 0.94022673 0.000000000   1.0000000 0.000000000
100      0.99 0.94022673 0.000000000   1.0000000 0.000000000
101      1.00 0.94022673 0.000000000   1.0000000 0.000000000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc.roc.plot</span>(df_rocr_mod) <span class="co"># graphe courbe ROC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(df_rocr_mod) <span class="co"># calcul AUC </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        AUC     AUC.sd
1 0.7902737 0.01208314</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 4 --------------------------------------------------------------</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>mod_start <span class="ot">=</span> <span class="fu">glm</span>(car<span class="sc">$</span>Purchase<span class="sc">~</span><span class="dv">1</span>, <span class="at">family =</span> binomial, car)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC k = 2 </span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>mod_both_AIC <span class="ot">=</span> <span class="fu">step</span>(mod_start, <span class="at">scope =</span> <span class="fu">formula</span>(mod_full), <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">k=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BIC k = log(n)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">dim</span>(car)[<span class="dv">1</span>]</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>mod_both_BIC <span class="ot">=</span> <span class="fu">step</span>(mod_start, <span class="at">scope =</span> <span class="fu">formula</span>(mod_full), <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">k =</span> <span class="fu">log</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1

Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_both_AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = car$Purchase ~ PPERSAUT + MKOOPKLA + PBRAND + APLEZIER + 
    MOPLLAAG + MBERBOER + MRELGE + PWALAND + AFIETS + MINK123M + 
    MINKGEM + PWAOREG + MGEMLEEF + PWAPART + ABYSTAND + ABRAND + 
    AWERKT + MGODPR + AWAOREG + MSKC + MOPLHOOG + MBERMIDD, family = binomial, 
    data = car)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8826  -0.3744  -0.2565  -0.1725   3.1647  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -6.19224    0.52494 -11.796  &lt; 2e-16 ***
PPERSAUT      0.22355    0.02431   9.196  &lt; 2e-16 ***
MKOOPKLA      0.05593    0.03559   1.572 0.116048    
PBRAND        0.24533    0.07137   3.437 0.000587 ***
APLEZIER      2.04258    0.38299   5.333 9.65e-08 ***
MOPLLAAG     -0.09275    0.04084  -2.271 0.023141 *  
MBERBOER     -0.16145    0.08213  -1.966 0.049312 *  
MRELGE        0.08609    0.03637   2.367 0.017941 *  
PWALAND      -0.35244    0.18342  -1.922 0.054667 .  
AFIETS        0.49134    0.20112   2.443 0.014565 *  
MINK123M     -0.26512    0.12196  -2.174 0.029718 *  
MINKGEM       0.09974    0.05618   1.775 0.075849 .  
PWAOREG       0.90496    0.58036   1.559 0.118920    
MGEMLEEF      0.16131    0.07647   2.109 0.034907 *  
PWAPART       0.15607    0.07597   2.054 0.039943 *  
ABYSTAND      0.51565    0.30400   1.696 0.089846 .  
ABRAND       -0.45738    0.26499  -1.726 0.084345 .  
AWERKT      -12.56588  306.81856  -0.041 0.967331    
MGODPR        0.05639    0.03474   1.623 0.104613    
AWAOREG      -3.63288    3.31767  -1.095 0.273512    
MSKC          0.08675    0.04353   1.993 0.046261 *  
MOPLHOOG      0.09673    0.04644   2.083 0.037263 *  
MBERMIDD      0.06828    0.03260   2.094 0.036234 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2635.5  on 5821  degrees of freedom
Residual deviance: 2295.4  on 5799  degrees of freedom
AIC: 2341.4

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_both_BIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = car$Purchase ~ PPERSAUT + PBRAND + APLEZIER + MOPLLAAG + 
    MBERBOER + MRELGE, family = binomial, data = car)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.5324  -0.3869  -0.2681  -0.1813   3.1846  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -4.25590    0.28160 -15.113  &lt; 2e-16 ***
PPERSAUT     0.23346    0.02360   9.894  &lt; 2e-16 ***
PBRAND       0.17672    0.03042   5.810 6.26e-09 ***
APLEZIER     2.00086    0.36984   5.410 6.30e-08 ***
MOPLLAAG    -0.13801    0.02539  -5.436 5.46e-08 ***
MBERBOER    -0.26479    0.07468  -3.546 0.000392 ***
MRELGE       0.13598    0.03256   4.176 2.97e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2635.5  on 5821  degrees of freedom
Residual deviance: 2353.0  on 5815  degrees of freedom
AIC: 2367

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod_both_AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> PPERSAUT  MKOOPKLA    PBRAND  APLEZIER  MOPLLAAG  MBERBOER    MRELGE   PWALAND 
 1.061129  1.612138  5.438441  1.008809  2.642005  1.202952  1.227286  1.096876 
   AFIETS  MINK123M   MINKGEM   PWAOREG  MGEMLEEF   PWAPART  ABYSTAND    ABRAND 
 1.009692  1.211645  1.793174 28.081012  1.097419  1.687378  1.021142  5.460960 
   AWERKT    MGODPR   AWAOREG      MSKC  MOPLHOOG  MBERMIDD 
 1.000002  1.075606 28.057222  2.309295  2.212204  1.235918 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod_both_BIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>PPERSAUT   PBRAND APLEZIER MOPLLAAG MBERBOER   MRELGE 
1.009196 1.026969 1.001332 1.039257 1.041977 1.018104 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on a encore un peu de colinearité pour des var du modèle selec avec AIC</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plus de colinearité pour le model selec avec BIC</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Il serait preferable de garder le mod_both_BIC</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co">#mais on peut aussi enlever les variables au vif elevé </span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>mod_both_AIC_2<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> car<span class="sc">$</span>Purchase <span class="sc">~</span> PPERSAUT <span class="sc">+</span> MKOOPKLA <span class="sc">+</span> PBRAND <span class="sc">+</span> APLEZIER <span class="sc">+</span> </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                         MOPLLAAG <span class="sc">+</span> MBERBOER <span class="sc">+</span> MRELGE <span class="sc">+</span> PWALAND <span class="sc">+</span> AFIETS <span class="sc">+</span> MINK123M <span class="sc">+</span> </span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>                         MINKGEM <span class="sc">+</span> MGEMLEEF <span class="sc">+</span> PWAPART <span class="sc">+</span> ABYSTAND <span class="sc">+</span> ABRAND <span class="sc">+</span> </span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>                         AWERKT <span class="sc">+</span> MGODPR <span class="sc">+</span> MSKC <span class="sc">+</span> MOPLHOOG <span class="sc">+</span> MBERMIDD, <span class="at">family =</span> binomial, </span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_both_AIC_2<span class="fl">.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = car$Purchase ~ PPERSAUT + MKOOPKLA + PBRAND + APLEZIER + 
    MOPLLAAG + MBERBOER + MRELGE + PWALAND + AFIETS + MINK123M + 
    MINKGEM + MGEMLEEF + PWAPART + ABYSTAND + ABRAND + AWERKT + 
    MGODPR + MSKC + MOPLHOOG + MBERMIDD, family = binomial, data = car)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.5608  -0.3748  -0.2578  -0.1733   3.1609  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -6.13191    0.52316 -11.721  &lt; 2e-16 ***
PPERSAUT      0.22142    0.02424   9.134  &lt; 2e-16 ***
MKOOPKLA      0.05561    0.03553   1.565 0.117578    
PBRAND        0.25594    0.07078   3.616 0.000299 ***
APLEZIER      2.03348    0.38274   5.313 1.08e-07 ***
MOPLLAAG     -0.09327    0.04093  -2.279 0.022689 *  
MBERBOER     -0.16619    0.08210  -2.024 0.042939 *  
MRELGE        0.08763    0.03631   2.413 0.015803 *  
PWALAND      -0.35071    0.18353  -1.911 0.056017 .  
AFIETS        0.48693    0.20098   2.423 0.015402 *  
MINK123M     -0.27387    0.12204  -2.244 0.024830 *  
MINKGEM       0.09891    0.05605   1.765 0.077632 .  
MGEMLEEF      0.15985    0.07635   2.094 0.036287 *  
PWAPART       0.14818    0.07594   1.951 0.051032 .  
ABYSTAND      0.50720    0.30385   1.669 0.095074 .  
ABRAND       -0.47863    0.26420  -1.812 0.070048 .  
AWERKT      -12.06366  312.17287  -0.039 0.969174    
MGODPR        0.05282    0.03470   1.522 0.127952    
MSKC          0.08254    0.04356   1.895 0.058073 .  
MOPLHOOG      0.09360    0.04634   2.020 0.043391 *  
MBERMIDD      0.06768    0.03255   2.079 0.037600 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2635.5  on 5821  degrees of freedom
Residual deviance: 2301.9  on 5801  degrees of freedom
AIC: 2343.9

Number of Fisher Scoring iterations: 15</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod_both_AIC_2<span class="fl">.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>PPERSAUT MKOOPKLA   PBRAND APLEZIER MOPLLAAG MBERBOER   MRELGE  PWALAND 
1.058123 1.612705 5.387839 1.008466 2.656919 1.206316 1.227004 1.095281 
  AFIETS MINK123M  MINKGEM MGEMLEEF  PWAPART ABYSTAND   ABRAND   AWERKT 
1.009595 1.209562 1.790558 1.096694 1.689480 1.020739 5.435687 1.000000 
  MGODPR     MSKC MOPLHOOG MBERMIDD 
1.074299 2.317082 2.210706 1.235177 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on analyse tout de même tout les modèle </span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="do">#####</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df_rocr_mod_both_AIC</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase)), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC[,<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase))</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC[,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">as.numeric</span>(mod_both_AIC<span class="sc">$</span>y)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC[,<span class="dv">3</span>] <span class="ot">=</span> mod_both_AIC<span class="sc">$</span>fitted</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC <span class="ot">=</span> <span class="fu">as.data.frame</span>(df_rocr_mod_both_AIC)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_AIC)[[<span class="dv">2</span>]] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'ID'</span>, <span class="st">"Observed"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_AIC)[[<span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ID"        "Observed"  "Predicted"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matrice de confusion </span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cmx</span>(df_rocr_mod_both_AIC, <span class="at">threshold =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         observed
predicted    1    0
        1    3   13
        0  345 5461</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la specificite et de la sensibilite</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sensitivity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_AIC,<span class="at">threshold=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  sensitivity sensitivity.sd
1  0.00862069    0.004962793</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">specificity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_AIC,<span class="at">threshold=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  specificity specificity.sd
1   0.9976251    0.000657946</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Courbe ROC pour le modele logistique CHD</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.plot.calculate</span>(df_rocr_mod_both_AIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    threshold        PCC sensitivity specificity       Kappa
1        0.00 0.05977327 1.000000000   0.0000000 0.000000000
2        0.01 0.14496737 0.991379310   0.0911582 0.010733751
3        0.02 0.34111989 0.945402299   0.3027037 0.040606652
4        0.03 0.46444521 0.876436782   0.4382536 0.061954525
5        0.04 0.56338028 0.827586207   0.5465839 0.087861037
6        0.05 0.63672278 0.775862069   0.6278772 0.111048014
7        0.06 0.69958777 0.729885057   0.6976617 0.137907936
8        0.07 0.74081072 0.683908046   0.7444282 0.156654525
9        0.08 0.78392305 0.643678161   0.7928389 0.185051480
10       0.09 0.80745448 0.580459770   0.8218853 0.190200758
11       0.10 0.82892477 0.517241379   0.8487395 0.193846739
12       0.11 0.84421161 0.465517241   0.8682864 0.194093262
13       0.12 0.86241841 0.416666667   0.8907563 0.200739921
14       0.13 0.87633116 0.387931034   0.9073803 0.211607862
15       0.14 0.88509103 0.373563218   0.9176105 0.221679840
16       0.15 0.89436620 0.344827586   0.9293022 0.225820973
17       0.16 0.90243902 0.310344828   0.9400804 0.223914056
18       0.17 0.90999656 0.287356322   0.9495798 0.228334268
19       0.18 0.91463415 0.264367816   0.9559737 0.224879950
20       0.19 0.91875644 0.238505747   0.9620022 0.217162129
21       0.20 0.92339402 0.221264368   0.9680307 0.217371228
22       0.21 0.92579869 0.192528736   0.9724151 0.199909401
23       0.22 0.92837513 0.163793103   0.9769821 0.180944458
24       0.23 0.93129509 0.143678161   0.9813665 0.169829831
25       0.24 0.93249742 0.123563218   0.9839240 0.151809671
26       0.25 0.93421505 0.112068966   0.9864815 0.144117324
27       0.26 0.93507386 0.100574713   0.9881257 0.133117681
28       0.27 0.93524562 0.080459770   0.9895871 0.108406729
29       0.28 0.93644796 0.068965517   0.9915966 0.096749684
30       0.29 0.93696324 0.063218391   0.9925100 0.090387630
31       0.30 0.93679148 0.045977011   0.9934235 0.065476523
32       0.31 0.93679148 0.045977011   0.9934235 0.065476523
33       0.32 0.93679148 0.037356322   0.9939715 0.052769147
34       0.33 0.93713501 0.037356322   0.9943369 0.053627643
35       0.34 0.93747853 0.028735632   0.9952503 0.041339153
36       0.35 0.93696324 0.020114943   0.9952503 0.026667104
37       0.36 0.93696324 0.020114943   0.9952503 0.026667104
38       0.37 0.93696324 0.020114943   0.9952503 0.026667104
39       0.38 0.93765029 0.020114943   0.9959810 0.028198702
40       0.39 0.93765029 0.020114943   0.9959810 0.028198702
41       0.40 0.93747853 0.014367816   0.9961637 0.018581672
42       0.41 0.93747853 0.011494253   0.9963464 0.013899901
43       0.42 0.93765029 0.011494253   0.9965290 0.014257769
44       0.43 0.93782205 0.011494253   0.9967117 0.014617351
45       0.44 0.93799382 0.011494253   0.9968944 0.014978662
46       0.45 0.93816558 0.011494253   0.9970771 0.015341712
47       0.46 0.93816558 0.011494253   0.9970771 0.015341712
48       0.47 0.93833734 0.011494253   0.9972598 0.015706515
49       0.48 0.93850910 0.011494253   0.9974425 0.016073084
50       0.49 0.93850910 0.011494253   0.9974425 0.016073084
51       0.50 0.93850910 0.008620690   0.9976251 0.011288039
52       0.51 0.93919615 0.008620690   0.9983559 0.012732519
53       0.52 0.93936791 0.008620690   0.9985385 0.013098084
54       0.53 0.93936791 0.008620690   0.9985385 0.013098084
55       0.54 0.93919615 0.005747126   0.9985385 0.007860143
56       0.55 0.93919615 0.005747126   0.9985385 0.007860143
57       0.56 0.93936791 0.005747126   0.9987212 0.008215463
58       0.57 0.93953968 0.005747126   0.9989039 0.008572545
59       0.58 0.93953968 0.005747126   0.9989039 0.008572545
60       0.59 0.93971144 0.005747126   0.9990866 0.008931403
61       0.60 0.93988320 0.005747126   0.9992693 0.009292050
62       0.61 0.93988320 0.005747126   0.9992693 0.009292050
63       0.62 0.94005496 0.005747126   0.9994520 0.009654499
64       0.63 0.94005496 0.005747126   0.9994520 0.009654499
65       0.64 0.94005496 0.005747126   0.9994520 0.009654499
66       0.65 0.94005496 0.005747126   0.9994520 0.009654499
67       0.66 0.94005496 0.005747126   0.9994520 0.009654499
68       0.67 0.94005496 0.005747126   0.9994520 0.009654499
69       0.68 0.94022673 0.005747126   0.9996346 0.010018763
70       0.69 0.94022673 0.005747126   0.9996346 0.010018763
71       0.70 0.94022673 0.005747126   0.9996346 0.010018763
72       0.71 0.94039849 0.005747126   0.9998173 0.010384857
73       0.72 0.94022673 0.002873563   0.9998173 0.005034602
74       0.73 0.94022673 0.002873563   0.9998173 0.005034602
75       0.74 0.94022673 0.002873563   0.9998173 0.005034602
76       0.75 0.94022673 0.002873563   0.9998173 0.005034602
77       0.76 0.94022673 0.002873563   0.9998173 0.005034602
78       0.77 0.94022673 0.002873563   0.9998173 0.005034602
79       0.78 0.94022673 0.002873563   0.9998173 0.005034602
80       0.79 0.94022673 0.002873563   0.9998173 0.005034602
81       0.80 0.94022673 0.002873563   0.9998173 0.005034602
82       0.81 0.94022673 0.002873563   0.9998173 0.005034602
83       0.82 0.94022673 0.002873563   0.9998173 0.005034602
84       0.83 0.94022673 0.002873563   0.9998173 0.005034602
85       0.84 0.94039849 0.002873563   1.0000000 0.005389965
86       0.85 0.94039849 0.002873563   1.0000000 0.005389965
87       0.86 0.94039849 0.002873563   1.0000000 0.005389965
88       0.87 0.94039849 0.002873563   1.0000000 0.005389965
89       0.88 0.94039849 0.002873563   1.0000000 0.005389965
90       0.89 0.94039849 0.002873563   1.0000000 0.005389965
91       0.90 0.94039849 0.002873563   1.0000000 0.005389965
92       0.91 0.94039849 0.002873563   1.0000000 0.005389965
93       0.92 0.94039849 0.002873563   1.0000000 0.005389965
94       0.93 0.94039849 0.002873563   1.0000000 0.005389965
95       0.94 0.94039849 0.002873563   1.0000000 0.005389965
96       0.95 0.94039849 0.002873563   1.0000000 0.005389965
97       0.96 0.94022673 0.000000000   1.0000000 0.000000000
98       0.97 0.94022673 0.000000000   1.0000000 0.000000000
99       0.98 0.94022673 0.000000000   1.0000000 0.000000000
100      0.99 0.94022673 0.000000000   1.0000000 0.000000000
101      1.00 0.94022673 0.000000000   1.0000000 0.000000000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df_rocr_mod_both_AIC_2.0</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC_2<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase)), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC_2<span class="fl">.0</span>[,<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase))</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC_2<span class="fl">.0</span>[,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">as.numeric</span>(mod_both_AIC_2<span class="fl">.0</span><span class="sc">$</span>y)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC_2<span class="fl">.0</span>[,<span class="dv">3</span>] <span class="ot">=</span> mod_both_AIC_2<span class="fl">.0</span><span class="sc">$</span>fitted</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC_2<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>)[[<span class="dv">2</span>]] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'ID'</span>, <span class="st">"Observed"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>)[[<span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ID"        "Observed"  "Predicted"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matrice de confusion </span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cmx</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>, <span class="at">threshold =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         observed
predicted    1    0
        1    3   10
        0  345 5464</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la specificite et de la sensibilite</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sensitivity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>,<span class="at">threshold=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  sensitivity sensitivity.sd
1  0.00862069    0.004962793</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">specificity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>,<span class="at">threshold=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  specificity specificity.sd
1   0.9981732   0.0005772153</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Courbe ROC pour le modele logistique CHD</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.plot.calculate</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    threshold        PCC sensitivity specificity       Kappa
1        0.00 0.05977327 1.000000000  0.00000000 0.000000000
2        0.01 0.14256269 0.991379310  0.08860066 0.010375734
3        0.02 0.33699760 0.945402299  0.29831933 0.039679377
4        0.03 0.46238406 0.876436782  0.43606138 0.061328003
5        0.04 0.56080385 0.824712644  0.54402631 0.086231565
6        0.05 0.63637925 0.775862069  0.62751187 0.110865467
7        0.06 0.69941601 0.724137931  0.69784436 0.136290531
8        0.07 0.74098248 0.672413793  0.74534161 0.153464445
9        0.08 0.78237719 0.629310345  0.79210815 0.178752751
10       0.09 0.80522157 0.568965517  0.82024114 0.183406580
11       0.10 0.82789419 0.511494253  0.84800877 0.190144650
12       0.11 0.84180694 0.454022989  0.86645963 0.185476989
13       0.12 0.86087255 0.410919540  0.88947753 0.195294306
14       0.13 0.87495706 0.385057471  0.90610157 0.207432573
15       0.14 0.88543456 0.370689655  0.91815857 0.220814092
16       0.15 0.89333562 0.330459770  0.92911947 0.214786877
17       0.16 0.90123669 0.298850575  0.93953233 0.213403336
18       0.17 0.90896599 0.281609195  0.94884910 0.221517154
19       0.18 0.91394710 0.261494253  0.95542565 0.220781531
20       0.19 0.91824115 0.232758621  0.96181951 0.211047328
21       0.20 0.92201992 0.215517241  0.96693460 0.208226193
22       0.21 0.92493988 0.186781609  0.97186701 0.191966716
23       0.22 0.92785984 0.152298851  0.97716478 0.167856623
24       0.23 0.93060804 0.137931034  0.98100110 0.161528129
25       0.24 0.93249742 0.112068966  0.98465473 0.138716548
26       0.25 0.93404328 0.100574713  0.98702959 0.129898981
27       0.26 0.93473033 0.091954023  0.98830837 0.121435084
28       0.27 0.93558914 0.074712644  0.99031787 0.101916487
29       0.28 0.93661972 0.068965517  0.99177932 0.097250552
30       0.29 0.93730677 0.060344828  0.99305809 0.087378516
31       0.30 0.93730677 0.045977011  0.99397150 0.066835585
32       0.31 0.93730677 0.045977011  0.99397150 0.066835585
33       0.32 0.93730677 0.037356322  0.99451955 0.054059829
34       0.33 0.93747853 0.037356322  0.99470223 0.054493992
35       0.34 0.93782205 0.028735632  0.99561564 0.042164393
36       0.35 0.93747853 0.020114943  0.99579832 0.027813102
37       0.36 0.93747853 0.020114943  0.99579832 0.027813102
38       0.37 0.93747853 0.020114943  0.99579832 0.027813102
39       0.38 0.93799382 0.020114943  0.99634636 0.028975383
40       0.39 0.93799382 0.020114943  0.99634636 0.028975383
41       0.40 0.93765029 0.014367816  0.99634636 0.018948977
42       0.41 0.93782205 0.011494253  0.99671173 0.014617351
43       0.42 0.93816558 0.011494253  0.99707709 0.015341712
44       0.43 0.93816558 0.011494253  0.99707709 0.015341712
45       0.44 0.93850910 0.011494253  0.99744246 0.016073084
46       0.45 0.93850910 0.011494253  0.99744246 0.016073084
47       0.46 0.93850910 0.011494253  0.99744246 0.016073084
48       0.47 0.93868087 0.011494253  0.99762514 0.016441431
49       0.48 0.93868087 0.011494253  0.99762514 0.016441431
50       0.49 0.93868087 0.008620690  0.99780782 0.011646519
51       0.50 0.93902439 0.008620690  0.99817318 0.012368746
52       0.51 0.93936791 0.008620690  0.99853855 0.013098084
53       0.52 0.93971144 0.008620690  0.99890391 0.013834639
54       0.53 0.93971144 0.008620690  0.99890391 0.013834639
55       0.54 0.93971144 0.008620690  0.99890391 0.013834639
56       0.55 0.93953968 0.005747126  0.99890391 0.008572545
57       0.56 0.93971144 0.005747126  0.99908659 0.008931403
58       0.57 0.93971144 0.005747126  0.99908659 0.008931403
59       0.58 0.93971144 0.005747126  0.99908659 0.008931403
60       0.59 0.93988320 0.005747126  0.99926927 0.009292050
61       0.60 0.94005496 0.005747126  0.99945195 0.009654499
62       0.61 0.94005496 0.005747126  0.99945195 0.009654499
63       0.62 0.94022673 0.005747126  0.99963464 0.010018763
64       0.63 0.94022673 0.005747126  0.99963464 0.010018763
65       0.64 0.94022673 0.005747126  0.99963464 0.010018763
66       0.65 0.94022673 0.005747126  0.99963464 0.010018763
67       0.66 0.94022673 0.005747126  0.99963464 0.010018763
68       0.67 0.94022673 0.005747126  0.99963464 0.010018763
69       0.68 0.94022673 0.005747126  0.99963464 0.010018763
70       0.69 0.94039849 0.005747126  0.99981732 0.010384857
71       0.70 0.94039849 0.005747126  0.99981732 0.010384857
72       0.71 0.94039849 0.002873563  1.00000000 0.005389965
73       0.72 0.94039849 0.002873563  1.00000000 0.005389965
74       0.73 0.94039849 0.002873563  1.00000000 0.005389965
75       0.74 0.94039849 0.002873563  1.00000000 0.005389965
76       0.75 0.94039849 0.002873563  1.00000000 0.005389965
77       0.76 0.94039849 0.002873563  1.00000000 0.005389965
78       0.77 0.94039849 0.002873563  1.00000000 0.005389965
79       0.78 0.94039849 0.002873563  1.00000000 0.005389965
80       0.79 0.94039849 0.002873563  1.00000000 0.005389965
81       0.80 0.94039849 0.002873563  1.00000000 0.005389965
82       0.81 0.94039849 0.002873563  1.00000000 0.005389965
83       0.82 0.94039849 0.002873563  1.00000000 0.005389965
84       0.83 0.94039849 0.002873563  1.00000000 0.005389965
85       0.84 0.94039849 0.002873563  1.00000000 0.005389965
86       0.85 0.94039849 0.002873563  1.00000000 0.005389965
87       0.86 0.94039849 0.002873563  1.00000000 0.005389965
88       0.87 0.94039849 0.002873563  1.00000000 0.005389965
89       0.88 0.94039849 0.002873563  1.00000000 0.005389965
90       0.89 0.94039849 0.002873563  1.00000000 0.005389965
91       0.90 0.94039849 0.002873563  1.00000000 0.005389965
92       0.91 0.94039849 0.002873563  1.00000000 0.005389965
93       0.92 0.94039849 0.002873563  1.00000000 0.005389965
94       0.93 0.94039849 0.002873563  1.00000000 0.005389965
95       0.94 0.94039849 0.002873563  1.00000000 0.005389965
96       0.95 0.94039849 0.002873563  1.00000000 0.005389965
97       0.96 0.94022673 0.000000000  1.00000000 0.000000000
98       0.97 0.94022673 0.000000000  1.00000000 0.000000000
99       0.98 0.94022673 0.000000000  1.00000000 0.000000000
100      0.99 0.94022673 0.000000000  1.00000000 0.000000000
101      1.00 0.94022673 0.000000000  1.00000000 0.000000000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df_rocr_mod_both_BIC</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_BIC <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase)), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_BIC[,<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase))</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_BIC[,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">as.numeric</span>(mod_both_BIC<span class="sc">$</span>y)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_BIC[,<span class="dv">3</span>] <span class="ot">=</span> mod_both_BIC<span class="sc">$</span>fitted</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_BIC <span class="ot">=</span> <span class="fu">as.data.frame</span>(df_rocr_mod_both_BIC)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_BIC)[[<span class="dv">2</span>]] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'ID'</span>, <span class="st">"Observed"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_BIC)[[<span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ID"        "Observed"  "Predicted"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matrice de confusion </span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cmx</span>(df_rocr_mod_both_BIC, <span class="at">threshold =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         observed
predicted    1    0
        1    3    5
        0  345 5469</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la specificite et de la sensibilite</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sensitivity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_BIC,<span class="at">threshold=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  sensitivity sensitivity.sd
1  0.00862069    0.004962793</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">specificity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_BIC,<span class="at">threshold=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  specificity specificity.sd
1   0.9990866   0.0004083396</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Courbe ROC pour le modele logistique CHD</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.plot.calculate</span>(df_rocr_mod_both_BIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    threshold        PCC sensitivity specificity       Kappa
1        0.00 0.05977327 1.000000000   0.0000000 0.000000000
2        0.01 0.11387839 0.991379310   0.0580928 0.006236199
3        0.02 0.30573686 0.951149425   0.2647059 0.033766823
4        0.03 0.44005496 0.876436782   0.4123128 0.054786724
5        0.04 0.53349364 0.816091954   0.5155280 0.073989259
6        0.05 0.61164548 0.755747126   0.6024845 0.093942266
7        0.06 0.66626589 0.712643678   0.6633175 0.112391504
8        0.07 0.72260392 0.649425287   0.7272561 0.132419851
9        0.08 0.75798695 0.606321839   0.7676288 0.147977641
10       0.09 0.79422879 0.540229885   0.8103763 0.160732911
11       0.10 0.81312264 0.505747126   0.8326635 0.169120085
12       0.11 0.84111989 0.448275862   0.8660943 0.181939429
13       0.12 0.86413604 0.399425287   0.8936792 0.195162378
14       0.13 0.87873583 0.382183908   0.9103033 0.213285407
15       0.14 0.88869804 0.353448276   0.9227256 0.218078399
16       0.15 0.90089316 0.293103448   0.9395323 0.208761324
17       0.16 0.90398488 0.287356322   0.9431860 0.212527844
18       0.17 0.91411886 0.221264368   0.9581659 0.190176854
19       0.18 0.91824115 0.218390805   0.9627329 0.199363483
20       0.19 0.92459636 0.149425287   0.9738765 0.155263076
21       0.20 0.92528341 0.143678161   0.9749726 0.151459249
22       0.21 0.93266919 0.103448276   0.9853855 0.129145502
23       0.22 0.93404328 0.100574713   0.9870296 0.129898981
24       0.23 0.93455857 0.097701149   0.9877603 0.127998390
25       0.24 0.93679148 0.048850575   0.9932408 0.069636886
26       0.25 0.93696324 0.040229885   0.9939715 0.057479164
27       0.26 0.93765029 0.037356322   0.9948849 0.054930146
28       0.27 0.93799382 0.031609195   0.9956156 0.047030424
29       0.28 0.93816558 0.028735632   0.9959810 0.042997359
30       0.29 0.93833734 0.017241379   0.9968944 0.025119942
31       0.30 0.93850910 0.017241379   0.9970771 0.025505557
32       0.31 0.93868087 0.017241379   0.9972598 0.025893025
33       0.32 0.93885263 0.017241379   0.9974425 0.026282360
34       0.33 0.93885263 0.017241379   0.9974425 0.026282360
35       0.34 0.93885263 0.014367816   0.9976251 0.021569883
36       0.35 0.93885263 0.014367816   0.9976251 0.021569883
37       0.36 0.93885263 0.014367816   0.9976251 0.021569883
38       0.37 0.93885263 0.014367816   0.9976251 0.021569883
39       0.38 0.93885263 0.014367816   0.9976251 0.021569883
40       0.39 0.93919615 0.014367816   0.9979905 0.022335101
41       0.40 0.93936791 0.014367816   0.9981732 0.022720507
42       0.41 0.93936791 0.014367816   0.9981732 0.022720507
43       0.42 0.93953968 0.014367816   0.9983559 0.023107798
44       0.43 0.93971144 0.014367816   0.9985385 0.023496985
45       0.44 0.93971144 0.014367816   0.9985385 0.023496985
46       0.45 0.93971144 0.014367816   0.9985385 0.023496985
47       0.46 0.93953968 0.008620690   0.9987212 0.013465453
48       0.47 0.93953968 0.008620690   0.9987212 0.013465453
49       0.48 0.93953968 0.008620690   0.9987212 0.013465453
50       0.49 0.93971144 0.008620690   0.9989039 0.013834639
51       0.50 0.93988320 0.008620690   0.9990866 0.014205656
52       0.51 0.93988320 0.008620690   0.9990866 0.014205656
53       0.52 0.94005496 0.008620690   0.9992693 0.014578518
54       0.53 0.93988320 0.005747126   0.9992693 0.009292050
55       0.54 0.93988320 0.005747126   0.9992693 0.009292050
56       0.55 0.93988320 0.005747126   0.9992693 0.009292050
57       0.56 0.93988320 0.005747126   0.9992693 0.009292050
58       0.57 0.93988320 0.005747126   0.9992693 0.009292050
59       0.58 0.93988320 0.005747126   0.9992693 0.009292050
60       0.59 0.93988320 0.005747126   0.9992693 0.009292050
61       0.60 0.93988320 0.005747126   0.9992693 0.009292050
62       0.61 0.94005496 0.005747126   0.9994520 0.009654499
63       0.62 0.94022673 0.005747126   0.9996346 0.010018763
64       0.63 0.94022673 0.005747126   0.9996346 0.010018763
65       0.64 0.94005496 0.002873563   0.9996346 0.004681023
66       0.65 0.94005496 0.002873563   0.9996346 0.004681023
67       0.66 0.94005496 0.002873563   0.9996346 0.004681023
68       0.67 0.94005496 0.002873563   0.9996346 0.004681023
69       0.68 0.94022673 0.002873563   0.9998173 0.005034602
70       0.69 0.94022673 0.002873563   0.9998173 0.005034602
71       0.70 0.94039849 0.002873563   1.0000000 0.005389965
72       0.71 0.94039849 0.002873563   1.0000000 0.005389965
73       0.72 0.94039849 0.002873563   1.0000000 0.005389965
74       0.73 0.94039849 0.002873563   1.0000000 0.005389965
75       0.74 0.94039849 0.002873563   1.0000000 0.005389965
76       0.75 0.94039849 0.002873563   1.0000000 0.005389965
77       0.76 0.94039849 0.002873563   1.0000000 0.005389965
78       0.77 0.94039849 0.002873563   1.0000000 0.005389965
79       0.78 0.94039849 0.002873563   1.0000000 0.005389965
80       0.79 0.94039849 0.002873563   1.0000000 0.005389965
81       0.80 0.94039849 0.002873563   1.0000000 0.005389965
82       0.81 0.94039849 0.002873563   1.0000000 0.005389965
83       0.82 0.94039849 0.002873563   1.0000000 0.005389965
84       0.83 0.94039849 0.002873563   1.0000000 0.005389965
85       0.84 0.94039849 0.002873563   1.0000000 0.005389965
86       0.85 0.94039849 0.002873563   1.0000000 0.005389965
87       0.86 0.94039849 0.002873563   1.0000000 0.005389965
88       0.87 0.94039849 0.002873563   1.0000000 0.005389965
89       0.88 0.94039849 0.002873563   1.0000000 0.005389965
90       0.89 0.94039849 0.002873563   1.0000000 0.005389965
91       0.90 0.94022673 0.000000000   1.0000000 0.000000000
92       0.91 0.94022673 0.000000000   1.0000000 0.000000000
93       0.92 0.94022673 0.000000000   1.0000000 0.000000000
94       0.93 0.94022673 0.000000000   1.0000000 0.000000000
95       0.94 0.94022673 0.000000000   1.0000000 0.000000000
96       0.95 0.94022673 0.000000000   1.0000000 0.000000000
97       0.96 0.94022673 0.000000000   1.0000000 0.000000000
98       0.97 0.94022673 0.000000000   1.0000000 0.000000000
99       0.98 0.94022673 0.000000000   1.0000000 0.000000000
100      0.99 0.94022673 0.000000000   1.0000000 0.000000000
101      1.00 0.94022673 0.000000000   1.0000000 0.000000000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="fu">auc.roc.plot</span>(df_rocr_mod, <span class="at">main =</span> <span class="st">"ROC plot mod_full"</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">auc.roc.plot</span>(df_rocr_mod_both_AIC, <span class="at">main =</span> <span class="st">"ROC plot mod_both_AIC"</span>)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="fu">auc.roc.plot</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>, <span class="at">main =</span> <span class="st">"ROC plot mod_both_AIC_2.0"</span>)</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="fu">auc.roc.plot</span>(df_rocr_mod_both_BIC, <span class="at">main =</span> <span class="st">"ROC plot mod_both_BIC"</span>) <span class="co"># graphe courbe ROC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># On veut maximiser l'AUC, ici les valeurs sont très proche </span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co"># donc on peut quand même préféré le petit modele (BIC) meme si AUC plus faible</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="do">## On compare avec anova </span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_full, mod_both_AIC_2<span class="fl">.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: car$Purchase ~ MOSTYPE + MAANTHUI + MGEMOMV + MGEMLEEF + MOSHOOFD + 
    MGODRK + MGODPR + MGODOV + MGODGE + MRELGE + MRELSA + MRELOV + 
    MFALLEEN + MFGEKIND + MFWEKIND + MOPLHOOG + MOPLMIDD + MOPLLAAG + 
    MBERHOOG + MBERZELF + MBERBOER + MBERMIDD + MBERARBG + MBERARBO + 
    MSKA + MSKB1 + MSKB2 + MSKC + MSKD + MHHUUR + MHKOOP + MAUT1 + 
    MAUT2 + MAUT0 + MZFONDS + MZPART + MINKM30 + MINK3045 + MINK4575 + 
    MINK7512 + MINK123M + MINKGEM + MKOOPKLA + PWAPART + PWABEDR + 
    PWALAND + PPERSAUT + PBESAUT + PMOTSCO + PVRAAUT + PAANHANG + 
    PTRACTOR + PWERKT + PBROM + PLEVEN + PPERSONG + PGEZONG + 
    PWAOREG + PBRAND + PZEILPL + PPLEZIER + PFIETS + PINBOED + 
    PBYSTAND + AWAPART + AWABEDR + AWALAND + APERSAUT + ABESAUT + 
    AMOTSCO + AVRAAUT + AAANHANG + ATRACTOR + AWERKT + ABROM + 
    ALEVEN + APERSONG + AGEZONG + AWAOREG + ABRAND + AZEILPL + 
    APLEZIER + AFIETS + AINBOED + ABYSTAND
Model 2: car$Purchase ~ PPERSAUT + MKOOPKLA + PBRAND + APLEZIER + MOPLLAAG + 
    MBERBOER + MRELGE + PWALAND + AFIETS + MINK123M + MINKGEM + 
    MGEMLEEF + PWAPART + ABYSTAND + ABRAND + AWERKT + MGODPR + 
    MSKC + MOPLHOOG + MBERMIDD
  Resid. Df Resid. Dev  Df Deviance
1      5736     2243.5             
2      5801     2301.9 -65  -58.458</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_full, mod_both_BIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: car$Purchase ~ MOSTYPE + MAANTHUI + MGEMOMV + MGEMLEEF + MOSHOOFD + 
    MGODRK + MGODPR + MGODOV + MGODGE + MRELGE + MRELSA + MRELOV + 
    MFALLEEN + MFGEKIND + MFWEKIND + MOPLHOOG + MOPLMIDD + MOPLLAAG + 
    MBERHOOG + MBERZELF + MBERBOER + MBERMIDD + MBERARBG + MBERARBO + 
    MSKA + MSKB1 + MSKB2 + MSKC + MSKD + MHHUUR + MHKOOP + MAUT1 + 
    MAUT2 + MAUT0 + MZFONDS + MZPART + MINKM30 + MINK3045 + MINK4575 + 
    MINK7512 + MINK123M + MINKGEM + MKOOPKLA + PWAPART + PWABEDR + 
    PWALAND + PPERSAUT + PBESAUT + PMOTSCO + PVRAAUT + PAANHANG + 
    PTRACTOR + PWERKT + PBROM + PLEVEN + PPERSONG + PGEZONG + 
    PWAOREG + PBRAND + PZEILPL + PPLEZIER + PFIETS + PINBOED + 
    PBYSTAND + AWAPART + AWABEDR + AWALAND + APERSAUT + ABESAUT + 
    AMOTSCO + AVRAAUT + AAANHANG + ATRACTOR + AWERKT + ABROM + 
    ALEVEN + APERSONG + AGEZONG + AWAOREG + ABRAND + AZEILPL + 
    APLEZIER + AFIETS + AINBOED + ABYSTAND
Model 2: car$Purchase ~ PPERSAUT + PBRAND + APLEZIER + MOPLLAAG + MBERBOER + 
    MRELGE
  Resid. Df Resid. Dev  Df Deviance
1      5736     2243.5             
2      5815     2353.0 -79  -109.48</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_both_AIC_2<span class="fl">.0</span>, mod_both_BIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: car$Purchase ~ PPERSAUT + MKOOPKLA + PBRAND + APLEZIER + MOPLLAAG + 
    MBERBOER + MRELGE + PWALAND + AFIETS + MINK123M + MINKGEM + 
    MGEMLEEF + PWAPART + ABYSTAND + ABRAND + AWERKT + MGODPR + 
    MSKC + MOPLHOOG + MBERMIDD
Model 2: car$Purchase ~ PPERSAUT + PBRAND + APLEZIER + MOPLLAAG + MBERBOER + 
    MRELGE
  Resid. Df Resid. Dev  Df Deviance
1      5801     2301.9             
2      5815     2353.0 -14  -51.019</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="do">### INTERPRETATION ???????</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 5 --------------------------------------------------------------</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co">#demarche aléatoire conduit à 6%</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">table</span>(car<span class="sc">$</span>Purchase)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>n, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    No    Yes 
94.023  5.977 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 6 --------------------------------------------------------------</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>mod_full.probs<span class="ot">=</span><span class="fu">predict</span>(mod_full, car, <span class="at">type=</span><span class="st">"response"</span>)<span class="co"># --&gt; donne les proba</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>mod_full.pred<span class="ot">=</span><span class="fu">rep</span>(<span class="st">"No"</span>, n)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>mod_full.pred[mod_full.probs<span class="sc">&gt;</span>.<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Yes"</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_full.pred, car<span class="sc">$</span>Purchase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             
mod_full.pred   No  Yes
          No  5466  341
          Yes    8    7</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># taux de reussitz de démarchage </span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (i.e, le nb de vrais positifs par rapport au nb de positifs prédit)</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 7/(8+7) = 0.4666667</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co"># on arrive à prévoir les souscriptions d'assurances dans 47% des cas</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (8+341)/n = 6% erreur de classification</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co"># (7+5466)/n = 94% precision ou accuracy</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co"># sensibility = 7/(7+341) =0.02</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mod_full.pred <span class="sc">==</span> car<span class="sc">$</span>Purchase) <span class="co"># ne marche pas ??</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.940055</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># = 0</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>mod_both_AIC_2.<span class="fl">0.</span>probs<span class="ot">=</span><span class="fu">predict</span>(mod_both_AIC_2<span class="fl">.0</span>, car, <span class="at">type=</span><span class="st">"response"</span>)<span class="co"># --&gt; donne les proba</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>mod_both_AIC_2.<span class="fl">0.</span>pred<span class="ot">=</span><span class="fu">rep</span>(<span class="st">"No"</span>, n)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>mod_both_AIC_2.<span class="fl">0.</span>pred[mod_both_AIC_2.<span class="fl">0.</span>probs<span class="sc">&gt;</span>.<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Yes"</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_both_AIC_2.<span class="fl">0.</span>pred, car<span class="sc">$</span>Purchase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     
mod_both_AIC_2.0.pred   No  Yes
                  No  5464  345
                  Yes   10    3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># refaire l'analyse du dessus </span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>mod_both_BIC.probs<span class="ot">=</span><span class="fu">predict</span>(mod_both_BIC, car, <span class="at">type=</span><span class="st">"response"</span>)<span class="co"># --&gt; donne les proba</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>mod_both_BIC.pred<span class="ot">=</span><span class="fu">rep</span>(<span class="st">"No"</span>, n)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>mod_both_BIC.pred[mod_both_BIC.probs<span class="sc">&gt;</span>.<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Yes"</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_both_BIC.pred, car<span class="sc">$</span>Purchase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 
mod_both_BIC.pred   No  Yes
              No  5469  345
              Yes    5    3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># refaire l'analyse du dessus </span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  % de clients ayant une proba &gt;0.5</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(<span class="fu">fitted.values</span>(mod_full)<span class="sc">&gt;</span><span class="fl">0.5</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>n, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.258</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.26%</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">fitted.values</span>(mod_full))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">fitted.values</span>(mod_full), <span class="fl">0.94</span>) <span class="co"># seuil pour que ce % corresponde à environ 6% des clients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      94% 
0.1807236 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1807236 </span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(<span class="fu">fitted.values</span>(mod_both_AIC_2<span class="fl">.0</span>)<span class="sc">&gt;</span><span class="fl">0.5</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>n, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.223</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.223</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">fitted.values</span>(mod_both_AIC_2<span class="fl">.0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">fitted.values</span>(mod_both_AIC_2<span class="fl">.0</span>), <span class="fl">0.94</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      94% 
0.1759159 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1759159</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(<span class="fu">fitted.values</span>(mod_both_BIC)<span class="sc">&gt;</span><span class="fl">0.5</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>n, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.137</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.137</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">fitted.values</span>(mod_both_BIC))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">fitted.values</span>(mod_both_BIC), <span class="fl">0.94</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      94% 
0.1659636 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1659636 </span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="co"># On décide dans la suite de fixer ce seuil à 0.2 et on cherche à sélectionner </span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="co"># le meilleur modèle parmi les 3 précédents.</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="co"># on change le seuil</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>mod_full.pred[mod_full.probs<span class="sc">&gt;</span><span class="fl">0.2</span>]<span class="ot">=</span><span class="dv">1</span> <span class="co"># = "Yes"</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_full.pred, car<span class="sc">$</span>Purchase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             
mod_full.pred   No  Yes
           1   197   87
           No 5277  261</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># taux de reussite demarchage (vrais positifs par rapport au positifs predits)</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 87/(197+87) = 0.306338 = 30.6%</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="do">### refaire pour les autres modèles </span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>mod_both_AIC_2.<span class="fl">0.</span>pred[mod_both_AIC_2.<span class="fl">0.</span>probs<span class="sc">&gt;</span><span class="fl">0.2</span>]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_both_AIC_2.<span class="fl">0.</span>pred, car<span class="sc">$</span>Purchase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     
mod_both_AIC_2.0.pred   No  Yes
                   1   181   75
                   No 5293  273</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2929688</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>mod_both_BIC.pred[mod_both_BIC.probs<span class="sc">&gt;</span><span class="fl">0.2</span>]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_both_BIC.pred, car<span class="sc">$</span>Purchase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 
mod_both_BIC.pred   No  Yes
               1   137   50
               No 5337  298</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2673797</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 7 --------------------------------------------------------------</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimer le taux de réussite du démarchage (c’est à dire le nombre de vrais</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="co"># positifs par rapport au nombre de positifs prédits) sur </span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="co"># l’échantillon d’apprentissage pour chaque modèle</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fct de cout : freq vrai posi parmi les posi preddit</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">=</span> <span class="cf">function</span>(r, p){</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># r = reponse</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p = prevision</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="fu">sum</span>(p<span class="sc">&gt;</span><span class="fl">0.2</span> <span class="sc">&amp;</span> r<span class="sc">==</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sum</span>(p<span class="sc">&gt;</span><span class="fl">0.2</span>)</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cost</span>(mod_full<span class="sc">$</span>y, <span class="fu">fitted.values</span>(mod_full))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.306338</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.306338 = 30.6 % </span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="co"># on obtient effectivement le même resultat que calculé précédement </span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cost</span>(mod_both_AIC_2<span class="fl">.0</span><span class="sc">$</span>y, <span class="fu">fitted.values</span>(mod_both_AIC_2<span class="fl">.0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2929688</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  0.2929688</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ca correspond </span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cost</span>(mod_both_BIC<span class="sc">$</span>y, <span class="fu">fitted.values</span>(mod_both_BIC))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2673797</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2673797</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ca correspond </span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Selection  du modele complet</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="co"># MAIS les resultats sont trop optimistes car ils sontobtenus via l'echant d'apprent</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Dans ce cas, il n'est pas etonnant que le plus gros mod (mod_full) soit selectionné </span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="co"># il faut évaluer l'erreur sur echant test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 8 --------------------------------------------------------------</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attachement du package : 'boot'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>L'objet suivant est masqué depuis 'package:psych':

    logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>L'objet suivant est masqué depuis 'package:car':

    logit</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> car, <span class="at">glmfit =</span> mod_full, <span class="at">cost =</span> cost, <span class="at">K=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in model.frame.default(formula = car$Purchase ~ ., data = structure(list(: les longueurs des variables diffèrent (trouvé pour 'MOSTYPE')</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">=</span> <span class="fu">cv.glm</span>(car, mod_both_AIC_2<span class="fl">.0</span>, cost, <span class="at">K=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in model.frame.default(formula = car$Purchase ~ PPERSAUT + MKOOPKLA + : les longueurs des variables diffèrent (trouvé pour 'PPERSAUT')</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">=</span> <span class="fu">cv.glm</span>(car, mod_both_BIC, cost, <span class="at">K=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in model.frame.default(formula = car$Purchase ~ PPERSAUT + PBRAND + : les longueurs des variables diffèrent (trouvé pour 'PPERSAUT')</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="do">## marche pas. pourquoi??? (voir photo code pour réponse)</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>delta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): objet 'res' introuvable</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>res2<span class="sc">$</span>delta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): objet 'res2' introuvable</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>res3<span class="sc">$</span>delta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): objet 'res3' introuvable</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5822   86</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### test #####</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>mod_test <span class="ot">=</span> <span class="fu">glm</span>(Caravan<span class="sc">$</span>Purchase<span class="sc">~</span>., <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> Caravan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: des probabilités ont été ajustées numériquement à 0 ou 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cv.glm</span>(Caravan, mod_test, <span class="at">cost =</span> cost, <span class="at">K=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in model.frame.default(formula = Caravan$Purchase ~ ., data = structure(list(: les longueurs des variables diffèrent (trouvé pour 'MOSTYPE')</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Caravan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    MOSTYPE         MAANTHUI         MGEMOMV         MGEMLEEF    
 Min.   : 1.00   Min.   : 1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:10.00   1st Qu.: 1.000   1st Qu.:2.000   1st Qu.:2.000  
 Median :30.00   Median : 1.000   Median :3.000   Median :3.000  
 Mean   :24.25   Mean   : 1.111   Mean   :2.679   Mean   :2.991  
 3rd Qu.:35.00   3rd Qu.: 1.000   3rd Qu.:3.000   3rd Qu.:3.000  
 Max.   :41.00   Max.   :10.000   Max.   :5.000   Max.   :6.000  
    MOSHOOFD          MGODRK           MGODPR          MGODOV    
 Min.   : 1.000   Min.   :0.0000   Min.   :0.000   Min.   :0.00  
 1st Qu.: 3.000   1st Qu.:0.0000   1st Qu.:4.000   1st Qu.:0.00  
 Median : 7.000   Median :0.0000   Median :5.000   Median :1.00  
 Mean   : 5.774   Mean   :0.6965   Mean   :4.627   Mean   :1.07  
 3rd Qu.: 8.000   3rd Qu.:1.0000   3rd Qu.:6.000   3rd Qu.:2.00  
 Max.   :10.000   Max.   :9.0000   Max.   :9.000   Max.   :5.00  
     MGODGE          MRELGE          MRELSA           MRELOV    
 Min.   :0.000   Min.   :0.000   Min.   :0.0000   Min.   :0.00  
 1st Qu.:2.000   1st Qu.:5.000   1st Qu.:0.0000   1st Qu.:1.00  
 Median :3.000   Median :6.000   Median :1.0000   Median :2.00  
 Mean   :3.259   Mean   :6.183   Mean   :0.8835   Mean   :2.29  
 3rd Qu.:4.000   3rd Qu.:7.000   3rd Qu.:1.0000   3rd Qu.:3.00  
 Max.   :9.000   Max.   :9.000   Max.   :7.0000   Max.   :9.00  
    MFALLEEN        MFGEKIND       MFWEKIND      MOPLHOOG        MOPLMIDD    
 Min.   :0.000   Min.   :0.00   Min.   :0.0   Min.   :0.000   Min.   :0.000  
 1st Qu.:0.000   1st Qu.:2.00   1st Qu.:3.0   1st Qu.:0.000   1st Qu.:2.000  
 Median :2.000   Median :3.00   Median :4.0   Median :1.000   Median :3.000  
 Mean   :1.888   Mean   :3.23   Mean   :4.3   Mean   :1.461   Mean   :3.351  
 3rd Qu.:3.000   3rd Qu.:4.00   3rd Qu.:6.0   3rd Qu.:2.000   3rd Qu.:4.000  
 Max.   :9.000   Max.   :9.00   Max.   :9.0   Max.   :9.000   Max.   :9.000  
    MOPLLAAG        MBERHOOG        MBERZELF        MBERBOER     
 Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.0000  
 1st Qu.:3.000   1st Qu.:0.000   1st Qu.:0.000   1st Qu.:0.0000  
 Median :5.000   Median :2.000   Median :0.000   Median :0.0000  
 Mean   :4.572   Mean   :1.895   Mean   :0.398   Mean   :0.5223  
 3rd Qu.:6.000   3rd Qu.:3.000   3rd Qu.:1.000   3rd Qu.:1.0000  
 Max.   :9.000   Max.   :9.000   Max.   :5.000   Max.   :9.0000  
    MBERMIDD        MBERARBG       MBERARBO          MSKA           MSKB1      
 Min.   :0.000   Min.   :0.00   Min.   :0.000   Min.   :0.000   Min.   :0.000  
 1st Qu.:2.000   1st Qu.:1.00   1st Qu.:1.000   1st Qu.:0.000   1st Qu.:1.000  
 Median :3.000   Median :2.00   Median :2.000   Median :1.000   Median :2.000  
 Mean   :2.899   Mean   :2.22   Mean   :2.306   Mean   :1.621   Mean   :1.607  
 3rd Qu.:4.000   3rd Qu.:3.00   3rd Qu.:3.000   3rd Qu.:2.000   3rd Qu.:2.000  
 Max.   :9.000   Max.   :9.00   Max.   :9.000   Max.   :9.000   Max.   :9.000  
     MSKB2            MSKC            MSKD           MHHUUR     
 Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
 1st Qu.:1.000   1st Qu.:2.000   1st Qu.:0.000   1st Qu.:2.000  
 Median :2.000   Median :4.000   Median :1.000   Median :4.000  
 Mean   :2.203   Mean   :3.759   Mean   :1.067   Mean   :4.237  
 3rd Qu.:3.000   3rd Qu.:5.000   3rd Qu.:2.000   3rd Qu.:7.000  
 Max.   :9.000   Max.   :9.000   Max.   :9.000   Max.   :9.000  
     MHKOOP          MAUT1          MAUT2           MAUT0          MZFONDS     
 Min.   :0.000   Min.   :0.00   Min.   :0.000   Min.   :0.000   Min.   :0.000  
 1st Qu.:2.000   1st Qu.:5.00   1st Qu.:0.000   1st Qu.:1.000   1st Qu.:5.000  
 Median :5.000   Median :6.00   Median :1.000   Median :2.000   Median :7.000  
 Mean   :4.772   Mean   :6.04   Mean   :1.316   Mean   :1.959   Mean   :6.277  
 3rd Qu.:7.000   3rd Qu.:7.00   3rd Qu.:2.000   3rd Qu.:3.000   3rd Qu.:8.000  
 Max.   :9.000   Max.   :9.00   Max.   :7.000   Max.   :9.000   Max.   :9.000  
     MZPART         MINKM30         MINK3045        MINK4575    
 Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:2.000   1st Qu.:1.000  
 Median :2.000   Median :2.000   Median :4.000   Median :3.000  
 Mean   :2.729   Mean   :2.574   Mean   :3.536   Mean   :2.731  
 3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:5.000   3rd Qu.:4.000  
 Max.   :9.000   Max.   :9.000   Max.   :9.000   Max.   :9.000  
    MINK7512         MINK123M         MINKGEM         MKOOPKLA    
 Min.   :0.0000   Min.   :0.0000   Min.   :0.000   Min.   :1.000  
 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:3.000  
 Median :0.0000   Median :0.0000   Median :4.000   Median :4.000  
 Mean   :0.7961   Mean   :0.2027   Mean   :3.784   Mean   :4.236  
 3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:4.000   3rd Qu.:6.000  
 Max.   :9.0000   Max.   :9.0000   Max.   :9.000   Max.   :8.000  
    PWAPART          PWABEDR           PWALAND           PPERSAUT   
 Min.   :0.0000   Min.   :0.00000   Min.   :0.00000   Min.   :0.00  
 1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.00  
 Median :0.0000   Median :0.00000   Median :0.00000   Median :5.00  
 Mean   :0.7712   Mean   :0.04002   Mean   :0.07162   Mean   :2.97  
 3rd Qu.:2.0000   3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:6.00  
 Max.   :3.0000   Max.   :6.00000   Max.   :4.00000   Max.   :8.00  
    PBESAUT           PMOTSCO          PVRAAUT            PAANHANG      
 Min.   :0.00000   Min.   :0.0000   Min.   :0.000000   Min.   :0.00000  
 1st Qu.:0.00000   1st Qu.:0.0000   1st Qu.:0.000000   1st Qu.:0.00000  
 Median :0.00000   Median :0.0000   Median :0.000000   Median :0.00000  
 Mean   :0.04827   Mean   :0.1754   Mean   :0.009447   Mean   :0.02096  
 3rd Qu.:0.00000   3rd Qu.:0.0000   3rd Qu.:0.000000   3rd Qu.:0.00000  
 Max.   :7.00000   Max.   :7.0000   Max.   :9.000000   Max.   :5.00000  
    PTRACTOR           PWERKT            PBROM           PLEVEN      
 Min.   :0.00000   Min.   :0.00000   Min.   :0.000   Min.   :0.0000  
 1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.000   1st Qu.:0.0000  
 Median :0.00000   Median :0.00000   Median :0.000   Median :0.0000  
 Mean   :0.09258   Mean   :0.01305   Mean   :0.215   Mean   :0.1948  
 3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.000   3rd Qu.:0.0000  
 Max.   :6.00000   Max.   :6.00000   Max.   :6.000   Max.   :9.0000  
    PPERSONG          PGEZONG           PWAOREG            PBRAND     
 Min.   :0.00000   Min.   :0.00000   Min.   :0.00000   Min.   :0.000  
 1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.000  
 Median :0.00000   Median :0.00000   Median :0.00000   Median :2.000  
 Mean   :0.01374   Mean   :0.01529   Mean   :0.02353   Mean   :1.828  
 3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:4.000  
 Max.   :6.00000   Max.   :3.00000   Max.   :7.00000   Max.   :8.000  
    PZEILPL             PPLEZIER           PFIETS           PINBOED       
 Min.   :0.0000000   Min.   :0.00000   Min.   :0.00000   Min.   :0.00000  
 1st Qu.:0.0000000   1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.00000  
 Median :0.0000000   Median :0.00000   Median :0.00000   Median :0.00000  
 Mean   :0.0008588   Mean   :0.01889   Mean   :0.02525   Mean   :0.01563  
 3rd Qu.:0.0000000   3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.00000  
 Max.   :3.0000000   Max.   :6.00000   Max.   :1.00000   Max.   :6.00000  
    PBYSTAND          AWAPART         AWABEDR           AWALAND       
 Min.   :0.00000   Min.   :0.000   Min.   :0.00000   Min.   :0.00000  
 1st Qu.:0.00000   1st Qu.:0.000   1st Qu.:0.00000   1st Qu.:0.00000  
 Median :0.00000   Median :0.000   Median :0.00000   Median :0.00000  
 Mean   :0.04758   Mean   :0.403   Mean   :0.01477   Mean   :0.02061  
 3rd Qu.:0.00000   3rd Qu.:1.000   3rd Qu.:0.00000   3rd Qu.:0.00000  
 Max.   :5.00000   Max.   :2.000   Max.   :5.00000   Max.   :1.00000  
    APERSAUT         ABESAUT           AMOTSCO           AVRAAUT        
 Min.   :0.0000   Min.   :0.00000   Min.   :0.00000   Min.   :0.000000  
 1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.000000  
 Median :1.0000   Median :0.00000   Median :0.00000   Median :0.000000  
 Mean   :0.5622   Mean   :0.01048   Mean   :0.04105   Mean   :0.002233  
 3rd Qu.:1.0000   3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.000000  
 Max.   :7.0000   Max.   :4.00000   Max.   :8.00000   Max.   :3.000000  
    AAANHANG          ATRACTOR           AWERKT             ABROM        
 Min.   :0.00000   Min.   :0.00000   Min.   :0.000000   Min.   :0.00000  
 1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.000000   1st Qu.:0.00000  
 Median :0.00000   Median :0.00000   Median :0.000000   Median :0.00000  
 Mean   :0.01254   Mean   :0.03367   Mean   :0.006183   Mean   :0.07042  
 3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.000000   3rd Qu.:0.00000  
 Max.   :3.00000   Max.   :4.00000   Max.   :6.000000   Max.   :2.00000  
     ALEVEN           APERSONG           AGEZONG            AWAOREG        
 Min.   :0.00000   Min.   :0.000000   Min.   :0.000000   Min.   :0.000000  
 1st Qu.:0.00000   1st Qu.:0.000000   1st Qu.:0.000000   1st Qu.:0.000000  
 Median :0.00000   Median :0.000000   Median :0.000000   Median :0.000000  
 Mean   :0.07661   Mean   :0.005325   Mean   :0.006527   Mean   :0.004638  
 3rd Qu.:0.00000   3rd Qu.:0.000000   3rd Qu.:0.000000   3rd Qu.:0.000000  
 Max.   :8.00000   Max.   :1.000000   Max.   :1.000000   Max.   :2.000000  
     ABRAND          AZEILPL             APLEZIER            AFIETS       
 Min.   :0.0000   Min.   :0.0000000   Min.   :0.000000   Min.   :0.00000  
 1st Qu.:0.0000   1st Qu.:0.0000000   1st Qu.:0.000000   1st Qu.:0.00000  
 Median :1.0000   Median :0.0000000   Median :0.000000   Median :0.00000  
 Mean   :0.5701   Mean   :0.0005153   Mean   :0.006012   Mean   :0.03178  
 3rd Qu.:1.0000   3rd Qu.:0.0000000   3rd Qu.:0.000000   3rd Qu.:0.00000  
 Max.   :7.0000   Max.   :1.0000000   Max.   :2.000000   Max.   :3.00000  
    AINBOED            ABYSTAND       Purchase  
 Min.   :0.000000   Min.   :0.00000   No :5474  
 1st Qu.:0.000000   1st Qu.:0.00000   Yes: 348  
 Median :0.000000   Median :0.00000             
 Mean   :0.007901   Mean   :0.01426             
 3rd Qu.:0.000000   3rd Qu.:0.00000             
 Max.   :2.000000   Max.   :2.00000             </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 9 --------------------------------------------------------------</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimer de même le taux de réussite pour chaque modèle lorsque le seuil</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="co"># varie de 0.10 à 0.30 par pas de 0.01</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">21</span>)</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(s <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>)){</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(k) <span class="co"># Concatenate and Print</span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>  res<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod_full,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>  res2<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod_both_AIC_2<span class="fl">.0</span>,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>  res3<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod_both_BIC,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>  mat[<span class="dv">1</span>,k]<span class="ot">=</span>res<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>  mat[<span class="dv">2</span>,k]<span class="ot">=</span>res2<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>  mat[<span class="dv">3</span>,k]<span class="ot">=</span>res3<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in model.frame.default(formula = car$Purchase ~ ., data = structure(list(: les longueurs des variables diffèrent (trouvé pour 'MOSTYPE')</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>),<span class="fu">t</span>(mat),<span class="at">type=</span><span class="st">'l'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in min(x): aucun argument trouvé pour min ; Inf est renvoyé</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in max(x): aucun argument pour max ; -Inf est renvoyé</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in plot.window(...): valeurs finies requises pour 'ylim'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Exercice_04_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>,<span class="fu">c</span>(<span class="st">'Tout'</span>,<span class="st">'AIC'</span>,<span class="st">'BIC'</span>),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co">#repetition 5 fois (tres long)</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>res_seuil<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>  mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">21</span>)</span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(s <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>)){</span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(k)</span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>    res<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a>    res2<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod2,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a>    res3<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod3,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a>    mat[<span class="dv">1</span>,k]<span class="ot">=</span>res<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a>    mat[<span class="dv">2</span>,k]<span class="ot">=</span>res2<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a>    mat[<span class="dv">3</span>,k]<span class="ot">=</span>res3<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb189-22"><a href="#cb189-22" aria-hidden="true" tabindex="-1"></a>  res_seuil[[i]]<span class="ot">=</span>mat</span>
<span id="cb189-23"><a href="#cb189-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in cv.glm(Caravan, mod, cost, K = 10): objet 'mod' introuvable</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>),<span class="fu">t</span>(res_seuil[[<span class="dv">1</span>]]),<span class="at">type=</span><span class="st">'l'</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.15</span>,<span class="fl">0.35</span>),<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in t.default(res_seuil[[1]]): l'argument n'est pas une matrice</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>) <span class="fu">matplot</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>),<span class="fu">t</span>(res_seuil[[i]]),<span class="at">type=</span><span class="st">'l'</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">add=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in t.default(res_seuil[[i]]): l'argument n'est pas une matrice</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>res_moy<span class="ot">=</span>res_seuil[[<span class="dv">1</span>]]</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>) res_moy<span class="ot">=</span>res_moy<span class="sc">+</span>res_seuil[[i]]</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>),<span class="fu">t</span>(res_moy)<span class="sc">/</span><span class="dv">5</span>,<span class="at">type=</span><span class="st">'l'</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">add=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in matplot(seq(0.1, 0.3, 0.01), t(res_moy)/5, type = "l", lty = 1, : 'x' et 'y' doivent avoir le même nombre de lignes</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>,<span class="fu">c</span>(<span class="st">'Tout'</span>,<span class="st">'AIC'</span>,<span class="st">'BIC'</span>),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="co">#On observe que les courbes deviennent tres variables lorsque le seuil grandit. Il y a meme des valeurs manquantes</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="co">#C'est parcequ'il y a tres peu de positifs predits dans ce cas (voire aucun dans certains folds) et donc l'estimation de l'erreur est tres peu precise</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Le meilleur modele semble celui par BIC. </span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Si on veut avoir a la fois un taux de demarchage optimum et un nombre de positifs pas trop faible, un seuil de 0.2 semble pas mal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb199" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Exercice 4"</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Clément Poupelin"</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="co">    embed-resources: false</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: article</span></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> false</span></span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> ["TP"]</span></span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "/img/baseball.png"</span></span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> ""</span></span>
<span id="cb199-21"><a href="#cb199-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb199-22"><a href="#cb199-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-23"><a href="#cb199-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-24"><a href="#cb199-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-25"><a href="#cb199-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup</span></span>
<span id="cb199-26"><a href="#cb199-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-27"><a href="#cb199-27" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb199-28"><a href="#cb199-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## packages</span></span>
<span id="cb199-29"><a href="#cb199-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb199-30"><a href="#cb199-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Données</span></span>
<span id="cb199-31"><a href="#cb199-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)         <span class="co"># Caravan data </span></span>
<span id="cb199-32"><a href="#cb199-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)        <span class="co"># manipulation des données</span></span>
<span id="cb199-33"><a href="#cb199-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-34"><a href="#cb199-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-35"><a href="#cb199-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)          <span class="co"># pour VIF</span></span>
<span id="cb199-36"><a href="#cb199-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-37"><a href="#cb199-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-38"><a href="#cb199-38" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA</span></span>
<span id="cb199-39"><a href="#cb199-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb199-40"><a href="#cb199-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb199-41"><a href="#cb199-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-42"><a href="#cb199-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-43"><a href="#cb199-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb199-44"><a href="#cb199-44" aria-hidden="true" tabindex="-1"></a><span class="do">## ggplot</span></span>
<span id="cb199-45"><a href="#cb199-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb199-46"><a href="#cb199-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)     <span class="co"># transformer les données en format long</span></span>
<span id="cb199-47"><a href="#cb199-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb199-48"><a href="#cb199-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-49"><a href="#cb199-49" aria-hidden="true" tabindex="-1"></a><span class="do">## for pairs panel</span></span>
<span id="cb199-50"><a href="#cb199-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb199-51"><a href="#cb199-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb199-52"><a href="#cb199-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-53"><a href="#cb199-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-54"><a href="#cb199-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-55"><a href="#cb199-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## fonctions</span></span>
<span id="cb199-56"><a href="#cb199-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-57"><a href="#cb199-57" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb199-58"><a href="#cb199-58" aria-hidden="true" tabindex="-1"></a><span class="fu">### boxplot</span></span>
<span id="cb199-59"><a href="#cb199-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-62"><a href="#cb199-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb199-63"><a href="#cb199-63" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb199-64"><a href="#cb199-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transformer les données en format long pour ggplot</span></span>
<span id="cb199-65"><a href="#cb199-65" aria-hidden="true" tabindex="-1"></a>  data_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(data)</span>
<span id="cb199-66"><a href="#cb199-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb199-67"><a href="#cb199-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb199-68"><a href="#cb199-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb199-69"><a href="#cb199-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span>  <span class="co"># Palette de couleurs harmonieuse</span></span>
<span id="cb199-70"><a href="#cb199-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Variables (Boxplot)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Valeurs"</span>) <span class="sc">+</span></span>
<span id="cb199-71"><a href="#cb199-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Thème épuré</span></span>
<span id="cb199-72"><a href="#cb199-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotation des étiquettes</span></span>
<span id="cb199-73"><a href="#cb199-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb199-74"><a href="#cb199-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-75"><a href="#cb199-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-76"><a href="#cb199-76" aria-hidden="true" tabindex="-1"></a><span class="fu">### pairs.panels</span></span>
<span id="cb199-77"><a href="#cb199-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-80"><a href="#cb199-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb199-81"><a href="#cb199-81" aria-hidden="true" tabindex="-1"></a>my_pairs.panels <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb199-82"><a href="#cb199-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs.panels</span>(</span>
<span id="cb199-83"><a href="#cb199-83" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb199-84"><a href="#cb199-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pearson"</span>,      <span class="co"># Méthode de corrélation </span></span>
<span id="cb199-85"><a href="#cb199-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">hist.col =</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Set3"</span>), <span class="co"># Couleurs des histogrammes</span></span>
<span id="cb199-86"><a href="#cb199-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> <span class="cn">TRUE</span>,          <span class="co"># Ajout des courbes de densité</span></span>
<span id="cb199-87"><a href="#cb199-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">ellipses =</span> <span class="cn">TRUE</span>,         <span class="co"># Ajout d'ellipses </span></span>
<span id="cb199-88"><a href="#cb199-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">smooth =</span> <span class="cn">TRUE</span>,           <span class="co"># Ajout de régressions lissées</span></span>
<span id="cb199-89"><a href="#cb199-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">lm =</span> <span class="cn">TRUE</span>,               <span class="co"># Ajout des droites de régression</span></span>
<span id="cb199-90"><a href="#cb199-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"#69b3a2"</span>,         <span class="co"># Couleur des points</span></span>
<span id="cb199-91"><a href="#cb199-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>              <span class="co"># Transparence </span></span>
<span id="cb199-92"><a href="#cb199-92" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb199-93"><a href="#cb199-93" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb199-94"><a href="#cb199-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-95"><a href="#cb199-95" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-96"><a href="#cb199-96" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb199-97"><a href="#cb199-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-98"><a href="#cb199-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-99"><a href="#cb199-99" aria-hidden="true" tabindex="-1"></a><span class="fu"># Données</span></span>
<span id="cb199-100"><a href="#cb199-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-101"><a href="#cb199-101" aria-hidden="true" tabindex="-1"></a>On considère le jeu de données Caravan de la librairie ISLR de R. Ce jeu de données contient, pour 5822 clients d’une assurance, 86 variables décrivant leur profil. La dernière variable Purchase indique si le client a souscrit</span>
<span id="cb199-102"><a href="#cb199-102" aria-hidden="true" tabindex="-1"></a>une assurance pour caravane ou non.</span>
<span id="cb199-103"><a href="#cb199-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-104"><a href="#cb199-104" aria-hidden="true" tabindex="-1"></a>Au vu des dimensions, on se passera de regarder le summary.</span>
<span id="cb199-107"><a href="#cb199-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb199-108"><a href="#cb199-108" aria-hidden="true" tabindex="-1"></a>Caravan <span class="sc">%&gt;%</span> <span class="fu">dim</span>()</span>
<span id="cb199-109"><a href="#cb199-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-110"><a href="#cb199-110" aria-hidden="true" tabindex="-1"></a>Vérifions juste s'il y a des valeurs manquantes </span>
<span id="cb199-113"><a href="#cb199-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb199-114"><a href="#cb199-114" aria-hidden="true" tabindex="-1"></a><span class="fu">anyNA</span>(Caravan)</span>
<span id="cb199-115"><a href="#cb199-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-116"><a href="#cb199-116" aria-hidden="true" tabindex="-1"></a>On s'intéressera à la variable purchase. Celle ci peut déjà nous indiquer que le pourcentage de clients ayant souscrit à une assurance Caravan est de <span class="in">`r round(nrow(subset(Caravan, Caravan$Purchase =="Yes")) * 100 / nrow(Caravan), 2)`</span>%</span>
<span id="cb199-117"><a href="#cb199-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-118"><a href="#cb199-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-119"><a href="#cb199-119" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyse descriptive</span></span>
<span id="cb199-120"><a href="#cb199-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-121"><a href="#cb199-121" aria-hidden="true" tabindex="-1"></a>::::::::::::::::::::: panel-tabset</span>
<span id="cb199-122"><a href="#cb199-122" aria-hidden="true" tabindex="-1"></a><span class="fu">## Boxplot</span></span>
<span id="cb199-123"><a href="#cb199-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-124"><a href="#cb199-124" aria-hidden="true" tabindex="-1"></a>On peut regarder un peu la distribution de nos différents variables quantitatives via des boxplots.</span>
<span id="cb199-125"><a href="#cb199-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-126"><a href="#cb199-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, fig.height=8, fig.width=16}</span></span>
<span id="cb199-127"><a href="#cb199-127" aria-hidden="true" tabindex="-1"></a><span class="fu">my_boxplot</span>(Caravan)</span>
<span id="cb199-128"><a href="#cb199-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-129"><a href="#cb199-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-130"><a href="#cb199-130" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb199-131"><a href="#cb199-131" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb199-132"><a href="#cb199-132" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-133"><a href="#cb199-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-134"><a href="#cb199-134" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb199-135"><a href="#cb199-135" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb199-136"><a href="#cb199-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-137"><a href="#cb199-137" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb199-138"><a href="#cb199-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-139"><a href="#cb199-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-140"><a href="#cb199-140" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-141"><a href="#cb199-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-142"><a href="#cb199-142" aria-hidden="true" tabindex="-1"></a>Pour confirmer cela, on peut faire des boxplot pour uniquement une varibale et ses différents points de temps.</span>
<span id="cb199-143"><a href="#cb199-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-144"><a href="#cb199-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-145"><a href="#cb199-145" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation panel</span></span>
<span id="cb199-146"><a href="#cb199-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-147"><a href="#cb199-147" aria-hidden="true" tabindex="-1"></a>On regarde ici la corrélation calculée entre chacune de nos variables.</span>
<span id="cb199-148"><a href="#cb199-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-149"><a href="#cb199-149" aria-hidden="true" tabindex="-1"></a>Comme nos données sont de grande dimension, on se propose de réduire le nombre d'individus et de prendre seulement quelques variables. Cela ne permettra donc pas d'avoir une étude précise des corrélation mais juste voir si sur un sous échantillon on peut déjà déceler des particularité</span>
<span id="cb199-150"><a href="#cb199-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=22, fig.width=28}</span></span>
<span id="cb199-151"><a href="#cb199-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-152"><a href="#cb199-152" aria-hidden="true" tabindex="-1"></a><span class="fu">my_pairs.panels</span>(Caravan[<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb199-153"><a href="#cb199-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-154"><a href="#cb199-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-155"><a href="#cb199-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-156"><a href="#cb199-156" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb199-157"><a href="#cb199-157" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb199-158"><a href="#cb199-158" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-159"><a href="#cb199-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-160"><a href="#cb199-160" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb199-161"><a href="#cb199-161" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb199-162"><a href="#cb199-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-163"><a href="#cb199-163" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb199-164"><a href="#cb199-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-165"><a href="#cb199-165" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-166"><a href="#cb199-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-167"><a href="#cb199-167" aria-hidden="true" tabindex="-1"></a><span class="fu">## PCA</span></span>
<span id="cb199-168"><a href="#cb199-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-169"><a href="#cb199-169" aria-hidden="true" tabindex="-1"></a>Avec une Analyse en Composantes Principales (PCA) on peut regarder un peu le comportement de nos données.</span>
<span id="cb199-170"><a href="#cb199-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-171"><a href="#cb199-171" aria-hidden="true" tabindex="-1"></a>En effet, Cette méthode respose sur la transformation des variables d'origine en nouvelles variables non corrélées, appelées composantes principales, qui capturent successivement la plus grande variance possible des données.</span>
<span id="cb199-172"><a href="#cb199-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-175"><a href="#cb199-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb199-176"><a href="#cb199-176" aria-hidden="true" tabindex="-1"></a>res_pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(Caravan, </span>
<span id="cb199-177"><a href="#cb199-177" aria-hidden="true" tabindex="-1"></a>               <span class="at">quali.sup =</span> <span class="fu">c</span>(<span class="fu">which</span>(<span class="fu">colnames</span>(Caravan) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Purchase"</span>))),</span>
<span id="cb199-178"><a href="#cb199-178" aria-hidden="true" tabindex="-1"></a>               <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb199-179"><a href="#cb199-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-180"><a href="#cb199-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-181"><a href="#cb199-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-182"><a href="#cb199-182" aria-hidden="true" tabindex="-1"></a>Ici, on spécifi notre variable qualitative en variable supplémentaire, ce qui veut d'ire qu'elles ne seront pas considérés pour la formation de nos composantes principales (variable que l'on cherchera à estimer plus tard).</span>
<span id="cb199-183"><a href="#cb199-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-184"><a href="#cb199-184" aria-hidden="true" tabindex="-1"></a>::::::::::::: panel-tabset</span>
<span id="cb199-185"><a href="#cb199-185" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Barplot des variances</span></span>
<span id="cb199-186"><a href="#cb199-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-187"><a href="#cb199-187" aria-hidden="true" tabindex="-1"></a>Tout d'abord, on peut commencer par regarder le pourcentage de variance expliqué par nos différentes composantes principales.</span>
<span id="cb199-188"><a href="#cb199-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-191"><a href="#cb199-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb199-192"><a href="#cb199-192" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(res_pca, </span>
<span id="cb199-193"><a href="#cb199-193" aria-hidden="true" tabindex="-1"></a>         <span class="at">ncp =</span> <span class="dv">15</span>,</span>
<span id="cb199-194"><a href="#cb199-194" aria-hidden="true" tabindex="-1"></a>         <span class="at">addlabels =</span> <span class="cn">TRUE</span>, </span>
<span id="cb199-195"><a href="#cb199-195" aria-hidden="true" tabindex="-1"></a>         <span class="at">barfill =</span> <span class="st">"coral"</span>,</span>
<span id="cb199-196"><a href="#cb199-196" aria-hidden="true" tabindex="-1"></a>         <span class="at">barcolor =</span> <span class="st">"coral"</span>,</span>
<span id="cb199-197"><a href="#cb199-197" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>),</span>
<span id="cb199-198"><a href="#cb199-198" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">"Percentage of variance of the 15 first components"</span>)</span>
<span id="cb199-199"><a href="#cb199-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-200"><a href="#cb199-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-201"><a href="#cb199-201" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb199-202"><a href="#cb199-202" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb199-203"><a href="#cb199-203" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-204"><a href="#cb199-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-205"><a href="#cb199-205" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb199-206"><a href="#cb199-206" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb199-207"><a href="#cb199-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-208"><a href="#cb199-208" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb199-209"><a href="#cb199-209" aria-hidden="true" tabindex="-1"></a>On voit ainsi que la variance expliqué par nos deux premiers axes est d'environ 16%. Ce qui est une situation que l'on peut facilement retrouver dans des cas de grandes dimensions avec beaucoup de variables.</span>
<span id="cb199-210"><a href="#cb199-210" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-211"><a href="#cb199-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-212"><a href="#cb199-212" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individus</span></span>
<span id="cb199-213"><a href="#cb199-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-214"><a href="#cb199-214" aria-hidden="true" tabindex="-1"></a>Le plan des individus est une projection des observations sur les axes principaux de la PCA. Cette visualisation permet d’identifier des regroupements, tendances et anomalies au sein des données.</span>
<span id="cb199-215"><a href="#cb199-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-216"><a href="#cb199-216" aria-hidden="true" tabindex="-1"></a>Ainsi, des individus proches sur le graphique ont des caractéristiques similaires par rapport aux variables utilisées.</span>
<span id="cb199-217"><a href="#cb199-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-218"><a href="#cb199-218" aria-hidden="true" tabindex="-1"></a>Puis, le placement d'un individu en fonction des axes peut permettre de savoir comment le jouer se caractérise par rapport aux variables qui contribuent le plus à ces axes.</span>
<span id="cb199-219"><a href="#cb199-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-220"><a href="#cb199-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-221"><a href="#cb199-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb199-222"><a href="#cb199-222" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(res_pca,</span>
<span id="cb199-223"><a href="#cb199-223" aria-hidden="true" tabindex="-1"></a>             <span class="at">label=</span><span class="st">"none"</span>, </span>
<span id="cb199-224"><a href="#cb199-224" aria-hidden="true" tabindex="-1"></a>             <span class="at">pointsize =</span> <span class="dv">2</span>,</span>
<span id="cb199-225"><a href="#cb199-225" aria-hidden="true" tabindex="-1"></a>             <span class="at">habillage=</span><span class="fu">as.factor</span>(Caravan<span class="sc">$</span>Purchase),</span>
<span id="cb199-226"><a href="#cb199-226" aria-hidden="true" tabindex="-1"></a>             <span class="at">addEllipses=</span><span class="cn">TRUE</span>,</span>
<span id="cb199-227"><a href="#cb199-227" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.level=</span><span class="fl">0.95</span>)</span>
<span id="cb199-228"><a href="#cb199-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-229"><a href="#cb199-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-230"><a href="#cb199-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-231"><a href="#cb199-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-232"><a href="#cb199-232" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb199-233"><a href="#cb199-233" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb199-234"><a href="#cb199-234" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-235"><a href="#cb199-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-236"><a href="#cb199-236" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb199-237"><a href="#cb199-237" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb199-238"><a href="#cb199-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-239"><a href="#cb199-239" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb199-240"><a href="#cb199-240" aria-hidden="true" tabindex="-1"></a>Ici on voit une repartition plutot uniforme sur le plan qui ne semble pas permettre de distinguer une séparation forte correspodant à notre variable qualitative.</span>
<span id="cb199-241"><a href="#cb199-241" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-242"><a href="#cb199-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-243"><a href="#cb199-243" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb199-244"><a href="#cb199-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-245"><a href="#cb199-245" aria-hidden="true" tabindex="-1"></a>Le cercle des variables est une représentation graphique qui permet d’analyser les relations entre les variables initiales et les composantes principales qui forment nos axes. Il est basé sur les corrélations entre les variables et les axes principaux.</span>
<span id="cb199-246"><a href="#cb199-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-247"><a href="#cb199-247" aria-hidden="true" tabindex="-1"></a>Ainsi, plus une variable est proche du bord du cercle, plus elle est bien représentée sur le plan factoriel et contribue fortement à la formation des axes. Ici, on utilise le cos2 pour le gradient de couleur qui va aider à l'indentifictation de ces différentes qualitées de représentation.</span>
<span id="cb199-248"><a href="#cb199-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-249"><a href="#cb199-249" aria-hidden="true" tabindex="-1"></a>De plus, selon l'angle entre deux varibles, on peut faire des suppositions sur leur corrélation :</span>
<span id="cb199-250"><a href="#cb199-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-251"><a href="#cb199-251" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Si deux variables ont des vecteurs proches (petit angle), elles sont fortement corrélées positivement</span>
<span id="cb199-252"><a href="#cb199-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-253"><a href="#cb199-253" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Si deux variables ont des vecteurs opposés (angle proche de 180°), elles sont corrélées négativement</span>
<span id="cb199-254"><a href="#cb199-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-255"><a href="#cb199-255" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Si l’angle est proche de 90°, alors les variables ne sont pas corrélées</span>
<span id="cb199-256"><a href="#cb199-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-257"><a href="#cb199-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=12}</span></span>
<span id="cb199-258"><a href="#cb199-258" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res_pca, </span>
<span id="cb199-259"><a href="#cb199-259" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.var =</span> <span class="st">"cos2"</span>,</span>
<span id="cb199-260"><a href="#cb199-260" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">rainbow</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">start =</span> .<span class="dv">6</span>, <span class="at">end =</span> .<span class="dv">9</span>),</span>
<span id="cb199-261"><a href="#cb199-261" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb199-262"><a href="#cb199-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-263"><a href="#cb199-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-264"><a href="#cb199-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-265"><a href="#cb199-265" aria-hidden="true" tabindex="-1"></a>:::: success-header</span>
<span id="cb199-266"><a href="#cb199-266" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb199-267"><a href="#cb199-267" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-268"><a href="#cb199-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-269"><a href="#cb199-269" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb199-270"><a href="#cb199-270" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb199-271"><a href="#cb199-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-272"><a href="#cb199-272" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb199-273"><a href="#cb199-273" aria-hidden="true" tabindex="-1"></a>Ici aussi, du fait du grand nombre de variable il est difficile de dicerner quelque chose de pertinent.</span>
<span id="cb199-274"><a href="#cb199-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-275"><a href="#cb199-275" aria-hidden="true" tabindex="-1"></a>Maintenant, certaines variables sont tout de même bien représenter sur nos premiers axes et sont assez proche, ce qui témoigne d'une corrélation entre elles.</span>
<span id="cb199-276"><a href="#cb199-276" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-277"><a href="#cb199-277" aria-hidden="true" tabindex="-1"></a>:::::::::::::</span>
<span id="cb199-278"><a href="#cb199-278" aria-hidden="true" tabindex="-1"></a>:::::::::::::::::::::</span>
<span id="cb199-279"><a href="#cb199-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-280"><a href="#cb199-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-281"><a href="#cb199-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-282"><a href="#cb199-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-283"><a href="#cb199-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-284"><a href="#cb199-284" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyse inférentielle</span></span>
<span id="cb199-285"><a href="#cb199-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-286"><a href="#cb199-286" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modèle brut</span></span>
<span id="cb199-287"><a href="#cb199-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-288"><a href="#cb199-288" aria-hidden="true" tabindex="-1"></a>Ajustons un modèle de régression logistique modélisant la probabilité de souscrire une assurance caravane en fonction de toutes les autres variables à disposition</span>
<span id="cb199-291"><a href="#cb199-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb199-292"><a href="#cb199-292" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Caravan<span class="sc">$</span>Purchase<span class="sc">~</span>.,</span>
<span id="cb199-293"><a href="#cb199-293" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> binomial,</span>
<span id="cb199-294"><a href="#cb199-294" aria-hidden="true" tabindex="-1"></a>                Caravan)</span>
<span id="cb199-295"><a href="#cb199-295" aria-hidden="true" tabindex="-1"></a>mod1 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb199-296"><a href="#cb199-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-297"><a href="#cb199-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-298"><a href="#cb199-298" aria-hidden="true" tabindex="-1"></a>on a ici un modèle avec beaucoup de variable. Mais si on analyse le summary, on constate que seulement 6 varaibales sont significative.</span>
<span id="cb199-299"><a href="#cb199-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-300"><a href="#cb199-300" aria-hidden="true" tabindex="-1"></a>Regardons un peu le VIF pour toutes les variables.</span>
<span id="cb199-301"><a href="#cb199-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=22, fig.width=28}</span></span>
<span id="cb199-302"><a href="#cb199-302" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(mod1)</span>
<span id="cb199-303"><a href="#cb199-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-304"><a href="#cb199-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer en data frame pour ggplot</span></span>
<span id="cb199-305"><a href="#cb199-305" aria-hidden="true" tabindex="-1"></a>vif_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb199-306"><a href="#cb199-306" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(vif_values),</span>
<span id="cb199-307"><a href="#cb199-307" aria-hidden="true" tabindex="-1"></a>  <span class="at">VIF =</span> vif_values</span>
<span id="cb199-308"><a href="#cb199-308" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb199-309"><a href="#cb199-309" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vif_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Variable, VIF), <span class="at">y =</span> <span class="fu">pmin</span>(VIF, <span class="dv">15</span>), <span class="at">fill =</span> VIF <span class="sc">&gt;</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb199-310"><a href="#cb199-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb199-311"><a href="#cb199-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(VIF <span class="sc">&gt;</span> <span class="dv">15</span>, <span class="fu">round</span>(VIF, <span class="dv">1</span>), <span class="st">""</span>)),  </span>
<span id="cb199-312"><a href="#cb199-312" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span>  <span class="co"># Affiche seulement si VIF &gt; 15</span></span>
<span id="cb199-313"><a href="#cb199-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  </span>
<span id="cb199-314"><a href="#cb199-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>)) <span class="sc">+</span></span>
<span id="cb199-315"><a href="#cb199-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variance Inflation Factor (VIF)"</span>,</span>
<span id="cb199-316"><a href="#cb199-316" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variables"</span>,</span>
<span id="cb199-317"><a href="#cb199-317" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"VIF (limité à 15)"</span>) <span class="sc">+</span></span>
<span id="cb199-318"><a href="#cb199-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb199-319"><a href="#cb199-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb199-320"><a href="#cb199-320" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb199-321"><a href="#cb199-321" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb199-322"><a href="#cb199-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-323"><a href="#cb199-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-324"><a href="#cb199-324" aria-hidden="true" tabindex="-1"></a>On constate la présence de beaucoup de valeurs avec un VIF très élevé et donc une forte colinéarité.</span>
<span id="cb199-325"><a href="#cb199-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-326"><a href="#cb199-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-327"><a href="#cb199-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sélecion automatique </span></span>
<span id="cb199-328"><a href="#cb199-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-329"><a href="#cb199-329" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb199-330"><a href="#cb199-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-331"><a href="#cb199-331" aria-hidden="true" tabindex="-1"></a><span class="fu">### AIC</span></span>
<span id="cb199-332"><a href="#cb199-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-333"><a href="#cb199-333" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb199-334"><a href="#cb199-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-335"><a href="#cb199-335" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Forward</span></span>
<span id="cb199-336"><a href="#cb199-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-337"><a href="#cb199-337" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Backward</span></span>
<span id="cb199-338"><a href="#cb199-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-339"><a href="#cb199-339" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Both</span></span>
<span id="cb199-340"><a href="#cb199-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-341"><a href="#cb199-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-342"><a href="#cb199-342" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-343"><a href="#cb199-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-344"><a href="#cb199-344" aria-hidden="true" tabindex="-1"></a><span class="fu">### BIC</span></span>
<span id="cb199-345"><a href="#cb199-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-346"><a href="#cb199-346" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb199-347"><a href="#cb199-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-348"><a href="#cb199-348" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Forward</span></span>
<span id="cb199-349"><a href="#cb199-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-350"><a href="#cb199-350" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Backward</span></span>
<span id="cb199-351"><a href="#cb199-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-352"><a href="#cb199-352" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Both</span></span>
<span id="cb199-353"><a href="#cb199-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-354"><a href="#cb199-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-355"><a href="#cb199-355" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-356"><a href="#cb199-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-357"><a href="#cb199-357" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb199-358"><a href="#cb199-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-359"><a href="#cb199-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-360"><a href="#cb199-360" aria-hidden="true" tabindex="-1"></a>Après toute ces modélisations, rappelons nous tout de même l'objectif de l’assureur est de démarcher des clients de manière ciblée pour</span>
<span id="cb199-361"><a href="#cb199-361" aria-hidden="true" tabindex="-1"></a>leurs faire souscrire une assurance caravane. </span>
<span id="cb199-362"><a href="#cb199-362" aria-hidden="true" tabindex="-1"></a>On pourrait alors de demander : s’il démarchait les clients de façon aléatoire, sans tenir compte de leurs caractéristiques, quel serait environ son taux de réussite ?</span>
<span id="cb199-363"><a href="#cb199-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-364"><a href="#cb199-364" aria-hidden="true" tabindex="-1"></a>Pour cela il suffit juste de ce rappeler du pourcentage donné précédemment qui nous disait la proportion de oui actuellement.</span>
<span id="cb199-365"><a href="#cb199-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-368"><a href="#cb199-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb199-369"><a href="#cb199-369" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">table</span>(Caravan<span class="sc">$</span>Purchase)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="fu">nrow</span>(Caravan), <span class="dv">3</span>)</span>
<span id="cb199-370"><a href="#cb199-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-371"><a href="#cb199-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-372"><a href="#cb199-372" aria-hidden="true" tabindex="-1"></a>Le pourcentage étant très bas, on va souhaiter utiliser l’un des 3 modèles estimés ci-dessus (le global, un de ceux sélectionnés par AIC et un de ceux sélectionnés par BIC) pour cibler les clients à démarcher.</span>
<span id="cb199-373"><a href="#cb199-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-374"><a href="#cb199-374" aria-hidden="true" tabindex="-1"></a>Ainsi on regardera </span>
<span id="cb199-375"><a href="#cb199-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-376"><a href="#cb199-376" aria-hidden="true" tabindex="-1"></a>Si l’on choisissait de démarcher tous les clients ayant une probabilité de souscrire l’assurance supérieure à 0.5, quel pourcentage de clients cela représenterait il pour chacun des 3 modèles estimés ? Quel seuil faudrait-il choisir à la place de 0.5 pour que ce pourcentage corresponde à environ 6% des clients ? On décide dans la suite de fixer ce seuil à 0.2 et on cherche à sélectionner le meilleur modèle parmi les 3 précédents.</span>
<span id="cb199-377"><a href="#cb199-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-378"><a href="#cb199-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-379"><a href="#cb199-379" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb199-380"><a href="#cb199-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-381"><a href="#cb199-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-382"><a href="#cb199-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-383"><a href="#cb199-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-384"><a href="#cb199-384" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session info</span></span>
<span id="cb199-385"><a href="#cb199-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-388"><a href="#cb199-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb199-389"><a href="#cb199-389" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>(<span class="at">pkgs =</span> <span class="st">"attached"</span>)</span>
<span id="cb199-390"><a href="#cb199-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-391"><a href="#cb199-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-392"><a href="#cb199-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-395"><a href="#cb199-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb199-396"><a href="#cb199-396" aria-hidden="true" tabindex="-1"></a>car <span class="ot">&lt;-</span> Caravan</span>
<span id="cb199-397"><a href="#cb199-397" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 3 --------------------------------------------------------------</span></span>
<span id="cb199-398"><a href="#cb199-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-399"><a href="#cb199-399" aria-hidden="true" tabindex="-1"></a>mod_full <span class="ot">=</span> <span class="fu">glm</span>(car<span class="sc">$</span>Purchase<span class="sc">~</span>., <span class="at">family =</span> binomial, car)</span>
<span id="cb199-400"><a href="#cb199-400" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_full)</span>
<span id="cb199-401"><a href="#cb199-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-402"><a href="#cb199-402" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb199-403"><a href="#cb199-403" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod_full) <span class="co"># quelques de vif elevé </span></span>
<span id="cb199-404"><a href="#cb199-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-405"><a href="#cb199-405" aria-hidden="true" tabindex="-1"></a><span class="do">## courbe ROC</span></span>
<span id="cb199-406"><a href="#cb199-406" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb199-407"><a href="#cb199-407" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PresenceAbsence) </span>
<span id="cb199-408"><a href="#cb199-408" aria-hidden="true" tabindex="-1"></a>df_rocr_mod <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase)), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb199-409"><a href="#cb199-409" aria-hidden="true" tabindex="-1"></a>df_rocr_mod[,<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase))</span>
<span id="cb199-410"><a href="#cb199-410" aria-hidden="true" tabindex="-1"></a>df_rocr_mod[,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">as.numeric</span>(mod_full<span class="sc">$</span>y)</span>
<span id="cb199-411"><a href="#cb199-411" aria-hidden="true" tabindex="-1"></a>df_rocr_mod[,<span class="dv">3</span>] <span class="ot">=</span> mod_full<span class="sc">$</span>fitted</span>
<span id="cb199-412"><a href="#cb199-412" aria-hidden="true" tabindex="-1"></a>df_rocr_mod <span class="ot">=</span> <span class="fu">as.data.frame</span>(df_rocr_mod)</span>
<span id="cb199-413"><a href="#cb199-413" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod)[[<span class="dv">2</span>]] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'ID'</span>, <span class="st">"Observed"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb199-414"><a href="#cb199-414" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod)[[<span class="dv">2</span>]]</span>
<span id="cb199-415"><a href="#cb199-415" aria-hidden="true" tabindex="-1"></a><span class="co"># matrice de confusion </span></span>
<span id="cb199-416"><a href="#cb199-416" aria-hidden="true" tabindex="-1"></a><span class="fu">cmx</span>(df_rocr_mod, <span class="at">threshold =</span> <span class="fl">0.5</span>)</span>
<span id="cb199-417"><a href="#cb199-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-418"><a href="#cb199-418" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la specificite et de la sensibilite</span></span>
<span id="cb199-419"><a href="#cb199-419" aria-hidden="true" tabindex="-1"></a><span class="fu">sensitivity</span>(<span class="fu">cmx</span>(df_rocr_mod,<span class="at">threshold=</span><span class="fl">0.5</span>))</span>
<span id="cb199-420"><a href="#cb199-420" aria-hidden="true" tabindex="-1"></a><span class="fu">specificity</span>(<span class="fu">cmx</span>(df_rocr_mod,<span class="at">threshold=</span><span class="fl">0.5</span>))</span>
<span id="cb199-421"><a href="#cb199-421" aria-hidden="true" tabindex="-1"></a><span class="co"># Courbe ROC pour le modele logistique CHD</span></span>
<span id="cb199-422"><a href="#cb199-422" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.plot.calculate</span>(df_rocr_mod)</span>
<span id="cb199-423"><a href="#cb199-423" aria-hidden="true" tabindex="-1"></a><span class="fu">auc.roc.plot</span>(df_rocr_mod) <span class="co"># graphe courbe ROC</span></span>
<span id="cb199-424"><a href="#cb199-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-425"><a href="#cb199-425" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(df_rocr_mod) <span class="co"># calcul AUC </span></span>
<span id="cb199-426"><a href="#cb199-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-427"><a href="#cb199-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-428"><a href="#cb199-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-431"><a href="#cb199-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb199-432"><a href="#cb199-432" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 4 --------------------------------------------------------------</span></span>
<span id="cb199-433"><a href="#cb199-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-434"><a href="#cb199-434" aria-hidden="true" tabindex="-1"></a>mod_start <span class="ot">=</span> <span class="fu">glm</span>(car<span class="sc">$</span>Purchase<span class="sc">~</span><span class="dv">1</span>, <span class="at">family =</span> binomial, car)</span>
<span id="cb199-435"><a href="#cb199-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-436"><a href="#cb199-436" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC k = 2 </span></span>
<span id="cb199-437"><a href="#cb199-437" aria-hidden="true" tabindex="-1"></a>mod_both_AIC <span class="ot">=</span> <span class="fu">step</span>(mod_start, <span class="at">scope =</span> <span class="fu">formula</span>(mod_full), <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb199-438"><a href="#cb199-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-439"><a href="#cb199-439" aria-hidden="true" tabindex="-1"></a><span class="co"># BIC k = log(n)</span></span>
<span id="cb199-440"><a href="#cb199-440" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">dim</span>(car)[<span class="dv">1</span>]</span>
<span id="cb199-441"><a href="#cb199-441" aria-hidden="true" tabindex="-1"></a>mod_both_BIC <span class="ot">=</span> <span class="fu">step</span>(mod_start, <span class="at">scope =</span> <span class="fu">formula</span>(mod_full), <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">k =</span> <span class="fu">log</span>(n))</span>
<span id="cb199-442"><a href="#cb199-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-443"><a href="#cb199-443" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_both_AIC)</span>
<span id="cb199-444"><a href="#cb199-444" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_both_BIC)</span>
<span id="cb199-445"><a href="#cb199-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-446"><a href="#cb199-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-447"><a href="#cb199-447" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod_both_AIC)</span>
<span id="cb199-448"><a href="#cb199-448" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod_both_BIC)</span>
<span id="cb199-449"><a href="#cb199-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-450"><a href="#cb199-450" aria-hidden="true" tabindex="-1"></a><span class="co"># on a encore un peu de colinearité pour des var du modèle selec avec AIC</span></span>
<span id="cb199-451"><a href="#cb199-451" aria-hidden="true" tabindex="-1"></a><span class="co"># plus de colinearité pour le model selec avec BIC</span></span>
<span id="cb199-452"><a href="#cb199-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-453"><a href="#cb199-453" aria-hidden="true" tabindex="-1"></a><span class="co"># Il serait preferable de garder le mod_both_BIC</span></span>
<span id="cb199-454"><a href="#cb199-454" aria-hidden="true" tabindex="-1"></a><span class="co">#mais on peut aussi enlever les variables au vif elevé </span></span>
<span id="cb199-455"><a href="#cb199-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-456"><a href="#cb199-456" aria-hidden="true" tabindex="-1"></a>mod_both_AIC_2<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> car<span class="sc">$</span>Purchase <span class="sc">~</span> PPERSAUT <span class="sc">+</span> MKOOPKLA <span class="sc">+</span> PBRAND <span class="sc">+</span> APLEZIER <span class="sc">+</span> </span>
<span id="cb199-457"><a href="#cb199-457" aria-hidden="true" tabindex="-1"></a>                         MOPLLAAG <span class="sc">+</span> MBERBOER <span class="sc">+</span> MRELGE <span class="sc">+</span> PWALAND <span class="sc">+</span> AFIETS <span class="sc">+</span> MINK123M <span class="sc">+</span> </span>
<span id="cb199-458"><a href="#cb199-458" aria-hidden="true" tabindex="-1"></a>                         MINKGEM <span class="sc">+</span> MGEMLEEF <span class="sc">+</span> PWAPART <span class="sc">+</span> ABYSTAND <span class="sc">+</span> ABRAND <span class="sc">+</span> </span>
<span id="cb199-459"><a href="#cb199-459" aria-hidden="true" tabindex="-1"></a>                         AWERKT <span class="sc">+</span> MGODPR <span class="sc">+</span> MSKC <span class="sc">+</span> MOPLHOOG <span class="sc">+</span> MBERMIDD, <span class="at">family =</span> binomial, </span>
<span id="cb199-460"><a href="#cb199-460" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> car)</span>
<span id="cb199-461"><a href="#cb199-461" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_both_AIC_2<span class="fl">.0</span>)</span>
<span id="cb199-462"><a href="#cb199-462" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod_both_AIC_2<span class="fl">.0</span>)</span>
<span id="cb199-463"><a href="#cb199-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-464"><a href="#cb199-464" aria-hidden="true" tabindex="-1"></a><span class="co"># on analyse tout de même tout les modèle </span></span>
<span id="cb199-465"><a href="#cb199-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-466"><a href="#cb199-466" aria-hidden="true" tabindex="-1"></a><span class="do">#####</span></span>
<span id="cb199-467"><a href="#cb199-467" aria-hidden="true" tabindex="-1"></a><span class="co"># df_rocr_mod_both_AIC</span></span>
<span id="cb199-468"><a href="#cb199-468" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase)), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb199-469"><a href="#cb199-469" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC[,<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase))</span>
<span id="cb199-470"><a href="#cb199-470" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC[,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">as.numeric</span>(mod_both_AIC<span class="sc">$</span>y)</span>
<span id="cb199-471"><a href="#cb199-471" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC[,<span class="dv">3</span>] <span class="ot">=</span> mod_both_AIC<span class="sc">$</span>fitted</span>
<span id="cb199-472"><a href="#cb199-472" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC <span class="ot">=</span> <span class="fu">as.data.frame</span>(df_rocr_mod_both_AIC)</span>
<span id="cb199-473"><a href="#cb199-473" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_AIC)[[<span class="dv">2</span>]] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'ID'</span>, <span class="st">"Observed"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb199-474"><a href="#cb199-474" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_AIC)[[<span class="dv">2</span>]]</span>
<span id="cb199-475"><a href="#cb199-475" aria-hidden="true" tabindex="-1"></a><span class="co"># matrice de confusion </span></span>
<span id="cb199-476"><a href="#cb199-476" aria-hidden="true" tabindex="-1"></a><span class="fu">cmx</span>(df_rocr_mod_both_AIC, <span class="at">threshold =</span> <span class="fl">0.5</span>)</span>
<span id="cb199-477"><a href="#cb199-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-478"><a href="#cb199-478" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la specificite et de la sensibilite</span></span>
<span id="cb199-479"><a href="#cb199-479" aria-hidden="true" tabindex="-1"></a><span class="fu">sensitivity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_AIC,<span class="at">threshold=</span><span class="fl">0.5</span>))</span>
<span id="cb199-480"><a href="#cb199-480" aria-hidden="true" tabindex="-1"></a><span class="fu">specificity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_AIC,<span class="at">threshold=</span><span class="fl">0.5</span>))</span>
<span id="cb199-481"><a href="#cb199-481" aria-hidden="true" tabindex="-1"></a><span class="co"># Courbe ROC pour le modele logistique CHD</span></span>
<span id="cb199-482"><a href="#cb199-482" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.plot.calculate</span>(df_rocr_mod_both_AIC)</span>
<span id="cb199-483"><a href="#cb199-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-484"><a href="#cb199-484" aria-hidden="true" tabindex="-1"></a><span class="co"># df_rocr_mod_both_AIC_2.0</span></span>
<span id="cb199-485"><a href="#cb199-485" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC_2<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase)), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb199-486"><a href="#cb199-486" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC_2<span class="fl">.0</span>[,<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase))</span>
<span id="cb199-487"><a href="#cb199-487" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC_2<span class="fl">.0</span>[,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">as.numeric</span>(mod_both_AIC_2<span class="fl">.0</span><span class="sc">$</span>y)</span>
<span id="cb199-488"><a href="#cb199-488" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC_2<span class="fl">.0</span>[,<span class="dv">3</span>] <span class="ot">=</span> mod_both_AIC_2<span class="fl">.0</span><span class="sc">$</span>fitted</span>
<span id="cb199-489"><a href="#cb199-489" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_AIC_2<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>)</span>
<span id="cb199-490"><a href="#cb199-490" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>)[[<span class="dv">2</span>]] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'ID'</span>, <span class="st">"Observed"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb199-491"><a href="#cb199-491" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>)[[<span class="dv">2</span>]]</span>
<span id="cb199-492"><a href="#cb199-492" aria-hidden="true" tabindex="-1"></a><span class="co"># matrice de confusion </span></span>
<span id="cb199-493"><a href="#cb199-493" aria-hidden="true" tabindex="-1"></a><span class="fu">cmx</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>, <span class="at">threshold =</span> <span class="fl">0.5</span>)</span>
<span id="cb199-494"><a href="#cb199-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-495"><a href="#cb199-495" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la specificite et de la sensibilite</span></span>
<span id="cb199-496"><a href="#cb199-496" aria-hidden="true" tabindex="-1"></a><span class="fu">sensitivity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>,<span class="at">threshold=</span><span class="fl">0.5</span>))</span>
<span id="cb199-497"><a href="#cb199-497" aria-hidden="true" tabindex="-1"></a><span class="fu">specificity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>,<span class="at">threshold=</span><span class="fl">0.5</span>))</span>
<span id="cb199-498"><a href="#cb199-498" aria-hidden="true" tabindex="-1"></a><span class="co"># Courbe ROC pour le modele logistique CHD</span></span>
<span id="cb199-499"><a href="#cb199-499" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.plot.calculate</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>)</span>
<span id="cb199-500"><a href="#cb199-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-501"><a href="#cb199-501" aria-hidden="true" tabindex="-1"></a><span class="co"># df_rocr_mod_both_BIC</span></span>
<span id="cb199-502"><a href="#cb199-502" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_BIC <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase)), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb199-503"><a href="#cb199-503" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_BIC[,<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="fu">as.matrix</span>(car<span class="sc">$</span>Purchase))</span>
<span id="cb199-504"><a href="#cb199-504" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_BIC[,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">as.numeric</span>(mod_both_BIC<span class="sc">$</span>y)</span>
<span id="cb199-505"><a href="#cb199-505" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_BIC[,<span class="dv">3</span>] <span class="ot">=</span> mod_both_BIC<span class="sc">$</span>fitted</span>
<span id="cb199-506"><a href="#cb199-506" aria-hidden="true" tabindex="-1"></a>df_rocr_mod_both_BIC <span class="ot">=</span> <span class="fu">as.data.frame</span>(df_rocr_mod_both_BIC)</span>
<span id="cb199-507"><a href="#cb199-507" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_BIC)[[<span class="dv">2</span>]] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'ID'</span>, <span class="st">"Observed"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb199-508"><a href="#cb199-508" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(df_rocr_mod_both_BIC)[[<span class="dv">2</span>]]</span>
<span id="cb199-509"><a href="#cb199-509" aria-hidden="true" tabindex="-1"></a><span class="co"># matrice de confusion </span></span>
<span id="cb199-510"><a href="#cb199-510" aria-hidden="true" tabindex="-1"></a><span class="fu">cmx</span>(df_rocr_mod_both_BIC, <span class="at">threshold =</span> <span class="fl">0.5</span>)</span>
<span id="cb199-511"><a href="#cb199-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-512"><a href="#cb199-512" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la specificite et de la sensibilite</span></span>
<span id="cb199-513"><a href="#cb199-513" aria-hidden="true" tabindex="-1"></a><span class="fu">sensitivity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_BIC,<span class="at">threshold=</span><span class="fl">0.5</span>))</span>
<span id="cb199-514"><a href="#cb199-514" aria-hidden="true" tabindex="-1"></a><span class="fu">specificity</span>(<span class="fu">cmx</span>(df_rocr_mod_both_BIC,<span class="at">threshold=</span><span class="fl">0.5</span>))</span>
<span id="cb199-515"><a href="#cb199-515" aria-hidden="true" tabindex="-1"></a><span class="co"># Courbe ROC pour le modele logistique CHD</span></span>
<span id="cb199-516"><a href="#cb199-516" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.plot.calculate</span>(df_rocr_mod_both_BIC)</span>
<span id="cb199-517"><a href="#cb199-517" aria-hidden="true" tabindex="-1"></a><span class="do">#####</span></span>
<span id="cb199-518"><a href="#cb199-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-519"><a href="#cb199-519" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb199-520"><a href="#cb199-520" aria-hidden="true" tabindex="-1"></a><span class="fu">auc.roc.plot</span>(df_rocr_mod, <span class="at">main =</span> <span class="st">"ROC plot mod_full"</span>)</span>
<span id="cb199-521"><a href="#cb199-521" aria-hidden="true" tabindex="-1"></a><span class="fu">auc.roc.plot</span>(df_rocr_mod_both_AIC, <span class="at">main =</span> <span class="st">"ROC plot mod_both_AIC"</span>)</span>
<span id="cb199-522"><a href="#cb199-522" aria-hidden="true" tabindex="-1"></a><span class="fu">auc.roc.plot</span>(df_rocr_mod_both_AIC_2<span class="fl">.0</span>, <span class="at">main =</span> <span class="st">"ROC plot mod_both_AIC_2.0"</span>)</span>
<span id="cb199-523"><a href="#cb199-523" aria-hidden="true" tabindex="-1"></a><span class="fu">auc.roc.plot</span>(df_rocr_mod_both_BIC, <span class="at">main =</span> <span class="st">"ROC plot mod_both_BIC"</span>) <span class="co"># graphe courbe ROC</span></span>
<span id="cb199-524"><a href="#cb199-524" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb199-525"><a href="#cb199-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-526"><a href="#cb199-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-527"><a href="#cb199-527" aria-hidden="true" tabindex="-1"></a><span class="co"># On veut maximiser l'AUC, ici les valeurs sont très proche </span></span>
<span id="cb199-528"><a href="#cb199-528" aria-hidden="true" tabindex="-1"></a><span class="co"># donc on peut quand même préféré le petit modele (BIC) meme si AUC plus faible</span></span>
<span id="cb199-529"><a href="#cb199-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-530"><a href="#cb199-530" aria-hidden="true" tabindex="-1"></a><span class="do">## On compare avec anova </span></span>
<span id="cb199-531"><a href="#cb199-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-532"><a href="#cb199-532" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_full, mod_both_AIC_2<span class="fl">.0</span>)</span>
<span id="cb199-533"><a href="#cb199-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-534"><a href="#cb199-534" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_full, mod_both_BIC)</span>
<span id="cb199-535"><a href="#cb199-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-536"><a href="#cb199-536" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_both_AIC_2<span class="fl">.0</span>, mod_both_BIC)</span>
<span id="cb199-537"><a href="#cb199-537" aria-hidden="true" tabindex="-1"></a><span class="do">### INTERPRETATION ???????</span></span>
<span id="cb199-538"><a href="#cb199-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-539"><a href="#cb199-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-540"><a href="#cb199-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-541"><a href="#cb199-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb199-542"><a href="#cb199-542" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 5 --------------------------------------------------------------</span></span>
<span id="cb199-543"><a href="#cb199-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-544"><a href="#cb199-544" aria-hidden="true" tabindex="-1"></a><span class="co">#demarche aléatoire conduit à 6%</span></span>
<span id="cb199-545"><a href="#cb199-545" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">table</span>(car<span class="sc">$</span>Purchase)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>n, <span class="dv">3</span>)</span>
<span id="cb199-546"><a href="#cb199-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-547"><a href="#cb199-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-548"><a href="#cb199-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 6 --------------------------------------------------------------</span></span>
<span id="cb199-549"><a href="#cb199-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-550"><a href="#cb199-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-551"><a href="#cb199-551" aria-hidden="true" tabindex="-1"></a>mod_full.probs<span class="ot">=</span><span class="fu">predict</span>(mod_full, car, <span class="at">type=</span><span class="st">"response"</span>)<span class="co"># --&gt; donne les proba</span></span>
<span id="cb199-552"><a href="#cb199-552" aria-hidden="true" tabindex="-1"></a>mod_full.pred<span class="ot">=</span><span class="fu">rep</span>(<span class="st">"No"</span>, n)</span>
<span id="cb199-553"><a href="#cb199-553" aria-hidden="true" tabindex="-1"></a>mod_full.pred[mod_full.probs<span class="sc">&gt;</span>.<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Yes"</span></span>
<span id="cb199-554"><a href="#cb199-554" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_full.pred, car<span class="sc">$</span>Purchase)</span>
<span id="cb199-555"><a href="#cb199-555" aria-hidden="true" tabindex="-1"></a><span class="co"># taux de reussitz de démarchage </span></span>
<span id="cb199-556"><a href="#cb199-556" aria-hidden="true" tabindex="-1"></a><span class="co"># (i.e, le nb de vrais positifs par rapport au nb de positifs prédit)</span></span>
<span id="cb199-557"><a href="#cb199-557" aria-hidden="true" tabindex="-1"></a><span class="co"># 7/(8+7) = 0.4666667</span></span>
<span id="cb199-558"><a href="#cb199-558" aria-hidden="true" tabindex="-1"></a><span class="co"># on arrive à prévoir les souscriptions d'assurances dans 47% des cas</span></span>
<span id="cb199-559"><a href="#cb199-559" aria-hidden="true" tabindex="-1"></a><span class="co"># (8+341)/n = 6% erreur de classification</span></span>
<span id="cb199-560"><a href="#cb199-560" aria-hidden="true" tabindex="-1"></a><span class="co"># (7+5466)/n = 94% precision ou accuracy</span></span>
<span id="cb199-561"><a href="#cb199-561" aria-hidden="true" tabindex="-1"></a><span class="co"># sensibility = 7/(7+341) =0.02</span></span>
<span id="cb199-562"><a href="#cb199-562" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mod_full.pred <span class="sc">==</span> car<span class="sc">$</span>Purchase) <span class="co"># ne marche pas ??</span></span>
<span id="cb199-563"><a href="#cb199-563" aria-hidden="true" tabindex="-1"></a><span class="co"># = 0</span></span>
<span id="cb199-564"><a href="#cb199-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-565"><a href="#cb199-565" aria-hidden="true" tabindex="-1"></a>mod_both_AIC_2.<span class="fl">0.</span>probs<span class="ot">=</span><span class="fu">predict</span>(mod_both_AIC_2<span class="fl">.0</span>, car, <span class="at">type=</span><span class="st">"response"</span>)<span class="co"># --&gt; donne les proba</span></span>
<span id="cb199-566"><a href="#cb199-566" aria-hidden="true" tabindex="-1"></a>mod_both_AIC_2.<span class="fl">0.</span>pred<span class="ot">=</span><span class="fu">rep</span>(<span class="st">"No"</span>, n)</span>
<span id="cb199-567"><a href="#cb199-567" aria-hidden="true" tabindex="-1"></a>mod_both_AIC_2.<span class="fl">0.</span>pred[mod_both_AIC_2.<span class="fl">0.</span>probs<span class="sc">&gt;</span>.<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Yes"</span></span>
<span id="cb199-568"><a href="#cb199-568" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_both_AIC_2.<span class="fl">0.</span>pred, car<span class="sc">$</span>Purchase)</span>
<span id="cb199-569"><a href="#cb199-569" aria-hidden="true" tabindex="-1"></a><span class="co"># refaire l'analyse du dessus </span></span>
<span id="cb199-570"><a href="#cb199-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-571"><a href="#cb199-571" aria-hidden="true" tabindex="-1"></a>mod_both_BIC.probs<span class="ot">=</span><span class="fu">predict</span>(mod_both_BIC, car, <span class="at">type=</span><span class="st">"response"</span>)<span class="co"># --&gt; donne les proba</span></span>
<span id="cb199-572"><a href="#cb199-572" aria-hidden="true" tabindex="-1"></a>mod_both_BIC.pred<span class="ot">=</span><span class="fu">rep</span>(<span class="st">"No"</span>, n)</span>
<span id="cb199-573"><a href="#cb199-573" aria-hidden="true" tabindex="-1"></a>mod_both_BIC.pred[mod_both_BIC.probs<span class="sc">&gt;</span>.<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Yes"</span></span>
<span id="cb199-574"><a href="#cb199-574" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_both_BIC.pred, car<span class="sc">$</span>Purchase)</span>
<span id="cb199-575"><a href="#cb199-575" aria-hidden="true" tabindex="-1"></a><span class="co"># refaire l'analyse du dessus </span></span>
<span id="cb199-576"><a href="#cb199-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-577"><a href="#cb199-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-578"><a href="#cb199-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-579"><a href="#cb199-579" aria-hidden="true" tabindex="-1"></a><span class="co">#  % de clients ayant une proba &gt;0.5</span></span>
<span id="cb199-580"><a href="#cb199-580" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(<span class="fu">fitted.values</span>(mod_full)<span class="sc">&gt;</span><span class="fl">0.5</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>n, <span class="dv">3</span>)</span>
<span id="cb199-581"><a href="#cb199-581" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.26%</span></span>
<span id="cb199-582"><a href="#cb199-582" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">fitted.values</span>(mod_full))</span>
<span id="cb199-583"><a href="#cb199-583" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">fitted.values</span>(mod_full), <span class="fl">0.94</span>) <span class="co"># seuil pour que ce % corresponde à environ 6% des clients</span></span>
<span id="cb199-584"><a href="#cb199-584" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1807236 </span></span>
<span id="cb199-585"><a href="#cb199-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-586"><a href="#cb199-586" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(<span class="fu">fitted.values</span>(mod_both_AIC_2<span class="fl">.0</span>)<span class="sc">&gt;</span><span class="fl">0.5</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>n, <span class="dv">3</span>)</span>
<span id="cb199-587"><a href="#cb199-587" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.223</span></span>
<span id="cb199-588"><a href="#cb199-588" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">fitted.values</span>(mod_both_AIC_2<span class="fl">.0</span>))</span>
<span id="cb199-589"><a href="#cb199-589" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">fitted.values</span>(mod_both_AIC_2<span class="fl">.0</span>), <span class="fl">0.94</span>)</span>
<span id="cb199-590"><a href="#cb199-590" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1759159</span></span>
<span id="cb199-591"><a href="#cb199-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-592"><a href="#cb199-592" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(<span class="fu">fitted.values</span>(mod_both_BIC)<span class="sc">&gt;</span><span class="fl">0.5</span>)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>n, <span class="dv">3</span>)</span>
<span id="cb199-593"><a href="#cb199-593" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.137</span></span>
<span id="cb199-594"><a href="#cb199-594" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">fitted.values</span>(mod_both_BIC))</span>
<span id="cb199-595"><a href="#cb199-595" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">fitted.values</span>(mod_both_BIC), <span class="fl">0.94</span>)</span>
<span id="cb199-596"><a href="#cb199-596" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1659636 </span></span>
<span id="cb199-597"><a href="#cb199-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-598"><a href="#cb199-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-599"><a href="#cb199-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-600"><a href="#cb199-600" aria-hidden="true" tabindex="-1"></a><span class="do">########</span></span>
<span id="cb199-601"><a href="#cb199-601" aria-hidden="true" tabindex="-1"></a><span class="co"># On décide dans la suite de fixer ce seuil à 0.2 et on cherche à sélectionner </span></span>
<span id="cb199-602"><a href="#cb199-602" aria-hidden="true" tabindex="-1"></a><span class="co"># le meilleur modèle parmi les 3 précédents.</span></span>
<span id="cb199-603"><a href="#cb199-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-604"><a href="#cb199-604" aria-hidden="true" tabindex="-1"></a><span class="co"># on change le seuil</span></span>
<span id="cb199-605"><a href="#cb199-605" aria-hidden="true" tabindex="-1"></a>mod_full.pred[mod_full.probs<span class="sc">&gt;</span><span class="fl">0.2</span>]<span class="ot">=</span><span class="dv">1</span> <span class="co"># = "Yes"</span></span>
<span id="cb199-606"><a href="#cb199-606" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_full.pred, car<span class="sc">$</span>Purchase)</span>
<span id="cb199-607"><a href="#cb199-607" aria-hidden="true" tabindex="-1"></a><span class="co"># taux de reussite demarchage (vrais positifs par rapport au positifs predits)</span></span>
<span id="cb199-608"><a href="#cb199-608" aria-hidden="true" tabindex="-1"></a><span class="co"># 87/(197+87) = 0.306338 = 30.6%</span></span>
<span id="cb199-609"><a href="#cb199-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-610"><a href="#cb199-610" aria-hidden="true" tabindex="-1"></a><span class="do">### refaire pour les autres modèles </span></span>
<span id="cb199-611"><a href="#cb199-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-612"><a href="#cb199-612" aria-hidden="true" tabindex="-1"></a>mod_both_AIC_2.<span class="fl">0.</span>pred[mod_both_AIC_2.<span class="fl">0.</span>probs<span class="sc">&gt;</span><span class="fl">0.2</span>]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb199-613"><a href="#cb199-613" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_both_AIC_2.<span class="fl">0.</span>pred, car<span class="sc">$</span>Purchase)</span>
<span id="cb199-614"><a href="#cb199-614" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2929688</span></span>
<span id="cb199-615"><a href="#cb199-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-616"><a href="#cb199-616" aria-hidden="true" tabindex="-1"></a>mod_both_BIC.pred[mod_both_BIC.probs<span class="sc">&gt;</span><span class="fl">0.2</span>]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb199-617"><a href="#cb199-617" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mod_both_BIC.pred, car<span class="sc">$</span>Purchase)</span>
<span id="cb199-618"><a href="#cb199-618" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2673797</span></span>
<span id="cb199-619"><a href="#cb199-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-620"><a href="#cb199-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-621"><a href="#cb199-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-622"><a href="#cb199-622" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb199-623"><a href="#cb199-623" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 7 --------------------------------------------------------------</span></span>
<span id="cb199-624"><a href="#cb199-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-625"><a href="#cb199-625" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimer le taux de réussite du démarchage (c’est à dire le nombre de vrais</span></span>
<span id="cb199-626"><a href="#cb199-626" aria-hidden="true" tabindex="-1"></a><span class="co"># positifs par rapport au nombre de positifs prédits) sur </span></span>
<span id="cb199-627"><a href="#cb199-627" aria-hidden="true" tabindex="-1"></a><span class="co"># l’échantillon d’apprentissage pour chaque modèle</span></span>
<span id="cb199-628"><a href="#cb199-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-629"><a href="#cb199-629" aria-hidden="true" tabindex="-1"></a><span class="co"># fct de cout : freq vrai posi parmi les posi preddit</span></span>
<span id="cb199-630"><a href="#cb199-630" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">=</span> <span class="cf">function</span>(r, p){</span>
<span id="cb199-631"><a href="#cb199-631" aria-hidden="true" tabindex="-1"></a>  <span class="co"># r = reponse</span></span>
<span id="cb199-632"><a href="#cb199-632" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p = prevision</span></span>
<span id="cb199-633"><a href="#cb199-633" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="fu">sum</span>(p<span class="sc">&gt;</span><span class="fl">0.2</span> <span class="sc">&amp;</span> r<span class="sc">==</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sum</span>(p<span class="sc">&gt;</span><span class="fl">0.2</span>)</span>
<span id="cb199-634"><a href="#cb199-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb199-635"><a href="#cb199-635" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb199-636"><a href="#cb199-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-637"><a href="#cb199-637" aria-hidden="true" tabindex="-1"></a><span class="fu">cost</span>(mod_full<span class="sc">$</span>y, <span class="fu">fitted.values</span>(mod_full))</span>
<span id="cb199-638"><a href="#cb199-638" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.306338 = 30.6 % </span></span>
<span id="cb199-639"><a href="#cb199-639" aria-hidden="true" tabindex="-1"></a><span class="co"># on obtient effectivement le même resultat que calculé précédement </span></span>
<span id="cb199-640"><a href="#cb199-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-641"><a href="#cb199-641" aria-hidden="true" tabindex="-1"></a><span class="fu">cost</span>(mod_both_AIC_2<span class="fl">.0</span><span class="sc">$</span>y, <span class="fu">fitted.values</span>(mod_both_AIC_2<span class="fl">.0</span>))</span>
<span id="cb199-642"><a href="#cb199-642" aria-hidden="true" tabindex="-1"></a><span class="co">#  0.2929688</span></span>
<span id="cb199-643"><a href="#cb199-643" aria-hidden="true" tabindex="-1"></a><span class="co"># ca correspond </span></span>
<span id="cb199-644"><a href="#cb199-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-645"><a href="#cb199-645" aria-hidden="true" tabindex="-1"></a><span class="fu">cost</span>(mod_both_BIC<span class="sc">$</span>y, <span class="fu">fitted.values</span>(mod_both_BIC))</span>
<span id="cb199-646"><a href="#cb199-646" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2673797</span></span>
<span id="cb199-647"><a href="#cb199-647" aria-hidden="true" tabindex="-1"></a><span class="co"># ca correspond </span></span>
<span id="cb199-648"><a href="#cb199-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-649"><a href="#cb199-649" aria-hidden="true" tabindex="-1"></a><span class="do">## Selection  du modele complet</span></span>
<span id="cb199-650"><a href="#cb199-650" aria-hidden="true" tabindex="-1"></a><span class="co"># MAIS les resultats sont trop optimistes car ils sontobtenus via l'echant d'apprent</span></span>
<span id="cb199-651"><a href="#cb199-651" aria-hidden="true" tabindex="-1"></a><span class="co"># Dans ce cas, il n'est pas etonnant que le plus gros mod (mod_full) soit selectionné </span></span>
<span id="cb199-652"><a href="#cb199-652" aria-hidden="true" tabindex="-1"></a><span class="co"># il faut évaluer l'erreur sur echant test</span></span>
<span id="cb199-653"><a href="#cb199-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-654"><a href="#cb199-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-655"><a href="#cb199-655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-656"><a href="#cb199-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-657"><a href="#cb199-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb199-658"><a href="#cb199-658" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 8 --------------------------------------------------------------</span></span>
<span id="cb199-659"><a href="#cb199-659" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb199-660"><a href="#cb199-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-661"><a href="#cb199-661" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> car, <span class="at">glmfit =</span> mod_full, <span class="at">cost =</span> cost, <span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb199-662"><a href="#cb199-662" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">=</span> <span class="fu">cv.glm</span>(car, mod_both_AIC_2<span class="fl">.0</span>, cost, <span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb199-663"><a href="#cb199-663" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">=</span> <span class="fu">cv.glm</span>(car, mod_both_BIC, cost, <span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb199-664"><a href="#cb199-664" aria-hidden="true" tabindex="-1"></a><span class="do">## marche pas. pourquoi??? (voir photo code pour réponse)</span></span>
<span id="cb199-665"><a href="#cb199-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-666"><a href="#cb199-666" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>delta</span>
<span id="cb199-667"><a href="#cb199-667" aria-hidden="true" tabindex="-1"></a>res2<span class="sc">$</span>delta</span>
<span id="cb199-668"><a href="#cb199-668" aria-hidden="true" tabindex="-1"></a>res3<span class="sc">$</span>delta</span>
<span id="cb199-669"><a href="#cb199-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-670"><a href="#cb199-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-671"><a href="#cb199-671" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(car)</span>
<span id="cb199-672"><a href="#cb199-672" aria-hidden="true" tabindex="-1"></a><span class="do">###### test #####</span></span>
<span id="cb199-673"><a href="#cb199-673" aria-hidden="true" tabindex="-1"></a>mod_test <span class="ot">=</span> <span class="fu">glm</span>(Caravan<span class="sc">$</span>Purchase<span class="sc">~</span>., <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data =</span> Caravan)</span>
<span id="cb199-674"><a href="#cb199-674" aria-hidden="true" tabindex="-1"></a><span class="fu">cv.glm</span>(Caravan, mod_test, <span class="at">cost =</span> cost, <span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb199-675"><a href="#cb199-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-676"><a href="#cb199-676" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Caravan)</span>
<span id="cb199-677"><a href="#cb199-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-678"><a href="#cb199-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb199-679"><a href="#cb199-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-680"><a href="#cb199-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-681"><a href="#cb199-681" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb199-682"><a href="#cb199-682" aria-hidden="true" tabindex="-1"></a><span class="co"># Question 9 --------------------------------------------------------------</span></span>
<span id="cb199-683"><a href="#cb199-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-684"><a href="#cb199-684" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimer de même le taux de réussite pour chaque modèle lorsque le seuil</span></span>
<span id="cb199-685"><a href="#cb199-685" aria-hidden="true" tabindex="-1"></a><span class="co"># varie de 0.10 à 0.30 par pas de 0.01</span></span>
<span id="cb199-686"><a href="#cb199-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-687"><a href="#cb199-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-688"><a href="#cb199-688" aria-hidden="true" tabindex="-1"></a>mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">21</span>)</span>
<span id="cb199-689"><a href="#cb199-689" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb199-690"><a href="#cb199-690" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(s <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>)){</span>
<span id="cb199-691"><a href="#cb199-691" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb199-692"><a href="#cb199-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(k) <span class="co"># Concatenate and Print</span></span>
<span id="cb199-693"><a href="#cb199-693" aria-hidden="true" tabindex="-1"></a>  res<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod_full,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb199-694"><a href="#cb199-694" aria-hidden="true" tabindex="-1"></a>  res2<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod_both_AIC_2<span class="fl">.0</span>,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb199-695"><a href="#cb199-695" aria-hidden="true" tabindex="-1"></a>  res3<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod_both_BIC,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb199-696"><a href="#cb199-696" aria-hidden="true" tabindex="-1"></a>  mat[<span class="dv">1</span>,k]<span class="ot">=</span>res<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb199-697"><a href="#cb199-697" aria-hidden="true" tabindex="-1"></a>  mat[<span class="dv">2</span>,k]<span class="ot">=</span>res2<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb199-698"><a href="#cb199-698" aria-hidden="true" tabindex="-1"></a>  mat[<span class="dv">3</span>,k]<span class="ot">=</span>res3<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb199-699"><a href="#cb199-699" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb199-700"><a href="#cb199-700" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>),<span class="fu">t</span>(mat),<span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb199-701"><a href="#cb199-701" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>,<span class="fu">c</span>(<span class="st">'Tout'</span>,<span class="st">'AIC'</span>,<span class="st">'BIC'</span>),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb199-702"><a href="#cb199-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-703"><a href="#cb199-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-704"><a href="#cb199-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-705"><a href="#cb199-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-706"><a href="#cb199-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-707"><a href="#cb199-707" aria-hidden="true" tabindex="-1"></a><span class="co">#repetition 5 fois (tres long)</span></span>
<span id="cb199-708"><a href="#cb199-708" aria-hidden="true" tabindex="-1"></a>res_seuil<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb199-709"><a href="#cb199-709" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb199-710"><a href="#cb199-710" aria-hidden="true" tabindex="-1"></a>  mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">21</span>)</span>
<span id="cb199-711"><a href="#cb199-711" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb199-712"><a href="#cb199-712" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(s <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>)){</span>
<span id="cb199-713"><a href="#cb199-713" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb199-714"><a href="#cb199-714" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(k)</span>
<span id="cb199-715"><a href="#cb199-715" aria-hidden="true" tabindex="-1"></a>    res<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb199-716"><a href="#cb199-716" aria-hidden="true" tabindex="-1"></a>    res2<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod2,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb199-717"><a href="#cb199-717" aria-hidden="true" tabindex="-1"></a>    res3<span class="ot">=</span><span class="fu">cv.glm</span>(Caravan,mod3,cost,<span class="at">K=</span><span class="dv">10</span>)</span>
<span id="cb199-718"><a href="#cb199-718" aria-hidden="true" tabindex="-1"></a>    mat[<span class="dv">1</span>,k]<span class="ot">=</span>res<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb199-719"><a href="#cb199-719" aria-hidden="true" tabindex="-1"></a>    mat[<span class="dv">2</span>,k]<span class="ot">=</span>res2<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb199-720"><a href="#cb199-720" aria-hidden="true" tabindex="-1"></a>    mat[<span class="dv">3</span>,k]<span class="ot">=</span>res3<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb199-721"><a href="#cb199-721" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb199-722"><a href="#cb199-722" aria-hidden="true" tabindex="-1"></a>  res_seuil[[i]]<span class="ot">=</span>mat</span>
<span id="cb199-723"><a href="#cb199-723" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb199-724"><a href="#cb199-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-725"><a href="#cb199-725" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>),<span class="fu">t</span>(res_seuil[[<span class="dv">1</span>]]),<span class="at">type=</span><span class="st">'l'</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.15</span>,<span class="fl">0.35</span>),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb199-726"><a href="#cb199-726" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>) <span class="fu">matplot</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>),<span class="fu">t</span>(res_seuil[[i]]),<span class="at">type=</span><span class="st">'l'</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">add=</span>T)</span>
<span id="cb199-727"><a href="#cb199-727" aria-hidden="true" tabindex="-1"></a>res_moy<span class="ot">=</span>res_seuil[[<span class="dv">1</span>]]</span>
<span id="cb199-728"><a href="#cb199-728" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>) res_moy<span class="ot">=</span>res_moy<span class="sc">+</span>res_seuil[[i]]</span>
<span id="cb199-729"><a href="#cb199-729" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.01</span>),<span class="fu">t</span>(res_moy)<span class="sc">/</span><span class="dv">5</span>,<span class="at">type=</span><span class="st">'l'</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">add=</span>T)</span>
<span id="cb199-730"><a href="#cb199-730" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>,<span class="fu">c</span>(<span class="st">'Tout'</span>,<span class="st">'AIC'</span>,<span class="st">'BIC'</span>),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb199-731"><a href="#cb199-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-732"><a href="#cb199-732" aria-hidden="true" tabindex="-1"></a><span class="co">#On observe que les courbes deviennent tres variables lorsque le seuil grandit. Il y a meme des valeurs manquantes</span></span>
<span id="cb199-733"><a href="#cb199-733" aria-hidden="true" tabindex="-1"></a><span class="co">#C'est parcequ'il y a tres peu de positifs predits dans ce cas (voire aucun dans certains folds) et donc l'estimation de l'erreur est tres peu precise</span></span>
<span id="cb199-734"><a href="#cb199-734" aria-hidden="true" tabindex="-1"></a><span class="co">#Le meilleur modele semble celui par BIC. </span></span>
<span id="cb199-735"><a href="#cb199-735" aria-hidden="true" tabindex="-1"></a><span class="co">#Si on veut avoir a la fois un taux de demarchage optimum et un nombre de positifs pas trop faible, un seuil de 0.2 semble pas mal</span></span>
<span id="cb199-736"><a href="#cb199-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-737"><a href="#cb199-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-738"><a href="#cb199-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2025, Clément Poupelin</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This blog is built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>