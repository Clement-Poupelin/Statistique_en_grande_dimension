<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Clément Poupelin">
<meta name="dcterms.date" content="2025-02-21">
<meta name="description" content="Comparaison de la regression Ridge et Lasso via le github de Laurent Rouvière">

<title>Statistique en grande dimension - Exercice 06 Bonus : Ridge vs Lasso</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../img/logo_univ_nantes_simple.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../custom.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/logo_univ_nantes_complet.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">X3MS020</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../TP_StatGdeDim.pdf" rel="" target=""><i class="bi bi-file-earmark-font-fill" role="img">
</i> 
 <span class="menu-text">Feuille de TP</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/Clement-Poupelin" rel="" target="">
 <span class="dropdown-text">Clément Poupelin</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/nonomtrt" rel="" target="">
 <span class="dropdown-text">Noémie Matrat</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-linkedin" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-linkedin">    
        <li>
    <a class="dropdown-item" href="http://www.linkedin.com/in/cl%C3%A9ment-poupelin-7675311a7/" rel="" target="">
 <span class="dropdown-text">Clément Poupelin</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.linkedin.com/in/no%C3%A9mie-matrat-86a34a200/" rel="" target="">
 <span class="dropdown-text">Noémie Matrat</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:clementjc.poupelin@gmail.com" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://clement-poupelin.github.io/" rel="" target=""><i class="bi bi-person-circle" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/clement__poupelin" rel="" target=""><i class="bi bi-instagram" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Exercice 06 Bonus : Ridge vs Lasso</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          Comparaison de la regression Ridge et Lasso via le github de Laurent Rouvière
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">regression Ridge</div>
                <div class="quarto-category">regression Lasso</div>
                <div class="quarto-category">validation croisée</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Clément Poupelin </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 21, 2025</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">February 21, 2025</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#rappels-sur-ridge-et-lasso" id="toc-rappels-sur-ridge-et-lasso" class="nav-link active" data-scroll-target="#rappels-sur-ridge-et-lasso">Rappels sur Ridge et Lasso</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#données" id="toc-données" class="nav-link" data-scroll-target="#données">Données</a></li>
  <li><a href="#analyse-descriptive" id="toc-analyse-descriptive" class="nav-link" data-scroll-target="#analyse-descriptive">Analyse descriptive</a></li>
  <li><a href="#analyse-inférentielle" id="toc-analyse-inférentielle" class="nav-link" data-scroll-target="#analyse-inférentielle">Analyse inférentielle</a></li>
  <li><a href="#selection-des-paramètres-de-régularisation" id="toc-selection-des-paramètres-de-régularisation" class="nav-link" data-scroll-target="#selection-des-paramètres-de-régularisation">Selection des paramètres de régularisation</a></li>
  <li><a href="#prédiction" id="toc-prédiction" class="nav-link" data-scroll-target="#prédiction">Prédiction</a></li>
  <li><a href="#comparaison" id="toc-comparaison" class="nav-link" data-scroll-target="#comparaison">Comparaison</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session info</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Dans cette partie et avant de passer à l’exercice 7, nous allons faire la section 3.1 sur la regression Ridge et Lasso avec <em><code>glmnet</code></em> sous <em><code>R</code></em> du <a href="https://lrouviere.github.io/TUTO_GRANDE_DIM/correction/03-ridge-lasso.html">tutoriel de Laurent Rouvière</a></p>
<section id="rappels-sur-ridge-et-lasso" class="level1">
<h1>Rappels sur Ridge et Lasso</h1>
<p>On se base encore ici sur notre modèle classique de régression linéaire :</p>
<p><span class="math display">\[y = X\beta + \mathcal{E} \quad \text{ou} \quad y = \beta_0 + \beta_1X^1 + ... + \beta_pX^p + \mathcal{E}\]</span></p>
<ul>
<li><p><span class="math inline">\(y \in \mathbb{R}^{n}\)</span> la variable réponse ou variable à expliquer</p></li>
<li><p><span class="math inline">\(X \in \mathbb{R}^{n\times (p+1)}\)</span> la matrice déterministe contenant nos <span class="math inline">\(p\)</span> variables explicatives</p></li>
<li><p><span class="math inline">\(\beta \in \mathbb{R}^{p+1}\)</span> le vecteur qui contient les coefficients de régression <span class="math inline">\(\beta_0, ..., \beta_p\)</span> que nous cherchons à estimer</p></li>
<li><p><span class="math inline">\(\mathcal{E} \in \mathbb{R}^{n}\)</span> le vecteur d’erreur qui n’est pas corrélé à nos variables explicatives. C’est la part d’aléa que nous n’arrivons pas à déterminer</p></li>
</ul>
<p>Pour l’estimation des coefficients de regression de ce type de modèle, nous utilisons souvent la méthodes des moindres carrées ordinaire (MCO) qui nous donne</p>
<p><span class="math display">\[\hat{\beta} = \underset{\beta}{argmin}||y-X\beta||^2\]</span> Malheureusement, lorsque <span class="math inline">\(p\)</span> est grand ou que les variables sont linéairement dépendantes, les estimateurs des moindres carrées peuvent être mis en défaut. Les méthodes pénalisées ou sous contraintes consistent alors à restreindre l’espace sur lequel on minimise ce critère.<br>
</p>
<p>L’idée principale de ces méthodes est de contraindre la valeur des estimateurs MCO pour réduire la variance, quitte à augmenter un peu le biais (d’où la terminologie de “régression biaisée”). Nous obtenons donc, pour un certain <span class="math inline">\(t&gt;0\)</span>, des estimations de la forme suivante : <span class="math display">\[ \hat{\beta}^{pen} = \underset{\beta}{argmin}||y-X\beta||^2 \quad \text{sous la contrainte} \quad ||\beta||? \leq t\]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Ridge</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Lasso</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>La régression Ridge contraint la <strong>norme <span class="math inline">\(\ell^2\)</span></strong> des coefficients <span class="math inline">\(\beta\)</span> à ne pas exploser, i.e <span class="math inline">\(||\beta||_2 = \sum_{j=0}^{p} \beta_j^2 \leq t\)</span>. Cela conduit à la solution d’optimisation suivante :</p>
<p><span class="math display">\[
\hat{\beta}_{Ridge} = \underset{\beta}{\operatorname{argmin}} \ ||y - X\beta||^2 \quad \text{sous la contrainte} \quad \sum_{j=0}^{p} \beta_j^2 \leq t
\]</span></p>
<p>où <span class="math inline">\(\hat{\beta}_{Ridge}\)</span> est <strong>unique</strong>, contrairement à Lasso qui peut produire plusieurs solutions.</p>
<p>Contrairement à Lasso, Ridge ne met pas exactement à zéro certains coefficients, mais réduit leur valeur. Il n’y a donc pas de sélection de variable effectué.<br>
Cette méthode est tout de même robuste en grande dimension et particulièrement utile lorsque les variables sont fortement corrélées. Il empêche les coefficients de devenir trop grands, ce qui réduit la variance du modèle.<br>
</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>La régression Lasso (pour Least Absolute Shrinkage and Selection Operator) contraint la norme <span class="math inline">\(\ell^1\)</span> de <span class="math inline">\(\beta\)</span> à ne pas exploser, i.e <span class="math inline">\(||\beta||_1 = \sum_{j=0}^{p} |\beta_j| \leq t\)</span>. Nous obtenons donc</p>
<p><span class="math display">\[\hat{\beta}_{Lasso} = \underset{\beta}{argmin}||y-X\beta||^2 \quad \text{sous la contrainte} \quad \sum_{j=0}^{p} |\beta_j| \leq t  \]</span></p>
<p>Où <span class="math inline">\(\hat{\beta}_{Lasso}\)</span> n’est pas nécessairement unique mais la prévision <span class="math inline">\(\hat{y} = X\hat{\beta}_{Lasso}\)</span> est unique.<br>
</p>
<p>Cette méthode est principalement caractérisée par le fait qu’elle est robuste à la grande dimension en sélectionnant les variables les plus pertinentes. En effet, elle nous permet de réduire les coefficients MCO des variables sélectionnées en rapprochant leur valeur de 0, ce qui est appelé la propriété de “seuillage doux” du Lasso.</p>
</div>
</div>
</div>
<p>Ici, il sera donc présenté les étapes principales qui permettent de faire ce type de régression avec <em><code>R</code></em>. Le package le plus souvent utilisé est <em><code>glmnet</code></em>.</p>
</section>
<section id="setup" class="level1">
<h1>Setup</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Fonctions</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inférence</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet) <span class="do">## regression pénalisée</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ggplot</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">pairs.panels</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Comparaison de modèles</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  data_long <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(data)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span>  <span class="co"># Palette de couleurs harmonieuse</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Variables (Boxplot)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Valeurs"</span>) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Thème épuré</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotation des étiquettes</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my_pairs.panels <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  psych<span class="sc">::</span><span class="fu">pairs.panels</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pearson"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Méthode de corrélation</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hist.col =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Set3"</span>),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Couleurs des histogrammes</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajout des courbes de densité</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ellipses =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajout d'ellipses</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajout de régressions lissées</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">lm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajout des droites de régression</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"#69b3a2"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Couleur des points</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>              <span class="co"># Transparence</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cv_ridge_vs_lasso <span class="ot">&lt;-</span> <span class="cf">function</span>(data, fmla) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">140400</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  data.X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(fmla, <span class="at">data =</span> data)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  data.Y <span class="ot">&lt;-</span> data<span class="sc">$</span>maxO3</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  blocs <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="at">k =</span> <span class="dv">10</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  prev <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(data)) <span class="sc">%&gt;%</span>  <span class="fu">as.data.frame</span>()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(prev) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Linéaire (MCO)"</span>, <span class="st">"Ridge"</span>, <span class="st">"Lasso"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    app <span class="ot">&lt;-</span> data[<span class="sc">-</span>blocs[[k]], ]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> data[blocs[[k]], ]</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    app.X <span class="ot">&lt;-</span> data.X[<span class="sc">-</span>blocs[[k]], ]</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    app.Y <span class="ot">&lt;-</span> data.Y[<span class="sc">-</span>blocs[[k]]]</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    test.X <span class="ot">&lt;-</span> data.X[blocs[[k]], ]</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    test.Y <span class="ot">&lt;-</span> data.Y[blocs[[k]]]</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    ridge <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(app.X, app.Y, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(app.X, app.Y, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    lin <span class="ot">&lt;-</span> <span class="fu">lm</span>(fmla, <span class="at">data =</span> app)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    prev[blocs[[k]], ] <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">lin =</span> <span class="fu">predict</span>(lin, <span class="at">newdata =</span> test),</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">ridge =</span> <span class="fu">as.vector</span>(<span class="fu">predict</span>(ridge, <span class="at">newx =</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>                                  test.X)),</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">lasso =</span> <span class="fu">as.vector</span>(<span class="fu">predict</span>(lasso, <span class="at">newx =</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>                                  test.X))</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  err <span class="ot">&lt;-</span> prev <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">obs =</span> data<span class="sc">$</span>maxO3) <span class="sc">%&gt;%</span>  <span class="fu">summarise_at</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="sc">~</span> <span class="fu">mean</span>((obs <span class="sc">-</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>                                                                             .)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(err)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="données" class="level1">
<h1>Données</h1>
<p>On considère le jeu de données <em>ozone.txt</em> où on cherche à expliquer la concentration maximale en ozone relevée sur une journée (variable <em>maxO3</em>) par d’autres variables essentiellement météorologiques.</p>
<p>La base de données d’origine <em>ozone.txt</em> répertorie ainsi 112 données météorologiques mesurées durant l’été 2001 à Rennes. Celles-ci sont caractérisées par les 13 variables suivantes :</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-hover table-condensed table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">maxO3</span></td>
<td style="text-align: left;">concentration maximale d'ozone (en DU)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">T9</span></td>
<td style="text-align: left;">température à 9H (en °C)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">T12</span></td>
<td style="text-align: left;">température à 12H (en °C)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">T15</span></td>
<td style="text-align: left;">température à 15H (en °C)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Ne9</span></td>
<td style="text-align: left;">nébulosité à 9H (en octa)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Ne12</span></td>
<td style="text-align: left;">nébulosité à 12H (en octa)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Ne15</span></td>
<td style="text-align: left;">nébulosité à 15H (en octa)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Vx9</span></td>
<td style="text-align: left;">vitesse du vent à 9H</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Vx12</span></td>
<td style="text-align: left;">vitesse du vent à 12H</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">Vx15</span></td>
<td style="text-align: left;">vitesse du vent à 15H</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">maxO3v</span></td>
<td style="text-align: left;">concentration maximale d'ozone de la veille (en DU)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span style=" font-weight: bold;    ">vent</span></td>
<td style="text-align: left;">direction principale du vent (Nord / Ouest / Sud / Est)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span style=" font-weight: bold;    ">pluie</span></td>
<td style="text-align: left;">présence ou non de pluie (Sec / Pluie)</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>On identifie le regroupement de toutes les données météorologiques récoltées en une journée par la date à laquelle les relevés ont été effectués.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ozone <span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"https://r-stat-sc-donnees.github.io/ozone.txt"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ozone <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-3bb3ba4d93b23a007f6d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3bb3ba4d93b23a007f6d">{"x":{"filter":"none","vertical":false,"data":[["20010601","20010602","20010603","20010604","20010605","20010606","20010607","20010610","20010611","20010612","20010613","20010614","20010615","20010616","20010617","20010618","20010620","20010621","20010622","20010623","20010624","20010625","20010626","20010627","20010628","20010629","20010630","20010701","20010702","20010703","20010704","20010705","20010706","20010707","20010708","20010709","20010710","20010711","20010712","20010713","20010714","20010715","20010716","20010717","20010718","20010719","20010720","20010721","20010722","20010723","20010724","20010725","20010726","20010727","20010728","20010729","20010730","20010731","20010801","20010802","20010803","20010804","20010805","20010806","20010807","20010808","20010809","20010810","20010811","20010812","20010813","20010814","20010815","20010819","20010820","20010821","20010822","20010823","20010824","20010825","20010826","20010827","20010828","20010829","20010830","20010831","20010901","20010902","20010903","20010904","20010905","20010906","20010907","20010908","20010912","20010913","20010914","20010915","20010916","20010917","20010918","20010919","20010920","20010921","20010922","20010923","20010924","20010925","20010927","20010928","20010929","20010930"],[87,82,92,114,94,80,79,79,101,106,101,90,72,70,83,88,145,81,121,146,121,146,108,83,57,81,67,70,106,139,79,93,97,113,72,88,77,71,56,45,67,67,84,63,69,92,88,66,72,81,83,149,153,159,149,160,156,84,126,116,77,63,54,65,72,60,70,77,98,111,75,116,109,67,76,113,117,131,166,159,100,114,112,101,76,59,78,76,55,71,66,59,68,63,78,74,71,69,71,60,42,65,71,96,98,92,76,84,77,99,83,70],[15.6,17,15.3,16.2,17.4,17.7,16.8,14.9,16.1,18.3,17.3,17.6,18.3,17.1,15.4,15.9,21,16.2,19.7,23.6,20.4,27,24,19.7,20.1,19.6,19.5,18.8,24.1,26.6,19.5,16.8,20.8,17.5,18.1,19.2,19.4,19.2,13.8,14.3,15.6,16.9,17.4,15.1,15.1,16.7,16.9,18,18.6,18.8,19,19.9,23.8,24,23.3,25,24.9,20.5,25.3,21.3,20,18.7,18.6,19.2,19.9,18.7,18.4,17.1,17.8,20.9,18.8,23.5,20.8,18.8,17.8,20.6,21.6,22.7,19.8,25,20.1,21,21,16.9,17.5,16.5,17.7,17.3,15.3,15.9,16.2,18.3,16.9,17.3,14.2,15.8,15.2,17.1,15.4,13.7,12.7,14.8,15.5,11.3,15.2,14.7,13.3,13.3,16.2,16.9,16.9,15.7],[18.5,18.4,17.6,19.7,20.5,19.8,15.6,17.5,19.6,21.9,19.3,20.3,19.6,18.2,17.4,19.1,24.6,22.4,24.2,28.6,25.2,32.7,23.5,22.9,22.4,25.1,23.4,22.7,28.4,30.1,18.8,18.2,23.7,18.2,21.2,22,20.7,21,17.3,14.5,18.6,19.1,20.4,20.5,15.6,19.1,20.3,21.6,21.9,22.5,22.5,26.9,27.7,28.3,27.6,29.6,30.5,26.3,29.5,23.8,18.2,20.6,18.7,23,21.6,21.4,17.1,20,22.8,25.2,20.5,29.8,23.7,21.1,21.3,24.8,26.9,28.4,27.2,33.5,22.9,26.3,24.4,17.8,18.6,20.3,20.2,22.7,16.8,19.2,18.9,18.3,20.8,19.8,22.2,18.7,17.9,17.7,17.7,14,14.3,16.3,18,19.4,19.7,17.6,17.7,17.7,20.8,23,19.8,18.6],[18.4,17.7,19.5,22.5,20.4,18.3,14.9,18.9,21.4,22.9,20.2,17.4,19.4,18,16.6,21.5,26.9,23.4,26.9,28.4,27.7,33.7,25.1,24.8,22.8,27.2,23.7,24.9,30.1,31.9,17.8,22,25,22.7,23.9,25.2,22.5,22.4,18.5,15.2,20.3,19.5,21.4,20.6,15.9,19.3,20.7,23.3,23.6,23.9,24.1,29,29.4,26.5,28.8,31.1,32.2,27.8,31.2,22.1,23.6,20.3,17.8,22.7,20.4,21.7,20.5,20.8,24.3,26.7,26,31.7,26.6,18.9,24,27,28.6,30.1,30.8,35.5,27.6,26.4,26.8,20.6,18.7,20.3,21.5,24.6,19.2,19.5,19.3,19,22.5,19.4,22,19.1,18.6,17.5,16.6,15.8,14.9,15.9,17.4,20.2,20.3,18.2,17.7,17.8,22.1,22.6,22.1,20.7],[4,5,2,1,8,6,7,5,2,5,7,7,7,7,8,6,0,8,2,1,1,0,4,7,7,3,5,5,0,0,8,8,2,8,7,4,7,6,8,8,5,5,3,8,8,7,6,8,4,6,2,3,1,2,4,0,0,1,1,7,5,6,8,8,7,7,3,4,1,1,8,1,8,7,7,1,6,5,4,1,8,7,1,7,7,5,5,4,8,7,2,7,6,7,5,8,6,6,4,4,8,7,7,3,2,1,7,3,6,6,6,7],[4,5,5,1,8,6,8,5,4,6,7,6,5,7,7,5,1,3,1,1,0,0,4,6,6,4,5,2,0,1,8,8,3,8,6,7,8,4,8,8,7,5,4,6,8,6,6,6,7,3,4,4,1,2,6,3,1,0,4,7,7,7,8,7,7,7,6,5,1,5,7,3,5,7,5,1,6,3,0,1,8,4,6,7,7,7,5,5,7,5,5,7,5,8,5,7,5,7,5,5,7,7,7,3,2,4,7,5,5,4,5,7],[8,7,4,0,7,7,8,4,4,8,3,8,6,7,7,4,1,1,0,2,0,0,0,6,7,4,4,1,1,4,8,6,4,5,4,4,7,6,6,8,5,6,6,6,8,4,5,5,6,2,6,3,4,7,3,5,4,2,4,8,6,7,8,7,8,7,3,4,0,2,1,5,4,8,5,2,4,3,1,1,6,5,3,7,7,6,3,6,5,3,6,7,7,8,6,7,1,8,5,4,7,7,6,3,2,6,6,6,5,7,3,7],[0.6946,-4.3301,2.9544,0.9848,-0.5,-5.6382,-4.3301,0,-0.766,1.2856,-1.5,0.6946,-0.8682,-4.3301,-4.3301,0.5209,-0.342,0,1.5321,1,0,2.9544,-2.5712,-2.5981,-5.6382,-1.9284,-1.5321,0.6840000000000001,2.8191,1.8794,0.6946,0,0,-3.7588,-2.5981,-1.9696,-6.5778,-7.8785,1.5,0.6840000000000001,-3.2139,-2.2981,0,2,-4.5963,-2.0521,-2.8191,-3,0.866,0.5209,0,1,0.9397,-0.342,0.866,1.5321,-0.5,-1.3681,3,0,-3.4641,-5,-4.6985,-3.8302,-3,-5.6382,-5.9088,-1.9284,0,-1.0261,-0.866,1.8794,-1.0261,-5.3623,-3.0642,1.3681,1.5321,0.1736,0.6428,1,1.2856,3.0642,4,-2,-3.4641,-4.3301,0,-2.9544,-1.8794,-6.1284,-1.3681,-3.9392,-1.5,-4.5963,-0.866,-4.5963,-1.0419,-5.1962,-3.8302,0,-2.5,-4.3301,-3.9392,-0.1736,4,5.1962,-0.9397,0,-0.6946,1.5,-4,0],[-1.7101,-4,1.8794,0.3473,-2.9544,-5,-1.8794,-1.0419,-1.0261,-2.2981,-1.5,-1.0419,-2.7362,-7.8785,-2.0521,-2.9544,-1.5321,0.3473,1.7321,-1.9284,-0.5209,6.5778,-3.8567,-3.9392,-3.8302,-2.5712,-3.0642,0,3.9392,2,-0.866,0,1.7101,-3.9392,-3.9392,-3.0642,-5.6382,-6.8937,-3.8302,4,-3.7588,-3.7588,0.3473,-5.3623,-3.8302,-4.4995,-3.4641,-3.5,-1.9696,-1,-1.0261,-0.9397,1.5,1.2856,-1.5321,-0.6840000000000001,-1.8794,-0.6946,3.7588,-2.3941,-2.5981,-4.924,-2.5,-4.924,-4.5963,-6.0622,-3.2139,-1.0261,-1.5321,-3,0,1.3681,-1.7101,-5.3623,-2.2981,0.8682,1.9284,-1.9696,-0.866,0.6946,-1.7321,2.8191,4,-0.5209,-4,-5.3623,0.5209,-2.9544,-1.8794,0,-0.8682,-1.9284,-3.4641,-6.0622,-5,-6.8937,-1.3681,-2.7362,0,3.2139,-3.2139,-6.0622,-3.0642,3.7588,5,5.1423,-0.766,-1,-2,0.8682,-3.7588,-1.0419],[-0.6946,-3,0.5209,-0.1736,-4.3301,-6,-3.7588,-1.3892,-2.2981,-3.9392,-0.8682,-0.6946,-6.8944,-5.1962,-3,-1.0261,-0.6840000000000001,-2.5712,2,-1.2155,1.0261,4.3301,-4.6985,-4.924,-4.5963,-4.3301,-0.8682,1.3681,3.4641,1.3681,-1.0261,1.2856,-2.7362,-4.6985,-3.7588,-4,-9,-6.8937,-2.0521,2.9544,-4,0,-2.5981,-6.1284,-4.3301,-2.7362,-3,-3.2139,-1.0261,-2,0.5209,-0.6428,0,-2,-0.1736,2.8191,-1.2856,0,5,-1.3892,-3.7588,-5.6382,-0.8682,-5.6382,-5.1962,-6.8937,-4.4995,0.5209,-1,-2.2981,0,0.6946,-3.2139,-2.5,-3.9392,-2.2981,1.9284,-1.9284,0.6840000000000001,-1.7101,-0.6840000000000001,1.3681,3.7588,1.8794,-1.7321,-4.5,0,-2,-2.3941,-1.3892,1.7101,-1.7101,-3.0642,-4.3301,-5,-7.5175,-1.0419,-1.0419,1.3892,0,-2.5,-5.1962,0,3.8302,4.3301,3.5,-0.5,-1.2856,-1.3681,0.8682,-4,-4],[84,87,82,92,114,94,80,99,79,101,106,101,90,72,70,83,121,145,81,121,146,121,146,108,83,57,81,67,70,106,139,79,93,97,113,72,88,77,71,56,45,67,67,84,63,69,92,88,66,72,81,83,149,153,159,149,160,156,84,126,116,77,63,54,65,72,60,70,77,98,111,75,116,86,67,76,113,117,131,166,159,100,114,112,101,76,59,78,76,55,71,66,59,68,62,78,74,71,69,71,60,42,65,71,96,98,92,76,71,77,99,83],["Nord","Nord","Est","Nord","Ouest","Ouest","Ouest","Nord","Nord","Ouest","Nord","Sud","Sud","Ouest","Nord","Ouest","Ouest","Nord","Est","Sud","Nord","Est","Sud","Ouest","Ouest","Sud","Ouest","Nord","Est","Sud","Ouest","Sud","Nord","Ouest","Ouest","Ouest","Ouest","Ouest","Ouest","Est","Ouest","Ouest","Sud","Ouest","Ouest","Nord","Ouest","Sud","Ouest","Nord","Nord","Ouest","Nord","Nord","Ouest","Sud","Ouest","Nord","Est","Sud","Ouest","Ouest","Sud","Ouest","Ouest","Ouest","Nord","Nord","Ouest","Ouest","Nord","Sud","Sud","Ouest","Ouest","Sud","Sud","Ouest","Ouest","Sud","Ouest","Est","Est","Nord","Ouest","Ouest","Nord","Ouest","Ouest","Nord","Nord","Nord","Ouest","Ouest","Ouest","Ouest","Nord","Nord","Nord","Nord","Nord","Ouest","Ouest","Est","Est","Nord","Ouest","Sud","Sud","Sud","Ouest","Sud"],["Sec","Sec","Sec","Sec","Sec","Pluie","Sec","Sec","Sec","Sec","Sec","Sec","Sec","Pluie","Sec","Sec","Sec","Sec","Sec","Sec","Sec","Sec","Sec","Sec","Pluie","Sec","Sec","Sec","Sec","Sec","Sec","Pluie","Sec","Pluie","Pluie","Sec","Sec","Sec","Pluie","Pluie","Pluie","Pluie","Sec","Pluie","Pluie","Sec","Pluie","Sec","Sec","Sec","Sec","Sec","Sec","Sec","Sec","Sec","Sec","Sec","Sec","Pluie","Pluie","Pluie","Pluie","Sec","Pluie","Pluie","Pluie","Sec","Pluie","Sec","Sec","Sec","Sec","Pluie","Pluie","Sec","Pluie","Sec","Sec","Sec","Sec","Sec","Sec","Pluie","Sec","Pluie","Pluie","Pluie","Pluie","Pluie","Pluie","Pluie","Pluie","Sec","Sec","Pluie","Pluie","Pluie","Sec","Pluie","Pluie","Pluie","Sec","Pluie","Sec","Sec","Pluie","Sec","Pluie","Sec","Pluie","Sec"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>maxO3<\/th>\n      <th>T9<\/th>\n      <th>T12<\/th>\n      <th>T15<\/th>\n      <th>Ne9<\/th>\n      <th>Ne12<\/th>\n      <th>Ne15<\/th>\n      <th>Vx9<\/th>\n      <th>Vx12<\/th>\n      <th>Vx15<\/th>\n      <th>maxO3v<\/th>\n      <th>vent<\/th>\n      <th>pluie<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"maxO3","targets":1},{"name":"T9","targets":2},{"name":"T12","targets":3},{"name":"T15","targets":4},{"name":"Ne9","targets":5},{"name":"Ne12","targets":6},{"name":"Ne15","targets":7},{"name":"Vx9","targets":8},{"name":"Vx12","targets":9},{"name":"Vx15","targets":10},{"name":"maxO3v","targets":11},{"name":"vent","targets":12},{"name":"pluie","targets":13}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Bien évidémment on a vérifié qu’il n’y a pas de valeurs manquantes dans cette base de données avec la fonction <em><code>anyNA</code></em> qui renvoie FALSE</p>
</div>
</div>
</section>
<section id="analyse-descriptive" class="level1">
<h1>Analyse descriptive</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Correlation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">PCA</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>On peut regarder un peu la distribution de nos différents variables quantitatives via des boxplots.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_boxplot</span>(ozone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>On remarque bien que les variabeles qui sont de même nature mais à des points de temps différents sont d’avantages similaires.</p>
</div>
<p>Pour confirmer cela, on peut faire des boxplot pour uniquement une varibale et ses différents points de temps.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Température</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Nébulosité</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Vitesse du vent</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(ozone, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"T9"</span>, <span class="st">"T12"</span>, <span class="st">"T15"</span>))  <span class="sc">%&gt;%</span> <span class="fu">my_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(ozone, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Ne9"</span>, <span class="st">"Ne12"</span>, <span class="st">"Ne15"</span>))  <span class="sc">%&gt;%</span> <span class="fu">my_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(ozone, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Vx9"</span>, <span class="st">"Vx12"</span>, <span class="st">"Vx15"</span>))  <span class="sc">%&gt;%</span> <span class="fu">my_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>On regarde ici la corrélation calculée entre chacune de nos variables.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_pairs.panels</span>(ozone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="2688"></p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>On voit la présence de plusieurs fortes corrélations qui peut déjà nous alerter si l’on veut faire des modèles de regressions linéaires car on risque d’avoir un problème de colinéarité entre les varibales explicatives.</p>
<p>Cependant ces corrélation fortes sont surtout présentes pour les variables qui sont à différents points de temps ce qui est logique.</p>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>Avec une Analyse en Composantes Principales (PCA) on peut regarder un peu le comportement de nos données.</p>
<p>En effet, Cette méthode respose sur la transformation des variables d’origine en nouvelles variables non corrélées, appelées composantes principales, qui capturent successivement la plus grande variance possible des données.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>res_pca <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">PCA</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  ozone,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">quali.sup =</span> <span class="fu">c</span>(<span class="fu">which</span>(<span class="fu">colnames</span>(ozone) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"vent"</span>, <span class="st">"pluie"</span>))),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">quanti.sup =</span> <span class="fu">c</span>(<span class="fu">which</span>(<span class="fu">colnames</span>(ozone) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"max03"</span>, <span class="st">"max03v"</span>))),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">graph =</span> <span class="cn">FALSE</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ici, on spécifi nos varibales qualitatives et on décide de mettre la variable <em>max03</em> et <em>max03v</em> en variable supplémentaire, ce qui veut d’ire qu’elles ne seront pas considérés pour la formation de nos composantes principales (variable que l’on cherchera à estimer plus tard).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Barplot des variances</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Individus</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Tout d’abord, on peut commencer par regarder le pourcentage de variance expliqué par nos différentes composantes principales.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_eig</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncp =</span> <span class="dv">10</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">addlabels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">barfill =</span> <span class="st">"coral"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">barcolor =</span> <span class="st">"coral"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Percentage of variance of the 10 first components"</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>On voit ainsi que la majorité de la variance est expliquée par nos deux premières composantes principales.</p>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Le plan des individus est une projection des observations sur les axes principaux de la PCA. Cette visualisation permet d’identifier des regroupements, tendances et anomalies au sein des données.</p>
<p>Ainsi, des individus proches sur le graphique ont des caractéristiques similaires par rapport aux variables utilisées.</p>
<p>Puis, le placement d’un individu en fonction des axes peut permettre de savoir comment le jouer se caractérise par rapport aux variables qui contribuent le plus à ces axes.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Pluie</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">vent</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointsize =</span> <span class="dv">2</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">habillage =</span> <span class="fu">as.factor</span>(ozone<span class="sc">$</span>pluie),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">addEllipses =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipse.level =</span> <span class="fl">0.95</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointsize =</span> <span class="dv">2</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">habillage =</span> <span class="fu">as.factor</span>(ozone<span class="sc">$</span>vent),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">addEllipses =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipse.level =</span> <span class="fl">0.95</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Ici on voit une repartition plutot uniforme sur le plan qui ne semble pas permettre de distinguer une séparation forte correspodant à nos variables qualitatives.</p>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>Le cercle des variables est une représentation graphique qui permet d’analyser les relations entre les variables initiales et les composantes principales qui forment nos axes. Il est basé sur les corrélations entre les variables et les axes principaux.</p>
<p>Ainsi, plus une variable est proche du bord du cercle, plus elle est bien représentée sur le plan factoriel et contribue fortement à la formation des axes. Ici, on utilise le cos2 pour le gradient de couleur qui va aider à l’indentifictation de ces différentes qualitées de représentation.</p>
<p>De plus, selon l’angle entre deux varibles, on peut faire des suppositions sur leur corrélation :</p>
<ul>
<li><p>Si deux variables ont des vecteurs proches (petit angle), elles sont fortement corrélées positivement</p></li>
<li><p>Si deux variables ont des vecteurs opposés (angle proche de 180°), elles sont corrélées négativement</p></li>
<li><p>Si l’angle est proche de 90°, alors les variables ne sont pas corrélées</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_var</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.var =</span> <span class="st">"cos2"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">gradient.cols =</span> <span class="fu">rainbow</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">start =</span> .<span class="dv">6</span>, <span class="at">end =</span> .<span class="dv">9</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Dans notre cas, ce que l’on peut voir c’est que la majorité de nos variables sont bien représentées par nos deux axes (cumulant plus de 70% d’explication). Mais beaucoup semblent aussi fortement corrélées avecla formation de trois groupes. Cette corrélation ayant déjà pu être observé précédemment et touours logique du fait du côté longitudinale de nos données.</p>
<p>Ce que l’on peut tout de même ajouté c’est que les variables max03 et surtout max03v semblent plutot corrélées aux variables température. Constat qui peut se confirmer avec le pairs.panels précédent.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="analyse-inférentielle" class="level1">
<h1>Analyse inférentielle</h1>
<p>Contrairement à la plupart des autres package <em><code>R</code></em> qui permettent de faire de l’apprentissage, le package <em><code>glmnet</code></em> n’autorise pas l’utilisation de formules.&nbsp; Il faut donc spécifier explicitement la matrice <span class="math inline">\(X\)</span> et le vecteur <span class="math inline">\(y\)</span>.<br>
</p>
<p>On peut obtenir la matrice <span class="math inline">\(X\)</span> et notamment le codage des variables qualitatives avec la fonction <em><code>model.matrix</code></em>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ozone.X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(maxO3 <span class="sc">~</span> ., <span class="at">data =</span> ozone)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ozone.Y <span class="ot">&lt;-</span> ozone<span class="sc">$</span>maxO3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Et ce n’est qu’après que l’on peut mettre en place la modélisation.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Ridge</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Lasso</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mod.R <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(ozone.X, ozone.Y, <span class="at">alpha =</span> <span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>La fonction <em><code>glmnet</code></em> calcule tous les estimateurs pour une grille de valeurs de <span class="math inline">\(\lambda\)</span> que l’on peut récupérer.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mod.R<span class="sc">$</span>lambda <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22007.27 20052.20 18270.82 16647.69 15168.76 13821.21</code></pre>
</div>
</div>
<p>Et on peut également récupérer les différentes valeurs de <span class="math inline">\(\beta\)</span> associée aux différents <span class="math inline">\(\lambda\)</span>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>beta_values <span class="ot">&lt;-</span> mod.R<span class="sc">$</span>beta <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> <span class="fu">t</span>()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(beta_values) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"lambda_"</span>, <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(mod.R<span class="sc">$</span>lambda), <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>beta_values <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-8fd57f8bf1414e8354e1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8fd57f8bf1414e8354e1">{"x":{"filter":"none","vertical":false,"data":[["lambda_1","lambda_2","lambda_3","lambda_4","lambda_5","lambda_6","lambda_7","lambda_8","lambda_9","lambda_10","lambda_11","lambda_12","lambda_13","lambda_14","lambda_15","lambda_16","lambda_17","lambda_18","lambda_19","lambda_20","lambda_21","lambda_22","lambda_23","lambda_24","lambda_25","lambda_26","lambda_27","lambda_28","lambda_29","lambda_30","lambda_31","lambda_32","lambda_33","lambda_34","lambda_35","lambda_36","lambda_37","lambda_38","lambda_39","lambda_40","lambda_41","lambda_42","lambda_43","lambda_44","lambda_45","lambda_46","lambda_47","lambda_48","lambda_49","lambda_50","lambda_51","lambda_52","lambda_53","lambda_54","lambda_55","lambda_56","lambda_57","lambda_58","lambda_59","lambda_60","lambda_61","lambda_62","lambda_63","lambda_64","lambda_65","lambda_66","lambda_67","lambda_68","lambda_69","lambda_70","lambda_71","lambda_72","lambda_73","lambda_74","lambda_75","lambda_76","lambda_77","lambda_78","lambda_79","lambda_80","lambda_81","lambda_82","lambda_83","lambda_84","lambda_85","lambda_86","lambda_87","lambda_88","lambda_89","lambda_90","lambda_91","lambda_92","lambda_93","lambda_94","lambda_95","lambda_96","lambda_97","lambda_98","lambda_99","lambda_100"],[6.376767136845531e-36,0.008768318105805901,0.009616184976445542,0.01054531308277929,0.01156332182350544,0.01267853315665772,0.01390001186998903,0.01523762454004342,0.01670210165855812,0.01830510276027827,0.02005928428918484,0.0219783698216961,0.02407722212251403,0.02637191633811675,0.02888035341407421,0.0316203415113226,0.03461245186531227,0.03787834304341974,0.04144123323824138,0.04532595314687764,0.04955898771647102,0.05416850345096349,0.05918435748637689,0.0646380841390433,0.07056285413005252,0.0769934012126961,0.08396591050774335,0.09151786252142398,0.09968782662828464,0.1085151977983737,0.1180398705945232,0.1283018450237918,0.1393407597605868,0.1511953496256357,0.1639028260508085,0.1774981816102807,0.1920134225493119,0.207476736549435,0.223900798923243,0.2413218238966092,0.2597427651846457,0.2791673012182959,0.2995907231353595,0.3209991119971646,0.3433686151219807,0.3666648530822855,0.3908424865425147,0.4158449675836239,0.4416044934813174,0.4680421723614187,0.4950684003487498,0.5225834396880277,0.5504781780702568,0.578568853192539,0.6068428255574839,0.6351207049618641,0.6632679202309009,0.6911470742214143,0.7186193293785674,0.7455457031496847,0.7717882476839402,0.7972111091868227,0.8216814896117187,0.8450705578669658,0.8672543731631023,0.8881148846375517,0.9075410563206677,0.9253190641978246,0.9416436975256984,0.9562815930819162,0.9690037551357993,0.979926744485056,0.9889720102589862,0.9961069949411459,1.001315406615674,1.004592676358196,1.005944761925504,1.005387082805666,1.002943757320601,0.9986471542265062,0.9925376657265664,0.9846635729209507,0.975080895509314,0.9638531619985943,0.9510510777270098,0.9367520944787081,0.9210952275778119,0.9040113382368304,0.8855663188851435,0.8660000041801741,0.845396975195038,0.8238623158818331,0.8015047953358442,0.7784344912604273,0.754762361972938,0.730599508721793,0.7060563716282106,0.6812419124484927,0.6562627916632707,0.6312225525360352],[5.523924108497797e-36,0.00759468599047568,0.008328972338315312,0.00913360993859454,0.0100151955628633,0.01098092914124598,0.0120386523266642,0.01319689923630186,0.01446494987730586,0.01585288610345145,0.01737164986418729,0.01903310340366607,0.02085009094240999,0.02283650122535147,0.02500765706375866,0.02737917094447022,0.02996869243245097,0.03279490824562901,0.03587784248063825,0.03923890013635022,0.04290090067184739,0.04688809871002647,0.05122618858023532,0.05594228896551761,0.06106490349777334,0.06662385274848512,0.07265017272085389,0.07917597469524905,0.08623426115480423,0.09385869256944922,0.1020833000979116,0.1109421398350027,0.1204688851427692,0.1306963549112816,0.1416559773397475,0.1533771910350214,0.1658867878899314,0.1792082052910711,0.1933568526935975,0.2083541381130027,0.2242057834579525,0.2409142628522592,0.258474971107981,0.2768755925838026,0.2960955715058261,0.316105711683377,0.3368679310622041,0.358335192210912,0.3804516237667357,0.4031528404620415,0.4263664612748393,0.4500128173977574,0.4740058351392975,0.4982261894306949,0.5226312815304638,0.5471002957070338,0.5715350424162977,0.5958376183389195,0.6199117509689734,0.6436640860030467,0.667005415277606,0.6898518608143086,0.7121260426379927,0.7337582588077998,0.7546876921976688,0.7748636301178293,0.7942466438234302,0.812948846056914,0.8307337112416424,0.8476799878413671,0.8635059692754083,0.8787819489715152,0.8932984431749003,0.9071013637989783,0.9202449395459462,0.9327898246097918,0.9448020136667005,0.9563521139207725,0.9675148701956573,0.9783687468909209,0.9889953995524471,0.999478947454569,1.009905037604133,1.020359741570019,1.030928346837167,1.041694104434493,1.052195947890578,1.063700284631641,1.07557770113108,1.087948522860017,1.100879932866934,1.114418078726738,1.128601768047797,1.143460772586117,1.159015279186437,1.175275736743529,1.192242831019537,1.209907590474191,1.228251622813948,1.247247474856918],[4.867401837606643e-36,0.006690987249583224,0.007337790344487353,0.00804653689201637,0.008823033745051716,0.009673614605144452,0.01060517654164021,0.01162522429597108,0.0127419168742119,0.01396411627901539,0.01530143815458437,0.01676430402429609,0.01836399468759561,0.02011270420833932,0.02202377979034788,0.02411108784709356,0.02639002608134533,0.02887696894286431,0.03158945191232448,0.03454620667783456,0.0377671869931353,0.04127358259346182,0.04508781816907394,0.04923353401197379,0.05373554457255035,0.05861977080895009,0.06391314190764322,0.06964346172985814,0.07583923523258554,0.08252945016811142,0.08974330963110259,0.09750991154905683,0.1058578720527984,0.1148148908672457,0.1244072584683135,0.1346593067830917,0.145592807667649,0.1572263262492967,0.169573562797688,0.1826465369492598,0.1964492178253556,0.2109805030297215,0.2262326938431432,0.2421909210030641,0.2588326625059081,0.2761273785887763,0.2940362869245367,0.3125122974035014,0.331500120843139,0.3509365599357098,0.3707509842756673,0.3908659850920791,0.4111982000283447,0.4316544553159359,0.4521557466400139,0.4726017438448236,0.4928971639593011,0.512946701906644,0.5326562860060977,0.5519343243947628,0.5706929411842713,0.5888492052336772,0.6063263484025896,0.6230549535432924,0.6389740675676817,0.6540321677059869,0.6681878882986457,0.681496527279184,0.693762404574497,0.705050042891164,0.715324363228934,0.7247081515601194,0.7331473777362556,0.740662992214292,0.7472803932256432,0.7530300422608923,0.7579473801510652,0.7620727226129126,0.7654509297148323,0.7681307321980005,0.7701637143851127,0.7716030393321461,0.7725020374017357,0.7729127751426697,0.7728846982568565,0.7724634165797857,0.7715261425973018,0.7704186503723482,0.7690852915343945,0.767478824589909,0.7656197870356766,0.763517474399385,0.7611741132158253,0.7585864650003674,0.7557465528421671,0.7526426052907097,0.7492601464092985,0.7455831645690204,0.7415953118548863,0.7372810870397638],[-6.821463874216168e-36,-0.009371145912831723,-0.01027639667858214,-0.01126821286359801,-0.01235468313306318,-0.01354462481569706,-0.01484763309491149,-0.01627414083699318,-0.01783548120288557,-0.01954395276042825,-0.0214128866937502,-0.02345671556179258,-0.02569104288535971,-0.02813271263828446,-0.03080014080968121,-0.0337124086232592,-0.03689068502890189,-0.04035742919937881,-0.04413663758684383,-0.0482538778701357,-0.05273630757753649,-0.05761267348465184,-0.06291328737559157,-0.06866997324881766,-0.07491598057226782,-0.08168585777904265,-0.08901527988744237,-0.09694082397946764,-0.1054996863418377,-0.1147293354338625,-0.1246670955749166,-0.1353496574221305,-0.1468125130156929,-0.1590893154749891,-0.1722111663847157,-0.1862058375364453,-0.2010969379643578,-0.2169030420535227,-0.2336364695050322,-0.2513040748121275,-0.2699036909119563,-0.2894252733850162,-0.3098497848508206,-0.3311487229309346,-0.3532838500050222,-0.3762071628411853,-0.3998611342272442,-0.4241792499130888,-0.4490868528363607,-0.4745022934344851,-0.5003383708533687,-0.5265040362478984,-0.5529063173050323,-0.5794503092977532,-0.6060564442182808,-0.6326342727638788,-0.6591057424979669,-0.6854014576194037,-0.7114623700949356,-0.7372412210941783,-0.7627037083283734,-0.7878293620593736,-0.8126121060990906,-0.8370604625571728,-0.8611973367199288,-0.8850593018379709,-0.9086953047504721,-0.9322570294380991,-0.9556171630359291,-0.9789345063383705,-1.00226660482268,-1.025775335536375,-1.049467976277378,-1.073404569336697,-1.097634805305672,-1.122197790135768,-1.147121335521768,-1.172421494729406,-1.198102200487534,-1.224154987970701,-1.250558893420604,-1.277280657596025,-1.304275335240679,-1.331487348072636,-1.358851951689041,-1.386297035278635,-1.413871178581019,-1.441242622500177,-1.468516627950105,-1.495545028001245,-1.522255706499081,-1.54857524589894,-1.574434720952607,-1.599771531205844,-1.624529922027121,-1.648661309595923,-1.67212438114309,-1.694884987397288,-1.716915869586649,-1.738196263648923],[-7.994984136614242e-36,-0.01098049876949722,-0.01204091790724622,-0.0132026759179068,-0.01447523312932105,-0.01586889581714414,-0.01739487634571429,-0.01906536218728166,-0.02089358799099506,-0.0228939103301415,-0.02508188460833224,-0.0274743434276626,-0.03008947551033629,-0.03294690401574914,-0.03606795125062513,-0.03947501460632314,-0.04319260873506306,-0.04724681232411265,-0.05166545875820183,-0.05647816716219237,-0.06171635395289158,-0.06741322008921631,-0.07360370858120814,-0.08032442619406831,-0.08761352269397361,-0.09551052046820335,-0.1040560869642332,-0.1132917421938552,-0.1232594936139293,-0.1340013911109938,-0.1455589956774301,-0.1579727567716818,-0.171281295401997,-0.1855205927495194,-0.2007230877172617,-0.2169166911851057,-0.234123729943707,-0.2523598391793662,-0.2716338787782523,-0.2919433381855399,-0.3132777337568757,-0.3356150073862014,-0.3589212561967041,-0.3831500691089045,-0.4082421011653348,-0.4341249326085695,-0.4607132531845638,-0.4879094023312106,-0.5156042831799797,-0.5436786533659766,-0.5720047795146259,-0.6004484260809791,-0.6288711339706557,-0.6571459257369207,-0.6851164714982846,-0.7126542439983808,-0.7396300571131522,-0.7659231793090343,-0.791423550307193,-0.8160337521374814,-0.8396706837906053,-0.8622668846578027,-0.8837714381227801,-0.9041503714465681,-0.9233864626220262,-0.9414783812642078,-0.9584391372334312,-0.9743360971256264,-0.9890927386195074,-1.002812753684323,-1.015597305072083,-1.02742645960646,-1.038360639797555,-1.048443961627241,-1.057716855890626,-1.066216329617807,-1.07397525863781,-1.081021484232761,-1.087376765091336,-1.093055790588068,-1.098065494698697,-1.102404845972874,-1.106065182325509,-1.109031061456647,-1.111281533534713,-1.112791713675162,-1.114476970224913,-1.114384328164014,-1.113498808377384,-1.111756647099263,-1.109132289852241,-1.105613599206789,-1.101194590526531,-1.095876810036274,-1.089669933407698,-1.082591941535068,-1.074669048214117,-1.06593540282435,-1.056432594720573,-1.04620899265792],[-5.839056910437948e-36,-0.008013519099753898,-0.008786771139921672,-0.009633787432183707,-0.01056142866934163,-0.01157716228261697,-0.0126891055443248,-0.01390607362996318,-0.0152376294562565,-0.0166941349402069,-0.01828680320178321,-0.02002775108645131,-0.02193005121016701,-0.02400778252550046,-0.02627617565560142,-0.02875129589434502,-0.03145058626487524,-0.03439258015136634,-0.03759699477703561,-0.04108473606995354,-0.04487788628867413,-0.0489996704584342,-0.05347439716757192,-0.05832736877853006,-0.06358475564334146,-0.06927342851269984,-0.07542074303228824,-0.08205427008115906,-0.08920146578546324,-0.09688927540648631,-0.1051436660316749,-0.1139890841718175,-0.1234478360661045,-0.133539390790095,-0.1442796092021782,-0.1556799053747242,-0.167746351416701,-0.1804787414284307,-0.1938706828298712,-0.2079050092030435,-0.2225577402883515,-0.2377943113693847,-0.253569524155188,-0.2698269819722117,-0.2864987220666106,-0.3035050841975591,-0.3207548496875784,-0.3381456774591504,-0.355564853580801,-0.3728903589739568,-0.389992246893783,-0.4067343083741988,-0.4229759907311166,-0.4385859775625522,-0.4534040799765317,-0.4672970926357186,-0.4801290347563374,-0.4917706012534342,-0.5021012587332665,-0.5110111848195658,-0.5184030019486753,-0.5241932544372105,-0.52831357455343,-0.5307114864207237,-0.531350812392409,-0.5302116788659689,-0.5272901654961182,-0.5226036612940387,-0.516156585778053,-0.5080079502492226,-0.4982238371714311,-0.4868447521250616,-0.4739596622437685,-0.4596607504374096,-0.444052356806125,-0.4272502438785,-0.4093801961764338,-0.390576183027531,-0.3709782562353897,-0.3507303841575429,-0.3299783753563693,-0.3088679694643592,-0.2875431108578248,-0.2661443892113416,-0.2448076259835451,-0.2236625949694696,-0.2031005009856475,-0.1826797471052889,-0.1627738965219702,-0.143500205079052,-0.1249415958380427,-0.1071737251465566,-0.09026176745366857,-0.07426009489830677,-0.05921246771154726,-0.04515229451950952,-0.03210298046270641,-0.02007835400797941,-0.009083156104032125,0.0008864219946651222],[5.706013931173594e-36,0.007835555984764809,0.008592131941368404,0.009420982246076634,0.01032885052782497,0.01132308058424169,0.01241166058808194,0.01360327191031525,0.01490734004130198,0.0163340873320839,0.01789458717065219,0.01960081907951128,0.02146572406812406,0.02350325939407082,0.02572852800496449,0.02815754610016342,0.03080768514602496,0.03369746266877215,0.036846631674565,0.04027620011185536,0.04400843608687871,0.04806685538775521,0.05247618743580214,0.05726231535419715,0.06245218544728174,0.06807368104892308,0.07415545546378403,0.08072671863794301,0.08781697231043145,0.09545568877805594,0.1036719291213796,0.1124938978615996,0.1219484326155152,0.1320604294486933,0.1428522073366967,0.1543428184428735,0.166547314778979,0.1794759861475814,0.1931349654357556,0.2075206230682118,0.2226254146865929,0.2384332577589651,0.2549199275152128,0.2720526804254818,0.2897900587644451,0.3080819074479016,0.3268696283142544,0.3460866884812642,0.3656593886455594,0.3855078847801567,0.4055474434094189,0.425689897391579,0.4458452567594819,0.4659396747568881,0.4858595902578491,0.505530445444514,0.5248717139711619,0.5438087862092318,0.5622740333087575,0.5802076091881798,0.5975579639646816,0.614282048129367,0.6303451900041406,0.6457206351685314,0.6603887509233327,0.6743359250147617,0.6875532251890548,0.7000990093657666,0.7118353952966238,0.7228274175267627,0.733027559795067,0.74252859966207,0.7512711898843135,0.7592495536026952,0.7664569688754589,0.7728870423339953,0.778534070455239,0.7833932425204362,0.7874607416858725,0.7907338519035395,0.7932111634984826,0.7948929183834552,0.7957814804806306,0.7958818800912995,0.7952023679687458,0.7937549199477322,0.7914149979788837,0.7884215015837529,0.7847124008070598,0.7803250135257054,0.7752926900559991,0.7696540244558917,0.7634517055169118,0.7567318194798253,0.7495433896095725,0.7419378251546257,0.7339683101949778,0.7256891585167754,0.7171551519881303,0.7084208793238492],[4.38734997427591e-36,0.006017633907140897,0.006597919082947303,0.007233482513284161,0.007929451202827177,0.008691401165935617,0.009525389837851788,0.01043799087098604,0.01143633002291628,0.01252812182787701,0.01372170664545005,0.01502608756352977,0.01645096649512269,0.01800677864788764,0.01970475748358436,0.02155683968759558,0.02357586067486054,0.02577546167761143,0.02817012198078307,0.03077515404575639,0.03360668450737896,0.03668161799290169,0.04001758035672279,0.0436328375871735,0.04754618634355574,0.05177681185234861,0.05634410876730305,0.06126746062307681,0.06656597373771861,0.0722581619039795,0.07836157901616719,0.08489239797262456,0.09186493583501382,0.09929112736527793,0.1071799517312227,0.1155368203742521,0.1243629377283899,0.1336546505748034,0.1434036946883592,0.1535934074503685,0.1642025176830041,0.1752020319277958,0.1865555209406267,0.1982189494541402,0.2101406973333642,0.2222618002183648,0.2345164312354754,0.2468326363442176,0.2591333246406148,0.2713375019686924,0.2833617222094845,0.2951217164497249,0.3065341467321616,0.3175280843003918,0.3280109223724721,0.3379195607946843,0.3471913304807661,0.3557723518927499,0.3636185105852368,0.3706961111788183,0.3769821772804812,0.382464376476331,0.3871405649336305,0.391017968888458,0.3941120518614462,0.3964451545360556,0.3980450318854527,0.3989177605577331,0.399137733303168,0.3987301249419454,0.3977843764084087,0.3962392114077999,0.3941811854251069,0.391652382707415,0.3886966426455339,0.3853594420592982,0.3816876570366114,0.3777292750251316,0.3735331722690241,0.3691490320826912,0.3646274015697016,0.3600198198151671,0.3553789232208057,0.350758442193659,0.3462130325720569,0.3417979191328016,0.3373008938836524,0.3333125644408615,0.3296154346964898,0.3262720822206268,0.3233285550017718,0.3208284196635116,0.3188101701498948,0.3173064459571098,0.3163434128271386,0.3159402717410645,0.3161089323676746,0.3168538635698562,0.318172124227137,0.3200535697374335],[3.970583108925521e-36,0.005447495933572625,0.005972963216594259,0.006548518978827264,0.00717881631876717,0.007868916613334147,0.008624319951731805,0.009450997227508303,0.01035542333619199,0.011344611221914,0.01242614643173354,0.01360822173554254,0.01489967125045718,0.01631000336954558,0.01784944165767371,0.01952891511580816,0.02136013453227777,0.02335557666754479,0.02552850214101286,0.02789295577639398,0.03046375500524856,0.03325646370234955,0.03628734852301806,0.03957331452561887,0.04313181661207188,0.04698074313140536,0.0511382678983192,0.05562266691945403,0.06045209634019158,0.06564432857576068,0.07121644432764439,0.07718447926628963,0.08356302563698911,0.09036479096100963,0.09760011838445137,0.1052764760715754,0.1133979263079282,0.1219645885825582,0.1309725523235132,0.1404117924264292,0.1502679318315203,0.1605205376369426,0.1711432057895374,0.1821034744146816,0.1933629100126585,0.2048773905572051,0.2165976034052456,0.2284697674860757,0.2404365786895541,0.2524383651340651,0.2644144256763712,0.2763045113891949,0.2880503966487982,0.2996009335834161,0.3108997082740145,0.3219065936574428,0.3325861263153911,0.3429115720538781,0.3528656225856711,0.362440749322261,0.3716391834356934,0.3804725097988574,0.3889608871846789,0.3971319379944615,0.4050193846458325,0.4126615399992,0.4200997770087908,0.4273478930334776,0.4345091789932902,0.4416008200947644,0.4486742003904867,0.4557316758958659,0.4628323551331559,0.4700092314744742,0.4772916407479518,0.4847041206980248,0.4922657938076355,0.4999899743837909,0.5078840489372419,0.515949602206221,0.524182709412031,0.5325743055629625,0.5411105660380873,0.5497732685484737,0.5585401375778125,0.5673851908622489,0.5764891945049487,0.5854473624255279,0.5943646883219791,0.6032290528337939,0.6120001393621585,0.6206387660980294,0.6291062296327358,0.6373647644052808,0.6453783090042181,0.6531132076911185,0.6605388416217606,0.6676281730167787,0.6743581836974657,0.6807101951344383],[6.892386621781383e-37,0.000948890681067787,0.001040771236243009,0.001141481364498712,0.00125185601228724,0.001372806353300025,0.001505326199933909,0.001650498843423008,0.00180950432781744,0.001983627157314847,0.002174264429118699,0.002382934374890742,0.002611285282714619,0.002861104758009615,0.003134328885958138,0.003433053309389128,0.003759541278717638,0.004116234577689546,0.004505762928033816,0.004930953286338399,0.005394838557956552,0.005900665465728322,0.006451901269457425,0.007052238988737066,0.007705600738301931,0.008416138743556172,0.009188233566848045,0.01002648904565244,0.01093572342598895,0.01192095617271558,0.01298738995792809,0.01414038737506485,0.01538544200501954,0.016728143576745,0.01817413712262192,0.0197290762306219,0.02139857074072161,0.02318812951824769,0.02510316348094363,0.02714868835814126,0.02932958081121385,0.03165031560411308,0.03411495017242644,0.03672706799110505,0.03948972925169326,0.04240543100888917,0.04547607868941776,0.04870297043280621,0.05208679516610527,0.05562764462885308,0.05932503879660129,0.06317796334106206,0.06718491694958981,0.07134512331525131,0.07565423589447366,0.08011046053333909,0.08471081993296614,0.08945207580617176,0.09433075437005523,0.09934315821599742,0.1044853620840731,0.1097531902240385,0.1151421733863995,0.1206474843827618,0.1262638528161988,0.1319854620272788,0.137805834269743,0.143714331471382,0.1497066199750079,0.1557728280986009,0.1619159526130441,0.168102490883671,0.1743296499541893,0.1805843422808182,0.1868525719784222,0.1931196317420752,0.1993702437400242,0.2055887133764532,0.211759095006757,0.217865371437102,0.2238916473247433,0.229822353266632,0.2356424543021842,0.2413376548715494,0.2468945920630529,0.2523010098023559,0.2575515722891784,0.2626239017239681,0.2675213312746855,0.272232639556432,0.2767527847303255,0.2810782219514987,0.2852068222014586,0.2891378735551298,0.2928719895134265,0.2964109997346908,0.2997578294021176,0.3029163706731493,0.3058913505455007,0.30868819909834],[-5.830507383673451e-36,-0.008069008318063408,-0.008854785646393524,-0.009716976572041047,-0.01066299124814126,-0.01170095174643555,-0.01283976110947964,-0.01408917708612256,-0.01545989251045849,-0.01696362284463785,-0.0186132014261297,-0.02042268297475967,-0.02240745592176927,-0.02458436411926616,-0.0269717842218826,-0.02958996739103729,-0.0324609132121959,-0.03560870808545805,-0.03905965951955019,-0.0428424829136792,-0.04698849947270767,-0.05153184466254687,-0.05650968617091483,-0.06196244977452472,-0.06793405080307735,-0.07447212800635195,-0.08162827554464175,-0.08945826750563581,-0.09802226777489068,-0.1073850162288969,-0.1176159800644679,-0.1287894566246827,-0.1409846113496845,-0.1542854315194918,-0.1687805733542976,-0.1845630769346495,-0.2017299205002865,-0.2203813832548385,-0.2406206550457864,-0.2625510106676485,-0.2862767504919551,-0.3119000250082241,-0.339519106385892,-0.3692259691701063,-0.4011035181148969,-0.4352224804627496,-0.4716380009862571,-0.5103860027145162,-0.5514794037304883,-0.5949043095247291,-0.640616329370249,-0.6885371917058195,-0.7385518546331608,-0.7905309462042398,-0.8442392425222196,-0.8994590949548029,-0.955915064606131,-1.013293746789571,-1.071247317802146,-1.12939850241172,-1.187346884824291,-1.244676381059685,-1.300963573208903,-1.355786491819541,-1.408733344193592,-1.459410649871262,-1.507450283098281,-1.552429532398261,-1.594098375111991,-1.632198883741005,-1.66702139522632,-1.697543948332792,-1.723957799042807,-1.74615592274607,-1.764066835065809,-1.777656899365694,-1.786928382606973,-1.791916269605176,-1.792683911710045,-1.789317964820148,-1.781923211881513,-1.770617803335916,-1.755529270854659,-1.736791475650139,-1.714542501678788,-1.688923409170049,-1.659974367051652,-1.627661149270682,-1.592646777889738,-1.554808987122035,-1.514303371959198,-1.471298583139882,-1.425965742779727,-1.378482890821862,-1.329035170475354,-1.277814529077939,-1.225019180171543,-1.170852775383032,-1.115523309420226,-1.059241803770576],[-1.022482893450636e-35,-0.01396210198165701,-0.01530184636689096,-0.01676785961668751,-0.01837157807345766,-0.020125379697054,-0.02204264166674469,-0.02413779745863934,-0.02642639189408334,-0.02892513260932348,-0.0316519360294827,-0.03462596550010804,-0.03786765873054775,-0.04139874112889852,-0.04524222015594689,-0.04942235857673518,-0.05396461801760433,-0.05889556631533797,-0.06424274338203448,-0.07003447536345168,-0.0762996278024046,-0.08306728707154033,-0.09036635832006197,-0.09822506728503759,-0.106670352641951,-0.1157271352277123,-0.1254174506057298,-0.1357594322277,-0.1467661340777472,-0.1584441843807233,-0.1707922659507171,-0.1837994242804953,-0.1974432117391173,-0.2116876854157193,-0.2264812873000686,-0.2417546485748536,-0.2574183745850547,-0.2733608830952408,-0.2894478136378049,-0.305515035966458,-0.3213744540429379,-0.336808627116279,-0.35157152931796,-0.365389029658249,-0.3779602587596165,-0.3889599650983794,-0.3980419321633808,-0.4048434856594871,-0.4089910676784762,-0.4101067947014039,-0.4078158515291309,-0.4017545078860449,-0.3915784834613481,-0.3769832266130442,-0.357666074327501,-0.3333991379038256,-0.3039942405943907,-0.2693177676765788,-0.2292940844077092,-0.183907155985607,-0.1332002756960879,-0.07727392767329229,-0.01628194455334416,0.04957374923491281,0.1200494169569742,0.1948663783796334,0.2737180729246203,0.3562046387451583,0.4421184823625908,0.5310627854321013,0.622752546142653,0.7166831052130566,0.8126067958562746,0.910210265862711,1.009204800434306,1.109328398855329,1.210346676664962,1.312051829769738,1.414260220208577,1.516809306882451,1.619554532579986,1.722366532051991,1.82512878540745,1.927735684586191,2.030090914740475,2.132106047280218,2.235851547161579,2.337223627680592,2.437916585569548,2.538009083673006,2.637414944470598,2.736066550735058,2.833897134717286,2.930838482194571,3.026820633533303,3.121771418741622,3.215616074980526,3.308277011714738,3.399673734763749,3.489722936308234],[1.51922151922152e-35,0.02086453112591683,0.02287940471322253,0.02508679953868288,0.02750469598858398,0.03015266973106305,0.03305201642513048,0.03622588249760025,0.03969940163486087,0.04349983626592781,0.04765672302836815,0.052202020866165,0.05717026000054461,0.06259868953316905,0.06852740519103032,0.07499954102581394,0.08206131686234899,0.08976219224567199,0.09815493959887227,0.1072956983139169,0.1172439906750211,0.1280626902151285,0.1398179318559145,0.1525789519298113,0.1664178449860088,0.1814092232171359,0.1976297635067102,0.2151576266101715,0.234071732989301,0.2544508804893065,0.2763726905678265,0.2999123723565552,0.3251412976619387,0.3521253852800442,0.3809232998653051,0.4115844791441075,0.4441470134996107,0.4786354137444601,0.5150600784807229,0.5534085870379165,0.5936523086996195,0.6357388828679058,0.6795916901465374,0.7251084188663216,0.7721601103393761,0.8205907920752671,0.8702178008730032,0.9208328841218553,0.9722041478545271,1.02407889458591,1.076187363577612,1.128247351923655,1.179969657794313,1.231096121187814,1.281286347219829,1.330292348436601,1.377861299046674,1.423767260866461,1.467818242672092,1.509862853275402,1.549796298274371,1.587565449745512,1.623172704915129,1.65667835604514,1.688201231209196,1.717917442675214,1.74605719767461,1.772777020070083,1.798561332448443,1.823725133831846,1.849026391533506,1.874204603052185,1.899956181126168,1.926693333964142,1.954819653455126,1.984723093102249,2.016767355074769,2.051283374797412,2.088561358856673,2.12884397241923,2.172321177448586,2.219127007196033,2.269338330021041,2.322975475638611,2.380004486721447,2.440340704903246,2.505626527496909,2.572359465414952,2.641924808702322,2.7140757041176,2.788544799422542,2.865055588463425,2.943318312136182,3.023035436914775,3.103906251638636,3.185630781188629,3.267913164546209,3.350464520007412,3.433005331415655,3.515267400559221],[2.772245542720769e-35,0.03809045854612312,0.04177067421863007,0.04580291172094175,0.05022012515036428,0.05505820854319108,0.06035622908678859,0.06615667257657792,0.07250570061812449,0.07945341849921631,0.08705415217980583,0.09536673227198625,0.1044547821941519,0.11438700686912,0.1252374562569405,0.1370858755841045,0.1500178604436889,0.1641251530667923,0.1795058253957383,0.1962644298295136,0.2145120891462493,0.2343665097342039,0.2559519001021887,0.2793987744659128,0.3048436191127956,0.3324283973600314,0.3622998674000619,0.3946086863733623,0.4295082738591037,0.4671534089053313,0.5076985370377064,0.5512957677131893,0.5980925487436825,0.6482290125952357,0.7018350003931496,0.7590267830395291,0.819903515016448,0.884543474918324,0.953001616574613,1.025300209410822,1.101432519239702,1.181354404546368,1.264982090615687,1.352189337617254,1.442805270272948,1.536613019940709,1.633349313001915,1.732705112430866,1.834327382914006,1.93782200526102,2.042757815198621,2.148671687539057,2.255074532028819,2.36148155635331,2.467323566300845,2.572094481588071,2.675268626978763,2.776329659740609,2.874777510025997,2.970134774139128,3.061952378034387,3.149814355303108,3.233341635109352,3.312194816712627,3.386076014444658,3.45472997278848,3.51794474717471,3.575215127821206,3.627001227227828,3.672992905854827,3.713729529176822,3.748141423396977,3.776804859210414,3.799840759971387,3.817420822366392,3.829765101729353,3.837138316632579,3.839845082676541,3.838224406768499,3.832643730321709,3.823492668344389,3.811176495745731,3.796109420575625,3.778707734953715,3.759383002881215,3.738535494234668,3.717115087537804,3.694377057770852,3.671229464073302,3.647939247333619,3.624766236603282,3.601944666388873,3.579672235043288,3.55811163931627,3.537391972144502,3.517610656858818,3.498835944369892,3.481109811888845,3.46445111508095,3.448858860148035]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>T9<\/th>\n      <th>T12<\/th>\n      <th>T15<\/th>\n      <th>Ne9<\/th>\n      <th>Ne12<\/th>\n      <th>Ne15<\/th>\n      <th>Vx9<\/th>\n      <th>Vx12<\/th>\n      <th>Vx15<\/th>\n      <th>maxO3v<\/th>\n      <th>ventNord<\/th>\n      <th>ventOuest<\/th>\n      <th>ventSud<\/th>\n      <th>pluieSec<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"T9","targets":1},{"name":"T12","targets":2},{"name":"T15","targets":3},{"name":"Ne9","targets":4},{"name":"Ne12","targets":5},{"name":"Ne15","targets":6},{"name":"Vx9","targets":7},{"name":"Vx12","targets":8},{"name":"Vx15","targets":9},{"name":"maxO3v","targets":10},{"name":"ventNord","targets":11},{"name":"ventOuest","targets":12},{"name":"ventSud","targets":13},{"name":"pluieSec","targets":14}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Puis on peut visualiser les chemins de régularisation des estimateurs <strong>Ridge</strong>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.R, <span class="at">xvar =</span> <span class="st">"lambda"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Ici on voit l’évolution de nos coefficients <span class="math inline">\(\beta\)</span> en fonction des diffrentes valeurs de <span class="math inline">\(\lambda\)</span>. Ainsi, sur la gauche on se retrouve dans la situation où il n’y a pas de pénalisation et donc nos coefficients sont les <span class="math inline">\(\beta\)</span> de l’estimation par moindres carrés. Et donc plus <span class="math inline">\(\lambda\)</span> va augmenter, plus on se retrouvera dans une situation où les coefficients vont tendrent vers 0.</p>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mod.L <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(ozone.X, ozone.Y, <span class="at">alpha =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>La fonction <em><code>glmnet</code></em> calcule tous les estimateurs pour une grille de valeurs de <span class="math inline">\(\lambda\)</span> que l’on peut récupérer.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mod.L<span class="sc">$</span>lambda <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22.00727 20.05220 18.27082 16.64769 15.16876 13.82121</code></pre>
</div>
</div>
<p>Et on peut également récupérer les différentes valeurs de <span class="math inline">\(\beta\)</span> associée aux différents <span class="math inline">\(\lambda\)</span>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>beta_values <span class="ot">&lt;-</span> mod.L<span class="sc">$</span>beta <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> <span class="fu">t</span>()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(beta_values) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"lambda_"</span>, <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(mod.L<span class="sc">$</span>lambda), <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>beta_values <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-433ce7d85fca0cd7047e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-433ce7d85fca0cd7047e">{"x":{"filter":"none","vertical":false,"data":[["lambda_1","lambda_2","lambda_3","lambda_4","lambda_5","lambda_6","lambda_7","lambda_8","lambda_9","lambda_10","lambda_11","lambda_12","lambda_13","lambda_14","lambda_15","lambda_16","lambda_17","lambda_18","lambda_19","lambda_20","lambda_21","lambda_22","lambda_23","lambda_24","lambda_25","lambda_26","lambda_27","lambda_28","lambda_29","lambda_30","lambda_31","lambda_32","lambda_33","lambda_34","lambda_35","lambda_36","lambda_37","lambda_38","lambda_39","lambda_40","lambda_41","lambda_42","lambda_43","lambda_44","lambda_45","lambda_46","lambda_47","lambda_48","lambda_49","lambda_50","lambda_51","lambda_52","lambda_53","lambda_54","lambda_55","lambda_56","lambda_57","lambda_58","lambda_59","lambda_60","lambda_61","lambda_62","lambda_63","lambda_64","lambda_65","lambda_66","lambda_67","lambda_68","lambda_69","lambda_70","lambda_71"],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0001317444384088287,0.0009385218103013691,0.001840155586493028,0.003655491681198563,0.006016371240724805,0.00681174366931621],[0,0.4858228912938862,0.9284866159092191,1.3101948211685,1.467227451051184,1.60500187165101,1.713709956024509,1.81349207255953,1.83143720067021,1.871916818087344,1.905437968363831,1.935044787650842,1.961649772010908,1.98674435139543,2.010020955004963,2.037414132339746,2.063646260557483,2.083237583510009,2.103792849859588,2.121220514773028,2.135303376392917,2.148971677584608,2.161603058703309,2.173171918610321,2.182853490175066,2.185605893431552,2.191185389054641,2.195334248447149,2.198536090307663,2.201131317370472,2.203266105863633,2.205094136071931,2.206762554271955,2.208252823641786,2.20968068839233,2.195207440085444,2.169918981482742,2.148176302255803,2.127571467005376,2.108618445864388,2.091279074475006,2.075770438681086,2.061847838332675,2.049961374646519,2.038538297403882,2.028162445947963,2.018691703567241,2.010040182867146,2.002923888412143,1.995744307995235,1.987100432977156,1.985508543103673,1.984585565615385,1.984429449709988,1.983950057386693,1.983362643666478,1.983275342414851,1.982939504194651,1.98292476022308,1.982688197935037,1.982306438071122,1.982170685047784,1.981998353685511,1.981910906613868,1.982042445849636,1.981995797929353,1.981418971913694,1.980803990739345,1.979440464763687,1.977845438924899,1.977513957718824],[0,0,0,0.02189670748388446,0.1884927104547472,0.2653828209523676,0.3493687316175589,0.425293242572068,0.4815811055132146,0.4914452408064159,0.5023342411591799,0.5129884066493562,0.5229878120289813,0.5242080882265583,0.5227121495592216,0.5158489313533524,0.5087613561163472,0.5000639180832849,0.492018686500445,0.4858363828032522,0.481381321896442,0.4768704915964145,0.4726322317896694,0.4687245476758939,0.4643536502672945,0.4656300190031506,0.4669716099970259,0.4697112897777902,0.4727362580017779,0.4758285143661406,0.4788205471198422,0.4816343318611655,0.4840550413585711,0.486279443391899,0.4883908560358466,0.492358680321249,0.4962156034092029,0.4997710422827339,0.5032954803147252,0.5067093552441114,0.5097906194647764,0.5124404712061101,0.5147464604800155,0.5165970596679365,0.5182779810431792,0.5198545001734374,0.5213230322966592,0.522675808802737,0.5237889942923292,0.5248179735546905,0.5229602620987359,0.5188851540695418,0.5146794976121585,0.5105128864341352,0.5068413859391443,0.503590150196485,0.5004153134450992,0.4976579014053827,0.4949805436513871,0.4926915798830763,0.4907112850102559,0.4887378006443369,0.4870738615522012,0.485412276802848,0.4838005457528333,0.482493028930752,0.4811901597138745,0.4801175262172517,0.4789966322927905,0.4778292957448663,0.4771571666495072],[0,0,0,0,0,0,0,0,-0.2013215373037936,-0.4457800412038607,-0.6693530664036769,-0.8731451935587764,-1.058864279828156,-1.202353387742147,-1.317071986960268,-1.421037153963655,-1.515657987371936,-1.584461473646641,-1.64922776404144,-1.708870054745082,-1.764743592527928,-1.814099103978133,-1.85907729089104,-1.900061477149703,-1.933054393009298,-1.969082376464264,-1.97834889987405,-1.993965819189747,-2.006949649338242,-2.018834562986262,-2.029699499953622,-2.039597446664456,-2.04991403874127,-2.057948390348048,-2.065250882486276,-2.074461835150804,-2.082726013256389,-2.09082315700604,-2.09705024295768,-2.102762482130058,-2.10765674382557,-2.111781474697111,-2.115929525462318,-2.120763387937572,-2.124203885543038,-2.127232988706195,-2.130047850417573,-2.132630570789555,-2.135759903185904,-2.13799221828033,-2.1319333717901,-2.130741953127598,-2.129671463438259,-2.128429384792354,-2.127654305815051,-2.126987622343378,-2.125972932038979,-2.125543819451122,-2.124677009109918,-2.124397280441502,-2.124206230366703,-2.123490278717409,-2.123386623387829,-2.122811793604287,-2.122207042596391,-2.122197843405663,-2.121831395431514,-2.121755793804441,-2.121326609724239,-2.120587850272561,-2.120589216744697],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.003721588949966689,-0.03677675146654091,-0.06243884158877245,-0.08530999511208243,-0.1050305210398099,-0.1243153152705933,-0.1418438005560816,-0.1578031684377756,-0.1732637177385165,-0.1775425341298954,-0.1877539567852359,-0.1913435865621871,-0.1956018502606242,-0.1994067324700423,-0.2028815405704843,-0.2060691198470098,-0.2080990999966926,-0.2110138747107794,-0.2135481828401893,-0.2293779011059567,-0.2586308322876385,-0.2835260222099466,-0.307699621542577,-0.3296631880868668,-0.3495302908405989,-0.3673801079623376,-0.3832466892254894,-0.3963545953092071,-0.4096605835077505,-0.4217768899714553,-0.4327528200914548,-0.4427461016110037,-0.45060983963079,-0.4589450532167298,-0.4803396462393183,-0.491354799731018,-0.5014653173118017,-0.5104392458247778,-0.5186381452820611,-0.526158910719999,-0.5329986628905774,-0.5390309991421721,-0.5447090090878719,-0.5496154978064088,-0.5541355014539548,-0.5585658702546127,-0.5621312306964317,-0.5657869450443257,-0.5690291362905771,-0.5715577520966387,-0.5744070387979477,-0.5767777961362475,-0.5796513629406514,-0.5826895031737763,-0.5841916214184477],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0.07086858414017515,0.1764190679401763,0.2730933650584627,0.3595320449415801,0.4388578692577841,0.5104579156030187,0.5755402146448797,0.6347289629448061,0.6887398017223937,0.7379558058498851,0.7828018544921574,0.8204510412730226,0.8496699187382861,0.8456526861536827,0.8431714004378381,0.8399287962549142,0.8367987434895532,0.8339413092738075,0.8313347934142328,0.8302850700330416,0.8282675513732974,0.8261689996524026,0.8101661541299409,0.7905436012570171,0.7724398439035991,0.7544771579134125,0.7379128700235631,0.7217688191780691,0.7054953256947798,0.6906878951332154,0.678729717696579,0.6667668861612635,0.655528538297695,0.6452535207936868,0.6358997669783548,0.6285498817265218,0.6210936452591268,0.6055359468007865,0.593826315806549,0.5837374878592917,0.5737631474074806,0.5654260584110538,0.5579548327701971,0.5503540298805666,0.5441000191783182,0.5377621613959394,0.5325862321919871,0.5280805636558568,0.5233461119910038,0.5194804867445261,0.5155511894128115,0.511701175128789,0.5087366500306071,0.5058925004095057,0.5038302286816967,0.5019897369438938,0.5003338392566027,0.4992177038387627],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.001560938837689138,0.005115382312844566,0.01140766420821948,0.01771265603830931,0.02337565189007035,0.02853538636294619,0.03334403937515707,0.03777527985581852,0.04182107296801509,0.04545325251265083,0.0487249407740566,0.08301427910868782,0.1202175666878762,0.153039774601762,0.1847246579382823,0.2121698428413199,0.2366814961225041,0.2606723522004359,0.2813923317880257,0.301425106818312,0.3186162065232306,0.3336194845753983,0.3484988553620176,0.3612797504282277,0.3737439806403435,0.3857624262220202,0.3956740924534573,0.4051308302637979,0.4129031938407744,0.4203575478640812,0.4275421104022787,0.4325313933733659],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.002907645921106033,0.0491064579278236,0.0890097926185526,0.1260630884341815,0.1598960488557166,0.190710851532062,0.2187852197486551,0.2434606067801566,0.2667181919461451,0.2880543566376031,0.3178516639846506,0.3507753177946661,0.3807313423347451,0.4090821648526843,0.4337064507487412,0.4553204596491103,0.4737447550417206,0.4899879330451825,0.5037228700867383,0.5170820669682483,0.5293902493188798,0.5405736445876311,0.5507476891970705,0.5591952399648169,0.5675135854867198,0.5905763710117786,0.6027590391597023,0.6138525193019786,0.6239785093439157,0.6330102505889104,0.6413095138073759,0.6490478725018142,0.655735385686398,0.6621496637490973,0.6676226430787912,0.6726399601694429,0.6776011592744882,0.6816448483028059,0.6857123858754144,0.6894086766028498,0.6923050417541926,0.6953197883934106,0.6976559754919157,0.7001464917014418,0.7025662960564182,0.7036088752216483],[0,0,0,0,0.008126543304673257,0.03789880857419468,0.06511475879279359,0.08990861654956929,0.1144433565106641,0.1370749886596559,0.1577729092010129,0.1766388302791972,0.1938313603887341,0.2085533416806526,0.2212798615868313,0.2328763794068963,0.2433623143766003,0.2530253589506538,0.2617220232350383,0.2696504128351019,0.2769094275872351,0.2834957217995935,0.28949524922048,0.2949614048381522,0.2996884674649359,0.3036412467793814,0.3072397740462404,0.3105060186799646,0.3134754608989014,0.3161798730368857,0.3186455689015454,0.3208929069703101,0.3229516809595552,0.3248215265022659,0.3265196296309367,0.3285570805098762,0.3308640678199043,0.3329179039403497,0.334806487058705,0.3365164647942774,0.338096285347057,0.3395470392469714,0.3408666767546676,0.3420442444967751,0.3431421764030508,0.3441413260992787,0.3450515200711431,0.3458810697837575,0.3466084986400622,0.3472993572400823,0.3472032238619606,0.3470442916374921,0.346911044315633,0.3467585250373701,0.3466447227527891,0.3465484079515853,0.3464316576540244,0.3463471334488106,0.3462482899436143,0.3461784032413837,0.3461245921992547,0.3460538169951958,0.3460035907121661,0.3459438405279242,0.3458782418528727,0.3458337227029136,0.3457759813954626,0.3457304357335264,0.345668768146683,0.3455913752654834,0.3455713903356649],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.1407246246519667,-0.4054897646224819,-0.6429738388734273,-0.8623806606188601,-1.062764526898673,-1.247432118113989,-1.418162350674293,-1.573603013767231,-1.712042036192385,-1.841104286927941,-1.958850731940518,-2.066117725822639,-2.163863671430091,-2.249879641377057,-2.330965360735282,-2.08148708892905,-1.857692925653099,-1.659013028583378,-1.46822943064577,-1.302806939934215,-1.154636391502792,-1.009859270317169,-0.8857381408284932,-0.7649154002905999,-0.6624038456275144,-0.5727292128229219,-0.4823707621189307,-0.4069319032386553,-0.3314733981251375,-0.259094853345011,-0.2016122125125389,-0.144408401941564,-0.09933987098858087,-0.05334107375143813,-0.007908369377980519,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01545164740391976,0.5092229985928821,0.94249262203314,1.329640509276609,1.695208135381446,2.016938979717077,2.306659570136347,2.583826543965576,2.825663505252844,3.056611656001091,3.256541610191424,3.433682240875797,3.607134872985385,3.755313152638126,3.899927256814001,4.036474748012121,4.148923516403527,4.258755372570556,4.348784422199186,4.438611540688732,4.525633668489617,4.569688013803754],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1461371184990177,0.2605668404724224,0.3644601795801932,0.4598149752228369,0.5457913098495475,0.6234897851597279,0.6929939836974557,0.7559309768390422,0.8124879853922737,0.8645784052047111,0.9120957613974954,0.9553969467468887,0.9948543474183246,1.030091085267051,1.071272869418583,1.469262166260958,1.812142360652513,2.118582068327347,2.407102158262586,2.661536519007701,2.890918014680518,3.109668861904767,3.300912124700855,3.483112211141435,3.641193894630822,3.781549921762142,3.918547905714431,4.035771575679267,4.149924902053174,4.257421267346852,4.34613416031713,4.432499726575875,4.503227244585895,4.573409760097598,4.640898540590142,4.672150421005952],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.09093164308658871,0.2674486396062391,0.4715734667611774,0.6516579011434052,0.8180311896981416,0.9698849683765179,1.108319207174786,1.234502125175198,1.346838156904117,1.451614471119412,1.547325803315351,1.654801302095809,1.773861258102672,1.8811197130279,1.981975399738697,2.073382923837674,2.157469466842999,2.234788349287903,2.304578434121709,2.364975698548811,2.422553229016509,2.475421710705109,2.523577774636562,2.567438588874907,2.604763063809912,2.643804215085672,2.709864459528907,2.758487131954725,2.801953643864347,2.842300852494112,2.878083408813967,2.910593819058251,2.941243364879965,2.968051183187871,2.99352096326903,3.01563317533814,3.03554748033883,3.054892444525378,3.071360755295401,3.087388982435489,3.102251666365909,3.114526610137896,3.126513749015011,3.136228170600866,3.145740871129441,3.154652501435125,3.1604723394141]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>T9<\/th>\n      <th>T12<\/th>\n      <th>T15<\/th>\n      <th>Ne9<\/th>\n      <th>Ne12<\/th>\n      <th>Ne15<\/th>\n      <th>Vx9<\/th>\n      <th>Vx12<\/th>\n      <th>Vx15<\/th>\n      <th>maxO3v<\/th>\n      <th>ventNord<\/th>\n      <th>ventOuest<\/th>\n      <th>ventSud<\/th>\n      <th>pluieSec<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"T9","targets":1},{"name":"T12","targets":2},{"name":"T15","targets":3},{"name":"Ne9","targets":4},{"name":"Ne12","targets":5},{"name":"Ne15","targets":6},{"name":"Vx9","targets":7},{"name":"Vx12","targets":8},{"name":"Vx15","targets":9},{"name":"maxO3v","targets":10},{"name":"ventNord","targets":11},{"name":"ventOuest","targets":12},{"name":"ventSud","targets":13},{"name":"pluieSec","targets":14}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Puis on peut visualiser les chemins de régularisation des estimateurs <strong>Lasso</strong>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.L, <span class="at">xvar =</span> <span class="st">"lambda"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Ici on voit l’évolution de nos coefficients <span class="math inline">\(\beta\)</span> en fonction des diffrentes valeurs de <span class="math inline">\(\lambda\)</span>. Ainsi, sur la gauche on se retrouve dans la situation où il n’y a pas de pénalisation et donc nos coefficients sont les <span class="math inline">\(\beta\)</span> de l’estimation par moindres carrés. Et donc plus <span class="math inline">\(\lambda\)</span> va augmenter, plus on se retrouvera dans une situation où les coefficients vont tendrent vers 0.</p>
</div>
</div>
</div>
</div>
</section>
<section id="selection-des-paramètres-de-régularisation" class="level1">
<h1>Selection des paramètres de régularisation</h1>
<p>Maintenant que les modèles sont estimés avec plusieurs valeurs de <span class="math inline">\(\lambda\)</span> possibles, il se pose la question du choix du bon paramètre.<br>
Pour cela, on utilise la fonction <em><code>cv.glmnet</code></em> qui, comme son nom le laisse suggérer, permet d’effectuer une validation croisée pour notre modèle avec par défaut <em><code>nfolds=10</code></em> (le nombre de pli pour le découpage de sous ensembles). Puis on peut faire un <em><code>plot</code></em> de l’objet.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Ridge</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Lasso</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ridgeCV <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(ozone.X, ozone.Y, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridgeCV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On visualise ici les erreurs quadratiques calculées par validation croisée 10 blocs en fonction de <span class="math inline">\(\lambda\)</span> (échelle logarithmique). Deux traits verticaux sont représentés :</p>
<ul>
<li><p>celui de gauche correspond à la valeur de <span class="math inline">\(\lambda\)</span> qui minimise l’erreur quadratique</p></li>
<li><p>celui de droite correspond à la plus grande valeur de <span class="math inline">\(\lambda\)</span> telle que l’erreur ne dépasse pas l’erreur minimale + 1 écart-type estimé de cette erreur</p></li>
</ul>
<p>D’un point de vu pratique, cela signifie que l’utilisateur peut choisir n’importe quelle valeur de lambda entre les deux traits verticaux.<br>
A savoir que si l’on veut diminuer la complexité du modèle on choisira la valeur de droite.</p>
<p>On peut obtenir ces deux valeurs assez facilement.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">" Valeur minimale : "</span>, ridgeCV<span class="sc">$</span>lambda.min, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Valeur maximale : "</span>, ridgeCV<span class="sc">$</span>lambda<span class="fl">.1</span>se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Valeur minimale :  9.750588 
 Valeur maximale :  39.36329</code></pre>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>lassoCV <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(ozone.X, ozone.Y, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lassoCV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Exercice_06Bonus_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>On visualise ici les erreurs quadratiques calculées par validation croisée 10 blocs en fonction de <span class="math inline">\(\lambda\)</span> (échelle logarithmique). Deux traits verticaux sont représentés :</p>
<ul>
<li><p>celui de gauche correspond à la valeur de <span class="math inline">\(\lambda\)</span> qui minimise l’erreur quadratique</p></li>
<li><p>celui de droite correspond à la plus grande valeur de <span class="math inline">\(\lambda\)</span> telle que l’erreur ne dépasse pas l’erreur minimale + 1 écart-type estimé de cette erreur</p></li>
</ul>
<p>D’un point de vu pratique, cela signifie que l’utilisateur peut choisir n’importe quelle valeur de lambda entre les deux traits verticaux.<br>
A savoir que si l’on veut diminuer la complexité du modèle on choisira la valeur de droite.</p>
<p>On peut obtenir ces deux valeurs assez facilement.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">" Valeur minimale : "</span>, lassoCV<span class="sc">$</span>lambda.min, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Valeur maximale : "</span>, lassoCV<span class="sc">$</span>lambda<span class="fl">.1</span>se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Valeur minimale :  1.230385 
 Valeur maximale :  4.525822</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="prédiction" class="level1">
<h1>Prédiction</h1>
<p>On souhaite maintenant prédire la variable cible pour de nouveaux individus, par exemple les 50ème et 51ème individus du jeu de données.</p>
<p>Une première approche pourrait consister à réajuster le modèle sur toutes les données pour la valeur de <span class="math inline">\(lambda\)</span> sélectionnée.<br>
Cette étape est en réalité déjà effectuée par la fonction <em><code>cv.glmnet</code></em>. Il suffit par conséquent d’appliquer la fonction predict à l’objet obtenu avec <em><code>cv.glmnet</code></em> en spécifiant la valeur de <span class="math inline">\(lambda\)</span> souhaitée.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Ridge</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Lasso</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(ridgeCV, <span class="at">newx =</span> ozone.X[<span class="dv">50</span><span class="sc">:</span><span class="dv">51</span>, ], <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         lambda.min
20010723   90.10981
20010724   96.74374</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(ridgeCV, <span class="at">newx =</span> ozone.X[<span class="dv">50</span><span class="sc">:</span><span class="dv">51</span>, ], <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         lambda.1se
20010723   93.11072
20010724   96.26805</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lassoCV, <span class="at">newx =</span> ozone.X[<span class="dv">50</span><span class="sc">:</span><span class="dv">51</span>, ], <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         lambda.min
20010723   87.18235
20010724   98.23752</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lassoCV, <span class="at">newx =</span> ozone.X[<span class="dv">50</span><span class="sc">:</span><span class="dv">51</span>, ], <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         lambda.1se
20010723   87.40631
20010724   95.85602</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="comparaison" class="level1">
<h1>Comparaison</h1>
<p>Puisque nous avons 3 méthodes de modélisations (MCO sans pénalisation, Ridge et Lasso), la prochaine étape logique va donc ^tre de comparer les trois méthodes pour déterminer laquelle est la plus approrié pour nos données.<br>
</p>
<p>On peut faire cela l’aide d’une validation croisée et pour cela on utilisera les données <em>ozone_complet.txt</em> qui contiennent plus d’individus et de variables.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ozone1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"https://lrouviere.github.io/stat_grand_dim/ozone_complet.txt"</span>, <span class="at">sep=</span><span class="st">";"</span>) <span class="sc">%&gt;%</span>  <span class="fu">na.omit</span>()</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>ozone1.X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(maxO3 <span class="sc">~</span> ., <span class="at">data =</span> ozone1)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>ozone1.Y <span class="ot">&lt;-</span> ozone1<span class="sc">$</span>maxO3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cv_ridge_vs_lasso</span>(ozone1, <span class="at">fmla =</span> <span class="fu">formula</span>(maxO3 <span class="sc">~</span> .)) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-fb7a19d0dff973ab99eb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-fb7a19d0dff973ab99eb">{"x":{"filter":"none","vertical":false,"data":[["1"],[184.5742714590106],[192.0575254957779],[190.1463246192359]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Linéaire (MCO)<\/th>\n      <th>Ridge<\/th>\n      <th>Lasso<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Linéaire (MCO)","targets":1},{"name":"Ridge","targets":2},{"name":"Lasso","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>On remarque que les approches régularisées n’apportent rien par rapport aux estimateurs MCO ici. Ceci peut s’expliquer par le fait que le nombre de variables n’est pas très important.</p>
</div>
<p>Pour changer, considérons toutes les interactions d’ordre 2</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cv_ridge_vs_lasso</span>(ozone1, <span class="at">fmla =</span> <span class="fu">formula</span>(maxO3 <span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-01fb866407163642616d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-01fb866407163642616d">{"x":{"filter":"none","vertical":false,"data":[["1"],[186.1735615575877],[167.9887499485505],[167.0197198311493]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Linéaire (MCO)<\/th>\n      <th>Ridge<\/th>\n      <th>Lasso<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Linéaire (MCO)","targets":1},{"name":"Ridge","targets":2},{"name":"Lasso","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="success-header">
<div class="success-icon">

</div>
<p>Résultats</p>
</div>
<div class="success">
<p>Les méthodes régularisées permettent ici de diminuer les erreurs quadratiques de manière intéressante. Cela vient certainement du fait du nombre de variables explicatives qui est beaucoup plus important lorsqu’on prend en compte toutes les interactions d’ordre 2.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ozone2.X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(maxO3 <span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>, <span class="at">data =</span> ozone1)[, <span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>En effet, à l’ordre 1 on est à 1366 individus pour 22 variables alors qu’à l’odre 2 on passe à 1366 individus pour 253</p>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Dans cette analyse, nous avons exploré l’utilisation des méthodes <strong>Ridge</strong> et <strong>Lasso</strong> sous <em><code>R</code></em>.<br>
Ces approches se révèlent particulièrement efficaces en grande dimension, offrant des solutions robustes pour la régression pénalisée.</p>
<p>Par la suite, le choix entre <strong>Lasso</strong> et <strong>Ridge</strong> dépend souvent des objectifs poursuivis :</p>
<ul>
<li><p><strong>Lasso</strong> intègre un mécanisme de sélection de variables, ce qui en fait un excellent outil pour identifier les prédicteurs les plus pertinents.</p></li>
<li><p><strong>Ridge</strong> conserve l’ensemble des variables en réduisant leurs coefficients sans les annuler, privilégiant ainsi une approche plus réguliarisée.</p></li>
</ul>
<p>(Voir la partie <strong>Rappel sur Ridge et Lasso</strong> pour plus de détails)</p>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>(<span class="at">pkgs =</span> <span class="st">"attached"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.4.2 (2024-10-31)
 os       Ubuntu 24.04.1 LTS
 system   x86_64, linux-gnu
 ui       X11
 language (EN)
 collate  fr_FR.UTF-8
 ctype    fr_FR.UTF-8
 tz       Europe/Paris
 date     2025-02-21
 pandoc   3.2 @ /usr/lib/rstudio/resources/app/bin/quarto/bin/tools/x86_64/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package    * version date (UTC) lib source
 dplyr      * 1.1.4   2023-11-17 [1] CRAN (R 4.4.2)
 forcats    * 1.0.0   2023-01-29 [1] CRAN (R 4.4.2)
 ggplot2    * 3.5.1   2024-04-23 [1] CRAN (R 4.4.2)
 glmnet     * 4.1-8   2023-08-22 [1] CRAN (R 4.4.2)
 gridExtra  * 2.3     2017-09-09 [1] CRAN (R 4.4.2)
 kableExtra * 1.4.0   2024-01-24 [1] CRAN (R 4.4.2)
 lubridate  * 1.9.4   2024-12-08 [1] CRAN (R 4.4.2)
 Matrix     * 1.6-5   2024-01-11 [4] CRAN (R 4.3.2)
 purrr      * 1.0.2   2023-08-10 [2] CRAN (R 4.3.3)
 readr      * 2.1.5   2024-01-10 [1] CRAN (R 4.4.2)
 stringr    * 1.5.1   2023-11-14 [2] CRAN (R 4.3.3)
 tibble     * 3.2.1   2023-03-20 [2] CRAN (R 4.3.3)
 tidyr      * 1.3.1   2024-01-24 [1] CRAN (R 4.4.2)
 tidyverse  * 2.0.0   2023-02-22 [1] CRAN (R 4.4.2)

 [1] /home/clement/R/x86_64-pc-linux-gnu-library/4.4
 [2] /usr/local/lib/R/site-library
 [3] /usr/lib/R/site-library
 [4] /usr/lib/R/library

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb47" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Exercice 06 Bonus : Ridge vs Lasso"</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Clément Poupelin"</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2025-02-21"</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">    embed-resources: false</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: article</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> false</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> ["regression Ridge", "regression Lasso", "validation croisée"]</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "/img/gants-de-boxe.png"</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Comparaison de la regression Ridge et Lasso via le github de Laurent Rouvière"</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>Dans cette partie et avant de passer à l'exercice 7, nous allons faire la section 3.1 sur la regression Ridge et Lasso avec *`glmnet`* sous *`R`* du <span class="co">[</span><span class="ot">tutoriel de Laurent Rouvière</span><span class="co">](https://lrouviere.github.io/TUTO_GRANDE_DIM/correction/03-ridge-lasso.html)</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="fu"># Rappels sur Ridge et Lasso</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>On se base encore ici sur notre modèle classique de régression linéaire :</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>$$y = X\beta + \mathcal{E} \quad \text{ou} \quad y = \beta_0 + \beta_1X^1 + ... + \beta_pX^p + \mathcal{E}$$ </span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$y \in \mathbb{R}^{n}$ la variable réponse ou variable à expliquer</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$X \in \mathbb{R}^{n\times (p+1)}$ la matrice déterministe contenant nos $p$ variables explicatives</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta \in \mathbb{R}^{p+1}$ le vecteur qui contient les coefficients de régression $\beta_0, ..., \beta_p$ que nous cherchons à estimer</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathcal{E} \in \mathbb{R}^{n}$ le vecteur d'erreur qui n'est pas corrélé à nos variables explicatives. C'est la part d'aléa que nous n'arrivons pas à déterminer</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>Pour l'estimation des coefficients de regression de ce type de modèle, nous utilisons souvent la méthodes des moindres carrées ordinaire (MCO) qui nous donne  </span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>$$\hat{\beta} = \underset{\beta}{argmin}||y-X\beta||^2$$</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>Malheureusement, lorsque $p$ est grand ou que les variables sont linéairement dépendantes, les estimateurs des moindres carrées peuvent être mis en défaut. Les méthodes pénalisées ou sous contraintes consistent alors à restreindre l’espace sur lequel on minimise ce critère.\</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>L'idée principale de ces méthodes est de contraindre la valeur des estimateurs MCO pour réduire la variance, quitte à augmenter un peu le biais (d’où la terminologie de "régression biaisée"). Nous obtenons donc, pour un certain $t&gt;0$, des estimations de la forme suivante : </span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>$$ \hat{\beta}^{pen} = \underset{\beta}{argmin}||y-X\beta||^2 \quad \text{sous la contrainte} \quad ||\beta||? \leq t$$</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ridge </span></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>La régression Ridge contraint la **norme $\ell^2$** des coefficients $\beta$ à ne pas exploser, i.e $||\beta||_2 = \sum_{j=0}^{p} \beta_j^2 \leq t$. Cela conduit à la solution d'optimisation suivante :</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>\hat{\beta}_{Ridge} = \underset{\beta}{\operatorname{argmin}} \ ||y - X\beta||^2 \quad \text{sous la contrainte} \quad \sum_{j=0}^{p} \beta_j^2 \leq t</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>où $\hat{\beta}_{Ridge}$ est **unique**, contrairement à Lasso qui peut produire plusieurs solutions.  </span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>Contrairement à Lasso, Ridge ne met pas exactement à zéro certains coefficients, mais réduit leur valeur. Il n'y a donc pas de sélection de variable effectué.\</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>Cette méthode est tout de même robuste en grande dimension et particulièrement utile lorsque les variables sont fortement corrélées. Il empêche les coefficients de devenir trop grands, ce qui réduit la variance du modèle. \</span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lasso </span></span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>La régression Lasso (pour Least Absolute Shrinkage and Selection Operator) contraint la norme $\ell^1$ de $\beta$ à ne pas exploser, i.e $||\beta||_1 = \sum_{j=0}^{p} |\beta_j| \leq t$. Nous obtenons donc</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>$$\hat{\beta}_{Lasso} = \underset{\beta}{argmin}||y-X\beta||^2 \quad \text{sous la contrainte} \quad \sum_{j=0}^{p} |\beta_j| \leq t  $$</span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>Où $\hat{\beta}_{Lasso}$ n’est pas nécessairement unique mais la prévision $\hat{y} = X\hat{\beta}_{Lasso}$  est unique.\</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>Cette méthode est principalement caractérisée par le fait qu'elle est robuste à la grande dimension en sélectionnant les variables les plus pertinentes. En effet, elle nous permet de réduire les coefficients MCO des variables sélectionnées en rapprochant leur valeur de 0, ce qui est appelé la propriété de "seuillage doux" du Lasso.</span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a>Ici, il sera donc présenté les étapes principales qui permettent de faire ce type de régression avec *`R`*. Le package le plus souvent utilisé est *`glmnet`*.</span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup</span></span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages</span></span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Inférence</span></span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet) <span class="do">## regression pénalisée</span></span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a><span class="do">## ggplot</span></span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fonctions </span></span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a><span class="fu">### boxplot </span></span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a>my_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a>  data_long <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(data)</span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span>  <span class="co"># Palette de couleurs harmonieuse</span></span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Variables (Boxplot)"</span>, <span class="at">x =</span> <span class="st">"Variables"</span>, <span class="at">y =</span> <span class="st">"Valeurs"</span>) <span class="sc">+</span></span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Thème épuré</span></span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotation des étiquettes</span></span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-119"><a href="#cb47-119" aria-hidden="true" tabindex="-1"></a><span class="fu">### pairs.panels </span></span>
<span id="cb47-122"><a href="#cb47-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-123"><a href="#cb47-123" aria-hidden="true" tabindex="-1"></a>my_pairs.panels <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb47-124"><a href="#cb47-124" aria-hidden="true" tabindex="-1"></a>  psych<span class="sc">::</span><span class="fu">pairs.panels</span>(</span>
<span id="cb47-125"><a href="#cb47-125" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb47-126"><a href="#cb47-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pearson"</span>,</span>
<span id="cb47-127"><a href="#cb47-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Méthode de corrélation</span></span>
<span id="cb47-128"><a href="#cb47-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">hist.col =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Set3"</span>),</span>
<span id="cb47-129"><a href="#cb47-129" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Couleurs des histogrammes</span></span>
<span id="cb47-130"><a href="#cb47-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-131"><a href="#cb47-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajout des courbes de densité</span></span>
<span id="cb47-132"><a href="#cb47-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">ellipses =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-133"><a href="#cb47-133" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajout d'ellipses</span></span>
<span id="cb47-134"><a href="#cb47-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-135"><a href="#cb47-135" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajout de régressions lissées</span></span>
<span id="cb47-136"><a href="#cb47-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">lm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-137"><a href="#cb47-137" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ajout des droites de régression</span></span>
<span id="cb47-138"><a href="#cb47-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"#69b3a2"</span>,</span>
<span id="cb47-139"><a href="#cb47-139" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Couleur des points</span></span>
<span id="cb47-140"><a href="#cb47-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>              <span class="co"># Transparence</span></span>
<span id="cb47-141"><a href="#cb47-141" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-142"><a href="#cb47-142" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-143"><a href="#cb47-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-144"><a href="#cb47-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-145"><a href="#cb47-145" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparaison de modèles</span></span>
<span id="cb47-146"><a href="#cb47-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-149"><a href="#cb47-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-150"><a href="#cb47-150" aria-hidden="true" tabindex="-1"></a>cv_ridge_vs_lasso <span class="ot">&lt;-</span> <span class="cf">function</span>(data, fmla) {</span>
<span id="cb47-151"><a href="#cb47-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">140400</span>)</span>
<span id="cb47-152"><a href="#cb47-152" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-153"><a href="#cb47-153" aria-hidden="true" tabindex="-1"></a>  data.X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(fmla, <span class="at">data =</span> data)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb47-154"><a href="#cb47-154" aria-hidden="true" tabindex="-1"></a>  data.Y <span class="ot">&lt;-</span> data<span class="sc">$</span>maxO3</span>
<span id="cb47-155"><a href="#cb47-155" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-156"><a href="#cb47-156" aria-hidden="true" tabindex="-1"></a>  blocs <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="at">k =</span> <span class="dv">10</span>)</span>
<span id="cb47-157"><a href="#cb47-157" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-158"><a href="#cb47-158" aria-hidden="true" tabindex="-1"></a>  prev <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(data)) <span class="sc">%&gt;%</span>  <span class="fu">as.data.frame</span>()</span>
<span id="cb47-159"><a href="#cb47-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(prev) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Linéaire (MCO)"</span>, <span class="st">"Ridge"</span>, <span class="st">"Lasso"</span>)</span>
<span id="cb47-160"><a href="#cb47-160" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb47-161"><a href="#cb47-161" aria-hidden="true" tabindex="-1"></a>    app <span class="ot">&lt;-</span> data[<span class="sc">-</span>blocs[[k]], ]</span>
<span id="cb47-162"><a href="#cb47-162" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> data[blocs[[k]], ]</span>
<span id="cb47-163"><a href="#cb47-163" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-164"><a href="#cb47-164" aria-hidden="true" tabindex="-1"></a>    app.X <span class="ot">&lt;-</span> data.X[<span class="sc">-</span>blocs[[k]], ]</span>
<span id="cb47-165"><a href="#cb47-165" aria-hidden="true" tabindex="-1"></a>    app.Y <span class="ot">&lt;-</span> data.Y[<span class="sc">-</span>blocs[[k]]]</span>
<span id="cb47-166"><a href="#cb47-166" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-167"><a href="#cb47-167" aria-hidden="true" tabindex="-1"></a>    test.X <span class="ot">&lt;-</span> data.X[blocs[[k]], ]</span>
<span id="cb47-168"><a href="#cb47-168" aria-hidden="true" tabindex="-1"></a>    test.Y <span class="ot">&lt;-</span> data.Y[blocs[[k]]]</span>
<span id="cb47-169"><a href="#cb47-169" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-170"><a href="#cb47-170" aria-hidden="true" tabindex="-1"></a>    ridge <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(app.X, app.Y, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb47-171"><a href="#cb47-171" aria-hidden="true" tabindex="-1"></a>    lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(app.X, app.Y, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb47-172"><a href="#cb47-172" aria-hidden="true" tabindex="-1"></a>    lin <span class="ot">&lt;-</span> <span class="fu">lm</span>(fmla, <span class="at">data =</span> app)</span>
<span id="cb47-173"><a href="#cb47-173" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-174"><a href="#cb47-174" aria-hidden="true" tabindex="-1"></a>    prev[blocs[[k]], ] <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb47-175"><a href="#cb47-175" aria-hidden="true" tabindex="-1"></a>      <span class="at">lin =</span> <span class="fu">predict</span>(lin, <span class="at">newdata =</span> test),</span>
<span id="cb47-176"><a href="#cb47-176" aria-hidden="true" tabindex="-1"></a>      <span class="at">ridge =</span> <span class="fu">as.vector</span>(<span class="fu">predict</span>(ridge, <span class="at">newx =</span></span>
<span id="cb47-177"><a href="#cb47-177" aria-hidden="true" tabindex="-1"></a>                                  test.X)),</span>
<span id="cb47-178"><a href="#cb47-178" aria-hidden="true" tabindex="-1"></a>      <span class="at">lasso =</span> <span class="fu">as.vector</span>(<span class="fu">predict</span>(lasso, <span class="at">newx =</span></span>
<span id="cb47-179"><a href="#cb47-179" aria-hidden="true" tabindex="-1"></a>                                  test.X))</span>
<span id="cb47-180"><a href="#cb47-180" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-181"><a href="#cb47-181" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-182"><a href="#cb47-182" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-183"><a href="#cb47-183" aria-hidden="true" tabindex="-1"></a>  err <span class="ot">&lt;-</span> prev <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">obs =</span> data<span class="sc">$</span>maxO3) <span class="sc">%&gt;%</span>  <span class="fu">summarise_at</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="sc">~</span> <span class="fu">mean</span>((obs <span class="sc">-</span></span>
<span id="cb47-184"><a href="#cb47-184" aria-hidden="true" tabindex="-1"></a>                                                                             .)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb47-185"><a href="#cb47-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(err)</span>
<span id="cb47-186"><a href="#cb47-186" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-187"><a href="#cb47-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-188"><a href="#cb47-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-189"><a href="#cb47-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-190"><a href="#cb47-190" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-191"><a href="#cb47-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-192"><a href="#cb47-192" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-193"><a href="#cb47-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-194"><a href="#cb47-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-195"><a href="#cb47-195" aria-hidden="true" tabindex="-1"></a><span class="fu"># Données</span></span>
<span id="cb47-196"><a href="#cb47-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-197"><a href="#cb47-197" aria-hidden="true" tabindex="-1"></a>On considère le jeu de données *ozone.txt* où on cherche à expliquer la concentration maximale en ozone relevée sur une journée (variable *maxO3*) par d’autres variables essentiellement météorologiques.</span>
<span id="cb47-198"><a href="#cb47-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-199"><a href="#cb47-199" aria-hidden="true" tabindex="-1"></a>La base de données d'origine *ozone.txt* répertorie ainsi 112 données météorologiques mesurées durant l'été 2001 à Rennes. Celles-ci sont caractérisées par les 13 variables suivantes : </span>
<span id="cb47-200"><a href="#cb47-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-201"><a href="#cb47-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb47-202"><a href="#cb47-202" aria-hidden="true" tabindex="-1"></a>ozone <span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"https://r-stat-sc-donnees.github.io/ozone.txt"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb47-203"><a href="#cb47-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-204"><a href="#cb47-204" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb47-205"><a href="#cb47-205" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb47-206"><a href="#cb47-206" aria-hidden="true" tabindex="-1"></a>identity_keys <span class="ot">&lt;-</span> <span class="fu">cell_spec</span>(</span>
<span id="cb47-207"><a href="#cb47-207" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">colnames</span>(ozone), <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-208"><a href="#cb47-208" aria-hidden="true" tabindex="-1"></a>identity_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"concentration maximale d'ozone (en DU)"</span>, <span class="st">"température à 9H (en °C)"</span>, <span class="st">"température à 12H (en °C)"</span>, <span class="st">"température à 15H (en °C)"</span>, <span class="st">"nébulosité à 9H (en octa)"</span>, <span class="st">"nébulosité à 12H (en octa)"</span>, <span class="st">"nébulosité à 15H (en octa)"</span>, <span class="st">"vitesse du vent à 9H"</span>, <span class="st">"vitesse du vent à 12H"</span>, <span class="st">"vitesse du vent à 15H"</span>, <span class="st">"concentration maximale d'ozone de la veille (en DU)"</span>, <span class="st">"direction principale du vent (Nord / Ouest / Sud / Est)"</span>, <span class="st">"présence ou non de pluie (Sec / Pluie)"</span>)</span>
<span id="cb47-209"><a href="#cb47-209" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb47-210"><a href="#cb47-210" aria-hidden="true" tabindex="-1"></a>  <span class="at">keys =</span> identity_keys, </span>
<span id="cb47-211"><a href="#cb47-211" aria-hidden="true" tabindex="-1"></a>  <span class="at">values =</span> identity_values, </span>
<span id="cb47-212"><a href="#cb47-212" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-213"><a href="#cb47-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(</span>
<span id="cb47-214"><a href="#cb47-214" aria-hidden="true" tabindex="-1"></a>    <span class="at">format =</span> <span class="st">"html"</span>, </span>
<span id="cb47-215"><a href="#cb47-215" aria-hidden="true" tabindex="-1"></a>    <span class="at">booktabs =</span> <span class="cn">TRUE</span>, </span>
<span id="cb47-216"><a href="#cb47-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">escape =</span> <span class="cn">FALSE</span>, </span>
<span id="cb47-217"><a href="#cb47-217" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="cn">NULL</span></span>
<span id="cb47-218"><a href="#cb47-218" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb47-219"><a href="#cb47-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span>
<span id="cb47-220"><a href="#cb47-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-221"><a href="#cb47-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-222"><a href="#cb47-222" aria-hidden="true" tabindex="-1"></a>On identifie le regroupement de toutes les données météorologiques récoltées en une journée par la date à laquelle les relevés ont été effectués.</span>
<span id="cb47-223"><a href="#cb47-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-226"><a href="#cb47-226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-227"><a href="#cb47-227" aria-hidden="true" tabindex="-1"></a>ozone <span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"https://r-stat-sc-donnees.github.io/ozone.txt"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb47-228"><a href="#cb47-228" aria-hidden="true" tabindex="-1"></a>ozone <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span>
<span id="cb47-229"><a href="#cb47-229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-230"><a href="#cb47-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-231"><a href="#cb47-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-232"><a href="#cb47-232" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb47-233"><a href="#cb47-233" aria-hidden="true" tabindex="-1"></a>Bien évidémment on a vérifié qu'il n'y a pas de valeurs manquantes dans cette base de données avec la fonction *`anyNA`* qui renvoie <span class="in">`r anyNA(ozone)`</span></span>
<span id="cb47-234"><a href="#cb47-234" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-235"><a href="#cb47-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-236"><a href="#cb47-236" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyse descriptive</span></span>
<span id="cb47-237"><a href="#cb47-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-238"><a href="#cb47-238" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb47-239"><a href="#cb47-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-240"><a href="#cb47-240" aria-hidden="true" tabindex="-1"></a><span class="fu">## Boxplot</span></span>
<span id="cb47-241"><a href="#cb47-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-242"><a href="#cb47-242" aria-hidden="true" tabindex="-1"></a>On peut regarder un peu la distribution de nos différents variables quantitatives via des boxplots.</span>
<span id="cb47-243"><a href="#cb47-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-244"><a href="#cb47-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, fig.height=6, fig.width=8}</span></span>
<span id="cb47-245"><a href="#cb47-245" aria-hidden="true" tabindex="-1"></a><span class="fu">my_boxplot</span>(ozone)</span>
<span id="cb47-246"><a href="#cb47-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-247"><a href="#cb47-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-248"><a href="#cb47-248" aria-hidden="true" tabindex="-1"></a>::: success-header</span>
<span id="cb47-249"><a href="#cb47-249" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb47-250"><a href="#cb47-250" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb47-251"><a href="#cb47-251" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb47-252"><a href="#cb47-252" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-253"><a href="#cb47-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-254"><a href="#cb47-254" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb47-255"><a href="#cb47-255" aria-hidden="true" tabindex="-1"></a>On remarque bien que les variabeles qui sont de même nature mais à des points de temps différents sont d'avantages similaires.</span>
<span id="cb47-256"><a href="#cb47-256" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-257"><a href="#cb47-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-258"><a href="#cb47-258" aria-hidden="true" tabindex="-1"></a>Pour confirmer cela, on peut faire des boxplot pour uniquement une varibale et ses différents points de temps.</span>
<span id="cb47-259"><a href="#cb47-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-260"><a href="#cb47-260" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb47-261"><a href="#cb47-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-262"><a href="#cb47-262" aria-hidden="true" tabindex="-1"></a><span class="fu">### Température</span></span>
<span id="cb47-263"><a href="#cb47-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, fig.height=6, fig.width=8}</span></span>
<span id="cb47-264"><a href="#cb47-264" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(ozone, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"T9"</span>, <span class="st">"T12"</span>, <span class="st">"T15"</span>))  <span class="sc">%&gt;%</span> <span class="fu">my_boxplot</span>()</span>
<span id="cb47-265"><a href="#cb47-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-266"><a href="#cb47-266" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nébulosité</span></span>
<span id="cb47-267"><a href="#cb47-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, fig.height=6, fig.width=8}</span></span>
<span id="cb47-268"><a href="#cb47-268" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(ozone, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Ne9"</span>, <span class="st">"Ne12"</span>, <span class="st">"Ne15"</span>))  <span class="sc">%&gt;%</span> <span class="fu">my_boxplot</span>()</span>
<span id="cb47-269"><a href="#cb47-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-270"><a href="#cb47-270" aria-hidden="true" tabindex="-1"></a><span class="fu">### Vitesse du vent </span></span>
<span id="cb47-271"><a href="#cb47-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, fig.height=6, fig.width=8}</span></span>
<span id="cb47-272"><a href="#cb47-272" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(ozone, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Vx9"</span>, <span class="st">"Vx12"</span>, <span class="st">"Vx15"</span>))  <span class="sc">%&gt;%</span> <span class="fu">my_boxplot</span>()</span>
<span id="cb47-273"><a href="#cb47-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-274"><a href="#cb47-274" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-275"><a href="#cb47-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-276"><a href="#cb47-276" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation</span></span>
<span id="cb47-277"><a href="#cb47-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-278"><a href="#cb47-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-279"><a href="#cb47-279" aria-hidden="true" tabindex="-1"></a>On regarde ici la corrélation calculée entre chacune de nos variables.</span>
<span id="cb47-280"><a href="#cb47-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-281"><a href="#cb47-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=22, fig.width=28}</span></span>
<span id="cb47-282"><a href="#cb47-282" aria-hidden="true" tabindex="-1"></a><span class="fu">my_pairs.panels</span>(ozone)</span>
<span id="cb47-283"><a href="#cb47-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-284"><a href="#cb47-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-285"><a href="#cb47-285" aria-hidden="true" tabindex="-1"></a>::: success-header</span>
<span id="cb47-286"><a href="#cb47-286" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb47-287"><a href="#cb47-287" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb47-288"><a href="#cb47-288" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb47-289"><a href="#cb47-289" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-290"><a href="#cb47-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-291"><a href="#cb47-291" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb47-292"><a href="#cb47-292" aria-hidden="true" tabindex="-1"></a>On voit la présence de plusieurs fortes corrélations qui peut déjà nous alerter si l'on veut faire des modèles de regressions linéaires car on risque d'avoir un problème de colinéarité entre les varibales explicatives.</span>
<span id="cb47-293"><a href="#cb47-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-294"><a href="#cb47-294" aria-hidden="true" tabindex="-1"></a>Cependant ces corrélation fortes sont surtout présentes pour les variables qui sont à différents points de temps ce qui est logique.</span>
<span id="cb47-295"><a href="#cb47-295" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-296"><a href="#cb47-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-297"><a href="#cb47-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-298"><a href="#cb47-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## PCA</span></span>
<span id="cb47-299"><a href="#cb47-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-300"><a href="#cb47-300" aria-hidden="true" tabindex="-1"></a>Avec une Analyse en Composantes Principales (PCA) on peut regarder un peu le comportement de nos données.</span>
<span id="cb47-301"><a href="#cb47-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-302"><a href="#cb47-302" aria-hidden="true" tabindex="-1"></a>En effet, Cette méthode respose sur la transformation des variables d'origine en nouvelles variables non corrélées, appelées composantes principales, qui capturent successivement la plus grande variance possible des données.</span>
<span id="cb47-303"><a href="#cb47-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-306"><a href="#cb47-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-307"><a href="#cb47-307" aria-hidden="true" tabindex="-1"></a>res_pca <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">PCA</span>(</span>
<span id="cb47-308"><a href="#cb47-308" aria-hidden="true" tabindex="-1"></a>  ozone,</span>
<span id="cb47-309"><a href="#cb47-309" aria-hidden="true" tabindex="-1"></a>  <span class="at">quali.sup =</span> <span class="fu">c</span>(<span class="fu">which</span>(<span class="fu">colnames</span>(ozone) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"vent"</span>, <span class="st">"pluie"</span>))),</span>
<span id="cb47-310"><a href="#cb47-310" aria-hidden="true" tabindex="-1"></a>  <span class="at">quanti.sup =</span> <span class="fu">c</span>(<span class="fu">which</span>(<span class="fu">colnames</span>(ozone) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"max03"</span>, <span class="st">"max03v"</span>))),</span>
<span id="cb47-311"><a href="#cb47-311" aria-hidden="true" tabindex="-1"></a>  <span class="at">graph =</span> <span class="cn">FALSE</span></span>
<span id="cb47-312"><a href="#cb47-312" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-313"><a href="#cb47-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-314"><a href="#cb47-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-315"><a href="#cb47-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-316"><a href="#cb47-316" aria-hidden="true" tabindex="-1"></a>Ici, on spécifi nos varibales qualitatives et on décide de mettre la variable *max03* et *max03v* en variable supplémentaire, ce qui veut d'ire qu'elles ne seront pas considérés pour la formation de nos composantes principales (variable que l'on cherchera à estimer plus tard).</span>
<span id="cb47-317"><a href="#cb47-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-318"><a href="#cb47-318" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb47-319"><a href="#cb47-319" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Barplot des variances</span></span>
<span id="cb47-320"><a href="#cb47-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-321"><a href="#cb47-321" aria-hidden="true" tabindex="-1"></a>Tout d'abord, on peut commencer par regarder le pourcentage de variance expliqué par nos différentes composantes principales.</span>
<span id="cb47-322"><a href="#cb47-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-325"><a href="#cb47-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-326"><a href="#cb47-326" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_eig</span>(</span>
<span id="cb47-327"><a href="#cb47-327" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb47-328"><a href="#cb47-328" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncp =</span> <span class="dv">10</span>,</span>
<span id="cb47-329"><a href="#cb47-329" aria-hidden="true" tabindex="-1"></a>  <span class="at">addlabels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-330"><a href="#cb47-330" aria-hidden="true" tabindex="-1"></a>  <span class="at">barfill =</span> <span class="st">"coral"</span>,</span>
<span id="cb47-331"><a href="#cb47-331" aria-hidden="true" tabindex="-1"></a>  <span class="at">barcolor =</span> <span class="st">"coral"</span>,</span>
<span id="cb47-332"><a href="#cb47-332" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>),</span>
<span id="cb47-333"><a href="#cb47-333" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Percentage of variance of the 10 first components"</span></span>
<span id="cb47-334"><a href="#cb47-334" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-335"><a href="#cb47-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-336"><a href="#cb47-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-337"><a href="#cb47-337" aria-hidden="true" tabindex="-1"></a>::: success-header</span>
<span id="cb47-338"><a href="#cb47-338" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb47-339"><a href="#cb47-339" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb47-340"><a href="#cb47-340" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb47-341"><a href="#cb47-341" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-342"><a href="#cb47-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-343"><a href="#cb47-343" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb47-344"><a href="#cb47-344" aria-hidden="true" tabindex="-1"></a>On voit ainsi que la majorité de la variance est expliquée par nos deux premières composantes principales.</span>
<span id="cb47-345"><a href="#cb47-345" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-346"><a href="#cb47-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-347"><a href="#cb47-347" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individus</span></span>
<span id="cb47-348"><a href="#cb47-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-349"><a href="#cb47-349" aria-hidden="true" tabindex="-1"></a>Le plan des individus est une projection des observations sur les axes principaux de la PCA. Cette visualisation permet d’identifier des regroupements, tendances et anomalies au sein des données.</span>
<span id="cb47-350"><a href="#cb47-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-351"><a href="#cb47-351" aria-hidden="true" tabindex="-1"></a>Ainsi, des individus proches sur le graphique ont des caractéristiques similaires par rapport aux variables utilisées.</span>
<span id="cb47-352"><a href="#cb47-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-353"><a href="#cb47-353" aria-hidden="true" tabindex="-1"></a>Puis, le placement d'un individu en fonction des axes peut permettre de savoir comment le jouer se caractérise par rapport aux variables qui contribuent le plus à ces axes.</span>
<span id="cb47-354"><a href="#cb47-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-355"><a href="#cb47-355" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb47-356"><a href="#cb47-356" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Pluie </span></span>
<span id="cb47-357"><a href="#cb47-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb47-358"><a href="#cb47-358" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb47-359"><a href="#cb47-359" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb47-360"><a href="#cb47-360" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb47-361"><a href="#cb47-361" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointsize =</span> <span class="dv">2</span>,</span>
<span id="cb47-362"><a href="#cb47-362" aria-hidden="true" tabindex="-1"></a>  <span class="at">habillage =</span> <span class="fu">as.factor</span>(ozone<span class="sc">$</span>pluie),</span>
<span id="cb47-363"><a href="#cb47-363" aria-hidden="true" tabindex="-1"></a>  <span class="at">addEllipses =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-364"><a href="#cb47-364" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipse.level =</span> <span class="fl">0.95</span></span>
<span id="cb47-365"><a href="#cb47-365" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-366"><a href="#cb47-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-367"><a href="#cb47-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-368"><a href="#cb47-368" aria-hidden="true" tabindex="-1"></a><span class="fu">##### vent </span></span>
<span id="cb47-369"><a href="#cb47-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb47-370"><a href="#cb47-370" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb47-371"><a href="#cb47-371" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb47-372"><a href="#cb47-372" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb47-373"><a href="#cb47-373" aria-hidden="true" tabindex="-1"></a>  <span class="at">pointsize =</span> <span class="dv">2</span>,</span>
<span id="cb47-374"><a href="#cb47-374" aria-hidden="true" tabindex="-1"></a>  <span class="at">habillage =</span> <span class="fu">as.factor</span>(ozone<span class="sc">$</span>vent),</span>
<span id="cb47-375"><a href="#cb47-375" aria-hidden="true" tabindex="-1"></a>  <span class="at">addEllipses =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-376"><a href="#cb47-376" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipse.level =</span> <span class="fl">0.95</span></span>
<span id="cb47-377"><a href="#cb47-377" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-378"><a href="#cb47-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-379"><a href="#cb47-379" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-380"><a href="#cb47-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-381"><a href="#cb47-381" aria-hidden="true" tabindex="-1"></a>::: success-header</span>
<span id="cb47-382"><a href="#cb47-382" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb47-383"><a href="#cb47-383" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb47-384"><a href="#cb47-384" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb47-385"><a href="#cb47-385" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-386"><a href="#cb47-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-387"><a href="#cb47-387" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb47-388"><a href="#cb47-388" aria-hidden="true" tabindex="-1"></a>Ici on voit une repartition plutot uniforme sur le plan qui ne semble pas permettre de distinguer une séparation forte correspodant à nos variables qualitatives.</span>
<span id="cb47-389"><a href="#cb47-389" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-390"><a href="#cb47-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-391"><a href="#cb47-391" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb47-392"><a href="#cb47-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-393"><a href="#cb47-393" aria-hidden="true" tabindex="-1"></a>Le cercle des variables est une représentation graphique qui permet d’analyser les relations entre les variables initiales et les composantes principales qui forment nos axes. Il est basé sur les corrélations entre les variables et les axes principaux.</span>
<span id="cb47-394"><a href="#cb47-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-395"><a href="#cb47-395" aria-hidden="true" tabindex="-1"></a>Ainsi, plus une variable est proche du bord du cercle, plus elle est bien représentée sur le plan factoriel et contribue fortement à la formation des axes. Ici, on utilise le cos2 pour le gradient de couleur qui va aider à l'indentifictation de ces différentes qualitées de représentation.</span>
<span id="cb47-396"><a href="#cb47-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-397"><a href="#cb47-397" aria-hidden="true" tabindex="-1"></a>De plus, selon l'angle entre deux varibles, on peut faire des suppositions sur leur corrélation :</span>
<span id="cb47-398"><a href="#cb47-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-399"><a href="#cb47-399" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Si deux variables ont des vecteurs proches (petit angle), elles sont fortement corrélées positivement</span>
<span id="cb47-400"><a href="#cb47-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-401"><a href="#cb47-401" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Si deux variables ont des vecteurs opposés (angle proche de 180°), elles sont corrélées négativement</span>
<span id="cb47-402"><a href="#cb47-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-403"><a href="#cb47-403" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Si l’angle est proche de 90°, alors les variables ne sont pas corrélées</span>
<span id="cb47-404"><a href="#cb47-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-405"><a href="#cb47-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb47-406"><a href="#cb47-406" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_pca_var</span>(</span>
<span id="cb47-407"><a href="#cb47-407" aria-hidden="true" tabindex="-1"></a>  res_pca,</span>
<span id="cb47-408"><a href="#cb47-408" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.var =</span> <span class="st">"cos2"</span>,</span>
<span id="cb47-409"><a href="#cb47-409" aria-hidden="true" tabindex="-1"></a>  <span class="at">gradient.cols =</span> <span class="fu">rainbow</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">start =</span> .<span class="dv">6</span>, <span class="at">end =</span> .<span class="dv">9</span>),</span>
<span id="cb47-410"><a href="#cb47-410" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span></span>
<span id="cb47-411"><a href="#cb47-411" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-412"><a href="#cb47-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-413"><a href="#cb47-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-414"><a href="#cb47-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-415"><a href="#cb47-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-416"><a href="#cb47-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-417"><a href="#cb47-417" aria-hidden="true" tabindex="-1"></a>::: success-header</span>
<span id="cb47-418"><a href="#cb47-418" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb47-419"><a href="#cb47-419" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb47-420"><a href="#cb47-420" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb47-421"><a href="#cb47-421" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-422"><a href="#cb47-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-423"><a href="#cb47-423" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb47-424"><a href="#cb47-424" aria-hidden="true" tabindex="-1"></a>Dans notre cas, ce que l'on peut voir c'est que la majorité de nos variables sont bien représentées par nos deux axes (cumulant plus de 70% d'explication). Mais beaucoup semblent aussi fortement corrélées avecla formation de trois groupes. Cette corrélation ayant déjà pu être observé précédemment et touours logique du fait du côté longitudinale de nos données.</span>
<span id="cb47-425"><a href="#cb47-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-426"><a href="#cb47-426" aria-hidden="true" tabindex="-1"></a>Ce que l'on peut tout de même ajouté c'est que les variables max03 et surtout max03v semblent plutot corrélées aux variables température. Constat qui peut se confirmer avec le pairs.panels précédent.</span>
<span id="cb47-427"><a href="#cb47-427" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-428"><a href="#cb47-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-429"><a href="#cb47-429" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-430"><a href="#cb47-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-431"><a href="#cb47-431" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-432"><a href="#cb47-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-433"><a href="#cb47-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-434"><a href="#cb47-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-435"><a href="#cb47-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-436"><a href="#cb47-436" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyse inférentielle</span></span>
<span id="cb47-437"><a href="#cb47-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-438"><a href="#cb47-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-439"><a href="#cb47-439" aria-hidden="true" tabindex="-1"></a>Contrairement à la plupart des autres package *`R`* qui permettent de faire de l’apprentissage, le package *`glmnet`* n’autorise pas l’utilisation de formules.\ </span>
<span id="cb47-440"><a href="#cb47-440" aria-hidden="true" tabindex="-1"></a>Il faut donc spécifier explicitement la matrice $X$ et le vecteur $y$.\</span>
<span id="cb47-441"><a href="#cb47-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-442"><a href="#cb47-442" aria-hidden="true" tabindex="-1"></a>On peut obtenir la matrice $X$ et notamment le codage des variables qualitatives avec la fonction *`model.matrix`*.</span>
<span id="cb47-445"><a href="#cb47-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-446"><a href="#cb47-446" aria-hidden="true" tabindex="-1"></a>ozone.X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(maxO3 <span class="sc">~</span> ., <span class="at">data =</span> ozone)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb47-447"><a href="#cb47-447" aria-hidden="true" tabindex="-1"></a>ozone.Y <span class="ot">&lt;-</span> ozone<span class="sc">$</span>maxO3</span>
<span id="cb47-448"><a href="#cb47-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-449"><a href="#cb47-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-450"><a href="#cb47-450" aria-hidden="true" tabindex="-1"></a>Et ce n'est qu'après que l'on peut mettre en place la modélisation.</span>
<span id="cb47-451"><a href="#cb47-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-452"><a href="#cb47-452" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb47-453"><a href="#cb47-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-454"><a href="#cb47-454" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ridge </span></span>
<span id="cb47-455"><a href="#cb47-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-458"><a href="#cb47-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-459"><a href="#cb47-459" aria-hidden="true" tabindex="-1"></a>mod.R <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(ozone.X, ozone.Y, <span class="at">alpha =</span> <span class="dv">0</span>) </span>
<span id="cb47-460"><a href="#cb47-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-461"><a href="#cb47-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-462"><a href="#cb47-462" aria-hidden="true" tabindex="-1"></a>La fonction *`glmnet`* calcule tous les estimateurs pour une grille de valeurs de $\lambda$ que l'on peut récupérer.</span>
<span id="cb47-465"><a href="#cb47-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-466"><a href="#cb47-466" aria-hidden="true" tabindex="-1"></a>mod.R<span class="sc">$</span>lambda <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb47-467"><a href="#cb47-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-468"><a href="#cb47-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-469"><a href="#cb47-469" aria-hidden="true" tabindex="-1"></a>Et on peut également récupérer les différentes valeurs de $\beta$ associée aux différents $\lambda$. </span>
<span id="cb47-472"><a href="#cb47-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-473"><a href="#cb47-473" aria-hidden="true" tabindex="-1"></a>beta_values <span class="ot">&lt;-</span> mod.R<span class="sc">$</span>beta <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> <span class="fu">t</span>()</span>
<span id="cb47-474"><a href="#cb47-474" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(beta_values) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"lambda_"</span>, <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(mod.R<span class="sc">$</span>lambda), <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb47-475"><a href="#cb47-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-476"><a href="#cb47-476" aria-hidden="true" tabindex="-1"></a>beta_values <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span>
<span id="cb47-477"><a href="#cb47-477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-478"><a href="#cb47-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-479"><a href="#cb47-479" aria-hidden="true" tabindex="-1"></a>Puis on peut visualiser les chemins de régularisation des estimateurs **Ridge**.</span>
<span id="cb47-480"><a href="#cb47-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-483"><a href="#cb47-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-484"><a href="#cb47-484" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.R, <span class="at">xvar =</span> <span class="st">"lambda"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-485"><a href="#cb47-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-486"><a href="#cb47-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-487"><a href="#cb47-487" aria-hidden="true" tabindex="-1"></a>::: success-header</span>
<span id="cb47-488"><a href="#cb47-488" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb47-489"><a href="#cb47-489" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb47-490"><a href="#cb47-490" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb47-491"><a href="#cb47-491" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-492"><a href="#cb47-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-493"><a href="#cb47-493" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb47-494"><a href="#cb47-494" aria-hidden="true" tabindex="-1"></a>Ici on voit l'évolution de nos coefficients $\beta$ en fonction des diffrentes valeurs de $\lambda$. Ainsi, sur la gauche on se retrouve dans la situation où il n'y a pas de pénalisation et donc nos coefficients sont les $\beta$ de l'estimation par moindres carrés. Et donc plus $\lambda$ va augmenter, plus on se retrouvera dans une situation où les coefficients vont tendrent vers 0.</span>
<span id="cb47-495"><a href="#cb47-495" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-496"><a href="#cb47-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-497"><a href="#cb47-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-498"><a href="#cb47-498" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lasso</span></span>
<span id="cb47-499"><a href="#cb47-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-502"><a href="#cb47-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-503"><a href="#cb47-503" aria-hidden="true" tabindex="-1"></a>mod.L <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(ozone.X, ozone.Y, <span class="at">alpha =</span> <span class="dv">1</span>) </span>
<span id="cb47-504"><a href="#cb47-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-505"><a href="#cb47-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-506"><a href="#cb47-506" aria-hidden="true" tabindex="-1"></a>La fonction *`glmnet`* calcule tous les estimateurs pour une grille de valeurs de $\lambda$ que l'on peut récupérer.</span>
<span id="cb47-509"><a href="#cb47-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-510"><a href="#cb47-510" aria-hidden="true" tabindex="-1"></a>mod.L<span class="sc">$</span>lambda <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb47-511"><a href="#cb47-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-512"><a href="#cb47-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-513"><a href="#cb47-513" aria-hidden="true" tabindex="-1"></a>Et on peut également récupérer les différentes valeurs de $\beta$ associée aux différents $\lambda$. </span>
<span id="cb47-516"><a href="#cb47-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-517"><a href="#cb47-517" aria-hidden="true" tabindex="-1"></a>beta_values <span class="ot">&lt;-</span> mod.L<span class="sc">$</span>beta <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> <span class="fu">t</span>()</span>
<span id="cb47-518"><a href="#cb47-518" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(beta_values) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"lambda_"</span>, <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(mod.L<span class="sc">$</span>lambda), <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb47-519"><a href="#cb47-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-520"><a href="#cb47-520" aria-hidden="true" tabindex="-1"></a>beta_values <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span>
<span id="cb47-521"><a href="#cb47-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-522"><a href="#cb47-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-523"><a href="#cb47-523" aria-hidden="true" tabindex="-1"></a>Puis on peut visualiser les chemins de régularisation des estimateurs **Lasso**.</span>
<span id="cb47-524"><a href="#cb47-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-527"><a href="#cb47-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-528"><a href="#cb47-528" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.L, <span class="at">xvar =</span> <span class="st">"lambda"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-529"><a href="#cb47-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-530"><a href="#cb47-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-531"><a href="#cb47-531" aria-hidden="true" tabindex="-1"></a>::: success-header</span>
<span id="cb47-532"><a href="#cb47-532" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb47-533"><a href="#cb47-533" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb47-534"><a href="#cb47-534" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb47-535"><a href="#cb47-535" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-536"><a href="#cb47-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-537"><a href="#cb47-537" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb47-538"><a href="#cb47-538" aria-hidden="true" tabindex="-1"></a>Ici on voit l'évolution de nos coefficients $\beta$ en fonction des diffrentes valeurs de $\lambda$. Ainsi, sur la gauche on se retrouve dans la situation où il n'y a pas de pénalisation et donc nos coefficients sont les $\beta$ de l'estimation par moindres carrés. Et donc plus $\lambda$ va augmenter, plus on se retrouvera dans une situation où les coefficients vont tendrent vers 0.</span>
<span id="cb47-539"><a href="#cb47-539" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-540"><a href="#cb47-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-541"><a href="#cb47-541" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-542"><a href="#cb47-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-543"><a href="#cb47-543" aria-hidden="true" tabindex="-1"></a><span class="fu"># Selection des paramètres de régularisation</span></span>
<span id="cb47-544"><a href="#cb47-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-545"><a href="#cb47-545" aria-hidden="true" tabindex="-1"></a>Maintenant que les modèles sont estimés avec plusieurs valeurs de $\lambda$ possibles, il se pose la question du choix du bon paramètre.\</span>
<span id="cb47-546"><a href="#cb47-546" aria-hidden="true" tabindex="-1"></a>Pour cela, on utilise la fonction *`cv.glmnet`* qui, comme son nom le laisse suggérer, permet d'effectuer une validation croisée pour notre modèle avec par défaut *`nfolds=10`* (le nombre de pli pour le découpage de sous ensembles). Puis on peut faire un *`plot`* de l’objet.</span>
<span id="cb47-547"><a href="#cb47-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-548"><a href="#cb47-548" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb47-549"><a href="#cb47-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-550"><a href="#cb47-550" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ridge </span></span>
<span id="cb47-551"><a href="#cb47-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-554"><a href="#cb47-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-555"><a href="#cb47-555" aria-hidden="true" tabindex="-1"></a>ridgeCV <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(ozone.X, ozone.Y, <span class="at">alpha =</span> <span class="dv">0</span>)</span>
<span id="cb47-556"><a href="#cb47-556" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridgeCV)</span>
<span id="cb47-557"><a href="#cb47-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-558"><a href="#cb47-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-559"><a href="#cb47-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-560"><a href="#cb47-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-561"><a href="#cb47-561" aria-hidden="true" tabindex="-1"></a>On visualise ici les erreurs quadratiques calculées par validation croisée 10 blocs en fonction de $\lambda$ (échelle logarithmique). Deux traits verticaux sont représentés :</span>
<span id="cb47-562"><a href="#cb47-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-563"><a href="#cb47-563" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>celui de gauche correspond à la valeur de $\lambda$ qui minimise l’erreur quadratique</span>
<span id="cb47-564"><a href="#cb47-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-565"><a href="#cb47-565" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>celui de droite correspond à la plus grande valeur de $\lambda$ telle que l’erreur ne dépasse pas l’erreur minimale + 1 écart-type estimé de cette erreur</span>
<span id="cb47-566"><a href="#cb47-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-567"><a href="#cb47-567" aria-hidden="true" tabindex="-1"></a>D’un point de vu pratique, cela signifie que l’utilisateur peut choisir n’importe quelle valeur de lambda entre les deux traits verticaux.\</span>
<span id="cb47-568"><a href="#cb47-568" aria-hidden="true" tabindex="-1"></a>A savoir que si l'on veut diminuer la complexité du modèle on choisira la valeur de droite.</span>
<span id="cb47-569"><a href="#cb47-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-570"><a href="#cb47-570" aria-hidden="true" tabindex="-1"></a>On peut obtenir ces deux valeurs assez facilement.</span>
<span id="cb47-573"><a href="#cb47-573" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-574"><a href="#cb47-574" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">" Valeur minimale : "</span>, ridgeCV<span class="sc">$</span>lambda.min, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Valeur maximale : "</span>, ridgeCV<span class="sc">$</span>lambda<span class="fl">.1</span>se)</span>
<span id="cb47-575"><a href="#cb47-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-576"><a href="#cb47-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-577"><a href="#cb47-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-578"><a href="#cb47-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-579"><a href="#cb47-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-580"><a href="#cb47-580" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lasso</span></span>
<span id="cb47-581"><a href="#cb47-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-584"><a href="#cb47-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-585"><a href="#cb47-585" aria-hidden="true" tabindex="-1"></a>lassoCV <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(ozone.X, ozone.Y, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb47-586"><a href="#cb47-586" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lassoCV)</span>
<span id="cb47-587"><a href="#cb47-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-588"><a href="#cb47-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-589"><a href="#cb47-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-590"><a href="#cb47-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-591"><a href="#cb47-591" aria-hidden="true" tabindex="-1"></a>On visualise ici les erreurs quadratiques calculées par validation croisée 10 blocs en fonction de $\lambda$ (échelle logarithmique). Deux traits verticaux sont représentés :</span>
<span id="cb47-592"><a href="#cb47-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-593"><a href="#cb47-593" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>celui de gauche correspond à la valeur de $\lambda$ qui minimise l’erreur quadratique</span>
<span id="cb47-594"><a href="#cb47-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-595"><a href="#cb47-595" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>celui de droite correspond à la plus grande valeur de $\lambda$ telle que l’erreur ne dépasse pas l’erreur minimale + 1 écart-type estimé de cette erreur</span>
<span id="cb47-596"><a href="#cb47-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-597"><a href="#cb47-597" aria-hidden="true" tabindex="-1"></a>D’un point de vu pratique, cela signifie que l’utilisateur peut choisir n’importe quelle valeur de lambda entre les deux traits verticaux.\</span>
<span id="cb47-598"><a href="#cb47-598" aria-hidden="true" tabindex="-1"></a>A savoir que si l'on veut diminuer la complexité du modèle on choisira la valeur de droite.</span>
<span id="cb47-599"><a href="#cb47-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-600"><a href="#cb47-600" aria-hidden="true" tabindex="-1"></a>On peut obtenir ces deux valeurs assez facilement.</span>
<span id="cb47-603"><a href="#cb47-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-604"><a href="#cb47-604" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">" Valeur minimale : "</span>, lassoCV<span class="sc">$</span>lambda.min, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Valeur maximale : "</span>, lassoCV<span class="sc">$</span>lambda<span class="fl">.1</span>se)</span>
<span id="cb47-605"><a href="#cb47-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-606"><a href="#cb47-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-607"><a href="#cb47-607" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-608"><a href="#cb47-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-609"><a href="#cb47-609" aria-hidden="true" tabindex="-1"></a><span class="fu"># Prédiction </span></span>
<span id="cb47-610"><a href="#cb47-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-611"><a href="#cb47-611" aria-hidden="true" tabindex="-1"></a>On souhaite maintenant prédire la variable cible pour de nouveaux individus, par exemple les 50ème et 51ème individus du jeu de données.</span>
<span id="cb47-612"><a href="#cb47-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-613"><a href="#cb47-613" aria-hidden="true" tabindex="-1"></a>Une première approche pourrait consister à réajuster le modèle sur toutes les données pour la valeur de $lambda$ sélectionnée.\</span>
<span id="cb47-614"><a href="#cb47-614" aria-hidden="true" tabindex="-1"></a>Cette étape est en réalité déjà effectuée par la fonction *`cv.glmnet`*. Il suffit par conséquent d’appliquer la fonction predict à l’objet obtenu avec *`cv.glmnet`* en spécifiant la valeur de $lambda$ souhaitée. </span>
<span id="cb47-615"><a href="#cb47-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-616"><a href="#cb47-616" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb47-617"><a href="#cb47-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-618"><a href="#cb47-618" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ridge </span></span>
<span id="cb47-619"><a href="#cb47-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-622"><a href="#cb47-622" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-623"><a href="#cb47-623" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(ridgeCV, <span class="at">newx =</span> ozone.X[<span class="dv">50</span><span class="sc">:</span><span class="dv">51</span>, ], <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb47-624"><a href="#cb47-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-625"><a href="#cb47-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-626"><a href="#cb47-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-629"><a href="#cb47-629" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-630"><a href="#cb47-630" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(ridgeCV, <span class="at">newx =</span> ozone.X[<span class="dv">50</span><span class="sc">:</span><span class="dv">51</span>, ], <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span>
<span id="cb47-631"><a href="#cb47-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-632"><a href="#cb47-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-633"><a href="#cb47-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-634"><a href="#cb47-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-635"><a href="#cb47-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-636"><a href="#cb47-636" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lasso</span></span>
<span id="cb47-637"><a href="#cb47-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-638"><a href="#cb47-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-641"><a href="#cb47-641" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-642"><a href="#cb47-642" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lassoCV, <span class="at">newx =</span> ozone.X[<span class="dv">50</span><span class="sc">:</span><span class="dv">51</span>, ], <span class="at">s =</span> <span class="st">"lambda.min"</span>)</span>
<span id="cb47-643"><a href="#cb47-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-644"><a href="#cb47-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-645"><a href="#cb47-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-648"><a href="#cb47-648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-649"><a href="#cb47-649" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lassoCV, <span class="at">newx =</span> ozone.X[<span class="dv">50</span><span class="sc">:</span><span class="dv">51</span>, ], <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span>
<span id="cb47-650"><a href="#cb47-650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-651"><a href="#cb47-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-652"><a href="#cb47-652" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-653"><a href="#cb47-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-654"><a href="#cb47-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-655"><a href="#cb47-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-656"><a href="#cb47-656" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparaison</span></span>
<span id="cb47-657"><a href="#cb47-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-658"><a href="#cb47-658" aria-hidden="true" tabindex="-1"></a>Puisque nous avons 3 méthodes de modélisations (MCO sans pénalisation, Ridge et Lasso), la prochaine étape logique va donc ^tre de comparer les trois méthodes pour déterminer laquelle est la plus approrié pour nos  données.\</span>
<span id="cb47-659"><a href="#cb47-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-660"><a href="#cb47-660" aria-hidden="true" tabindex="-1"></a>On peut faire cela l’aide d’une validation croisée et pour cela on utilisera les données *ozone_complet.txt* qui contiennent plus d’individus et de variables.</span>
<span id="cb47-661"><a href="#cb47-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-662"><a href="#cb47-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-665"><a href="#cb47-665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-666"><a href="#cb47-666" aria-hidden="true" tabindex="-1"></a>ozone1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"https://lrouviere.github.io/stat_grand_dim/ozone_complet.txt"</span>, <span class="at">sep=</span><span class="st">";"</span>) <span class="sc">%&gt;%</span>  <span class="fu">na.omit</span>()</span>
<span id="cb47-667"><a href="#cb47-667" aria-hidden="true" tabindex="-1"></a>ozone1.X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(maxO3 <span class="sc">~</span> ., <span class="at">data =</span> ozone1)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb47-668"><a href="#cb47-668" aria-hidden="true" tabindex="-1"></a>ozone1.Y <span class="ot">&lt;-</span> ozone1<span class="sc">$</span>maxO3</span>
<span id="cb47-669"><a href="#cb47-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-670"><a href="#cb47-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-671"><a href="#cb47-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-674"><a href="#cb47-674" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-675"><a href="#cb47-675" aria-hidden="true" tabindex="-1"></a><span class="fu">cv_ridge_vs_lasso</span>(ozone1, <span class="at">fmla =</span> <span class="fu">formula</span>(maxO3 <span class="sc">~</span> .)) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span>
<span id="cb47-676"><a href="#cb47-676" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-677"><a href="#cb47-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-678"><a href="#cb47-678" aria-hidden="true" tabindex="-1"></a>::: success-header</span>
<span id="cb47-679"><a href="#cb47-679" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb47-680"><a href="#cb47-680" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb47-681"><a href="#cb47-681" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb47-682"><a href="#cb47-682" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-683"><a href="#cb47-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-684"><a href="#cb47-684" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb47-685"><a href="#cb47-685" aria-hidden="true" tabindex="-1"></a>On remarque que les approches régularisées n’apportent rien par rapport aux estimateurs MCO ici. Ceci peut s’expliquer par le fait que le nombre de variables n’est pas très important.</span>
<span id="cb47-686"><a href="#cb47-686" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-687"><a href="#cb47-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-688"><a href="#cb47-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-689"><a href="#cb47-689" aria-hidden="true" tabindex="-1"></a>Pour changer, considérons toutes les interactions d’ordre 2</span>
<span id="cb47-692"><a href="#cb47-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-693"><a href="#cb47-693" aria-hidden="true" tabindex="-1"></a><span class="fu">cv_ridge_vs_lasso</span>(ozone1, <span class="at">fmla =</span> <span class="fu">formula</span>(maxO3 <span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span>
<span id="cb47-694"><a href="#cb47-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-695"><a href="#cb47-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-696"><a href="#cb47-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-697"><a href="#cb47-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-698"><a href="#cb47-698" aria-hidden="true" tabindex="-1"></a>::: success-header</span>
<span id="cb47-699"><a href="#cb47-699" aria-hidden="true" tabindex="-1"></a>::: success-icon</span>
<span id="cb47-700"><a href="#cb47-700" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb47-701"><a href="#cb47-701" aria-hidden="true" tabindex="-1"></a>Résultats</span>
<span id="cb47-702"><a href="#cb47-702" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-703"><a href="#cb47-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-704"><a href="#cb47-704" aria-hidden="true" tabindex="-1"></a>::: success</span>
<span id="cb47-705"><a href="#cb47-705" aria-hidden="true" tabindex="-1"></a>Les méthodes régularisées permettent ici de diminuer les erreurs quadratiques de manière intéressante. Cela vient certainement du fait du nombre de variables explicatives qui est beaucoup plus important lorsqu’on prend en compte toutes les interactions d’ordre 2.</span>
<span id="cb47-708"><a href="#cb47-708" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-709"><a href="#cb47-709" aria-hidden="true" tabindex="-1"></a>ozone2.X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(maxO3 <span class="sc">~</span> .<span class="sc">^</span><span class="dv">2</span>, <span class="at">data =</span> ozone1)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb47-710"><a href="#cb47-710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb47-711"><a href="#cb47-711" aria-hidden="true" tabindex="-1"></a>En effet, à l'ordre 1 on est à <span class="in">`r dim(ozone1.X)[1]`</span> individus pour <span class="in">`r dim(ozone1.X)[2]`</span> variables alors qu'à l'odre 2 on passe à <span class="in">`r dim(ozone2.X)[1]`</span> individus pour <span class="in">`r dim(ozone2.X)[2]`</span></span>
<span id="cb47-712"><a href="#cb47-712" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb47-713"><a href="#cb47-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-714"><a href="#cb47-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-715"><a href="#cb47-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-716"><a href="#cb47-716" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb47-717"><a href="#cb47-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-718"><a href="#cb47-718" aria-hidden="true" tabindex="-1"></a>Dans cette analyse, nous avons exploré l’utilisation des méthodes **Ridge** et **Lasso** sous *`R`*.\</span>
<span id="cb47-719"><a href="#cb47-719" aria-hidden="true" tabindex="-1"></a>Ces approches se révèlent particulièrement efficaces en grande dimension, offrant des solutions robustes pour la régression pénalisée.</span>
<span id="cb47-720"><a href="#cb47-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-721"><a href="#cb47-721" aria-hidden="true" tabindex="-1"></a>Par la suite, le choix entre **Lasso** et **Ridge** dépend souvent des objectifs poursuivis : </span>
<span id="cb47-722"><a href="#cb47-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-723"><a href="#cb47-723" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>**Lasso** intègre un mécanisme de sélection de variables, ce qui en fait un excellent outil pour identifier les prédicteurs les plus pertinents. </span>
<span id="cb47-724"><a href="#cb47-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-725"><a href="#cb47-725" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Ridge** conserve l’ensemble des variables en réduisant leurs coefficients sans les annuler, privilégiant ainsi une approche plus réguliarisée. </span>
<span id="cb47-726"><a href="#cb47-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-727"><a href="#cb47-727" aria-hidden="true" tabindex="-1"></a>(Voir la partie **Rappel sur Ridge et Lasso** pour plus de détails)</span>
<span id="cb47-728"><a href="#cb47-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-729"><a href="#cb47-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-730"><a href="#cb47-730" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session info</span></span>
<span id="cb47-731"><a href="#cb47-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-734"><a href="#cb47-734" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb47-735"><a href="#cb47-735" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>(<span class="at">pkgs =</span> <span class="st">"attached"</span>)</span>
<span id="cb47-736"><a href="#cb47-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2025, Clément Poupelin</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This blog is built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>