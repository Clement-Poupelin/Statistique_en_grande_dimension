<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Clément Poupelin">
<meta name="dcterms.date" content="2025-02-17">

<title>Statistique en grande dimension - Exercice 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Statistique en grande dimension</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Clement-Poupelin" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#données" id="toc-données" class="nav-link" data-scroll-target="#données">Données</a></li>
  <li><a href="#analyse-descriptive" id="toc-analyse-descriptive" class="nav-link" data-scroll-target="#analyse-descriptive">Analyse descriptive</a></li>
  <li><a href="#analyse-inférentielle" id="toc-analyse-inférentielle" class="nav-link" data-scroll-target="#analyse-inférentielle">Analyse inférentielle</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session info</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Exercice 1</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">TP</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Clément Poupelin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 17, 2025</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="setup" class="level1">
<h1>Setup</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Fonctions</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR) <span class="co"># Hitters data </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps) <span class="co"># regsubsets </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="co"># pour ggcorr</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># pour VIF</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Summary</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">## PCA</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)  <span class="co"># Pour transformer les données en format long</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="do">## for pairs panel</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Critères</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">plot pour nos critères</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>r2_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># r2 = SSE/SST = (SST - SSR)/SST = 1 - ssr/sst</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SCR<span class="sc">/</span>SCT</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>r2a_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  r2a <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SCR<span class="sc">/</span>(n<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">/</span>(SCT<span class="sc">/</span>(n<span class="dv">-1</span>))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2a)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>cp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, SCR){</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  sig <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  cp <span class="ot">&lt;-</span> SCR<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>) <span class="sc">-</span> n</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cp)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>aic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(aic)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>bic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="fu">log</span>(n)<span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(bic)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Criteria_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(Criteria, <span class="at">crit_name =</span> <span class="st">"Critère"</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création d'un data frame pour ggplot</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  df_criteria <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb_var =</span> <span class="fu">seq_along</span>(Criteria),  <span class="co"># Nombre de variables utilisées</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Criteria =</span> Criteria            <span class="co"># Valeurs du critère (RSS, AIC, BIC, etc.)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création du plot avec ggplot2</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_criteria, <span class="fu">aes</span>(<span class="at">x =</span> nb_var, <span class="at">y =</span> Criteria)) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Évolution de"</span>, crit_name, <span class="st">"en fonction du nombre de variables"</span>),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Nombre de variables sélectionnées"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> crit_name</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">26</span>),  <span class="co"># Titre centré et agrandi</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(g)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="données" class="level1">
<h1>Données</h1>
<p>On étudie le jeu de données <a href="https://rdrr.io/cran/ISLR/man/Hitters.html"><strong>Hitters</strong></a> disponible dans la libraire { <em>ISLR</em> } de <em>R</em>.</p>
<p>Il s’agit d’un je de données de la Major League Baseball provenant des saisons de 1986 et 1987.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ?Hitters</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Hitters <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 322  20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Hitters <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     AtBat            Hits         HmRun            Runs       
 Min.   : 16.0   Min.   :  1   Min.   : 0.00   Min.   :  0.00  
 1st Qu.:255.2   1st Qu.: 64   1st Qu.: 4.00   1st Qu.: 30.25  
 Median :379.5   Median : 96   Median : 8.00   Median : 48.00  
 Mean   :380.9   Mean   :101   Mean   :10.77   Mean   : 50.91  
 3rd Qu.:512.0   3rd Qu.:137   3rd Qu.:16.00   3rd Qu.: 69.00  
 Max.   :687.0   Max.   :238   Max.   :40.00   Max.   :130.00  
                                                               
      RBI             Walks            Years            CAtBat       
 Min.   :  0.00   Min.   :  0.00   Min.   : 1.000   Min.   :   19.0  
 1st Qu.: 28.00   1st Qu.: 22.00   1st Qu.: 4.000   1st Qu.:  816.8  
 Median : 44.00   Median : 35.00   Median : 6.000   Median : 1928.0  
 Mean   : 48.03   Mean   : 38.74   Mean   : 7.444   Mean   : 2648.7  
 3rd Qu.: 64.75   3rd Qu.: 53.00   3rd Qu.:11.000   3rd Qu.: 3924.2  
 Max.   :121.00   Max.   :105.00   Max.   :24.000   Max.   :14053.0  
                                                                     
     CHits            CHmRun           CRuns             CRBI        
 Min.   :   4.0   Min.   :  0.00   Min.   :   1.0   Min.   :   0.00  
 1st Qu.: 209.0   1st Qu.: 14.00   1st Qu.: 100.2   1st Qu.:  88.75  
 Median : 508.0   Median : 37.50   Median : 247.0   Median : 220.50  
 Mean   : 717.6   Mean   : 69.49   Mean   : 358.8   Mean   : 330.12  
 3rd Qu.:1059.2   3rd Qu.: 90.00   3rd Qu.: 526.2   3rd Qu.: 426.25  
 Max.   :4256.0   Max.   :548.00   Max.   :2165.0   Max.   :1659.00  
                                                                     
     CWalks        League  Division    PutOuts          Assists     
 Min.   :   0.00   A:175   E:157    Min.   :   0.0   Min.   :  0.0  
 1st Qu.:  67.25   N:147   W:165    1st Qu.: 109.2   1st Qu.:  7.0  
 Median : 170.50                    Median : 212.0   Median : 39.5  
 Mean   : 260.24                    Mean   : 288.9   Mean   :106.9  
 3rd Qu.: 339.25                    3rd Qu.: 325.0   3rd Qu.:166.0  
 Max.   :1566.00                    Max.   :1378.0   Max.   :492.0  
                                                                    
     Errors          Salary       NewLeague
 Min.   : 0.00   Min.   :  67.5   A:176    
 1st Qu.: 3.00   1st Qu.: 190.0   N:146    
 Median : 6.00   Median : 425.0            
 Mean   : 8.04   Mean   : 535.9            
 3rd Qu.:11.00   3rd Qu.: 750.0            
 Max.   :32.00   Max.   :2460.0            
                 NA's   :59                </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>On peut déjà remarquer la présence de 59 valeurs manquantes pour la variable <em>Salary</em>.</p>
</div>
</div>
<p>On va donc commencer par s’en débarasser (il ne s’agit que de 59 lignes sur 322). Puis on va également se concentrer sur les variables quantitatives .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA_quant <span class="ot">&lt;-</span> Hitters_Without_NA <span class="sc">%&gt;%</span> <span class="fu">subset</span>(, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(League, Division, NewLeague))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA_quant <span class="sc">%&gt;%</span> <span class="fu">dim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 263  17</code></pre>
</div>
</div>
</section>
<section id="analyse-descriptive" class="level1">
<h1>Analyse descriptive</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Correlation panel</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">PCA</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>On peut regarder un peu la distribution de nos différents variables quantitatives via des boxplots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer les données en format long pour ggplot</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Hitters_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(Hitters_Without_NA_quant)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Hitters_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span>  <span class="co"># Palette de couleurs harmonieuse</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Variables (Boxplot)"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variables"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Valeurs"</span>) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Thème épuré</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotation des étiquettes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Exercice_1_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>On peut remarquer que nos variables ont en général peut de valeurs outliers.</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>On regarde ici la corrélation calculée entre chacune de nos variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  Hitters_Without_NA_quant,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"pearson"</span>,      <span class="co"># Méthode de corrélation </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">hist.col =</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Set3"</span>), <span class="co"># Couleurs des histogrammes</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">density =</span> <span class="cn">TRUE</span>,          <span class="co"># Ajout des courbes de densité</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipses =</span> <span class="cn">TRUE</span>,         <span class="co"># Ajout d'ellipses </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">smooth =</span> <span class="cn">TRUE</span>,           <span class="co"># Ajout de régressions lissées</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">lm =</span> <span class="cn">TRUE</span>,               <span class="co"># Ajout des droites de régression</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"#69b3a2"</span>,         <span class="co"># Couleur des points</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>              <span class="co"># Transparence </span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Exercice_1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="2688"></p>
</div>
</div>
<p>On voit la présence de plusieurs fortes corrélations qui peut déjà nous alerter si l’on veut faire des modèles de regressions linéaires car on risque d’avoir un problème de colinéarité entre les varibales explicatives.</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Avec une Analyse en Composantes Principales (PCA) on peut regarder un peu le comportement de nos données.</p>
<p>En effet, Cette méthode respose sur la transformation des variables d’origine en nouvelles variables non corrélées, appelées composantes principales, qui capturent successivement la plus grande variance possible des données.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>res_pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(Hitters_Without_NA, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">quali.sup =</span> <span class="fu">c</span>(<span class="fu">which</span>(<span class="fu">colnames</span>(Hitters_Without_NA) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"League"</span>, <span class="st">"Division"</span>, <span class="st">"NewLeague"</span>))),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">quanti.sup =</span> <span class="fu">which</span>(<span class="fu">colnames</span>(Hitters_Without_NA) <span class="sc">==</span> <span class="st">"Salary"</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ici, on spécifi nos varibales qualitatives et on décide de mettre la variable <em>Salary</em> en variable supplémentaire, ce qui veut d’ire qu’elle ne sera pas considéré pour la formation de nos composantes principales (variable que l’on cherchera à estimer plus tard).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Individus</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Variables</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Le plan des individus est une projection des observations (dans notre cas, les joueurs de baseball) sur les axes principaux de la PCA. Cette visualisation permet d’identifier des regroupements, tendances et anomalies au sein des données.</p>
<p>Ainsi, des individus proches sur le graphique ont des caractéristiques similaires par rapport aux variables utilisées.</p>
<p>Puis, le placement d’un individu en fonction des axes peut permettre de savoir comment le jouer se caractérise par rapport aux variables qui contribuent le plus à ces axes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(res_pca, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="st">"none"</span>,  <span class="co"># Supprime les noms des individus</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">pointsize =</span> <span class="dv">2</span>,    <span class="co"># Taille des points</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.ind =</span> <span class="st">"cyan3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Exercice_1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Ici, on voit que les joueurs se répartissent bien sur le plan ce qui témoignent de la présence d’une grande variété de type de joueurs.</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Le cercle des variables est une représentation graphique qui permet d’analyser les relations entre les variables initiales et les composantes principales qui forment nos axes. Il est basé sur les corrélations entre les variables et les axes principaux.</p>
<p>Ainsi, plus une variable est proche du bord du cercle, plus elle est bien représentée sur le plan factoriel et contribue fortement à la formation des axes.</p>
<p>De plus, selon l’angle entre deux varibles, on peut faire des suppositions sur leur corrélation :</p>
<ul>
<li><p>Si deux variables ont des vecteurs proches (petit angle), elles sont fortement corrélées positivement</p></li>
<li><p>Si deux variables ont des vecteurs opposés (angle proche de 180°), elles sont corrélées négativement</p></li>
<li><p>Si l’angle est proche de 90°, alors les variables ne sont pas corrélées</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res_pca, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.var =</span> <span class="st">"purple"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Exercice_1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Dans notre cas, ce que l’on peut voir c’est que la majorité de nos variables sont bien représentées par nos deux axes (cumulant plus de 70% d’explication). Mais beaucoup semblent aussi fortement corrélées avecla formation de deux groupes et la variable <em>Salary</em> se trouvant au milieu. Cette corrélation ayant déjà pu être observé précédemment.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="analyse-inférentielle" class="level1">
<h1>Analyse inférentielle</h1>
<p>On désire modéliser le salaire <em>Salary</em> en fonction des variables disponibles.</p>
<p>On va donc ajuster un modèle de régression linéaire en utilisant toutes les variables à disposition et analyser la qualité de cet ajustement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>           Hitters_Without_NA) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>mod1 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ ., data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-907.62 -178.35  -31.11  139.09 1877.04 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  163.10359   90.77854   1.797 0.073622 .  
AtBat         -1.97987    0.63398  -3.123 0.002008 ** 
Hits           7.50077    2.37753   3.155 0.001808 ** 
HmRun          4.33088    6.20145   0.698 0.485616    
Runs          -2.37621    2.98076  -0.797 0.426122    
RBI           -1.04496    2.60088  -0.402 0.688204    
Walks          6.23129    1.82850   3.408 0.000766 ***
Years         -3.48905   12.41219  -0.281 0.778874    
CAtBat        -0.17134    0.13524  -1.267 0.206380    
CHits          0.13399    0.67455   0.199 0.842713    
CHmRun        -0.17286    1.61724  -0.107 0.914967    
CRuns          1.45430    0.75046   1.938 0.053795 .  
CRBI           0.80771    0.69262   1.166 0.244691    
CWalks        -0.81157    0.32808  -2.474 0.014057 *  
LeagueN       62.59942   79.26140   0.790 0.430424    
DivisionW   -116.84925   40.36695  -2.895 0.004141 ** 
PutOuts        0.28189    0.07744   3.640 0.000333 ***
Assists        0.37107    0.22120   1.678 0.094723 .  
Errors        -3.36076    4.39163  -0.765 0.444857    
NewLeagueN   -24.76233   79.00263  -0.313 0.754218    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 315.6 on 243 degrees of freedom
Multiple R-squared:  0.5461,    Adjusted R-squared:  0.5106 
F-statistic: 15.39 on 19 and 243 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nous sommes sur un modèle comprenant des variables quantitatives et qualitative ce qui le rapproche d’une modélisation ANOVA.</p>
</div>
</div>
<p>Quelques commentaires sur le modèle :</p>
<ul>
<li><p>beaucoup de variables ont un effet non significatif</p></li>
<li><p>le <span class="math inline">\(R^2\)</span> et le <span class="math inline">\(R^2_{adjusted}\)</span> sont autour de 0.5 ce qui témoigne d’une mauvaise qualité d’ajustament du modèle</p></li>
<li><p>l’écart type résiduel est de 315.6 ce qui est assez important et témoigne d’un modèle peu précis</p></li>
</ul>
<p>Pour tenter de trouver un meilleur ajustment, il est important d’analyser d’avantage le lien entre toutes les variables explicatives. On utilise alors comunément le VIF</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     AtBat       Hits      HmRun       Runs        RBI      Walks      Years 
 22.944366  30.281255   7.758668  15.246418  11.921715   4.148712   9.313280 
    CAtBat      CHits     CHmRun      CRuns       CRBI     CWalks     League 
251.561160 502.954289  46.488462 162.520810 131.965858  19.744105   4.134115 
  Division    PutOuts    Assists     Errors  NewLeague 
  1.075398   1.236317   2.709341   2.214543   4.099063 </code></pre>
</div>
</div>
<p>On remarque ainsi que beaucoup de valeurs sont supérieur à 10 ce qui s’interprète communément comme la précence d’une forte colinéarité sur nos variables explicatives.</p>
<p>Cette colinéarité se constatait déjà durant les analyses descriptive via les graphes de corrélations (d’où l’importance de ne pas se lancer trop rapidement dans les analyses inférentielles).</p>
<p>Maintenant, on va donc tenter de trouver le meilleur sous-modèle possible. Pour cela on va suivre la procédure suivante :</p>
<ul>
<li><p>mettre en oeuvre une méthode de sélection automatique exhaustive et observer l’évolution des SCR (Sommes de Carrés Résiduels) pour les modèles retenus en fonction de leur taille.</p></li>
<li><p>déduire de ces SCR le <span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2_{adjusted}\)</span>, AIC, BIC et <span class="math inline">\(C_p\)</span> correspondants. Les comparer avec les valeurs fournies dans le summary de regsubsets et tracer leur évolution en fonction de la taille du modèle.</p></li>
</ul>
<p>Puis reproduire la même procédure avec des séléctions <em>backward</em>, <em>forward</em> et <em>stepwise</em></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Un rappel sur nos critère se trouve dans la partie <em>Setup</em>, onglet fonction, de ce document avec la création de fonction pour les calculés.</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Sélection automatique</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">backward</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">forward</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">both</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>selec_auto <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"exhaustive"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span> <span class="co"># maximum size of subsets to examine</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                         )</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># selec_auto %&gt;% summary()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On va déjà commencer par regarder la valeur du critère en fonction des variables des différents modèles testés.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'bic'</span>) </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'Cp'</span>) </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'r2'</span>) </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'adjr2'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Exercice_1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ici on remarque clairement que toutes nos variables ne sont pas gardés lorsque l’on cherche à optimiser nos critères.</p>
<p>Aussi, on peut voir encore de faibles valeurs pour les <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> pouvant témoignés d’un mauvais ajustement de modèle.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>plot.regsubsets() de leaps ne prend pas directement “aic” comme option de scale. Pour une sélection basée sur AIC, une approche alternative consiste à utiliser la fonction stepAIC() du package MASS, qui permet une sélection pas à pas basée sur AIC.</p>
</div>
</div>
<p>Regardons un peut l’évolution de la Somme des Carrés Résiduels (SCR).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>SCR <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>rss</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Criteria_plot</span>(SCR, <span class="at">crit_name =</span> <span class="st">"Somme des Carrés Résiduels"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Exercice_1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="1536"></p>
</div>
</div>
<p>Maintenant regardons les autres critères mentionné précédemment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">r2_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>r2a <span class="ot">&lt;-</span> <span class="fu">r2a_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">cp_fun</span>(mod1, SCR)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">aic_fun</span>(SCR)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">&lt;-</span> <span class="fu">bic_fun</span>(SCR)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(r2, <span class="at">crit_name =</span> <span class="st">"R2"</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(r2a, <span class="at">crit_name =</span> <span class="st">"R2 ajusté"</span>),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(cp, <span class="at">crit_name =</span> <span class="st">"Cp"</span>),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(aic, <span class="at">crit_name =</span> <span class="st">"AIC"</span>),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Exercice_1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="2880"></p>
</div>
</div>
<p>On peut ainsi voir que ce sont plutot des modèles entre 5 et 10 variables qui optimisent nos critères (donc pas un modèle avec toutes nos variables).</p>
<p>Regardons donc pour chaque critère quel est le modèle qui resort comme le meilleur</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>best_model_r2 <span class="ot">&lt;-</span> <span class="fu">which.max</span>(r2)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>which[best_model_r2,]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Meilleur modèle selon R2 : Modèle avec"</span>, best_model_r2, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Meilleur modèle selon R2 : Modèle avec 19 variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "(Intercept)" "AtBat"       "Hits"        "HmRun"       "Runs"       
 [6] "RBI"         "Walks"       "Years"       "CAtBat"      "CHits"      
[11] "CHmRun"      "CRuns"       "CRBI"        "CWalks"      "LeagueN"    
[16] "DivisionW"   "PutOuts"     "Assists"     "Errors"      "NewLeagueN" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>best_model_r2a <span class="ot">&lt;-</span> <span class="fu">which.max</span>(r2a)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>which[best_model_r2a,]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Meilleur modèle selon AIC : Modèle avec"</span>, best_model_r2a, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Meilleur modèle selon AIC : Modèle avec 11 variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "(Intercept)" "AtBat"       "Hits"        "Walks"       "CAtBat"     
 [6] "CRuns"       "CRBI"        "CWalks"      "LeagueN"     "DivisionW"  
[11] "PutOuts"     "Assists"    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>best_model_cp <span class="ot">&lt;-</span> <span class="fu">which.min</span>(cp)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>which[best_model_cp,]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Meilleur modèle selon AIC : Modèle avec"</span>, best_model_cp, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Meilleur modèle selon AIC : Modèle avec 10 variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "(Intercept)" "AtBat"       "Hits"        "Walks"       "CAtBat"     
 [6] "CRuns"       "CRBI"        "CWalks"      "DivisionW"   "PutOuts"    
[11] "Assists"    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>best_model_aic <span class="ot">&lt;-</span> <span class="fu">which.min</span>(aic)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>which[best_model_aic,]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Meilleur modèle selon AIC : Modèle avec"</span>, best_model_aic, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Meilleur modèle selon AIC : Modèle avec 10 variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "(Intercept)" "AtBat"       "Hits"        "Walks"       "CAtBat"     
 [6] "CRuns"       "CRBI"        "CWalks"      "DivisionW"   "PutOuts"    
[11] "Assists"    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>best_model_bic <span class="ot">&lt;-</span> <span class="fu">which.min</span>(bic)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>which[best_model_bic,]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Meilleur modèle selon BIC : Modèle avec"</span>, best_model_bic, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Meilleur modèle selon BIC : Modèle avec 6 variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "(Intercept)" "AtBat"       "Hits"        "Walks"       "CRBI"       
[6] "DivisionW"   "PutOuts"    </code></pre>
</div>
</div>
<p>Pour finir, comparons un peut les critères que nous avons calculés avec ceux que l’on peut récupérer via le summary de regsubset (pour tous sauf l’AIC qui n’est pas présent).</p>
<p>Pour cela regardons si nous avons régulièrement la valeur 0 (ou valeur proche) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(r2<span class="sc">-</span><span class="fu">summary</span>(selec_auto)<span class="sc">$</span>rsq) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(r2a<span class="sc">-</span><span class="fu">summary</span>(selec_auto)<span class="sc">$</span>adjr2) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cp<span class="sc">-</span><span class="fu">summary</span>(selec_auto)<span class="sc">$</span>cp) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(bic<span class="sc">-</span><span class="fu">summary</span>(selec_auto)<span class="sc">$</span>bic) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3214</code></pre>
</div>
</div>
<p>on voit une grosse différence seulement pour le BIC donc regardons plus en détail.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(<span class="fu">summary</span>(selec_auto)<span class="sc">$</span>bic, <span class="at">crit_name =</span> <span class="st">"BIC regsubstet ajusté"</span>),</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Exercice_1_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="2496"></p>
</div>
</div>
<p>On voit que les valeurs sont différentes mais en fait le comportement est identique. Ce qui veut dire que la différence est seulement due à une constant multiplicative près.</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Cette fois ci on va regarder en sélection backward. D’abord, on fait à nouveau avec la fonction regsubset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>selec_back <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"backward"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>SCR <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_back)<span class="sc">$</span>rss</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">r2_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>r2a <span class="ot">&lt;-</span> <span class="fu">r2a_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">cp_fun</span>(mod1, SCR)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">aic_fun</span>(SCR)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">&lt;-</span> <span class="fu">bic_fun</span>(SCR)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(r2, <span class="at">crit_name =</span> <span class="st">"R2"</span>),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(r2a, <span class="at">crit_name =</span> <span class="st">"R2 ajusté"</span>),</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(cp, <span class="at">crit_name =</span> <span class="st">"Cp"</span>),</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(SCR, <span class="at">crit_name =</span> <span class="st">"Somme des Carrés Résiduels"</span>),</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(aic, <span class="at">crit_name =</span> <span class="st">"AIC"</span>),</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Exercice_1_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="2880"></p>
</div>
</div>
<p>On peut également utiliser la fonction <em>step</em> de la library { <em>stats</em> }. Pour cela, on part du plus gros modèle défini précédemment par mod1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>modselect_back_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="co"># trace = TRUE permet de voir le détail des étapes</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="fu">log</span>(n) <span class="co"># BIC selection</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Puis on peut regarder le modèle qui optimise le critère utilisé pour la selection.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>modselect_back_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ AtBat + Hits + Walks + CRuns + CRBI + CWalks + 
    Division + PutOuts, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-794.06 -171.94  -28.48  133.36 2017.83 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  117.15204   65.07016   1.800 0.072985 .  
AtBat         -2.03392    0.52282  -3.890 0.000128 ***
Hits           6.85491    1.65215   4.149 4.56e-05 ***
Walks          6.44066    1.52212   4.231 3.25e-05 ***
CRuns          0.70454    0.24869   2.833 0.004981 ** 
CRBI           0.52732    0.18861   2.796 0.005572 ** 
CWalks        -0.80661    0.26395  -3.056 0.002483 ** 
DivisionW   -123.77984   39.28749  -3.151 0.001824 ** 
PutOuts        0.27539    0.07431   3.706 0.000259 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 314.7 on 254 degrees of freedom
Multiple R-squared:  0.5281,    Adjusted R-squared:  0.5133 
F-statistic: 35.54 on 8 and 254 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>La fonction step propose aussi une selection avec AIC et Cp.</p>
<ul>
<li>AIC</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>modselect_back_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">2</span> <span class="co"># AIC selection</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>modselect_back_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ AtBat + Hits + Walks + CAtBat + CRuns + 
    CRBI + CWalks + Division + PutOuts + Assists, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-939.11 -176.87  -34.08  130.90 1910.55 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  162.53544   66.90784   2.429 0.015830 *  
AtBat         -2.16865    0.53630  -4.044 7.00e-05 ***
Hits           6.91802    1.64665   4.201 3.69e-05 ***
Walks          5.77322    1.58483   3.643 0.000327 ***
CAtBat        -0.13008    0.05550  -2.344 0.019858 *  
CRuns          1.40825    0.39040   3.607 0.000373 ***
CRBI           0.77431    0.20961   3.694 0.000271 ***
CWalks        -0.83083    0.26359  -3.152 0.001818 ** 
DivisionW   -112.38006   39.21438  -2.866 0.004511 ** 
PutOuts        0.29737    0.07444   3.995 8.50e-05 ***
Assists        0.28317    0.15766   1.796 0.073673 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.8 on 252 degrees of freedom
Multiple R-squared:  0.5405,    Adjusted R-squared:  0.5223 
F-statistic: 29.64 on 10 and 252 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><span class="math inline">\(C_p\)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>modselect_back_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">1</span> <span class="co"># Cp selection</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>modselect_back_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ AtBat + Hits + Walks + CAtBat + CRuns + 
    CRBI + CWalks + League + Division + PutOuts + Assists, data = Hitters_Without_NA)

Residuals:
   Min     1Q Median     3Q    Max 
-932.2 -175.4  -29.2  130.4 1897.2 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  135.75122   71.34623   1.903 0.058223 .  
AtBat         -2.12775    0.53746  -3.959 9.81e-05 ***
Hits           6.92370    1.64612   4.206 3.62e-05 ***
Walks          5.62028    1.59064   3.533 0.000488 ***
CAtBat        -0.13899    0.05609  -2.478 0.013870 *  
CRuns          1.45533    0.39270   3.706 0.000259 ***
CRBI           0.78525    0.20978   3.743 0.000225 ***
CWalks        -0.82286    0.26361  -3.121 0.002010 ** 
LeagueN       43.11162   39.96612   1.079 0.281755    
DivisionW   -111.14603   39.21835  -2.834 0.004970 ** 
PutOuts        0.28941    0.07478   3.870 0.000139 ***
Assists        0.26883    0.15816   1.700 0.090430 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.7 on 251 degrees of freedom
Multiple R-squared:  0.5426,    Adjusted R-squared:  0.5226 
F-statistic: 27.07 on 11 and 251 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>On voit que parmi nos modèles, le BIC semble le plus parcimonieux mais de manière général on constate encore des valeurs de <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> assez faibles.</p>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>Cette fois ci on va regarder en sélection <em>forward</em>. D’abord, on fait à nouveau avec la fonction regsubset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>selec_forw <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"forward"</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>SCR <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_forw)<span class="sc">$</span>rss</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">r2_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>r2a <span class="ot">&lt;-</span> <span class="fu">r2a_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">cp_fun</span>(mod1, SCR)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">aic_fun</span>(SCR)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">&lt;-</span> <span class="fu">bic_fun</span>(SCR)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(r2, <span class="at">crit_name =</span> <span class="st">"R2"</span>),</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(r2a, <span class="at">crit_name =</span> <span class="st">"R2 ajusté"</span>),</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(cp, <span class="at">crit_name =</span> <span class="st">"Cp"</span>),</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(SCR, <span class="at">crit_name =</span> <span class="st">"Somme des Carrés Résiduels"</span>),</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(aic, <span class="at">crit_name =</span> <span class="st">"AIC"</span>),</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Exercice_1_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="2880"></p>
</div>
</div>
<p>On peut également utiliser la fonction <em>step</em> de la library { <em>stats</em> }. Cette fois ci il faut définir en modèle de départ le plus petit modèle (celui composé seulement de l’intercept).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Salary<span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>           Hitters_Without_NA)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>modselect_forw_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="co"># trace = TRUE permet de voir le détail des étapes</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="fu">log</span>(n) <span class="co"># BIC selection</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>                       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Puis on peut regarder le modèle qui optimise le critère utilisé pour la selection.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>modselect_forw_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-873.11 -181.72  -25.91  141.77 2040.47 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   91.51180   65.00006   1.408 0.160382    
CRBI           0.64302    0.06443   9.979  &lt; 2e-16 ***
Hits           7.60440    1.66254   4.574 7.46e-06 ***
PutOuts        0.26431    0.07477   3.535 0.000484 ***
DivisionW   -122.95153   39.82029  -3.088 0.002239 ** 
AtBat         -1.86859    0.52742  -3.543 0.000470 ***
Walks          3.69765    1.21036   3.055 0.002488 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 319.9 on 256 degrees of freedom
Multiple R-squared:  0.5087,    Adjusted R-squared:  0.4972 
F-statistic: 44.18 on 6 and 256 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>La fonction step propose aussi une selection avec AIC et Cp.</p>
<ul>
<li>AIC</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>modselect_forw_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">2</span> <span class="co"># AIC selection</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>modselect_forw_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks + CWalks + CRuns + CAtBat + Assists, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-939.11 -176.87  -34.08  130.90 1910.55 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  162.53544   66.90784   2.429 0.015830 *  
CRBI           0.77431    0.20961   3.694 0.000271 ***
Hits           6.91802    1.64665   4.201 3.69e-05 ***
PutOuts        0.29737    0.07444   3.995 8.50e-05 ***
DivisionW   -112.38006   39.21438  -2.866 0.004511 ** 
AtBat         -2.16865    0.53630  -4.044 7.00e-05 ***
Walks          5.77322    1.58483   3.643 0.000327 ***
CWalks        -0.83083    0.26359  -3.152 0.001818 ** 
CRuns          1.40825    0.39040   3.607 0.000373 ***
CAtBat        -0.13008    0.05550  -2.344 0.019858 *  
Assists        0.28317    0.15766   1.796 0.073673 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.8 on 252 degrees of freedom
Multiple R-squared:  0.5405,    Adjusted R-squared:  0.5223 
F-statistic: 29.64 on 10 and 252 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><span class="math inline">\(C_p\)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>modselect_forw_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">1</span> <span class="co"># Cp selection</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>modselect_forw_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks + CWalks + CRuns + CAtBat + Assists + League, data = Hitters_Without_NA)

Residuals:
   Min     1Q Median     3Q    Max 
-932.2 -175.4  -29.2  130.4 1897.2 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  135.75122   71.34623   1.903 0.058223 .  
CRBI           0.78525    0.20978   3.743 0.000225 ***
Hits           6.92370    1.64612   4.206 3.62e-05 ***
PutOuts        0.28941    0.07478   3.870 0.000139 ***
DivisionW   -111.14603   39.21835  -2.834 0.004970 ** 
AtBat         -2.12775    0.53746  -3.959 9.81e-05 ***
Walks          5.62028    1.59064   3.533 0.000488 ***
CWalks        -0.82286    0.26361  -3.121 0.002010 ** 
CRuns          1.45533    0.39270   3.706 0.000259 ***
CAtBat        -0.13899    0.05609  -2.478 0.013870 *  
Assists        0.26883    0.15816   1.700 0.090430 .  
LeagueN       43.11162   39.96612   1.079 0.281755    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.7 on 251 degrees of freedom
Multiple R-squared:  0.5426,    Adjusted R-squared:  0.5226 
F-statistic: 27.07 on 11 and 251 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>On voit que parmi nos modèles, le BIC semble le plus parcimonieux mais de manière général on constate encore des valeurs de <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> assez faibles.</p>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<p>Maintenant on va regarder en sélection <em>both</em>. On va alors utiliser la fonction <em>step</em> directement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>modselect_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="fu">log</span>(n))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>modselect_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-873.11 -181.72  -25.91  141.77 2040.47 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   91.51180   65.00006   1.408 0.160382    
CRBI           0.64302    0.06443   9.979  &lt; 2e-16 ***
Hits           7.60440    1.66254   4.574 7.46e-06 ***
PutOuts        0.26431    0.07477   3.535 0.000484 ***
DivisionW   -122.95153   39.82029  -3.088 0.002239 ** 
AtBat         -1.86859    0.52742  -3.543 0.000470 ***
Walks          3.69765    1.21036   3.055 0.002488 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 319.9 on 256 degrees of freedom
Multiple R-squared:  0.5087,    Adjusted R-squared:  0.4972 
F-statistic: 44.18 on 6 and 256 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>modselect_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>modselect_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks + CWalks + CRuns + CAtBat + Assists, data = Hitters_Without_NA)

Residuals:
    Min      1Q  Median      3Q     Max 
-939.11 -176.87  -34.08  130.90 1910.55 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  162.53544   66.90784   2.429 0.015830 *  
CRBI           0.77431    0.20961   3.694 0.000271 ***
Hits           6.91802    1.64665   4.201 3.69e-05 ***
PutOuts        0.29737    0.07444   3.995 8.50e-05 ***
DivisionW   -112.38006   39.21438  -2.866 0.004511 ** 
AtBat         -2.16865    0.53630  -4.044 7.00e-05 ***
Walks          5.77322    1.58483   3.643 0.000327 ***
CWalks        -0.83083    0.26359  -3.152 0.001818 ** 
CRuns          1.40825    0.39040   3.607 0.000373 ***
CAtBat        -0.13008    0.05550  -2.344 0.019858 *  
Assists        0.28317    0.15766   1.796 0.073673 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.8 on 252 degrees of freedom
Multiple R-squared:  0.5405,    Adjusted R-squared:  0.5223 
F-statistic: 29.64 on 10 and 252 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>modselect_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>modselect_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ CRBI + Hits + PutOuts + Division + AtBat + 
    Walks + CWalks + CRuns + CAtBat + Assists + League, data = Hitters_Without_NA)

Residuals:
   Min     1Q Median     3Q    Max 
-932.2 -175.4  -29.2  130.4 1897.2 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  135.75122   71.34623   1.903 0.058223 .  
CRBI           0.78525    0.20978   3.743 0.000225 ***
Hits           6.92370    1.64612   4.206 3.62e-05 ***
PutOuts        0.28941    0.07478   3.870 0.000139 ***
DivisionW   -111.14603   39.21835  -2.834 0.004970 ** 
AtBat         -2.12775    0.53746  -3.959 9.81e-05 ***
Walks          5.62028    1.59064   3.533 0.000488 ***
CWalks        -0.82286    0.26361  -3.121 0.002010 ** 
CRuns          1.45533    0.39270   3.706 0.000259 ***
CAtBat        -0.13899    0.05609  -2.478 0.013870 *  
Assists        0.26883    0.15816   1.700 0.090430 .  
LeagueN       43.11162   39.96612   1.079 0.281755    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 311.7 on 251 degrees of freedom
Multiple R-squared:  0.5426,    Adjusted R-squared:  0.5226 
F-statistic: 27.07 on 11 and 251 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Malheuresement, même en sélection <em>both</em> nous avons encore des <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span> faibles.</p>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>À la lumière des résultats de notre analyse, on peut envisager le modèle <em>both</em> car bien qu’il n’ait pas montré de grandes améliorations en termes de <span class="math inline">\(R^2\)</span> et <span class="math inline">\(R^2_{adjusted}\)</span>, il permet de réduire le nombre de variables tout en maintenant celles qui sont significatives. Ce modèle est donc plus parcimonieux tout en conservant des variables importantes. Cependant, une réflexion supplémentaire pourrait être menée sur l’éventuelle suppression de l’<em>intercept</em>, ce qui nécessiterait une validation supplémentaire.</p>
<p>En ce qui concerne le choix final du modèle, on peut opté pour celui qui maximise le critère BIC, ce qui nous mène à un modèle avec 6 variables. Le BIC est particulièrement utile pour privilégier un modèle plus simple et plus parcimonieux, ce qui est un atout lorsqu’on cherche à éviter un surajustement. Toutefois, il est important de noter que la qualité de l’ajustement n’est pas optimale, ce qui suggère qu’il pourrait manquer certaines informations pour expliquer pleinement la variable cible (le salaire).</p>
<p>Enfin, la validité interne est un aspect crucial qui n’a pas été suffisamment exploré dans cette analyse. Il aurait été pertinent de vérifier que toutes les hypothèses sous-jacentes des modèles étaient satisfaites. Cela aurait permis de renforcer la robustesse de nos résultats et de garantir que les conclusions qu’on sont fiables.</p>
<p>Donc, il serait pertinent d’examiner plus en profondeur la validité interne, notamment en testant les hypothèses de normalité, d’homoscédasticité, et d’indépendance des résidus.</p>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>(<span class="at">pkgs =</span> <span class="st">"attached"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.2.1 (2022-06-23 ucrt)
 os       Windows 10 x64 (build 22631)
 system   x86_64, mingw32
 ui       RTerm
 language (EN)
 collate  French_France.utf8
 ctype    French_France.utf8
 tz       Europe/Paris
 date     2025-02-17
 pandoc   3.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package      * version date (UTC) lib source
 car          * 3.1-2   2023-03-30 [1] CRAN (R 4.2.3)
 carData      * 3.0-5   2022-01-06 [1] CRAN (R 4.2.1)
 dplyr        * 1.1.4   2023-11-17 [1] CRAN (R 4.2.3)
 DT           * 0.33    2024-04-04 [1] CRAN (R 4.2.3)
 factoextra   * 1.0.7   2020-04-01 [1] CRAN (R 4.2.1)
 FactoMineR   * 2.9     2023-10-12 [1] CRAN (R 4.2.3)
 GGally       * 2.2.1   2024-02-14 [1] CRAN (R 4.2.3)
 ggplot2      * 3.5.1   2024-04-23 [1] CRAN (R 4.2.3)
 gridExtra    * 2.3     2017-09-09 [1] CRAN (R 4.2.1)
 ISLR         * 1.4     2021-09-15 [1] CRAN (R 4.2.3)
 leaps        * 3.1     2020-01-16 [1] CRAN (R 4.2.1)
 MASS         * 7.3-60  2023-05-04 [1] CRAN (R 4.2.3)
 psych        * 2.4.1   2024-01-18 [1] CRAN (R 4.2.3)
 RColorBrewer * 1.1-3   2022-04-03 [1] CRAN (R 4.2.0)
 reshape2     * 1.4.4   2020-04-09 [1] CRAN (R 4.2.1)
 rstatix      * 0.7.2   2023-02-01 [1] CRAN (R 4.2.1)
 tibble       * 3.2.1   2023-03-20 [1] CRAN (R 4.2.3)

 [1] C:/Users/cleme/AppData/Local/R/win-library/4.2
 [2] C:/Program Files/R/R-4.2.1/library

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb79" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Exercice 1"</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Clément Poupelin"</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co">    embed-resources: false</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: article</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> false</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> ["TP"]</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> ""</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> ""</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup </span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="fu">## packages</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, setup, warning=FALSE, message=FALSE}</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR) <span class="co"># Hitters data </span></span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps) <span class="co"># regsubsets </span></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="co"># pour ggcorr</span></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># pour VIF</span></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Summary</span></span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a><span class="do">## PCA</span></span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)  <span class="co"># Pour transformer les données en format long</span></span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a><span class="do">## for pairs panel</span></span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fonctions </span></span>
<span id="cb79-55"><a href="#cb79-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-56"><a href="#cb79-56" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-57"><a href="#cb79-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-58"><a href="#cb79-58" aria-hidden="true" tabindex="-1"></a><span class="fu">### Critères</span></span>
<span id="cb79-59"><a href="#cb79-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-62"><a href="#cb79-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-63"><a href="#cb79-63" aria-hidden="true" tabindex="-1"></a>r2_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb79-64"><a href="#cb79-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># r2 = SSE/SST = (SST - SSR)/SST = 1 - ssr/sst</span></span>
<span id="cb79-65"><a href="#cb79-65" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb79-66"><a href="#cb79-66" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SCR<span class="sc">/</span>SCT</span>
<span id="cb79-67"><a href="#cb79-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2)</span>
<span id="cb79-68"><a href="#cb79-68" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-69"><a href="#cb79-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-70"><a href="#cb79-70" aria-hidden="true" tabindex="-1"></a>r2a_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(y, SCR){</span>
<span id="cb79-71"><a href="#cb79-71" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb79-72"><a href="#cb79-72" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb79-73"><a href="#cb79-73" aria-hidden="true" tabindex="-1"></a>  SCT <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y) )<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb79-74"><a href="#cb79-74" aria-hidden="true" tabindex="-1"></a>  r2a <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SCR<span class="sc">/</span>(n<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">/</span>(SCT<span class="sc">/</span>(n<span class="dv">-1</span>))</span>
<span id="cb79-75"><a href="#cb79-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r2a)</span>
<span id="cb79-76"><a href="#cb79-76" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-77"><a href="#cb79-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-78"><a href="#cb79-78" aria-hidden="true" tabindex="-1"></a>cp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, SCR){</span>
<span id="cb79-79"><a href="#cb79-79" aria-hidden="true" tabindex="-1"></a>  sig <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb79-80"><a href="#cb79-80" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb79-81"><a href="#cb79-81" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb79-82"><a href="#cb79-82" aria-hidden="true" tabindex="-1"></a>  cp <span class="ot">&lt;-</span> SCR<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>) <span class="sc">-</span> n</span>
<span id="cb79-83"><a href="#cb79-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cp)</span>
<span id="cb79-84"><a href="#cb79-84" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-85"><a href="#cb79-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-86"><a href="#cb79-86" aria-hidden="true" tabindex="-1"></a>aic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb79-87"><a href="#cb79-87" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb79-88"><a href="#cb79-88" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb79-89"><a href="#cb79-89" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb79-90"><a href="#cb79-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(aic)</span>
<span id="cb79-91"><a href="#cb79-91" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-92"><a href="#cb79-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-93"><a href="#cb79-93" aria-hidden="true" tabindex="-1"></a>bic_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(SCR){</span>
<span id="cb79-94"><a href="#cb79-94" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb79-95"><a href="#cb79-95" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb79-96"><a href="#cb79-96" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">log</span>(SCR<span class="sc">/</span>n) <span class="sc">+</span> <span class="fu">log</span>(n)<span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb79-97"><a href="#cb79-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(bic)</span>
<span id="cb79-98"><a href="#cb79-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-99"><a href="#cb79-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-100"><a href="#cb79-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-101"><a href="#cb79-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-102"><a href="#cb79-102" aria-hidden="true" tabindex="-1"></a><span class="fu">### plot pour nos critères</span></span>
<span id="cb79-105"><a href="#cb79-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-106"><a href="#cb79-106" aria-hidden="true" tabindex="-1"></a>Criteria_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(Criteria, <span class="at">crit_name =</span> <span class="st">"Critère"</span>) {</span>
<span id="cb79-107"><a href="#cb79-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création d'un data frame pour ggplot</span></span>
<span id="cb79-108"><a href="#cb79-108" aria-hidden="true" tabindex="-1"></a>  df_criteria <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb79-109"><a href="#cb79-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb_var =</span> <span class="fu">seq_along</span>(Criteria),  <span class="co"># Nombre de variables utilisées</span></span>
<span id="cb79-110"><a href="#cb79-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">Criteria =</span> Criteria            <span class="co"># Valeurs du critère (RSS, AIC, BIC, etc.)</span></span>
<span id="cb79-111"><a href="#cb79-111" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-112"><a href="#cb79-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-113"><a href="#cb79-113" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Création du plot avec ggplot2</span></span>
<span id="cb79-114"><a href="#cb79-114" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_criteria, <span class="fu">aes</span>(<span class="at">x =</span> nb_var, <span class="at">y =</span> Criteria)) <span class="sc">+</span></span>
<span id="cb79-115"><a href="#cb79-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb79-116"><a href="#cb79-116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb79-117"><a href="#cb79-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb79-118"><a href="#cb79-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Évolution de"</span>, crit_name, <span class="st">"en fonction du nombre de variables"</span>),</span>
<span id="cb79-119"><a href="#cb79-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Nombre de variables sélectionnées"</span>,</span>
<span id="cb79-120"><a href="#cb79-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> crit_name</span>
<span id="cb79-121"><a href="#cb79-121" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb79-122"><a href="#cb79-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb79-123"><a href="#cb79-123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb79-124"><a href="#cb79-124" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">26</span>),  <span class="co"># Titre centré et agrandi</span></span>
<span id="cb79-125"><a href="#cb79-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb79-126"><a href="#cb79-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb79-127"><a href="#cb79-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)</span>
<span id="cb79-128"><a href="#cb79-128" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-129"><a href="#cb79-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-130"><a href="#cb79-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(g)</span>
<span id="cb79-131"><a href="#cb79-131" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-132"><a href="#cb79-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-133"><a href="#cb79-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-134"><a href="#cb79-134" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb79-135"><a href="#cb79-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-136"><a href="#cb79-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-137"><a href="#cb79-137" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-138"><a href="#cb79-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-139"><a href="#cb79-139" aria-hidden="true" tabindex="-1"></a><span class="fu"># Données </span></span>
<span id="cb79-140"><a href="#cb79-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-141"><a href="#cb79-141" aria-hidden="true" tabindex="-1"></a>On étudie le jeu de données <span class="co">[</span><span class="ot">**Hitters**</span><span class="co">](https://rdrr.io/cran/ISLR/man/Hitters.html)</span> disponible dans la libraire <span class="sc">\{</span> *ISLR* \} de *R*.</span>
<span id="cb79-142"><a href="#cb79-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-143"><a href="#cb79-143" aria-hidden="true" tabindex="-1"></a>Il s'agit d'un je de données de la Major League Baseball provenant des saisons de 1986 et 1987.</span>
<span id="cb79-144"><a href="#cb79-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-147"><a href="#cb79-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-148"><a href="#cb79-148" aria-hidden="true" tabindex="-1"></a><span class="co"># ?Hitters</span></span>
<span id="cb79-149"><a href="#cb79-149" aria-hidden="true" tabindex="-1"></a>Hitters <span class="sc">%&gt;%</span></span>
<span id="cb79-150"><a href="#cb79-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dim</span>()</span>
<span id="cb79-151"><a href="#cb79-151" aria-hidden="true" tabindex="-1"></a>Hitters <span class="sc">%&gt;%</span></span>
<span id="cb79-152"><a href="#cb79-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb79-153"><a href="#cb79-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-154"><a href="#cb79-154" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb79-155"><a href="#cb79-155" aria-hidden="true" tabindex="-1"></a>On peut déjà remarquer la présence de 59 valeurs manquantes pour la variable *Salary*.</span>
<span id="cb79-156"><a href="#cb79-156" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-157"><a href="#cb79-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-158"><a href="#cb79-158" aria-hidden="true" tabindex="-1"></a>On va donc commencer par s'en débarasser (il ne s'agit que de 59 lignes sur 322). Puis on va également se concentrer sur les variables quantitatives .</span>
<span id="cb79-161"><a href="#cb79-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-162"><a href="#cb79-162" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span>
<span id="cb79-163"><a href="#cb79-163" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA_quant <span class="ot">&lt;-</span> Hitters_Without_NA <span class="sc">%&gt;%</span> <span class="fu">subset</span>(, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(League, Division, NewLeague))</span>
<span id="cb79-164"><a href="#cb79-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-165"><a href="#cb79-165" aria-hidden="true" tabindex="-1"></a>Hitters_Without_NA_quant <span class="sc">%&gt;%</span> <span class="fu">dim</span>()</span>
<span id="cb79-166"><a href="#cb79-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-167"><a href="#cb79-167" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyse descriptive </span></span>
<span id="cb79-168"><a href="#cb79-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-169"><a href="#cb79-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-170"><a href="#cb79-170" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-171"><a href="#cb79-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-172"><a href="#cb79-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-173"><a href="#cb79-173" aria-hidden="true" tabindex="-1"></a><span class="fu">## Boxplot </span></span>
<span id="cb79-174"><a href="#cb79-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-175"><a href="#cb79-175" aria-hidden="true" tabindex="-1"></a>On peut regarder un peu la distribution de nos différents variables quantitatives via des boxplots.</span>
<span id="cb79-176"><a href="#cb79-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-177"><a href="#cb79-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, fig.height=6, fig.width=8}</span></span>
<span id="cb79-178"><a href="#cb79-178" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformer les données en format long pour ggplot</span></span>
<span id="cb79-179"><a href="#cb79-179" aria-hidden="true" tabindex="-1"></a>Hitters_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(Hitters_Without_NA_quant)</span>
<span id="cb79-180"><a href="#cb79-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-181"><a href="#cb79-181" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Hitters_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb79-182"><a href="#cb79-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb79-183"><a href="#cb79-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span>  <span class="co"># Palette de couleurs harmonieuse</span></span>
<span id="cb79-184"><a href="#cb79-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des Variables (Boxplot)"</span>,</span>
<span id="cb79-185"><a href="#cb79-185" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variables"</span>,</span>
<span id="cb79-186"><a href="#cb79-186" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Valeurs"</span>) <span class="sc">+</span></span>
<span id="cb79-187"><a href="#cb79-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Thème épuré</span></span>
<span id="cb79-188"><a href="#cb79-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotation des étiquettes</span></span>
<span id="cb79-189"><a href="#cb79-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-190"><a href="#cb79-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-191"><a href="#cb79-191" aria-hidden="true" tabindex="-1"></a>On peut remarquer que nos variables ont en général peut de valeurs outliers.</span>
<span id="cb79-192"><a href="#cb79-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-193"><a href="#cb79-193" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation panel</span></span>
<span id="cb79-194"><a href="#cb79-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-195"><a href="#cb79-195" aria-hidden="true" tabindex="-1"></a>On regarde ici la corrélation calculée entre chacune de nos variables.</span>
<span id="cb79-196"><a href="#cb79-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=22, fig.width=28}</span></span>
<span id="cb79-197"><a href="#cb79-197" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(</span>
<span id="cb79-198"><a href="#cb79-198" aria-hidden="true" tabindex="-1"></a>  Hitters_Without_NA_quant,</span>
<span id="cb79-199"><a href="#cb79-199" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"pearson"</span>,      <span class="co"># Méthode de corrélation </span></span>
<span id="cb79-200"><a href="#cb79-200" aria-hidden="true" tabindex="-1"></a>  <span class="at">hist.col =</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">"Set3"</span>), <span class="co"># Couleurs des histogrammes</span></span>
<span id="cb79-201"><a href="#cb79-201" aria-hidden="true" tabindex="-1"></a>  <span class="at">density =</span> <span class="cn">TRUE</span>,          <span class="co"># Ajout des courbes de densité</span></span>
<span id="cb79-202"><a href="#cb79-202" aria-hidden="true" tabindex="-1"></a>  <span class="at">ellipses =</span> <span class="cn">TRUE</span>,         <span class="co"># Ajout d'ellipses </span></span>
<span id="cb79-203"><a href="#cb79-203" aria-hidden="true" tabindex="-1"></a>  <span class="at">smooth =</span> <span class="cn">TRUE</span>,           <span class="co"># Ajout de régressions lissées</span></span>
<span id="cb79-204"><a href="#cb79-204" aria-hidden="true" tabindex="-1"></a>  <span class="at">lm =</span> <span class="cn">TRUE</span>,               <span class="co"># Ajout des droites de régression</span></span>
<span id="cb79-205"><a href="#cb79-205" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"#69b3a2"</span>,         <span class="co"># Couleur des points</span></span>
<span id="cb79-206"><a href="#cb79-206" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>              <span class="co"># Transparence </span></span>
<span id="cb79-207"><a href="#cb79-207" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-208"><a href="#cb79-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-209"><a href="#cb79-209" aria-hidden="true" tabindex="-1"></a>On voit la présence de plusieurs fortes corrélations qui peut déjà nous alerter si l'on veut faire des modèles de regressions linéaires car on risque d'avoir un problème de colinéarité entre les varibales explicatives.</span>
<span id="cb79-210"><a href="#cb79-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-211"><a href="#cb79-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## PCA </span></span>
<span id="cb79-212"><a href="#cb79-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-213"><a href="#cb79-213" aria-hidden="true" tabindex="-1"></a>Avec une Analyse en Composantes Principales (PCA) on peut regarder un peu le comportement de nos données.</span>
<span id="cb79-214"><a href="#cb79-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-215"><a href="#cb79-215" aria-hidden="true" tabindex="-1"></a>En effet, Cette méthode respose sur la transformation des variables d'origine en nouvelles variables non corrélées, appelées composantes principales, qui capturent successivement la plus grande variance possible des données.</span>
<span id="cb79-218"><a href="#cb79-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-219"><a href="#cb79-219" aria-hidden="true" tabindex="-1"></a>res_pca <span class="ot">&lt;-</span> <span class="fu">PCA</span>(Hitters_Without_NA, </span>
<span id="cb79-220"><a href="#cb79-220" aria-hidden="true" tabindex="-1"></a>               <span class="at">quali.sup =</span> <span class="fu">c</span>(<span class="fu">which</span>(<span class="fu">colnames</span>(Hitters_Without_NA) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"League"</span>, <span class="st">"Division"</span>, <span class="st">"NewLeague"</span>))),</span>
<span id="cb79-221"><a href="#cb79-221" aria-hidden="true" tabindex="-1"></a>               <span class="at">quanti.sup =</span> <span class="fu">which</span>(<span class="fu">colnames</span>(Hitters_Without_NA) <span class="sc">==</span> <span class="st">"Salary"</span>),</span>
<span id="cb79-222"><a href="#cb79-222" aria-hidden="true" tabindex="-1"></a>               <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb79-223"><a href="#cb79-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-224"><a href="#cb79-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-225"><a href="#cb79-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-226"><a href="#cb79-226" aria-hidden="true" tabindex="-1"></a>Ici, on spécifi nos varibales qualitatives et on décide de mettre la variable *Salary* en variable supplémentaire, ce qui veut d'ire qu'elle ne sera pas considéré pour la formation de nos composantes principales (variable que l'on cherchera à estimer plus tard).</span>
<span id="cb79-227"><a href="#cb79-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-228"><a href="#cb79-228" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-229"><a href="#cb79-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-230"><a href="#cb79-230" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Individus</span></span>
<span id="cb79-231"><a href="#cb79-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-232"><a href="#cb79-232" aria-hidden="true" tabindex="-1"></a>Le plan des individus est une projection des observations (dans notre cas, les joueurs de baseball) sur les axes principaux de la PCA. Cette visualisation permet d’identifier des regroupements, tendances et anomalies au sein des données. </span>
<span id="cb79-233"><a href="#cb79-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-234"><a href="#cb79-234" aria-hidden="true" tabindex="-1"></a>Ainsi, des individus proches sur le graphique ont des caractéristiques similaires par rapport aux variables utilisées.</span>
<span id="cb79-235"><a href="#cb79-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-236"><a href="#cb79-236" aria-hidden="true" tabindex="-1"></a>Puis, le placement d'un individu en fonction des axes peut permettre de savoir comment le jouer se caractérise par rapport aux variables qui contribuent le plus à ces axes.</span>
<span id="cb79-237"><a href="#cb79-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-238"><a href="#cb79-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb79-239"><a href="#cb79-239" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(res_pca, </span>
<span id="cb79-240"><a href="#cb79-240" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="st">"none"</span>,  <span class="co"># Supprime les noms des individus</span></span>
<span id="cb79-241"><a href="#cb79-241" aria-hidden="true" tabindex="-1"></a>             <span class="at">pointsize =</span> <span class="dv">2</span>,    <span class="co"># Taille des points</span></span>
<span id="cb79-242"><a href="#cb79-242" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.ind =</span> <span class="st">"cyan3"</span>)</span>
<span id="cb79-243"><a href="#cb79-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-244"><a href="#cb79-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-245"><a href="#cb79-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-246"><a href="#cb79-246" aria-hidden="true" tabindex="-1"></a>Ici, on voit que les joueurs se répartissent bien sur le plan ce qui témoignent de la présence d'une grande variété de type de joueurs.</span>
<span id="cb79-247"><a href="#cb79-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-248"><a href="#cb79-248" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables</span></span>
<span id="cb79-249"><a href="#cb79-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-250"><a href="#cb79-250" aria-hidden="true" tabindex="-1"></a>Le cercle des variables est une représentation graphique qui permet d’analyser les relations entre les variables initiales et les composantes principales qui forment nos axes. Il est basé sur les corrélations entre les variables et les axes principaux.</span>
<span id="cb79-251"><a href="#cb79-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-252"><a href="#cb79-252" aria-hidden="true" tabindex="-1"></a>Ainsi, plus une variable est proche du bord du cercle, plus elle est bien représentée sur le plan factoriel et contribue fortement à la formation des axes.</span>
<span id="cb79-253"><a href="#cb79-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-254"><a href="#cb79-254" aria-hidden="true" tabindex="-1"></a>De plus, selon l'angle entre deux varibles, on peut faire des suppositions sur leur corrélation : </span>
<span id="cb79-255"><a href="#cb79-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-256"><a href="#cb79-256" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si deux variables ont des vecteurs proches (petit angle), elles sont fortement corrélées positivement</span>
<span id="cb79-257"><a href="#cb79-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-258"><a href="#cb79-258" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si deux variables ont des vecteurs opposés (angle proche de 180°), elles sont corrélées négativement</span>
<span id="cb79-259"><a href="#cb79-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-260"><a href="#cb79-260" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si l’angle est proche de 90°, alors les variables ne sont pas corrélées</span>
<span id="cb79-261"><a href="#cb79-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-262"><a href="#cb79-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6, fig.width=8}</span></span>
<span id="cb79-263"><a href="#cb79-263" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(res_pca, </span>
<span id="cb79-264"><a href="#cb79-264" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.var =</span> <span class="st">"purple"</span>,</span>
<span id="cb79-265"><a href="#cb79-265" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-266"><a href="#cb79-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-267"><a href="#cb79-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-268"><a href="#cb79-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-269"><a href="#cb79-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-270"><a href="#cb79-270" aria-hidden="true" tabindex="-1"></a>Dans notre cas, ce que l'on peut voir c'est que la majorité de nos variables sont bien représentées par nos deux axes (cumulant plus de 70% d'explication). </span>
<span id="cb79-271"><a href="#cb79-271" aria-hidden="true" tabindex="-1"></a>Mais beaucoup semblent aussi fortement corrélées avecla formation de deux groupes et la variable *Salary* se trouvant au milieu. Cette corrélation ayant déjà pu être observé précédemment.</span>
<span id="cb79-272"><a href="#cb79-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-273"><a href="#cb79-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-274"><a href="#cb79-274" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb79-275"><a href="#cb79-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-276"><a href="#cb79-276" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-277"><a href="#cb79-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-278"><a href="#cb79-278" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analyse inférentielle</span></span>
<span id="cb79-279"><a href="#cb79-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-280"><a href="#cb79-280" aria-hidden="true" tabindex="-1"></a>On désire modéliser le salaire *Salary* en fonction des variables disponibles.</span>
<span id="cb79-281"><a href="#cb79-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-282"><a href="#cb79-282" aria-hidden="true" tabindex="-1"></a>On va donc ajuster un modèle de régression linéaire en utilisant toutes les variables à disposition et analyser la qualité de cet ajustement.</span>
<span id="cb79-283"><a href="#cb79-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-286"><a href="#cb79-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-287"><a href="#cb79-287" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> .,</span>
<span id="cb79-288"><a href="#cb79-288" aria-hidden="true" tabindex="-1"></a>           Hitters_Without_NA) </span>
<span id="cb79-289"><a href="#cb79-289" aria-hidden="true" tabindex="-1"></a>mod1 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb79-290"><a href="#cb79-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-291"><a href="#cb79-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-292"><a href="#cb79-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-293"><a href="#cb79-293" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb79-294"><a href="#cb79-294" aria-hidden="true" tabindex="-1"></a>Nous sommes sur un modèle comprenant des variables quantitatives et qualitative ce qui le rapproche d'une modélisation ANOVA.</span>
<span id="cb79-295"><a href="#cb79-295" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb79-296"><a href="#cb79-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-297"><a href="#cb79-297" aria-hidden="true" tabindex="-1"></a>Quelques commentaires sur le modèle :</span>
<span id="cb79-298"><a href="#cb79-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-299"><a href="#cb79-299" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>beaucoup de variables ont un effet non significatif</span>
<span id="cb79-300"><a href="#cb79-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-301"><a href="#cb79-301" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>le $R^2$ et le $R^2_{adjusted}$ sont autour de 0.5 ce qui témoigne d'une mauvaise qualité d'ajustament du modèle</span>
<span id="cb79-302"><a href="#cb79-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-303"><a href="#cb79-303" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>l'écart type résiduel est de 315.6 ce qui est assez important et témoigne d'un modèle peu précis</span>
<span id="cb79-304"><a href="#cb79-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-305"><a href="#cb79-305" aria-hidden="true" tabindex="-1"></a>Pour tenter de trouver un meilleur ajustment, il est important d'analyser d'avantage le lien entre toutes les variables explicatives. On utilise alors comunément le VIF</span>
<span id="cb79-308"><a href="#cb79-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-309"><a href="#cb79-309" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod1) </span>
<span id="cb79-310"><a href="#cb79-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-311"><a href="#cb79-311" aria-hidden="true" tabindex="-1"></a>On remarque ainsi que beaucoup de valeurs sont supérieur à 10 ce qui s'interprète communément comme la précence d'une forte colinéarité sur nos variables explicatives.</span>
<span id="cb79-312"><a href="#cb79-312" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb79-313"><a href="#cb79-313" aria-hidden="true" tabindex="-1"></a>Cette colinéarité se constatait déjà durant les analyses descriptive via les graphes de corrélations (d'où l'importance de ne pas se lancer trop rapidement dans les analyses inférentielles).</span>
<span id="cb79-314"><a href="#cb79-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-315"><a href="#cb79-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-316"><a href="#cb79-316" aria-hidden="true" tabindex="-1"></a>Maintenant, on va donc tenter de trouver le meilleur sous-modèle possible. Pour cela on va suivre la procédure suivante : </span>
<span id="cb79-317"><a href="#cb79-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-318"><a href="#cb79-318" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>mettre en oeuvre une méthode de sélection automatique exhaustive et observer l’évolution des SCR (Sommes de Carrés Résiduels) pour les modèles retenus en fonction de leur taille.</span>
<span id="cb79-319"><a href="#cb79-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-320"><a href="#cb79-320" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>déduire de ces SCR le $R^2$, $R^2_{adjusted}$, AIC, BIC et $C_p$ correspondants. Les comparer avec les valeurs fournies dans le summary de regsubsets et tracer leur évolution en fonction de la taille du modèle.</span>
<span id="cb79-321"><a href="#cb79-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-322"><a href="#cb79-322" aria-hidden="true" tabindex="-1"></a>Puis reproduire la même procédure avec des séléctions *backward*, *forward* et *stepwise*</span>
<span id="cb79-323"><a href="#cb79-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-324"><a href="#cb79-324" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb79-325"><a href="#cb79-325" aria-hidden="true" tabindex="-1"></a>Un rappel sur nos critère se trouve dans la partie *Setup*, onglet fonction, de ce document avec la création de fonction pour les calculés.</span>
<span id="cb79-326"><a href="#cb79-326" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb79-327"><a href="#cb79-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-328"><a href="#cb79-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-329"><a href="#cb79-329" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-330"><a href="#cb79-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-331"><a href="#cb79-331" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sélection automatique</span></span>
<span id="cb79-332"><a href="#cb79-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-335"><a href="#cb79-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-336"><a href="#cb79-336" aria-hidden="true" tabindex="-1"></a>selec_auto <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb79-337"><a href="#cb79-337" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb79-338"><a href="#cb79-338" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"exhaustive"</span>,</span>
<span id="cb79-339"><a href="#cb79-339" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span> <span class="co"># maximum size of subsets to examine</span></span>
<span id="cb79-340"><a href="#cb79-340" aria-hidden="true" tabindex="-1"></a>                         )</span>
<span id="cb79-341"><a href="#cb79-341" aria-hidden="true" tabindex="-1"></a><span class="co"># selec_auto %&gt;% summary()</span></span>
<span id="cb79-342"><a href="#cb79-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-343"><a href="#cb79-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-344"><a href="#cb79-344" aria-hidden="true" tabindex="-1"></a>On va déjà commencer par regarder la valeur du critère en fonction des variables des différents modèles testés.</span>
<span id="cb79-345"><a href="#cb79-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-346"><a href="#cb79-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=10, fig.width=12}</span></span>
<span id="cb79-347"><a href="#cb79-347" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb79-348"><a href="#cb79-348" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'bic'</span>) </span>
<span id="cb79-349"><a href="#cb79-349" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'Cp'</span>) </span>
<span id="cb79-350"><a href="#cb79-350" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'r2'</span>) </span>
<span id="cb79-351"><a href="#cb79-351" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(selec_auto, <span class="at">scale =</span> <span class="st">'adjr2'</span>) </span>
<span id="cb79-352"><a href="#cb79-352" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb79-353"><a href="#cb79-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-354"><a href="#cb79-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-355"><a href="#cb79-355" aria-hidden="true" tabindex="-1"></a>Ici on remarque clairement que toutes nos variables ne sont pas gardés lorsque l'on cherche à optimiser nos critères.</span>
<span id="cb79-356"><a href="#cb79-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-357"><a href="#cb79-357" aria-hidden="true" tabindex="-1"></a>Aussi, on peut voir encore de faibles valeurs pour les $R^2$ et $R^2_{adjusted}$ pouvant témoignés d'un mauvais ajustement de modèle.</span>
<span id="cb79-358"><a href="#cb79-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-359"><a href="#cb79-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-360"><a href="#cb79-360" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb79-361"><a href="#cb79-361" aria-hidden="true" tabindex="-1"></a>plot.regsubsets() de leaps ne prend pas directement "aic" comme option de scale. Pour une sélection basée sur AIC, une approche alternative consiste à utiliser la fonction stepAIC() du package MASS, qui permet une sélection pas à pas basée sur AIC.</span>
<span id="cb79-362"><a href="#cb79-362" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb79-363"><a href="#cb79-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-364"><a href="#cb79-364" aria-hidden="true" tabindex="-1"></a>Regardons un peut l'évolution de la Somme des Carrés Résiduels (SCR).</span>
<span id="cb79-365"><a href="#cb79-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=12, fig.width=16}</span></span>
<span id="cb79-366"><a href="#cb79-366" aria-hidden="true" tabindex="-1"></a>SCR <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>rss</span>
<span id="cb79-367"><a href="#cb79-367" aria-hidden="true" tabindex="-1"></a><span class="fu">Criteria_plot</span>(SCR, <span class="at">crit_name =</span> <span class="st">"Somme des Carrés Résiduels"</span>)</span>
<span id="cb79-368"><a href="#cb79-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-369"><a href="#cb79-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-370"><a href="#cb79-370" aria-hidden="true" tabindex="-1"></a>Maintenant regardons les autres critères mentionné précédemment</span>
<span id="cb79-371"><a href="#cb79-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=18, fig.width=30}</span></span>
<span id="cb79-372"><a href="#cb79-372" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">r2_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb79-373"><a href="#cb79-373" aria-hidden="true" tabindex="-1"></a>r2a <span class="ot">&lt;-</span> <span class="fu">r2a_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb79-374"><a href="#cb79-374" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">cp_fun</span>(mod1, SCR)</span>
<span id="cb79-375"><a href="#cb79-375" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">aic_fun</span>(SCR)</span>
<span id="cb79-376"><a href="#cb79-376" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">&lt;-</span> <span class="fu">bic_fun</span>(SCR)</span>
<span id="cb79-377"><a href="#cb79-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-378"><a href="#cb79-378" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(r2, <span class="at">crit_name =</span> <span class="st">"R2"</span>),</span>
<span id="cb79-379"><a href="#cb79-379" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(r2a, <span class="at">crit_name =</span> <span class="st">"R2 ajusté"</span>),</span>
<span id="cb79-380"><a href="#cb79-380" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(cp, <span class="at">crit_name =</span> <span class="st">"Cp"</span>),</span>
<span id="cb79-381"><a href="#cb79-381" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(aic, <span class="at">crit_name =</span> <span class="st">"AIC"</span>),</span>
<span id="cb79-382"><a href="#cb79-382" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb79-383"><a href="#cb79-383" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb79-384"><a href="#cb79-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-385"><a href="#cb79-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-386"><a href="#cb79-386" aria-hidden="true" tabindex="-1"></a>On peut ainsi voir que ce sont plutot des modèles entre 5 et 10 variables qui optimisent nos critères (donc pas un modèle avec toutes nos variables).</span>
<span id="cb79-387"><a href="#cb79-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-388"><a href="#cb79-388" aria-hidden="true" tabindex="-1"></a>Regardons donc pour chaque critère quel est le modèle qui resort comme le meilleur</span>
<span id="cb79-389"><a href="#cb79-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-392"><a href="#cb79-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-393"><a href="#cb79-393" aria-hidden="true" tabindex="-1"></a>best_model_r2 <span class="ot">&lt;-</span> <span class="fu">which.max</span>(r2)</span>
<span id="cb79-394"><a href="#cb79-394" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>which[best_model_r2,]</span>
<span id="cb79-395"><a href="#cb79-395" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Meilleur modèle selon R2 : Modèle avec"</span>, best_model_r2, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb79-396"><a href="#cb79-396" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb79-397"><a href="#cb79-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-398"><a href="#cb79-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-401"><a href="#cb79-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-402"><a href="#cb79-402" aria-hidden="true" tabindex="-1"></a>best_model_r2a <span class="ot">&lt;-</span> <span class="fu">which.max</span>(r2a)</span>
<span id="cb79-403"><a href="#cb79-403" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>which[best_model_r2a,]</span>
<span id="cb79-404"><a href="#cb79-404" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Meilleur modèle selon AIC : Modèle avec"</span>, best_model_r2a, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb79-405"><a href="#cb79-405" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb79-406"><a href="#cb79-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-407"><a href="#cb79-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-410"><a href="#cb79-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-411"><a href="#cb79-411" aria-hidden="true" tabindex="-1"></a>best_model_cp <span class="ot">&lt;-</span> <span class="fu">which.min</span>(cp)</span>
<span id="cb79-412"><a href="#cb79-412" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>which[best_model_cp,]</span>
<span id="cb79-413"><a href="#cb79-413" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Meilleur modèle selon AIC : Modèle avec"</span>, best_model_cp, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb79-414"><a href="#cb79-414" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb79-415"><a href="#cb79-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-416"><a href="#cb79-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-419"><a href="#cb79-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-420"><a href="#cb79-420" aria-hidden="true" tabindex="-1"></a>best_model_aic <span class="ot">&lt;-</span> <span class="fu">which.min</span>(aic)</span>
<span id="cb79-421"><a href="#cb79-421" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>which[best_model_aic,]</span>
<span id="cb79-422"><a href="#cb79-422" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Meilleur modèle selon AIC : Modèle avec"</span>, best_model_aic, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb79-423"><a href="#cb79-423" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb79-424"><a href="#cb79-424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-425"><a href="#cb79-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-428"><a href="#cb79-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-429"><a href="#cb79-429" aria-hidden="true" tabindex="-1"></a>best_model_bic <span class="ot">&lt;-</span> <span class="fu">which.min</span>(bic)</span>
<span id="cb79-430"><a href="#cb79-430" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_auto)<span class="sc">$</span>which[best_model_bic,]</span>
<span id="cb79-431"><a href="#cb79-431" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Meilleur modèle selon BIC : Modèle avec"</span>, best_model_bic, <span class="st">"variables</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb79-432"><a href="#cb79-432" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(selected_vars)[<span class="fu">as.data.frame</span>(selected_vars)[, <span class="dv">1</span>] <span class="sc">==</span> <span class="cn">TRUE</span>, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb79-433"><a href="#cb79-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-434"><a href="#cb79-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-435"><a href="#cb79-435" aria-hidden="true" tabindex="-1"></a>Pour finir, comparons un peut les critères que nous avons calculés avec ceux que l'on peut récupérer via le summary de regsubset (pour tous sauf l'AIC qui n'est pas présent).</span>
<span id="cb79-436"><a href="#cb79-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-437"><a href="#cb79-437" aria-hidden="true" tabindex="-1"></a>Pour cela regardons si nous avons régulièrement la valeur 0 (ou valeur proche) : </span>
<span id="cb79-440"><a href="#cb79-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-441"><a href="#cb79-441" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(r2<span class="sc">-</span><span class="fu">summary</span>(selec_auto)<span class="sc">$</span>rsq) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb79-442"><a href="#cb79-442" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(r2a<span class="sc">-</span><span class="fu">summary</span>(selec_auto)<span class="sc">$</span>adjr2) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb79-443"><a href="#cb79-443" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cp<span class="sc">-</span><span class="fu">summary</span>(selec_auto)<span class="sc">$</span>cp) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb79-444"><a href="#cb79-444" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(bic<span class="sc">-</span><span class="fu">summary</span>(selec_auto)<span class="sc">$</span>bic) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb79-445"><a href="#cb79-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-446"><a href="#cb79-446" aria-hidden="true" tabindex="-1"></a>on voit une grosse différence seulement pour le BIC donc regardons plus en détail.</span>
<span id="cb79-447"><a href="#cb79-447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=14, fig.width=26}</span></span>
<span id="cb79-448"><a href="#cb79-448" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb79-449"><a href="#cb79-449" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(<span class="fu">summary</span>(selec_auto)<span class="sc">$</span>bic, <span class="at">crit_name =</span> <span class="st">"BIC regsubstet ajusté"</span>),</span>
<span id="cb79-450"><a href="#cb79-450" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb79-451"><a href="#cb79-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-452"><a href="#cb79-452" aria-hidden="true" tabindex="-1"></a>On voit que les valeurs sont différentes mais en fait le comportement est identique. Ce qui veut dire que la différence est seulement due à une constant multiplicative près.</span>
<span id="cb79-453"><a href="#cb79-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-454"><a href="#cb79-454" aria-hidden="true" tabindex="-1"></a><span class="fu">## backward</span></span>
<span id="cb79-455"><a href="#cb79-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-456"><a href="#cb79-456" aria-hidden="true" tabindex="-1"></a>Cette fois ci on va regarder en sélection backward. D'abord, on fait à nouveau avec la fonction regsubset.</span>
<span id="cb79-457"><a href="#cb79-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-460"><a href="#cb79-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-461"><a href="#cb79-461" aria-hidden="true" tabindex="-1"></a>selec_back <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb79-462"><a href="#cb79-462" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb79-463"><a href="#cb79-463" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"backward"</span>,</span>
<span id="cb79-464"><a href="#cb79-464" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span>)</span>
<span id="cb79-465"><a href="#cb79-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-466"><a href="#cb79-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-467"><a href="#cb79-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-468"><a href="#cb79-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=18, fig.width=30}</span></span>
<span id="cb79-469"><a href="#cb79-469" aria-hidden="true" tabindex="-1"></a>SCR <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_back)<span class="sc">$</span>rss</span>
<span id="cb79-470"><a href="#cb79-470" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">r2_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb79-471"><a href="#cb79-471" aria-hidden="true" tabindex="-1"></a>r2a <span class="ot">&lt;-</span> <span class="fu">r2a_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb79-472"><a href="#cb79-472" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">cp_fun</span>(mod1, SCR)</span>
<span id="cb79-473"><a href="#cb79-473" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">aic_fun</span>(SCR)</span>
<span id="cb79-474"><a href="#cb79-474" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">&lt;-</span> <span class="fu">bic_fun</span>(SCR)</span>
<span id="cb79-475"><a href="#cb79-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-476"><a href="#cb79-476" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(r2, <span class="at">crit_name =</span> <span class="st">"R2"</span>),</span>
<span id="cb79-477"><a href="#cb79-477" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(r2a, <span class="at">crit_name =</span> <span class="st">"R2 ajusté"</span>),</span>
<span id="cb79-478"><a href="#cb79-478" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(cp, <span class="at">crit_name =</span> <span class="st">"Cp"</span>),</span>
<span id="cb79-479"><a href="#cb79-479" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(SCR, <span class="at">crit_name =</span> <span class="st">"Somme des Carrés Résiduels"</span>),</span>
<span id="cb79-480"><a href="#cb79-480" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(aic, <span class="at">crit_name =</span> <span class="st">"AIC"</span>),</span>
<span id="cb79-481"><a href="#cb79-481" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb79-482"><a href="#cb79-482" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb79-483"><a href="#cb79-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-484"><a href="#cb79-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-485"><a href="#cb79-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-486"><a href="#cb79-486" aria-hidden="true" tabindex="-1"></a>On peut également utiliser la fonction *step* de la library \{ *stats* <span class="sc">\}</span>. Pour cela, on part du plus gros modèle défini précédemment par mod1.</span>
<span id="cb79-489"><a href="#cb79-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-490"><a href="#cb79-490" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(Hitters_Without_NA)[<span class="dv">1</span>]</span>
<span id="cb79-491"><a href="#cb79-491" aria-hidden="true" tabindex="-1"></a>modselect_back_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb79-492"><a href="#cb79-492" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb79-493"><a href="#cb79-493" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="co"># trace = TRUE permet de voir le détail des étapes</span></span>
<span id="cb79-494"><a href="#cb79-494" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb79-495"><a href="#cb79-495" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="fu">log</span>(n) <span class="co"># BIC selection</span></span>
<span id="cb79-496"><a href="#cb79-496" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb79-497"><a href="#cb79-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-498"><a href="#cb79-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-499"><a href="#cb79-499" aria-hidden="true" tabindex="-1"></a>Puis on peut regarder le modèle qui optimise le critère utilisé pour la selection.</span>
<span id="cb79-502"><a href="#cb79-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-503"><a href="#cb79-503" aria-hidden="true" tabindex="-1"></a>modselect_back_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb79-504"><a href="#cb79-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-505"><a href="#cb79-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-506"><a href="#cb79-506" aria-hidden="true" tabindex="-1"></a>La fonction step propose aussi une selection avec AIC et Cp.</span>
<span id="cb79-507"><a href="#cb79-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-508"><a href="#cb79-508" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>AIC</span>
<span id="cb79-511"><a href="#cb79-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-512"><a href="#cb79-512" aria-hidden="true" tabindex="-1"></a>modselect_back_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb79-513"><a href="#cb79-513" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb79-514"><a href="#cb79-514" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb79-515"><a href="#cb79-515" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb79-516"><a href="#cb79-516" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">2</span> <span class="co"># AIC selection</span></span>
<span id="cb79-517"><a href="#cb79-517" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb79-518"><a href="#cb79-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-519"><a href="#cb79-519" aria-hidden="true" tabindex="-1"></a>modselect_back_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb79-520"><a href="#cb79-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-521"><a href="#cb79-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-522"><a href="#cb79-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-523"><a href="#cb79-523" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$C_p$</span>
<span id="cb79-526"><a href="#cb79-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-527"><a href="#cb79-527" aria-hidden="true" tabindex="-1"></a>modselect_back_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod1,</span>
<span id="cb79-528"><a href="#cb79-528" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb79-529"><a href="#cb79-529" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb79-530"><a href="#cb79-530" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"backward"</span>),</span>
<span id="cb79-531"><a href="#cb79-531" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">1</span> <span class="co"># Cp selection</span></span>
<span id="cb79-532"><a href="#cb79-532" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb79-533"><a href="#cb79-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-534"><a href="#cb79-534" aria-hidden="true" tabindex="-1"></a>modselect_back_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb79-535"><a href="#cb79-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-536"><a href="#cb79-536" aria-hidden="true" tabindex="-1"></a>On voit que parmi nos modèles, le BIC semble le plus parcimonieux mais de manière général on constate encore des valeurs de $R^2$ et $R^2_{adjusted}$ assez faibles.</span>
<span id="cb79-537"><a href="#cb79-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-538"><a href="#cb79-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-539"><a href="#cb79-539" aria-hidden="true" tabindex="-1"></a><span class="fu">## forward</span></span>
<span id="cb79-540"><a href="#cb79-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-541"><a href="#cb79-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-542"><a href="#cb79-542" aria-hidden="true" tabindex="-1"></a>Cette fois ci on va regarder en sélection *forward*. D'abord, on fait à nouveau avec la fonction regsubset.</span>
<span id="cb79-543"><a href="#cb79-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-546"><a href="#cb79-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-547"><a href="#cb79-547" aria-hidden="true" tabindex="-1"></a>selec_forw <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(Salary<span class="sc">~</span>.,</span>
<span id="cb79-548"><a href="#cb79-548" aria-hidden="true" tabindex="-1"></a>                         Hitters_Without_NA,</span>
<span id="cb79-549"><a href="#cb79-549" aria-hidden="true" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">"forward"</span>,</span>
<span id="cb79-550"><a href="#cb79-550" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nvmax =</span> <span class="dv">19</span>)</span>
<span id="cb79-551"><a href="#cb79-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-552"><a href="#cb79-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-553"><a href="#cb79-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-554"><a href="#cb79-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=18, fig.width=30}</span></span>
<span id="cb79-555"><a href="#cb79-555" aria-hidden="true" tabindex="-1"></a>SCR <span class="ot">&lt;-</span> <span class="fu">summary</span>(selec_forw)<span class="sc">$</span>rss</span>
<span id="cb79-556"><a href="#cb79-556" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">r2_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb79-557"><a href="#cb79-557" aria-hidden="true" tabindex="-1"></a>r2a <span class="ot">&lt;-</span> <span class="fu">r2a_fun</span>(Hitters_Without_NA<span class="sc">$</span>Salary, SCR)</span>
<span id="cb79-558"><a href="#cb79-558" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">cp_fun</span>(mod1, SCR)</span>
<span id="cb79-559"><a href="#cb79-559" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">aic_fun</span>(SCR)</span>
<span id="cb79-560"><a href="#cb79-560" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">&lt;-</span> <span class="fu">bic_fun</span>(SCR)</span>
<span id="cb79-561"><a href="#cb79-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-562"><a href="#cb79-562" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">Criteria_plot</span>(r2, <span class="at">crit_name =</span> <span class="st">"R2"</span>),</span>
<span id="cb79-563"><a href="#cb79-563" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(r2a, <span class="at">crit_name =</span> <span class="st">"R2 ajusté"</span>),</span>
<span id="cb79-564"><a href="#cb79-564" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(cp, <span class="at">crit_name =</span> <span class="st">"Cp"</span>),</span>
<span id="cb79-565"><a href="#cb79-565" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(SCR, <span class="at">crit_name =</span> <span class="st">"Somme des Carrés Résiduels"</span>),</span>
<span id="cb79-566"><a href="#cb79-566" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(aic, <span class="at">crit_name =</span> <span class="st">"AIC"</span>),</span>
<span id="cb79-567"><a href="#cb79-567" aria-hidden="true" tabindex="-1"></a>             <span class="fu">Criteria_plot</span>(bic, <span class="at">crit_name =</span> <span class="st">"BIC"</span>),</span>
<span id="cb79-568"><a href="#cb79-568" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb79-569"><a href="#cb79-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-570"><a href="#cb79-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-571"><a href="#cb79-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-572"><a href="#cb79-572" aria-hidden="true" tabindex="-1"></a>On peut également utiliser la fonction *step* de la library \{ *stats* <span class="sc">\}</span>. Cette fois ci il faut définir en modèle de départ le plus petit modèle (celui composé seulement de l'intercept).</span>
<span id="cb79-575"><a href="#cb79-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-576"><a href="#cb79-576" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Salary<span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb79-577"><a href="#cb79-577" aria-hidden="true" tabindex="-1"></a>           Hitters_Without_NA)</span>
<span id="cb79-578"><a href="#cb79-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-579"><a href="#cb79-579" aria-hidden="true" tabindex="-1"></a>modselect_forw_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb79-580"><a href="#cb79-580" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb79-581"><a href="#cb79-581" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, <span class="co"># trace = TRUE permet de voir le détail des étapes</span></span>
<span id="cb79-582"><a href="#cb79-582" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb79-583"><a href="#cb79-583" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="fu">log</span>(n) <span class="co"># BIC selection</span></span>
<span id="cb79-584"><a href="#cb79-584" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb79-585"><a href="#cb79-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-586"><a href="#cb79-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-587"><a href="#cb79-587" aria-hidden="true" tabindex="-1"></a>Puis on peut regarder le modèle qui optimise le critère utilisé pour la selection.</span>
<span id="cb79-590"><a href="#cb79-590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-591"><a href="#cb79-591" aria-hidden="true" tabindex="-1"></a>modselect_forw_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb79-592"><a href="#cb79-592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-593"><a href="#cb79-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-594"><a href="#cb79-594" aria-hidden="true" tabindex="-1"></a>La fonction step propose aussi une selection avec AIC et Cp.</span>
<span id="cb79-595"><a href="#cb79-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-596"><a href="#cb79-596" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>AIC</span>
<span id="cb79-599"><a href="#cb79-599" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-600"><a href="#cb79-600" aria-hidden="true" tabindex="-1"></a>modselect_forw_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb79-601"><a href="#cb79-601" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb79-602"><a href="#cb79-602" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb79-603"><a href="#cb79-603" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb79-604"><a href="#cb79-604" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">2</span> <span class="co"># AIC selection</span></span>
<span id="cb79-605"><a href="#cb79-605" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb79-606"><a href="#cb79-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-607"><a href="#cb79-607" aria-hidden="true" tabindex="-1"></a>modselect_forw_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb79-608"><a href="#cb79-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-609"><a href="#cb79-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-610"><a href="#cb79-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-611"><a href="#cb79-611" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$C_p$</span>
<span id="cb79-614"><a href="#cb79-614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-615"><a href="#cb79-615" aria-hidden="true" tabindex="-1"></a>modselect_forw_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb79-616"><a href="#cb79-616" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb79-617"><a href="#cb79-617" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>, </span>
<span id="cb79-618"><a href="#cb79-618" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"forward"</span>),</span>
<span id="cb79-619"><a href="#cb79-619" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">1</span> <span class="co"># Cp selection</span></span>
<span id="cb79-620"><a href="#cb79-620" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb79-621"><a href="#cb79-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-622"><a href="#cb79-622" aria-hidden="true" tabindex="-1"></a>modselect_forw_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb79-623"><a href="#cb79-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-624"><a href="#cb79-624" aria-hidden="true" tabindex="-1"></a>On voit que parmi nos modèles, le BIC semble le plus parcimonieux mais de manière général on constate encore des valeurs de $R^2$ et $R^2_{adjusted}$ assez faibles.</span>
<span id="cb79-625"><a href="#cb79-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-626"><a href="#cb79-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-627"><a href="#cb79-627" aria-hidden="true" tabindex="-1"></a><span class="fu">## both </span></span>
<span id="cb79-628"><a href="#cb79-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-629"><a href="#cb79-629" aria-hidden="true" tabindex="-1"></a>Maintenant on va regarder en sélection *both*. On va alors utiliser la fonction *step* directement.</span>
<span id="cb79-632"><a href="#cb79-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-633"><a href="#cb79-633" aria-hidden="true" tabindex="-1"></a>modselect_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb79-634"><a href="#cb79-634" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb79-635"><a href="#cb79-635" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb79-636"><a href="#cb79-636" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb79-637"><a href="#cb79-637" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="fu">log</span>(n))</span>
<span id="cb79-638"><a href="#cb79-638" aria-hidden="true" tabindex="-1"></a>modselect_bic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb79-639"><a href="#cb79-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-642"><a href="#cb79-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-643"><a href="#cb79-643" aria-hidden="true" tabindex="-1"></a>modselect_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb79-644"><a href="#cb79-644" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb79-645"><a href="#cb79-645" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb79-646"><a href="#cb79-646" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb79-647"><a href="#cb79-647" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb79-648"><a href="#cb79-648" aria-hidden="true" tabindex="-1"></a>modselect_aic <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb79-649"><a href="#cb79-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-650"><a href="#cb79-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-653"><a href="#cb79-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-654"><a href="#cb79-654" aria-hidden="true" tabindex="-1"></a>modselect_cp <span class="ot">&lt;-</span> <span class="fu">step</span>(mod0,</span>
<span id="cb79-655"><a href="#cb79-655" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(mod1),</span>
<span id="cb79-656"><a href="#cb79-656" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb79-657"><a href="#cb79-657" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"both"</span>),</span>
<span id="cb79-658"><a href="#cb79-658" aria-hidden="true" tabindex="-1"></a>                  <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb79-659"><a href="#cb79-659" aria-hidden="true" tabindex="-1"></a>modselect_cp <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb79-660"><a href="#cb79-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-661"><a href="#cb79-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-662"><a href="#cb79-662" aria-hidden="true" tabindex="-1"></a>Malheuresement, même en sélection *both* nous avons encore des $R^2$ et $R^2_{adjusted}$ faibles.</span>
<span id="cb79-663"><a href="#cb79-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-664"><a href="#cb79-664" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb79-665"><a href="#cb79-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-666"><a href="#cb79-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-667"><a href="#cb79-667" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb79-668"><a href="#cb79-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-669"><a href="#cb79-669" aria-hidden="true" tabindex="-1"></a>À la lumière des résultats de notre analyse, on peut envisager le modèle *both* car bien qu'il n'ait pas montré de grandes améliorations en termes de $R^2$ et $R^2_{adjusted}$, il permet de réduire le nombre de variables tout en maintenant celles qui sont significatives. Ce modèle est donc plus parcimonieux tout en conservant des variables importantes. Cependant, une réflexion supplémentaire pourrait être menée sur l'éventuelle suppression de l'*intercept*, ce qui nécessiterait une validation supplémentaire.</span>
<span id="cb79-670"><a href="#cb79-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-671"><a href="#cb79-671" aria-hidden="true" tabindex="-1"></a>En ce qui concerne le choix final du modèle, on peut opté pour celui qui maximise le critère BIC, ce qui nous mène à un modèle avec 6 variables. Le BIC est particulièrement utile pour privilégier un modèle plus simple et plus parcimonieux, ce qui est un atout lorsqu'on cherche à éviter un surajustement. Toutefois, il est important de noter que la qualité de l'ajustement n'est pas optimale, ce qui suggère qu'il pourrait manquer certaines informations pour expliquer pleinement la variable cible (le salaire).</span>
<span id="cb79-672"><a href="#cb79-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-673"><a href="#cb79-673" aria-hidden="true" tabindex="-1"></a>Enfin, la validité interne est un aspect crucial qui n'a pas été suffisamment exploré dans cette analyse. Il aurait été pertinent de vérifier que toutes les hypothèses sous-jacentes des modèles étaient satisfaites. Cela aurait permis de renforcer la robustesse de nos résultats et de garantir que les conclusions qu'on sont fiables.</span>
<span id="cb79-674"><a href="#cb79-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-675"><a href="#cb79-675" aria-hidden="true" tabindex="-1"></a>Donc, il serait pertinent d'examiner plus en profondeur la validité interne, notamment en testant les hypothèses de normalité, d'homoscédasticité, et d'indépendance des résidus.</span>
<span id="cb79-676"><a href="#cb79-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-677"><a href="#cb79-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-678"><a href="#cb79-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-679"><a href="#cb79-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-680"><a href="#cb79-680" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session info </span></span>
<span id="cb79-681"><a href="#cb79-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-684"><a href="#cb79-684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-685"><a href="#cb79-685" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>(<span class="at">pkgs =</span> <span class="st">"attached"</span>)</span>
<span id="cb79-686"><a href="#cb79-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>