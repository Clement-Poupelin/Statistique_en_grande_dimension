{
  "hash": "ec633a2a350dd2940abe4092238cf856",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Exercice 2\"\nauthor: \"Clément Poupelin\"\ndate: \"2025-02-18\"\nformat: \n  html:\n    embed-resources: false\n    toc: true\n    code-fold: true\n    code-summary: \"Show the code\"\n    code-tools: true\n    toc-location: right\n    page-layout: article\n    code-overflow: wrap\ntoc: true\nnumber-sections: false\neditor: visual\ncategories: [\"TP\"]\nimage: \"/img/baseball.png\"\ndescription: \"Ici, on continu sur des données de baseball à utilser des méthodes de regression avec selection de variable en testant le lien linéaire existant et en mettant en avant le fléau de la dimensionalité\"\n---\n\n\n\n# Setup\n\n::: panel-tabset\n## packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Données\nlibrary(ISLR)         # Hitters data \nlibrary(dplyr)        # manipulation des données\n```\n:::\n\n\n\n## Fonctions\n:::\n\n# Données\n\nOn étudie à nouveau le jeu de données [**Hitters**](https://rdrr.io/cran/ISLR/man/Hitters.html) disponible dans la libraire { *ISLR* } de *R*.\n\nIl s'agit d'un jeu de données de la Major League Baseball provenant des saisons de 1986 et 1987 possèdant 322 lignes/individus pour les différents joueurs et 20 variables.\n\nParmi les variables, on trouve les informations suivantes :\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover table-condensed\" style=\"margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">AtBat</span> </td>\n   <td style=\"text-align:left;\"> Number of times at bat in 1986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">Hits</span> </td>\n   <td style=\"text-align:left;\"> Number of hits in 1986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">HmRun</span> </td>\n   <td style=\"text-align:left;\"> Number of home runs in 1986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">Runs</span> </td>\n   <td style=\"text-align:left;\"> Number of runs in 1986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">RBI</span> </td>\n   <td style=\"text-align:left;\"> Number of runs batted in in 1986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">Walks</span> </td>\n   <td style=\"text-align:left;\"> Number of walks in 1986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">Years</span> </td>\n   <td style=\"text-align:left;\"> Number of years in the major leagues </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">CAtBat</span> </td>\n   <td style=\"text-align:left;\"> Number of times at bat during his career </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">CHits</span> </td>\n   <td style=\"text-align:left;\"> Number of hits during his career </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">CHmRun</span> </td>\n   <td style=\"text-align:left;\"> Number of home runs during his career </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">CRuns</span> </td>\n   <td style=\"text-align:left;\"> Number of runs during his career </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">CRBI</span> </td>\n   <td style=\"text-align:left;\"> Number of runs batted in during his career </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">CWalks</span> </td>\n   <td style=\"text-align:left;\"> Number of walks during his career </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">League</span> </td>\n   <td style=\"text-align:left;\"> A factor with levels A and N indicating player's league at the end of 1986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">Division</span> </td>\n   <td style=\"text-align:left;\"> A factor with levels E and W indicating player's division at the end of 1986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">PutOuts</span> </td>\n   <td style=\"text-align:left;\"> Number of put outs in 1986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">Assists</span> </td>\n   <td style=\"text-align:left;\"> Number of assists in 1986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">Errors</span> </td>\n   <td style=\"text-align:left;\"> Number of errors in 1986 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">Salary</span> </td>\n   <td style=\"text-align:left;\"> 1987 annual salary on opening day in thousands of dollars </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> <span style=\" font-weight: bold;    \">NewLeague</span> </td>\n   <td style=\"text-align:left;\"> A factor with levels A and N indicating player's league at the beginning of 1987 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nRegardons maintenant le *summary*() pour examiner les différentes variables.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ?Hitters\nHitters %>%\n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     AtBat            Hits         HmRun            Runs       \n Min.   : 16.0   Min.   :  1   Min.   : 0.00   Min.   :  0.00  \n 1st Qu.:255.2   1st Qu.: 64   1st Qu.: 4.00   1st Qu.: 30.25  \n Median :379.5   Median : 96   Median : 8.00   Median : 48.00  \n Mean   :380.9   Mean   :101   Mean   :10.77   Mean   : 50.91  \n 3rd Qu.:512.0   3rd Qu.:137   3rd Qu.:16.00   3rd Qu.: 69.00  \n Max.   :687.0   Max.   :238   Max.   :40.00   Max.   :130.00  \n                                                               \n      RBI             Walks            Years            CAtBat       \n Min.   :  0.00   Min.   :  0.00   Min.   : 1.000   Min.   :   19.0  \n 1st Qu.: 28.00   1st Qu.: 22.00   1st Qu.: 4.000   1st Qu.:  816.8  \n Median : 44.00   Median : 35.00   Median : 6.000   Median : 1928.0  \n Mean   : 48.03   Mean   : 38.74   Mean   : 7.444   Mean   : 2648.7  \n 3rd Qu.: 64.75   3rd Qu.: 53.00   3rd Qu.:11.000   3rd Qu.: 3924.2  \n Max.   :121.00   Max.   :105.00   Max.   :24.000   Max.   :14053.0  \n                                                                     \n     CHits            CHmRun           CRuns             CRBI        \n Min.   :   4.0   Min.   :  0.00   Min.   :   1.0   Min.   :   0.00  \n 1st Qu.: 209.0   1st Qu.: 14.00   1st Qu.: 100.2   1st Qu.:  88.75  \n Median : 508.0   Median : 37.50   Median : 247.0   Median : 220.50  \n Mean   : 717.6   Mean   : 69.49   Mean   : 358.8   Mean   : 330.12  \n 3rd Qu.:1059.2   3rd Qu.: 90.00   3rd Qu.: 526.2   3rd Qu.: 426.25  \n Max.   :4256.0   Max.   :548.00   Max.   :2165.0   Max.   :1659.00  \n                                                                     \n     CWalks        League  Division    PutOuts          Assists     \n Min.   :   0.00   A:175   E:157    Min.   :   0.0   Min.   :  0.0  \n 1st Qu.:  67.25   N:147   W:165    1st Qu.: 109.2   1st Qu.:  7.0  \n Median : 170.50                    Median : 212.0   Median : 39.5  \n Mean   : 260.24                    Mean   : 288.9   Mean   :106.9  \n 3rd Qu.: 339.25                    3rd Qu.: 325.0   3rd Qu.:166.0  \n Max.   :1566.00                    Max.   :1378.0   Max.   :492.0  \n                                                                    \n     Errors          Salary       NewLeague\n Min.   : 0.00   Min.   :  67.5   A:176    \n 1st Qu.: 3.00   1st Qu.: 190.0   N:146    \n Median : 6.00   Median : 425.0            \n Mean   : 8.04   Mean   : 535.9            \n 3rd Qu.:11.00   3rd Qu.: 750.0            \n Max.   :32.00   Max.   :2460.0            \n                 NA's   :59                \n```\n\n\n:::\n:::\n\n\n\n::: callout-warning\nOn peut déjà remarquer la présence de 59 valeurs manquantes pour la variable *Salary*.\n:::\n\nOn va donc commencer par s'en débarasser (il ne s'agit que de 59 lignes sur 322). Puis on va également se concentrer sur les variables quantitatives .\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHitters_Without_NA <- Hitters %>% na.omit()\n```\n:::\n\n\n\nPuis cette fois ci nous allons simplement nous concentrer sur un sous jeu de données composé des 18 premières lignes sans valeurs manquantes.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHitters_Without_NA_18 <- Hitters_Without_NA[1:18, ]\nHitters_Without_NA_18 %>% dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 18 20\n```\n\n\n:::\n:::\n\n\n\n::: callout-warning\nAttention, on peut remarquer ici que le nombre de variable est supérieur au nombre d'individus.\n:::\n\nMaintenant, il conviendrait dans ce genre de situation d'effectuer de premières analyses descritptives. Mais celle ci ayant déjà été faite pendant l'[Exercice 1](../posts/Exercice_01.qmd), on se permettra de ne pas les refaires.\n\n# Analyse inférentielle\n\n## Modèle brut\n\nOn désire modéliser le salaire *Salary* en fonction des variables disponibles.\n\nOn va donc ajuster un modèle de régression linéaire en utilisant toutes les variables à disposition et analyser la qualité de cet ajustement.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 <- lm(formula = Salary ~ .,\n           Hitters_Without_NA_18) \nmod1 %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Salary ~ ., data = Hitters_Without_NA_18)\n\nResiduals:\nALL 18 residuals are 0: no residual degrees of freedom!\n\nCoefficients: (2 not defined because of singularities)\n             Estimate Std. Error t value Pr(>|t|)\n(Intercept) -223.7909        NaN     NaN      NaN\nAtBat         -3.2428        NaN     NaN      NaN\nHits          13.1990        NaN     NaN      NaN\nHmRun        -60.8834        NaN     NaN      NaN\nRuns           0.6875        NaN     NaN      NaN\nRBI           10.3993        NaN     NaN      NaN\nWalks          7.0114        NaN     NaN      NaN\nYears         -2.3702        NaN     NaN      NaN\nCAtBat         0.2643        NaN     NaN      NaN\nCHits         -1.7919        NaN     NaN      NaN\nCHmRun         5.3897        NaN     NaN      NaN\nCRuns          4.0162        NaN     NaN      NaN\nCRBI          -4.0134        NaN     NaN      NaN\nCWalks         1.5822        NaN     NaN      NaN\nLeagueN      233.6380        NaN     NaN      NaN\nDivisionW    299.1771        NaN     NaN      NaN\nPutOuts       -0.1250        NaN     NaN      NaN\nAssists       -0.8539        NaN     NaN      NaN\nErrors             NA         NA      NA       NA\nNewLeagueN         NA         NA      NA       NA\n\nResidual standard error: NaN on 0 degrees of freedom\nMultiple R-squared:      1,\tAdjusted R-squared:    NaN \nF-statistic:   NaN on 17 and 0 DF,  p-value: NA\n```\n\n\n:::\n:::\n\n\n\n::: success-header\n::: success-icon\n::: \nRésultats\n:::\n\n::: success\nOn peut clairement constater que ce modèle brut ne fonctionne pas avec pourtant un $R^2 = 1$. On retrouve donc le problème typique de l'analyse en grande dimension lorsque $p>n$ (fléau de la dimensionalité).\n:::\n\n\nOn peut aussi s'amuser à regarder les critères AIC et BIC de ce modèles qui se retrouve à tendre vers l'infini.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat( \"AIC = \", AIC(mod1), \"et BIC = \", BIC(mod1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAIC =  -Inf et BIC =  -Inf\n```\n\n\n:::\n:::\n\n\n\n### Prediction\n\nOn va maintenant tenter de prédire la variable *Salary* pour les autres joueurs.\n\nDéjà on peut regarder sur les 18 joueurs si la prédiction via le modèle nous donne des bonnes valeur.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSalary_hat <- predict(mod1, Hitters_Without_NA_18)\nSalary <- Hitters_Without_NA_18$Salary\n```\n:::\n\n\n\n- $\\widehat{Salary} - Salary =$ 0\n\nCe que l'on constate c'est qu'effectivement nous sommes avec un résultat qui pourrait nous faire penser que le modèle est bien ajusté.\n \n \nPourtant si nous regardons la prédiction obtenue par le modèle pour les autres joueurs et que nous effectuons la même soustraction pour comparer la qualité de prediction, nous voyons bien l'inéfficacité du modèle. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHitters_Without_NA_No18 <- Hitters_Without_NA[19:nrow(Hitters_Without_NA),]\nSalary_hat_No18 <- predict(mod1, Hitters_Without_NA_No18)\nSalary_No18 <- Hitters_Without_NA_No18$Salary\nsummary(Salary_hat_No18 - Salary_No18 )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-2363.67  -424.10   -49.12   -70.88   294.40  2648.41 \n```\n\n\n:::\n:::\n\n\n\nEn effet on voit bien au dessus que les valeurs ne sont pas proche de 0 en moyennes et on même des valeurs assez extrêmes.\n\n\n## Modèles parcimonieux\n\nOn va maintenant mettre un oeuvre une méthode de sélection automatique classique pour réduire le nombre de variable explicative et tenter d'éviter les problèmes de grande dimension.\n\nPour cela nous allons donc partir du plus petit modèle (celui avec seulement l'*intercept*) puis faire grandir le nombre de variable. Il av donc s'agir d'une méthode de sélection automatique *forward*.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod0 <- lm(Salary~1, Hitters_Without_NA_18)\nmod_forw <- step(mod0,\n                 scope = formula(mod1),\n                 trace = FALSE,\n                 direction = c(\"forward\"))\nmod_forw %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Salary ~ CWalks + League, data = Hitters_Without_NA_18)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-215.51  -82.67  -48.10   26.13  302.49 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  259.3539    77.1270   3.363  0.00427 ** \nCWalks         0.9699     0.1606   6.039 2.27e-05 ***\nLeagueN     -137.2850    79.1236  -1.735  0.10322    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 160.8 on 15 degrees of freedom\nMultiple R-squared:  0.7495,\tAdjusted R-squared:  0.7161 \nF-statistic: 22.44 on 2 and 15 DF,  p-value: 3.095e-05\n```\n\n\n:::\n:::\n\n\n\n\n::: success-header\n::: success-icon\n::: \nRésultats\n:::\n\n::: success\nNous obtenons maintenant un modèle avec 2 variable dont une significative. Puis nous pouvons constater des valeurs assez élevés pour le $R^2$ et $R^2_{adjusted}$.\n\nRegardons aussi les critères AIC et BIC.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat( \"AIC = \", AIC(mod_forw), \"et BIC = \", BIC(mod_forw))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAIC =  238.6917 et BIC =  242.2531\n```\n\n\n:::\n:::\n\n\n:::\n\nMaintenant, nous allons permuter de façon aléatoire les salaires des 18 joueurs et refaire la même analyse inférentielle. Ainsi, le lien linéaire devrait disparaitre et nous donner de mauvais résultats.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSalary_permute <- sample(Salary)\n\nmod1_permute <- lm(Salary_permute~., Hitters_Without_NA_18)\nmod1_permute %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Salary_permute ~ ., data = Hitters_Without_NA_18)\n\nResiduals:\nALL 18 residuals are 0: no residual degrees of freedom!\n\nCoefficients: (3 not defined because of singularities)\n             Estimate Std. Error t value Pr(>|t|)\n(Intercept) -822.0887        NaN     NaN      NaN\nAtBat          0.5933        NaN     NaN      NaN\nHits          -6.7053        NaN     NaN      NaN\nHmRun       -122.2282        NaN     NaN      NaN\nRuns           6.6566        NaN     NaN      NaN\nRBI           30.9676        NaN     NaN      NaN\nWalks         15.5688        NaN     NaN      NaN\nYears        122.4281        NaN     NaN      NaN\nCAtBat        -2.2144        NaN     NaN      NaN\nCHits          2.5295        NaN     NaN      NaN\nCHmRun         2.1420        NaN     NaN      NaN\nCRuns         10.6507        NaN     NaN      NaN\nCRBI          -1.4325        NaN     NaN      NaN\nCWalks        -0.5231        NaN     NaN      NaN\nLeagueN      380.0268        NaN     NaN      NaN\nDivisionW    492.9926        NaN     NaN      NaN\nPutOuts        0.5733        NaN     NaN      NaN\nAssists       -0.8438        NaN     NaN      NaN\nErrors             NA         NA      NA       NA\nSalary             NA         NA      NA       NA\nNewLeagueN         NA         NA      NA       NA\n\nResidual standard error: NaN on 0 degrees of freedom\nMultiple R-squared:      1,\tAdjusted R-squared:    NaN \nF-statistic:   NaN on 17 and 0 DF,  p-value: NA\n```\n\n\n:::\n:::\n\n\n\nA nouveau on peut constater l'inéfficacité d'un modèle avec toutes les variables du fait d'avoir $p>n$.\n\nUtilisons maintenant la sélection automatique.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod0_permute <- lm(Salary_permute~1, Hitters_Without_NA_18)\nmod_forw_permute <- step(mod0_permute, \n                         scope = formula(mod1_permute),\n                         trace = FALSE,\n                         direction = c(\"forward\"))\nmod_forw_permute %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Salary_permute ~ HmRun + Assists + League + CWalks + \n    Salary + AtBat + PutOuts + CHmRun + Years + Runs + RBI + \n    Hits + CRBI, data = Hitters_Without_NA_18)\n\nResiduals:\n      -Alan Ashby      -Alvin Davis     -Andre Dawson -Andres Galarraga \n           69.099             4.154            36.276           -72.432 \n -Alfredo Griffin        -Al Newman  -Argenis Salazar    -Andres Thomas \n          -54.959             4.437            25.579             2.892 \n  -Andre Thornton    -Alan Trammell     -Alex Trevino    -Andy VanSlyke \n          -39.065            40.957            28.494            13.052 \n    -Alan Wiggins       -Bill Almon       -Buddy Bell -Buddy Biancalana \n           34.930           -37.305           -23.857           -11.596 \n     -Bruce Bochy      -Barry Bonds \n          -31.338            10.682 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)   \n(Intercept)  541.9134   161.0329   3.365  0.02817 * \nHmRun         20.3892    20.6526   0.987  0.37941   \nAssists        1.0335     0.5006   2.065  0.10789   \nLeagueN     -118.7813    76.6127  -1.550  0.19598   \nCWalks        -2.8142     0.6995  -4.023  0.01582 * \nSalary         1.6503     0.3207   5.145  0.00677 **\nAtBat         -1.6605     1.7671  -0.940  0.40060   \nPutOuts        0.6403     0.1535   4.171  0.01402 * \nCHmRun         0.6953     2.1370   0.325  0.76120   \nYears        -34.5859    11.5835  -2.986  0.04051 * \nRuns          10.4587     3.8522   2.715  0.05326 . \nRBI           17.8717     6.1240   2.918  0.04332 * \nHits         -15.1345     7.6368  -1.982  0.11856   \nCRBI           1.2496     0.8160   1.531  0.20045   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 76.9 on 4 degrees of freedom\nMultiple R-squared:  0.9847,\tAdjusted R-squared:  0.9351 \nF-statistic: 19.84 on 13 and 4 DF,  p-value: 0.005374\n```\n\n\n:::\n:::\n\n\n\n::: success-header\n::: success-icon\n::: \nRésultats\n:::\n\n::: success\nOn retrouve ici un modèle très différent concernant les variables sélectionnés avec de très mauvais résultats de $R^2$ et $R^2_{adjusted}$.\n:::\n\nPour finir, on va maintenant reprendre le jeu de données **Hitters** complet et permuter tous les salaires de façon aléatoire. Ensuite, on va ajuster le meilleur modèle de régression possible pour expliquer les salaires en fonction des autres variables.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSalary_permute <- sample(Hitters_Without_NA$Salary)\nHitters_Without_NA_And_Salary = Hitters_Without_NA[,-19]\n\nHitters_With_Salary_permute <- cbind(Hitters_Without_NA_And_Salary, Salary_permute)\n\nmod0_permute <- lm(Salary_permute~., Hitters_With_Salary_permute)\nmod1_permute <- lm(Salary_permute~1, Hitters_With_Salary_permute)\n\n\nmod_permute_back <- step(mod1_permute,\n                         scope = formula(mod1_permute),\n                         trace = FALSE,\n                         direction = c(\"backward\"))\nmod_permute_back %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Salary_permute ~ 1, data = Hitters_With_Salary_permute)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-468.4 -345.9 -110.9  214.1 1924.1 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   535.93      27.82   19.27   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 451.1 on 262 degrees of freedom\n```\n\n\n:::\n\n```{.r .cell-code}\nmod_permute_forw <- step(mod0_permute,\n                         scope = formula(mod1_permute),\n                         trace = FALSE,\n                         direction = c(\"forward\"))\nmod_permute_forw %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Salary_permute ~ AtBat + Hits + HmRun + Runs + RBI + \n    Walks + Years + CAtBat + CHits + CHmRun + CRuns + CRBI + \n    CWalks + League + Division + PutOuts + Assists + Errors + \n    NewLeague, data = Hitters_With_Salary_permute)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-653.5 -326.1 -112.7  230.6 1792.7 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 665.29652  131.92312   5.043 8.97e-07 ***\nAtBat        -1.14759    0.92132  -1.246    0.214    \nHits          3.50834    3.45513   1.015    0.311    \nHmRun        13.66082    9.01220   1.516    0.131    \nRuns         -2.16289    4.33176  -0.499    0.618    \nRBI          -4.54579    3.77970  -1.203    0.230    \nWalks         2.37187    2.65726   0.893    0.373    \nYears        -5.60942   18.03790  -0.311    0.756    \nCAtBat        0.07581    0.19653   0.386    0.700    \nCHits        -0.45167    0.98029  -0.461    0.645    \nCHmRun       -0.89947    2.35024  -0.383    0.702    \nCRuns         0.29180    1.09060   0.268    0.789    \nCRBI          0.68887    1.00654   0.684    0.494    \nCWalks       -0.27243    0.47678  -0.571    0.568    \nLeagueN     -16.26902  115.18594  -0.141    0.888    \nDivisionW   -38.48045   58.66292  -0.656    0.512    \nPutOuts       0.12102    0.11254   1.075    0.283    \nAssists       0.15173    0.32146   0.472    0.637    \nErrors        1.06453    6.38210   0.167    0.868    \nNewLeagueN  -37.54638  114.80989  -0.327    0.744    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 458.6 on 243 degrees of freedom\nMultiple R-squared:  0.04144,\tAdjusted R-squared:  -0.03351 \nF-statistic: 0.5529 on 19 and 243 DF,  p-value: 0.9354\n```\n\n\n:::\n\n```{.r .cell-code}\nmod_permute_both <- step(mod0_permute,\n                         scope = formula(mod1_permute),\n                         trace = FALSE,\n                         direction = c(\"both\"))\nmod_permute_both %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Salary_permute ~ CRBI, data = Hitters_With_Salary_permute)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-566.0 -353.3 -121.0  236.9 1887.8 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 488.6621    39.6753  12.317   <2e-16 ***\nCRBI          0.1430     0.0859   1.665   0.0971 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 449.6 on 261 degrees of freedom\nMultiple R-squared:  0.01051,\tAdjusted R-squared:  0.006722 \nF-statistic: 2.773 on 1 and 261 DF,  p-value: 0.09706\n```\n\n\n:::\n:::\n\n\n\n::: success-header\n::: success-icon\n::: \nRésultats\n:::\n\n::: success\nOn constate de très mauvais résultats de $R^2$ et $R^2_{adjusted}$ et au final la seule variable qui semble vraiment significative est l'*intercept* ce qui montre bien qu'avec la permutation aléatoire de la variable *Salary*, le lien linéaire qui existait à disparu.\n:::\n\n\n# Conclusion\n\nOn a donc pu voir l'importance du lien linéaire dans la construction d'un modèle de regression linéaire. Cela renforce par l'exemple la véracité du modèle de régression linéaire (au cas où l'on en doutais encore).\n\n# Session info\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessioninfo::session_info(pkgs = \"attached\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.4.2 (2024-10-31)\n os       Ubuntu 24.04.1 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  fr_FR.UTF-8\n ctype    fr_FR.UTF-8\n tz       Europe/Paris\n date     2025-02-18\n pandoc   3.2 @ /usr/lib/rstudio/resources/app/bin/quarto/bin/tools/x86_64/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package    * version date (UTC) lib source\n dplyr      * 1.1.4   2023-11-17 [1] CRAN (R 4.4.2)\n forcats    * 1.0.0   2023-01-29 [1] CRAN (R 4.4.2)\n ggplot2    * 3.5.1   2024-04-23 [1] CRAN (R 4.4.2)\n ISLR       * 1.4     2021-09-15 [1] CRAN (R 4.4.2)\n kableExtra * 1.4.0   2024-01-24 [1] CRAN (R 4.4.2)\n lubridate  * 1.9.4   2024-12-08 [1] CRAN (R 4.4.2)\n purrr      * 1.0.2   2023-08-10 [2] CRAN (R 4.3.3)\n readr      * 2.1.5   2024-01-10 [1] CRAN (R 4.4.2)\n stringr    * 1.5.1   2023-11-14 [2] CRAN (R 4.3.3)\n tibble     * 3.2.1   2023-03-20 [2] CRAN (R 4.3.3)\n tidyr      * 1.3.1   2024-01-24 [1] CRAN (R 4.4.2)\n tidyverse  * 2.0.0   2023-02-22 [1] CRAN (R 4.4.2)\n\n [1] /home/clement/R/x86_64-pc-linux-gnu-library/4.4\n [2] /usr/local/lib/R/site-library\n [3] /usr/lib/R/site-library\n [4] /usr/lib/R/library\n\n──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}